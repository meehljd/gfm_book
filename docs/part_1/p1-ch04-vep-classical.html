<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Classical Variant Prediction – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_2/p2--architectures.html" rel="next">
<link href="../part_1/p1-ch03-gwas.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch04-vep-classical.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch04-conservation" id="toc-sec-ch04-conservation" class="nav-link active" data-scroll-target="#sec-ch04-conservation"><span class="header-section-number">4.1</span> Conservation-Based Approaches</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-constraint-metrics" id="toc-sec-ch04-constraint-metrics" class="nav-link" data-scroll-target="#sec-ch04-constraint-metrics"><span class="header-section-number">4.1.1</span> Evolutionary Constraint Metrics</a></li>
  <li><a href="#sec-ch04-conservation-clinical-gap" id="toc-sec-ch04-conservation-clinical-gap" class="nav-link" data-scroll-target="#sec-ch04-conservation-clinical-gap"><span class="header-section-number">4.1.2</span> What Conservation Measures Versus What Clinicians Need</a></li>
  <li><a href="#sec-ch04-conservation-boundaries" id="toc-sec-ch04-conservation-boundaries" class="nav-link" data-scroll-target="#sec-ch04-conservation-boundaries"><span class="header-section-number">4.1.3</span> Clinical Application and Boundaries</a></li>
  </ul></li>
  <li><a href="#sec-ch04-protein-predictors" id="toc-sec-ch04-protein-predictors" class="nav-link" data-scroll-target="#sec-ch04-protein-predictors"><span class="header-section-number">4.2</span> Protein-Level Predictors</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-sift" id="toc-sec-ch04-sift" class="nav-link" data-scroll-target="#sec-ch04-sift"><span class="header-section-number">4.2.1</span> <em>SIFT</em>: Sequence Homology as Functional Constraint</a></li>
  <li><a href="#sec-ch04-polyphen" id="toc-sec-ch04-polyphen" class="nav-link" data-scroll-target="#sec-ch04-polyphen"><span class="header-section-number">4.2.2</span> <em>PolyPhen-2</em>: Integrating Structure and Sequence</a></li>
  <li><a href="#sec-ch04-sequence-to-function" id="toc-sec-ch04-sequence-to-function" class="nav-link" data-scroll-target="#sec-ch04-sequence-to-function"><span class="header-section-number">4.2.3</span> From Sequence to Function</a></li>
  <li><a href="#sec-ch04-protein-boundaries" id="toc-sec-ch04-protein-boundaries" class="nav-link" data-scroll-target="#sec-ch04-protein-boundaries"><span class="header-section-number">4.2.4</span> Boundaries of Protein-Level Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch04-cadd" id="toc-sec-ch04-cadd" class="nav-link" data-scroll-target="#sec-ch04-cadd"><span class="header-section-number">4.3</span> <em>CADD</em> Framework</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-cadd-training" id="toc-sec-ch04-cadd-training" class="nav-link" data-scroll-target="#sec-ch04-cadd-training"><span class="header-section-number">4.3.1</span> Evolutionary Proxy Training and Label Sources</a></li>
  <li><a href="#sec-ch04-cadd-features" id="toc-sec-ch04-cadd-features" class="nav-link" data-scroll-target="#sec-ch04-cadd-features"><span class="header-section-number">4.3.2</span> Feature Integration</a></li>
  <li><a href="#sec-ch04-cadd-scoring" id="toc-sec-ch04-cadd-scoring" class="nav-link" data-scroll-target="#sec-ch04-cadd-scoring"><span class="header-section-number">4.3.3</span> Model Architecture and Scoring</a></li>
  <li><a href="#sec-ch04-proxy-problem" id="toc-sec-ch04-proxy-problem" class="nav-link" data-scroll-target="#sec-ch04-proxy-problem"><span class="header-section-number">4.3.4</span> Evolutionary Proxy Problem</a></li>
  </ul></li>
  <li><a href="#sec-ch04-ensemble-methods" id="toc-sec-ch04-ensemble-methods" class="nav-link" data-scroll-target="#sec-ch04-ensemble-methods"><span class="header-section-number">4.4</span> Other Ensemble Methods</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-revel" id="toc-sec-ch04-revel" class="nav-link" data-scroll-target="#sec-ch04-revel"><span class="header-section-number">4.4.1</span> <em>REVEL</em></a></li>
  <li><a href="#sec-ch04-mcap" id="toc-sec-ch04-mcap" class="nav-link" data-scroll-target="#sec-ch04-mcap"><span class="header-section-number">4.4.2</span> <em>M-CAP</em></a></li>
  <li><a href="#sec-ch04-ensemble-comparison" id="toc-sec-ch04-ensemble-comparison" class="nav-link" data-scroll-target="#sec-ch04-ensemble-comparison"><span class="header-section-number">4.4.3</span> Comparison and Selection</a></li>
  </ul></li>
  <li><a href="#sec-ch04-circularity" id="toc-sec-ch04-circularity" class="nav-link" data-scroll-target="#sec-ch04-circularity"><span class="header-section-number">4.5</span> Circularity and Ascertainment Bias</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-circularity-definition" id="toc-sec-ch04-circularity-definition" class="nav-link" data-scroll-target="#sec-ch04-circularity-definition"><span class="header-section-number">4.5.1</span> Circularity Problem</a></li>
  <li><a href="#sec-ch04-ascertainment" id="toc-sec-ch04-ascertainment" class="nav-link" data-scroll-target="#sec-ch04-ascertainment"><span class="header-section-number">4.5.2</span> Ascertainment Bias</a></li>
  <li><a href="#sec-ch04-clinical-implications" id="toc-sec-ch04-clinical-implications" class="nav-link" data-scroll-target="#sec-ch04-clinical-implications"><span class="header-section-number">4.5.3</span> Implications for Clinical Use</a></li>
  </ul></li>
  <li><a href="#sec-ch04-feature-limitations" id="toc-sec-ch04-feature-limitations" class="nav-link" data-scroll-target="#sec-ch04-feature-limitations"><span class="header-section-number">4.6</span> Limitations of the Feature Engineering Paradigm</a>
  <ul class="collapse">
  <li><a href="#sec-ch04-feature-ceiling" id="toc-sec-ch04-feature-ceiling" class="nav-link" data-scroll-target="#sec-ch04-feature-ceiling"><span class="header-section-number">4.6.1</span> Feature Ceiling</a></li>
  <li><a href="#sec-ch04-limited-context" id="toc-sec-ch04-limited-context" class="nav-link" data-scroll-target="#sec-ch04-limited-context"><span class="header-section-number">4.6.2</span> Limited Context</a></li>
  <li><a href="#sec-ch04-measurement-gap" id="toc-sec-ch04-measurement-gap" class="nav-link" data-scroll-target="#sec-ch04-measurement-gap"><span class="header-section-number">4.6.3</span> Persistent Gap Between Measurement and Need</a></li>
  <li><a href="#sec-ch04-features-to-representations" id="toc-sec-ch04-features-to-representations" class="nav-link" data-scroll-target="#sec-ch04-features-to-representations"><span class="header-section-number">4.6.4</span> From Features to Representations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch04-vep-classical.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch04-vep-classical" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Every classical predictor measures a proxy, and proxies can lie.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 40-50 minutes</p>
<p><strong>Prerequisites:</strong> Understanding of genetic variants (SNPs, indels, missense/nonsense terminology) from Chapter 1; familiarity with population databases and allele frequency concepts from Chapter 2; basic awareness of GWAS principles from Chapter 3. No machine learning background required.</p>
<p><strong>You will learn:</strong></p>
<ul>
<li>How conservation scores quantify evolutionary constraint and why they serve as proxies for function</li>
<li>How protein-level predictors (<em>SIFT</em>, <em>PolyPhen-2</em>) assess amino acid substitution severity</li>
<li>How <em>CADD</em> pioneered evolutionary proxy training and feature integration for variant scoring</li>
<li>Why the gap between what we measure and what clinicians need represents a fundamental limitation</li>
<li>How circularity and ascertainment bias affect all variant effect predictors</li>
</ul>
<p><strong>Key insight:</strong> Every classical predictor measures a proxy for clinical pathogenicity, not pathogenicity itself. Conservation scores measure evolutionary fitness, not disease relevance. Protein predictors measure structural disruption, not clinical consequence. Understanding these gaps is essential for appropriate interpretation.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Why This Matters to You">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why This Matters to You
</div>
</div>
<div class="callout-body-container callout-body">
<p>Whether you are interpreting variants for clinical diagnosis, training foundation models for VEP, or evaluating new prediction tools, you will encounter classical predictors constantly: <em>SIFT</em>, <em>PolyPhen-2</em>, and <em>CADD</em> appear in nearly every clinical variant report. Understanding what these tools actually measure (and what they miss) protects you from over-trusting their outputs and helps you recognize when foundation models genuinely improve over classical baselines versus when they merely inherit the same biases. After this chapter, you’ll be able to critically evaluate any variant predictor by asking: <em>What proxy does it measure, and where does that proxy fail?</em></p>
</div>
</div>
<p><strong>Conservation scores</strong> measure evolutionary constraint, not disease relevance. Protein-level predictors estimate structural disruption, not clinical pathogenicity. Splice site algorithms identify sequence motifs, not functional consequences. Every classical variant effect predictor measures something <em>correlated</em> with what clinicians actually need to know, not the thing itself: will this variant cause disease in this patient?</p>
<p>The gap between measurable signal and clinical question is irreducible. Evolutionary conservation reflects reproductive fitness, not human health; protein structure does not determine disease penetrance; and splice motifs do not guarantee splicing outcomes. Classical methods achieve what they achieve by combining multiple imperfect proxies, hoping that their convergence approximates clinical truth.</p>
<p>The conceptual foundations and practical methods that dominated variant interpretation before the foundation model era reveal both genuine insights and systematic blind spots. The trajectory from single-signal predictors through increasingly sophisticated ensemble methods traces a persistent gap: what we can measure differs from what clinicians need to know. Conservation scores like PhyloP and <strong>Genomic Evolutionary Rate Profiling (GERP)</strong> quantify purifying selection across evolutionary time, identifying positions where variation is depleted relative to neutral expectations. Protein-level tools like <em>SIFT</em> and <em>PolyPhen-2</em> assess amino acid substitutions through sequence conservation and structural features. Splice predictors identify the sequence motifs that mark intron-exon boundaries. Each approach captures genuine biological signal, but each also fails in characteristic ways: conservation misses recently evolved human-specific functions, protein predictors cannot assess non-coding variants, splice algorithms miss cryptic sites and tissue-specific regulation.</p>
<p>The field’s response was to develop integrative methods that combine multiple signals into unified scores. <em>CADD</em> receives particular attention here because it introduced design patterns that recur throughout genomic machine learning: using evolutionary signals as proxy labels, training on large-scale genomic data, integrating dozens of diverse annotations, and precomputing scores genome-wide for downstream reuse. <em>CADD</em> and its successors, including <em>REVEL</em>, <em>PrimateAI</em>, and <em>M-CAP</em>, remain in active clinical use today. Understanding their construction and limitations illuminates both what classical methods achieved and why the field ultimately moved toward learned representations (<a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a> for learned representations, <a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a> for attention mechanisms, <a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-defining" class="quarto-xref"><span>Section 14.2</span></a> for foundation model principles).</p>
<div id="fig-variant-funnel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-variant-funnel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/01-fig-variant-funnel.svg" class="img-fluid figure-img"></p>
<figcaption>The variant interpretation funnel showing progressive filtering</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-variant-funnel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: The variant interpretation funnel. Whole-genome sequencing identifies approximately 4-5 million variants per individual. Successive computational filters progressively reduce this burden to a manageable set for expert review. Common variants (allele frequency &gt;1% in gnomAD) are typically excluded as likely benign, reducing the set to ~100,000. Filtering for protein-coding or splice-relevant consequences yields ~25,000 candidates. Conservation filters (phyloP &gt; 2) reduce this to ~5,000, and ensemble predictor thresholds (CADD &gt;= 20) produce several hundred high-priority candidates. The final set for clinical review typically numbers 50-100 variants. Each filter stage applies different resources and reflects different assumptions about which variants merit attention.
</figcaption>
</figure>
</div>
<section id="sec-ch04-conservation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-ch04-conservation"><span class="header-section-number">4.1</span> Conservation-Based Approaches</h2>
<p>A clinical geneticist evaluating a novel intronic variant faces an immediate problem: no functional annotation exists for most of the genome, and no clinical database has seen this specific change before. The variant lies outside any protein-coding region, no regulatory element overlaps it, and the patient’s phenotype offers no clear mechanistic hypothesis. Yet one source of information spans the entire genome and predates any experimental annotation by billions of years. If a genomic position has remained unchanged across species separated by hundreds of millions of years of evolution, mutations at that position are likely to be deleterious. Natural selection has already performed the largest functional screen imaginable, running experiments across countless organisms over evolutionary time, and conservation scores quantify the results.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading further, consider: if a position shows the same nucleotide across humans, mice, chickens, and fish (species that diverged hundreds of millions of years ago), what can you infer about that position? What assumptions does this inference require?</p>
</div>
</div>
<p>Conservation signals derive from the population variant catalogs described in <a href="p1-ch02-data.html#sec-ch02-gnomad" class="quarto-xref"><span>Section 2.2.3</span></a>, where patterns of variation across populations reveal which positions tolerate change. The variant calling quality from <a href="p1-ch01-ngs.html#sec-ch01-classical" class="quarto-xref"><span>Section 1.3</span></a> directly affects which variants appear in constraint calculations, potentially biasing constraint metrics in regions with systematic calling errors.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Variant Types by Coding Effect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Variant Types by Coding Effect
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> Variants in protein-coding regions are classified by their effect on the amino acid sequence:</p>
<p><strong>Synonymous (Silent):</strong> The nucleotide change does not alter the amino acid due to genetic code redundancy (e.g., both GGU and GGC encode glycine). Often assumed neutral, but can affect:</p>
<ul>
<li>Splicing (exonic splice enhancers/silencers)</li>
<li>mRNA stability and structure</li>
<li>Translation efficiency (codon usage bias)</li>
</ul>
<p><strong>Nonsynonymous (Missense):</strong> The change substitutes one amino acid for another (e.g., valine → glutamate). Effect depends on:</p>
<ul>
<li>Chemical similarity of amino acids</li>
<li>Position in protein structure</li>
<li>Functional importance of the residue</li>
</ul>
<p><strong>Nonsense:</strong> Creates a premature stop codon, truncating the protein. Usually loss-of-function, but may escape nonsense-mediated decay if near the last exon.</p>
<p><strong>Frameshift:</strong> Insertion or deletion not divisible by 3, shifting the reading frame. Typically severe loss-of-function.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variant Type</th>
<th>Effect</th>
<th>Typical Consequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Synonymous</td>
<td>Same amino acid</td>
<td>Usually neutral; can affect splicing</td>
</tr>
<tr class="even">
<td>Missense</td>
<td>Different amino acid</td>
<td>Variable; depends on context</td>
</tr>
<tr class="odd">
<td>Nonsense</td>
<td>Premature stop</td>
<td>Loss-of-function</td>
</tr>
<tr class="even">
<td>Frameshift</td>
<td>Altered sequence</td>
<td>Loss-of-function</td>
</tr>
</tbody>
</table>
<p><strong>Key insight:</strong> Protein-level predictors (<em>SIFT</em>, <em>PolyPhen</em>) only assess missense variants. Other types require different prediction approaches.</p>
</div>
</div>
<div id="fig-conservation-scores" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-conservation-scores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/02-A-fig-conservation-scores.svg" class="img-fluid figure-img"></p>
<figcaption>Multiple sequence alignment revealing conservation</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/02-B-fig-conservation-scores.svg" class="img-fluid figure-img"></p>
<figcaption>Genome-wide distribution of phyloP scores</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/02-C-fig-conservation-scores.svg" class="img-fluid figure-img"></p>
<figcaption>Conservation provides evidence in annotation-sparse regions</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conservation-scores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Evolutionary conservation as a proxy for functional importance. (A) Multiple sequence alignment comparing a highly conserved position (left, same nucleotide across species) with a neutrally evolving position (right, variable nucleotides). Phylogenetic tree indicates evolutionary relationships. (B) Genome-wide distribution of phyloP scores, with most positions near zero (neutral) and a long right tail representing constrained elements. Positions with scores above 2 show strong evidence of purifying selection. (C) Genome browser view of an intronic variant with no regulatory annotations but deep conservation, illustrating how evolutionary signal provides evidence of function in annotation-sparse regions.
</figcaption>
</figure>
</div>
<section id="sec-ch04-constraint-metrics" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="sec-ch04-constraint-metrics"><span class="header-section-number">4.1.1</span> Evolutionary Constraint Metrics</h3>
<p>A clinical report arrives stating that a variant has “phyloP = 3.2” and “GERP = 4.5”—but what do these numbers actually mean? Without understanding the quantitative framework behind conservation scores, these values are opaque. The challenge is translating the qualitative intuition that “conservation implies function” into precise numerical values that can be compared across variants and combined with other evidence.</p>
<p>The logic of conservation is straightforward: if a position matters for survival or reproduction, mutations there will be removed by selection before they can spread through the population. Quantifying this signal requires comparing sequences across species to identify positions where substitutions occur less frequently than expected under neutral evolution. Conservation scores translate this evolutionary signal into numerical values that can inform variant interpretation.</p>
<p>PhyloP scores quantify the deviation of observed substitution rates from neutral expectation at individual positions <span class="citation" data-cites="siepel_phastcons_2005">(<a href="../bib/references.html#ref-siepel_phastcons_2005" role="doc-biblioref">Siepel et al. 2005</a>)</span>. The score is computed by comparing the observed pattern of bases at each alignment column against a neutral evolutionary model (typically fit to ancestral repeat sequences that are assumed to evolve without selective constraint). The choice of ancestral repeats for calibrating the neutral model is deliberate: these sequences arose from transposon insertions that have lost their original function and now accumulate mutations at rates reflecting only mutation pressure, without selective filtering. This provides a baseline against which constraint at functional positions can be measured. Positive phyloP scores indicate conservation, meaning evolution is slower than expected under neutrality. Negative scores indicate acceleration, suggesting faster evolution that may reflect positive selection. A phyloP score of 2 indicates that the observed base is approximately 100-fold more conserved than expected under neutrality, providing strong evidence that mutations at this position have been systematically removed by selection.</p>
<p>GERP takes a complementary approach by estimating rejected substitutions at each position: the number of substitutions that would have been expected under neutrality but are absent from the observed alignment <span class="citation" data-cites="davydov_identifying_2010">(<a href="../bib/references.html#ref-davydov_identifying_2010" role="doc-biblioref">Davydov et al. 2010</a>)</span>. Large positive GERP scores indicate strong constraint. For a position conserved across 30 mammalian species, a GERP score of 5 implies that approximately five substitutions were rejected by selection over mammalian evolution. This interpretation connects directly to the biological process of <strong>purifying selection</strong> but depends on accurate neutral rate estimation and alignment quality.</p>
<p><strong>phastCons</strong> provides element-level rather than position-level conservation by identifying contiguous stretches of constrained sequence <span class="citation" data-cites="siepel_phastcons_2005">(<a href="../bib/references.html#ref-siepel_phastcons_2005" role="doc-biblioref">Siepel et al. 2005</a>)</span>. Using a <strong>hidden Markov model</strong>, phastCons classifies each position as belonging to a conserved or non-conserved state, then outputs the posterior probability of conservation. The resulting scores are smoother than position-level metrics, capturing functional elements that span multiple nucleotides even when individual positions show moderate conservation. This element-level view proves particularly valuable for identifying regulatory sequences where the overall constraint matters more than any single nucleotide.</p>
<div id="tbl-conservation-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-conservation-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Comparison of major conservation metrics
</figcaption>
<div aria-describedby="tbl-conservation-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 35%">
<col style="width: 14%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>What It Measures</th>
<th>Scale</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>phyloP</strong></td>
<td>Deviation from neutral evolution rate</td>
<td>Continuous; positive = conserved</td>
<td>Score of 2 = ~100x slower than neutral</td>
</tr>
<tr class="even">
<td><strong>GERP</strong></td>
<td>Rejected substitutions</td>
<td>Continuous; higher = more constrained</td>
<td>Score of 5 = ~5 expected mutations removed</td>
</tr>
<tr class="odd">
<td><strong>phastCons</strong></td>
<td>Probability of conserved state</td>
<td>0-1 probability</td>
<td>Score of 0.9 = 90% likely constrained element</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Conservation scores from phastCons and phyloP serve as foundational features throughout computational genomics. Integrative methods like CADD (<a href="#sec-ch04-cadd" class="quarto-xref"><span>Section 4.3</span></a>) combine conservation with dozens of other annotations to score variant deleteriousness. Fine-mapping algorithms use conservation to weight prior probabilities when prioritizing causal variants within GWAS loci (<a href="p1-ch03-gwas.html#sec-ch03-ld" class="quarto-xref"><span>Section 3.3</span></a>). Yet conservation measures evolutionary fitness, not disease relevance, and variants pathogenic in humans may be invisible to cross-species constraint. This evolutionary proxy problem creates fundamental limitations for clinical interpretation, examined in <a href="#sec-ch04-conservation-clinical-gap" class="quarto-xref"><span>Section 4.1.2</span></a>.</p>
</section>
<section id="sec-ch04-conservation-clinical-gap" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="sec-ch04-conservation-clinical-gap"><span class="header-section-number">4.1.2</span> What Conservation Measures Versus What Clinicians Need</h3>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Conservation scores answer the question: “Has this position been important for organismal fitness across evolutionary time?” Clinicians need to answer: “Will this variant cause disease in my patient?” These are related but fundamentally different questions.</p>
</div>
</div>
<p>Conservation scores measure evolutionary constraint: the degree to which a position has resisted substitution over millions of years. This is not the same as clinical relevance. A position can be evolutionarily constrained for functions unrelated to human disease, or clinically important despite modest conservation. The assumption underlying conservation-based interpretation is that positions under strong constraint are more likely to be functionally important and therefore more likely to cause disease when mutated. This assumption is often correct but not universally so.</p>
<p>The clinician wants to know: will this variant cause disease in my patient? Conservation provides indirect evidence: this position has been important for organismal fitness across evolutionary time. The gap between these questions creates interpretive challenges. A variant at a highly conserved position in a gene with no known disease association provides evolutionary evidence of functional importance but no direct path to clinical interpretation. Conversely, a variant at a modestly conserved position in a well-established disease gene may be clinically significant despite weak conservation signal.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A patient has a variant at a position with phyloP = 0.5 (weak conservation) in <em>BRCA1</em>, a well-established breast cancer gene. Another patient has a variant with phyloP = 4.0 (strong conservation) in a gene with no known disease associations. Which variant is more likely to be clinically actionable? What additional information would you need?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <em>BRCA1</em> variant is more likely to be clinically actionable despite weak conservation, because gene-disease association trumps position-level constraint when making clinical decisions. Additional information needed includes: variant type (missense vs.&nbsp;nonsense), population frequency, other computational predictions, family history, and whether the variant has been reported in clinical databases like ClinVar.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-ch04-conservation-boundaries" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="sec-ch04-conservation-boundaries"><span class="header-section-number">4.1.3</span> Clinical Application and Boundaries</h3>
<p>When should a clinical laboratory trust a conservation score, and when should they treat it with skepticism? The answer depends on understanding both where conservation signals excel and where they systematically fail. A deep intronic variant with no regulatory annotations but strong conservation demands attention; a variant in an immune gene with weak conservation may still be pathogenic. Knowing when to rely on evolutionary evidence (and when to look elsewhere) separates effective variant interpretation from mechanical score-chasing.</p>
<p>Conservation scores prove particularly valuable for non-coding variant interpretation, where direct functional annotations are often incomplete or absent. A deeply conserved intronic position likely participates in splicing regulation, gene expression control, or other functional processes even if no explicit annotation overlaps it. Under ACMG-AMP guidelines for variant classification, strong conservation provides computational evidence (the PP3 criterion) supporting pathogenicity <span class="citation" data-cites="richards_standards_2015">(<a href="../bib/references.html#ref-richards_standards_2015" role="doc-biblioref">Richards et al. 2015</a>)</span>. A variant falling at a position with phyloP greater than 2 and GERP greater than 4 carries significantly more weight than one at an unconserved position, even when no other annotation is available. These scores remain central to clinical variant interpretation workflows, as examined in <a href="../part_7/p7-ch28-clinical-risk.html" class="quarto-xref"><span>Chapter 28</span></a>, where they contribute evidence alongside population frequency, functional studies, and segregation data.</p>
<p>The boundaries of conservation-based approaches are equally important to recognize, and these boundaries are not merely technical inconveniences but reflect fundamental gaps in what evolutionary signal can reveal. Conservation requires evolutionary time to accumulate signal. Recently evolved functional elements, including human-specific regulatory sequences and primate-specific genes, may show little conservation despite genuine function. A position can be functionally critical in humans yet unconserved because the function arose too recently for selection to leave a detectable signature. The fraction of the human genome showing evidence of human-specific function since the human-chimpanzee split (including thousands of human accelerated regions) presents exactly this challenge: important to human biology, yet invisible to conservation metrics <span class="citation" data-cites="hubisz_exploring_2014">(<a href="../bib/references.html#ref-hubisz_exploring_2014" role="doc-biblioref">Hubisz and Pollard 2014</a>)</span>.</p>
<p>Conservation patterns vary dramatically by functional context. Neural development genes tend to be highly conserved across vertebrates, while immune genes evolve rapidly under positive selection. Critically, lack of conservation does not prove neutrality: a position may be diverging under positive selection, or may serve lineage-specific functions absent in the comparison species.</p>
<p>Conservation scores also face technical challenges from alignment quality. In repetitive regions, <strong>segmental duplications</strong>, and rapidly evolving gene families, reliable alignments may be impossible to construct, leaving conservation scores undefined or unreliable precisely where variant interpretation is most difficult. The HLA region, immunoglobulin loci, and centromeric sequences are clinically important yet systematically difficult to assess by conservation. The regions most difficult to interpret computationally are frequently those of greatest clinical interest.</p>
<p>These boundaries do not diminish the value of conservation; they define where that value applies. Conservation provides information largely orthogonal to population frequency (which reflects recent human history rather than deep evolutionary constraint) and to functional genomics annotations (which capture biochemical activity rather than selective importance). Integrative methods such as <em>CADD</em> combine conservation with these other signals to achieve better performance than any single source. Protein language models, examined in <a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>, learn conservation-like signals directly from sequence data without requiring explicit alignments, potentially addressing some technical limitations while introducing their own assumptions about what constitutes functional constraint.</p>
<div id="box-acmg-amp" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ACMG-AMP Variant Classification Framework
</div>
</div>
<div class="callout-body-container callout-body">
<p>The ACMG-AMP framework classifies variants into five clinical tiers: Pathogenic, Likely Pathogenic, <strong>Variant of Uncertain Significance (VUS)</strong>, Likely Benign, and Benign <span class="citation" data-cites="richards_standards_2015">(<a href="../bib/references.html#ref-richards_standards_2015" role="doc-biblioref">Richards et al. 2015</a>)</span>. Classification combines multiple evidence types at different strength levels (very strong through supporting). Computational predictions occupy the supporting tier through criteria PP3 (predicted damaging) and BP4 (predicted benign), meaning they can contribute to but not independently establish pathogenicity. The full evidence framework, including thresholds for upgrading computational evidence strength, is detailed in <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-acmg-mapping" class="quarto-xref"><span>Section 18.5.3</span></a>.</p>
<div id="fig-acmg-classification" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-acmg-classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/03-fig-acmg-classification.svg" class="img-fluid figure-img"></p>
<figcaption>ACMG-AMP five-tier classification framework</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-acmg-classification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: The ACMG-AMP framework for clinical variant classification. Variants are classified into five tiers based on combined evidence. Computational predictions (PP3/BP4) provide supporting-level evidence, reflecting appropriate caution about their evidentiary weight.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch04-protein-predictors" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-ch04-protein-predictors"><span class="header-section-number">4.2</span> Protein-Level Predictors</h2>
<p>A diagnostic laboratory receives exome sequencing results for a 45-year-old woman with early-onset breast cancer and a family history suggesting hereditary cancer syndrome. Among hundreds of rare variants, one stands out: a missense change in <em>BRCA2</em> substituting glycine for arginine at a conserved position. Is this the explanation for her cancer, or an incidental finding? No previous case report exists for this exact variant. No functional assay has tested its effect. The question of whether this amino acid substitution disrupts <em>BRCA2</em> function determines whether her siblings should be tested and whether she qualifies for PARP inhibitor therapy. The clinical stakes could not be higher, yet the evidence available is entirely computational. Protein-level predictors attempt to answer such questions by encoding biological intuition about which amino acid changes matter.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a missense variant (amino acid substitution), what properties would you consider when predicting whether it disrupts protein function? Think about the amino acid itself, its position in the protein, and what you could learn from evolution.</p>
</div>
</div>
<section id="sec-ch04-sift" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="sec-ch04-sift"><span class="header-section-number">4.2.1</span> <em>SIFT</em>: Sequence Homology as Functional Constraint</h3>
<p>Conservation scores can identify constrained positions, but they cannot distinguish which substitutions at those positions are tolerated. A position might be highly conserved overall yet accept certain amino acid changes that preserve function. For missense variants specifically, the relevant question is not whether the position is constrained but whether the specific amino acid substitution disrupts function. <em>SIFT</em> addresses this distinction by examining which amino acids have been accepted at each position across evolutionary history <span class="citation" data-cites="ng_sift_2003">(<a href="../bib/references.html#ref-ng_sift_2003" role="doc-biblioref">Ng and Henikoff 2003</a>)</span>.</p>
<p><em>SIFT</em> collects homologous protein sequences from diverse species, constructs a <strong>multiple sequence alignment</strong>, and examines which amino acids appear at each position across the alignment. Positions that are highly conserved (showing the same or similar amino acids across species) are predicted to be functionally important; substitutions introducing amino acids not observed at that position are predicted to be deleterious.</p>
<p>The method computes a normalized probability for each possible amino acid at each position based on the diversity observed in the alignment. The <em>SIFT</em> score for a substitution is the probability of observing the mutant amino acid, scaled by the position’s overall diversity. The scaling by position diversity serves a critical purpose: without it, highly variable positions would yield low scores for any substitution simply because no single amino acid dominates, while conserved positions would appear to tolerate nothing. The scaling ensures that scores reflect deviation from position-specific expectations rather than raw conservation. Scores range from 0 to 1, with low scores (typically below 0.05) indicating predicted damage. A <em>SIFT</em> score of 0.01 for a particular missense variant indicates that the mutant amino acid is rarely or never observed at that position across the sequence family, suggesting functional constraint has prevented its fixation throughout evolution.</p>
<p><strong>Worked Example:</strong> Consider a leucine-to-proline substitution at position 285 in a highly conserved enzyme. <em>SIFT</em> examines the alignment of 500 homologous sequences and finds that position 285 contains leucine in 495 sequences, isoleucine in 4, and valine in 1. Proline never appears. The probability of observing proline at this position is essentially zero, yielding a <em>SIFT</em> score near 0, predicting the substitution as deleterious. The biological intuition: leucine sits in an alpha-helix, and proline would break the helix structure.</p>
<p><em>SIFT’s</em> simplicity is both its strength and its limitation. The method requires only protein sequence information and a database of homologs; it makes no assumptions about protein structure, physicochemistry, or mechanism of damage. This generality allows application to any protein with sufficient homologs in sequence databases. For proteins with few homologs, young gene families, or positions with limited alignment depth, predictions may be unreliable. The method captures only the evolutionary signal present in the alignment, missing functional constraints that arose recently or affect only a subset of species.</p>
</section>
<section id="sec-ch04-polyphen" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sec-ch04-polyphen"><span class="header-section-number">4.2.2</span> <em>PolyPhen-2</em>: Integrating Structure and Sequence</h3>
<p><em>SIFT’s</em> reliance on sequence alone ignores substantial information about how amino acid substitutions affect protein function. A glycine buried in a protein’s hydrophobic core will disrupt structure differently than one on a surface loop. A substitution at a catalytic site matters more than one far from any functional region. <em>PolyPhen-2</em> extends sequence-based prediction by incorporating protein structure features and amino acid physicochemistry, recognizing that the same substitution can have different consequences depending on its structural context <span class="citation" data-cites="adzhubei_method_2010">(<a href="../bib/references.html#ref-adzhubei_method_2010" role="doc-biblioref">Adzhubei et al. 2010</a>)</span>.</p>
<p>The method uses a <strong>naive Bayes classifier</strong> trained to distinguish disease-causing mutations from neutral polymorphisms based on a collection of sequence-derived and structure-derived features. The choice of naive Bayes reflects a principled tradeoff: although the “naive” independence assumption between features is biologically unrealistic (conservation and solvent accessibility are correlated), the classifier remains robust when features are redundant and performs well with limited training data. More complex models might overfit to the relatively small sets of annotated disease variants available when <em>PolyPhen-2</em> was developed. The feature set includes sequence conservation (similar to <em>SIFT</em>) but adds several structural descriptors when three-dimensional structure data is available: solvent accessibility (whether the position is buried or exposed), secondary structure context (alpha-helix, beta-sheet, or random coil), and proximity to known functional sites. Solvent accessibility matters because buried residues must maintain hydrophobic packing to preserve protein stability, while surface-exposed residues face fewer constraints unless they participate in binding interfaces. Amino acid physicochemical properties inform predictions about whether substitutions are conservative or radical. The Grantham distance, a measure of biochemical dissimilarity between amino acid pairs based on composition, polarity, and molecular volume, contributes to assessing substitution severity <span class="citation" data-cites="grantham_amino_1974">(<a href="../bib/references.html#ref-grantham_amino_1974" role="doc-biblioref">Grantham 1974</a>)</span>. Where Grantham distance derives from physicochemical properties, BLOSUM matrices capture empirical substitution frequencies observed across evolutionarily related proteins <span class="citation" data-cites="henikoff_amino_1992">(<a href="../bib/references.html#ref-henikoff_amino_1992" role="doc-biblioref">Henikoff and Henikoff 1992</a>)</span>. A glycine-to-arginine substitution (Grantham distance of 125) represents a far more radical change than a leucine-to-isoleucine substitution (Grantham distance of 5).</p>
<p><em>PolyPhen-2</em> provides two models trained on different datasets: HumDiv, trained on disease-causing and neutral variants from protein sequence databases, and HumVar, trained on Mendelian disease mutations versus common human polymorphisms. The choice of training set affects score interpretation; HumVar produces more conservative predictions appropriate for clinical Mendelian disease variant classification, while HumDiv is more sensitive and may be preferable for research applications where missing a true positive is more costly than false positives.</p>
<p><em>PolyPhen-2</em> scores range from 0 to 1, with higher scores indicating greater predicted deleteriousness. The output includes qualitative classifications (benign, possibly damaging, probably damaging) based on score thresholds. A <em>PolyPhen-2</em> score of 0.95 with a “probably damaging” classification indicates high confidence that the substitution disrupts protein function, though the clinical significance depends on additional evidence about the specific disease context.</p>
<div id="tbl-sift-polyphen" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sift-polyphen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Comparison of <em>SIFT</em> and <em>PolyPhen-2</em>
</figcaption>
<div aria-describedby="tbl-sift-polyphen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th><em>SIFT</em></th>
<th><em>PolyPhen-2</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Input</strong></td>
<td>Sequence only</td>
<td>Sequence + structure (when available)</td>
</tr>
<tr class="even">
<td><strong>Score range</strong></td>
<td>0-1 (low = damaging)</td>
<td>0-1 (high = damaging)</td>
</tr>
<tr class="odd">
<td><strong>Threshold</strong></td>
<td>&lt; 0.05 = damaging</td>
<td>&gt; 0.85 = probably damaging</td>
</tr>
<tr class="even">
<td><strong>Strength</strong></td>
<td>Works with alignment alone</td>
<td>Incorporates structural context</td>
</tr>
<tr class="odd">
<td><strong>Limitation</strong></td>
<td>Misses structural effects</td>
<td>Requires structure data for full power</td>
</tr>
<tr class="even">
<td><strong>Use case</strong></td>
<td>Any protein with homologs</td>
<td>Best when structure available</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="sec-ch04-sequence-to-function" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="sec-ch04-sequence-to-function"><span class="header-section-number">4.2.3</span> From Sequence to Function</h3>
<p>A clinical report states that a variant is “probably damaging” according to PolyPhen-2 and “deleterious” according to SIFT. The patient’s physician asks: “So this variant causes disease?” The answer is more complicated than the scores suggest. A “probably damaging” designation means the substitution likely impairs the protein’s normal function, but whether that impairment causes the patient’s disease depends on factors these tools cannot assess.</p>
<p><em>PolyPhen-2</em>, <em>SIFT</em>, and similar tools answer a mechanistic question: does this amino acid substitution disrupt protein function? They assess whether the new residue fits the structural context, whether the position tolerates variation across species, and whether the physicochemical change is drastic. These are genuine molecular insights. A “probably damaging” designation from <em>PolyPhen-2</em> means the substitution likely impairs the protein’s normal function, but the clinical significance of that impairment requires reasoning that protein-level predictors cannot provide.</p>
<p>Protein language models like <em>ESM-2</em> (<a href="../part_4/p4-ch16-protein-lm.html#sec-ch16-esm-family" class="quarto-xref"><span>Section 16.1</span></a>) provide alternative approaches to variant effect prediction that learn evolutionary constraint from sequence alone, without explicit multiple sequence alignments. <em>ESM</em>-based variant scoring is examined in <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-protein-vep" class="quarto-xref"><span>Section 18.2</span></a>, where zero-shot prediction paradigms avoid the limitations of supervised training on biased clinical labels.</p>
</section>
<section id="sec-ch04-protein-boundaries" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="sec-ch04-protein-boundaries"><span class="header-section-number">4.2.4</span> Boundaries of Protein-Level Prediction</h3>
<p>Several fundamental boundaries constrain all protein-level predictors, and these boundaries are not merely technical inconveniences but reflect deep gaps in what sequence and structure analysis alone can reveal. Protein-level tools are restricted to missense variants; nonsense, frameshift, splice-altering, and non-coding variants lie entirely outside their scope. A patient’s most important variant may be intronic or synonymous, yet protein-level predictors have nothing to say about it. This constraint is absolute: these methods analyze amino acid substitutions and cannot be extended to other variant types without fundamental redesign.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Inheritance Patterns">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Inheritance Patterns
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> How a genetic disease is inherited determines whether one or two mutant copies cause disease:</p>
<p><strong>Autosomal Dominant:</strong> One mutant copy is sufficient to cause disease.</p>
<ul>
<li>Affected individuals typically have one affected parent</li>
<li>50% risk of transmission to each child</li>
<li>Examples: Huntington’s disease, Marfan syndrome, many cancer predisposition syndromes (<em>BRCA1/2</em>)</li>
</ul>
<p><strong>Autosomal Recessive:</strong> Two mutant copies required (one from each parent).</p>
<ul>
<li>Parents are typically unaffected carriers</li>
<li>25% risk when both parents are carriers</li>
<li>Examples: Cystic fibrosis, sickle cell disease, phenylketonuria</li>
</ul>
<p><strong>X-Linked:</strong> Gene located on X chromosome.</p>
<ul>
<li>Males (XY) are typically more severely affected (no backup copy)</li>
<li>Females (XX) may be carriers or variably affected</li>
<li>Examples: Duchenne muscular dystrophy, hemophilia</li>
</ul>
<p><strong>Why this matters for variant interpretation:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Inheritance</th>
<th>Heterozygous (one copy)</th>
<th>Homozygous (two copies)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dominant</td>
<td>Disease</td>
<td>Disease (often more severe)</td>
</tr>
<tr class="even">
<td>Recessive</td>
<td>Carrier (healthy)</td>
<td>Disease</td>
</tr>
</tbody>
</table>
<p>A “damaging” variant in a recessive disease gene may be clinically benign in a heterozygous carrier. Variant effect predictors cannot distinguish these scenarios; they score molecular impact, not clinical consequence.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Common Misconception: Gain-of-Function Variants">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Common Misconception: Gain-of-Function Variants
</div>
</div>
<div class="callout-body-container callout-body">
<p>The terminology “gain-of-function” can mislead: it sounds beneficial, yet these mutations cause some of the most severe human diseases. A gain-of-function variant does not improve the protein; it creates aberrant activity that the cell cannot regulate. Protein-level predictors designed to detect structural disruption will often miss these variants entirely because the protein remains well-folded and active; it simply does something it should not.</p>
</div>
</div>
<p>Protein-level predictors estimate impact on protein function without specifying the mechanism or clinical consequence. A variant predicted to damage function might impair enzymatic activity, disrupt protein folding, eliminate a binding interface, or alter stability. The clinical relevance depends on which function is affected and whether the phenotype results from <strong>loss of function</strong> or <strong>gain of function</strong>. A predicted-damaging variant in a tumor suppressor behaves very differently from one in an oncogene, yet protein-level predictors provide no information about this distinction. The same high score can indicate completely different clinical implications depending on biological context.</p>
<p>In <em>FGFR3</em>, gain-of-function mutations cause the receptor to signal constitutively, driving achondroplasia by suppressing bone growth. In <em>PIK3CA</em>, activating mutations produce uncontrolled cell proliferation. In ion channels like <em>SCN1A</em>, gain-of-function can cause epileptic encephalopathy through neuronal hyperexcitability. These variants may preserve or even enhance protein structure and activity, precisely the opposite of what conservation-based predictors flag as damaging. A perfectly folded protein with enhanced catalytic activity will score as “tolerated” by methods designed to detect disruption, yet its clinical consequences may be devastating. Loss-of-function and gain-of-function mutations in the same gene can cause entirely different diseases: loss of <em>RET</em> function causes Hirschsprung disease (failed neural crest migration), while gain of <em>RET</em> function causes multiple endocrine neoplasia (tumor predisposition). Protein-level predictors cannot distinguish these mechanisms because they assess structural perturbation, not the direction of functional change.</p>
<p>These tools also provide no information about inheritance mode, <strong>penetrance</strong>, or expressivity. A strongly predicted-damaging variant in a gene with high tolerance to heterozygous loss may be clinically benign in carriers. Protein-level predictors cannot distinguish between a variant causing severe disease in homozygotes and one causing no disease at all when heterozygous. This distinction becomes critical when counseling families, where the mode of inheritance fundamentally changes recurrence risk and management recommendations.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Penetrance and Expressivity">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Penetrance and Expressivity
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For all readers:</strong> These clinical genetics terms describe why the same variant causes disease in some carriers but not others:</p>
<p><strong>Penetrance:</strong> The probability that a person carrying a pathogenic variant will actually develop the associated disease.</p>
<ul>
<li><em>Complete penetrance</em> (100%): All carriers develop disease (e.g., Huntington’s disease)</li>
<li><em>Incomplete/reduced penetrance</em> (&lt;100%): Only some carriers develop disease (e.g., <em>BRCA1</em> mutations have ~70% lifetime breast cancer risk)</li>
<li><em>Age-dependent penetrance</em>: Disease probability increases with age</li>
</ul>
<p><strong>Expressivity:</strong> The range of severity among individuals who do develop disease. Even with complete penetrance, some carriers may have mild symptoms while others have severe manifestations.</p>
<p><strong>Why this matters for variant interpretation:</strong></p>
<ol type="1">
<li>A variant with high predicted deleteriousness may cause no disease if penetrance is low</li>
<li>Unaffected family members can carry pathogenic variants (reduced penetrance)</li>
<li>Variant effect predictors measure molecular disruption, not penetrance; a “damaging” score tells you nothing about whether the carrier will develop disease</li>
<li>Population databases (gnomAD) may contain carriers of pathogenic variants who have not yet manifested disease or have incomplete penetrance</li>
</ol>
<p><strong>The gap:</strong> VEP scores predict functional impact; clinical outcomes require additional information about inheritance mode, penetrance, and genetic background.</p>
</div>
</div>
<p>Protein-level predictors inherit the training data biases present in their underlying databases. Disease mutations in training sets are enriched for severe, early-onset Mendelian conditions with clear inheritance patterns. Variants causing subtle effects, incomplete penetrance, or complex phenotypes may be systematically mispredicted. The well-studied genes that dominate training data may not generalize to poorly characterized genes where variants are most difficult to interpret.</p>
<p><em>SIFT</em> and <em>PolyPhen-2</em> remain widely used in clinical practice and serve as features within more sophisticated ensemble methods. Their scores appear in diagnostic reports, contribute to ACMG-AMP classification criteria, and inform variant prioritization in research and clinical pipelines. Understanding their construction and limitations is essential for appropriate interpretation.</p>
</section>
</section>
<section id="sec-ch04-cadd" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-ch04-cadd"><span class="header-section-number">4.3</span> <em>CADD</em> Framework</h2>
<p>The protein-level predictors and conservation scores examined above each capture one aspect of variant function, yet clinical interpretation requires weighing multiple lines of evidence simultaneously. A variant might fall in a conserved region, alter a moderately constrained amino acid, and overlap a predicted enhancer. How should these signals be combined? More fundamentally, how can we train a predictor when curated pathogenic variants number in the hundreds of thousands while the genome contains billions of possible mutations? These questions expose a fundamental tension: the variants we most need to interpret (rare, novel, never before seen) are precisely those for which training labels do not exist.</p>
<p><em>CADD</em> addressed these challenges by reframing variant effect prediction as a large-scale machine learning problem <span class="citation" data-cites="kircher_general_2014 rentzsch_cadd_2019">(<a href="../bib/references.html#ref-kircher_general_2014" role="doc-biblioref">Kircher et al. 2014</a>; <a href="../bib/references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>. The key insight was not better feature engineering or more sophisticated classification, but rather a reconceptualization of the labeling problem itself. Instead of training directly on small sets of known pathogenic versus benign variants, which are scarce and biased toward certain genes and variant types, <em>CADD</em> contrasts variants that have survived purifying selection in the human lineage with matched simulated variants that could have occurred but did not. This evolutionary proxy strategy transforms the labeling problem, yielding millions of training examples where curated datasets provide thousands.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>CADD’s</em> breakthrough was not algorithmic sophistication but creative problem reframing. By using evolutionary proxy labels (observed vs.&nbsp;simulated variants) instead of clinical labels, <em>CADD</em> transformed a problem with thousands of training examples into one with millions, at the cost of measuring evolutionary tolerance rather than clinical pathogenicity directly.</p>
</div>
</div>
<section id="sec-ch04-cadd-training" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="sec-ch04-cadd-training"><span class="header-section-number">4.3.1</span> Evolutionary Proxy Training and Label Sources</h3>
<p>The conceptual foundation of <em>CADD</em> rests on constructing training labels from evolutionary signal rather than clinical curation. The method builds two proxy classes of variants that serve as training labels, each designed to approximate a category that cannot be observed directly. Understanding these label sources is essential because the same proxy labeling strategies reappear throughout genomic machine learning, including in the foundation models discussed in <a href="../part_4/p4-ch14-fm-principles.html" class="quarto-xref"><span>Chapter 14</span></a> and <a href="../part_3/p3-ch08-pretraining.html" class="quarto-xref"><span>Chapter 8</span></a>.</p>
<div id="fig-cadd-training" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cadd-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/04-A-fig-cadd-training.svg" class="img-fluid figure-img"></p>
<figcaption>Proxy-neutral class from human-derived alleles</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/04-B-fig-cadd-training.svg" class="img-fluid figure-img"></p>
<figcaption>Proxy-deleterious class from simulated variants</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/04-C-fig-cadd-training.svg" class="img-fluid figure-img"></p>
<figcaption>Classification learning distinguishes the two classes</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cadd-training-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: The CADD training paradigm: evolutionary proxy labeling. (A) The proxy-neutral class consists of human-derived alleles that reached high frequency since the human-chimpanzee split, having survived millions of years of purifying selection. (B) The proxy-deleterious class comprises simulated variants matching human mutational processes, representing changes that could occur but are generally not observed at high frequency, enriching for alleles disfavored by selection. (C) A classifier learns to distinguish these classes based on integrated genomic annotations, outputting an ‘evolutionary tolerance’ score. This proxy labeling strategy transforms the variant effect prediction problem from one with scarce clinical labels to one with millions of evolutionary training examples, though the gap between evolutionary tolerance and clinical pathogenicity remains irreducible.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>CADD</em> trains on “proxy-neutral” variants (observed in humans) versus “proxy-deleterious” variants (simulated but not observed). Why might this be more powerful than training on known pathogenic versus benign variants? What are the tradeoffs?</p>
</div>
</div>
<p>The proxy-neutral class consists of variants that have been tolerated by purifying selection. <em>CADD</em> draws these from sequence differences that arose on the human lineage since the split from chimpanzees and became fixed or nearly fixed in modern humans. These are identified by their <strong>derived allele frequency</strong>: alleles that differ from the inferred ancestral state (typically determined by comparison to chimpanzee and other great ape sequences) and are present at very high frequency in human populations. Because these derived alleles have persisted over millions of years of evolution, most are presumed to be neutral or only weakly deleterious. This is not a perfect proxy: some observed alleles are genuinely pathogenic, particularly those with incomplete penetrance, late onset, or context-dependent effects. The proxy-neutral class is, on average, substantially enriched for tolerated alleles relative to a random sample of possible mutations.</p>
<p>The proxy-deleterious class is constructed by simulating mutations across the genome according to realistic mutational processes. The simulation matches local sequence context (typically using trinucleotide frequencies to capture the strong dependence of mutation rates on flanking bases). CpG dinucleotides, for example, have elevated mutation rates due to spontaneous deamination of methylated cytosines, and the simulation accounts for this by generating more CpG transitions. Regional variation in mutation rates, driven by factors including replication timing and chromatin state, is similarly incorporated.</p>
<p>The logic underlying this construction is subtle but powerful. Simulated variants represent changes that could plausibly occur under human mutational processes but are generally not observed at high frequency in population databases. The proxy-deleterious class as a whole is enriched for alleles disfavored by selection, because the set of possible mutations includes many that disrupt conserved elements, alter protein function, or perturb regulatory sequences. By contrasting this set with the proxy-neutral class (high derived allele frequency variants that survived selection), <em>CADD</em> learns to recognize the annotation signatures that distinguish variants under purifying selection from those that have been tolerated.</p>
<p>This proxy labeling strategy has important implications. <em>CADD</em> does not learn to distinguish pathogenic from benign variants directly; it learns to distinguish tolerated-by-evolution from possible-but-not-observed. The assumption is that variants depleted by selection are enriched for functional effects and therefore enriched for disease relevance. This assumption is often correct but introduces a systematic gap between what <em>CADD</em> measures (evolutionary tolerance) and what clinicians need (disease causation).</p>
</section>
<section id="sec-ch04-cadd-features" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sec-ch04-cadd-features"><span class="header-section-number">4.3.2</span> Feature Integration</h3>
<p>Conservation scores measure evolutionary constraint. Protein-level predictors assess amino acid substitution severity. Regulatory annotations mark biochemically active regions. Each signal captures genuine biology, but no single annotation captures the full complexity of variant function. A missense variant in a constrained gene might be tolerated if it falls in an unconserved loop region; a synonymous variant might be pathogenic if it disrupts splicing. The power of <em>CADD</em> lies in learning how these heterogeneous signals interact, upweighting annotations that distinguish proxy-deleterious from proxy-neutral variants and downweighting those that do not.</p>
<p><em>CADD</em> integrates more than 60 features, far exceeding what explicit combination rules could accommodate. Gene model annotations describe the local transcript and coding context of each variant. The most fundamental is the predicted sequence consequence: whether a variant is synonymous, missense, nonsense, frameshift, splice-site disrupting, or located in untranslated or intronic regions. Distance to exon-intron boundaries and proximity to canonical splice sites provide additional context. Gene-level attributes including constraint metrics (pLI, LOEUF from gnomAD) quantify how tolerant each gene is to damaging variation; these metrics are described in detail in <a href="p1-ch02-data.html#sec-ch02-constraints" class="quarto-xref"><span>Section 2.9</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Connecting Concepts: Haploinsufficiency">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Connecting Concepts: Haploinsufficiency
</div>
</div>
<div class="callout-body-container callout-body">
<p>The gene-level constraint metrics used by <em>CADD</em> derive from a fundamental concept introduced in <a href="p1-ch02-data.html#sec-ch02-constraints" class="quarto-xref"><span>Section 2.9</span></a>: <strong>haploinsufficiency</strong>. Most genes tolerate heterozygous loss because a single functional copy produces sufficient protein for normal function. Haploinsufficient genes are different; they require both copies to maintain adequate protein levels, making heterozygous loss-of-function variants pathogenic. A pLI approaching 1.0 indicates that loss-of-function variants are nearly absent from healthy individuals. By incorporating these gene-level constraint metrics, <em>CADD</em> can weight identical variants differently depending on whether they occur in dosage-sensitive or dosage-tolerant genes.</p>
</div>
</div>
<p><em>CADD</em> draws on three families of evidence. Evolutionary constraint from phyloP, GERP, and phastCons provides the conservation signals described earlier; incorporating multiple metrics computed from different alignments captures complementary aspects of selective pressure. For coding variants, amino acid substitution predictions from <em>SIFT</em> and <em>PolyPhen-2</em> assess structural and functional disruption, supplemented by physicochemical properties, Grantham distances, and domain annotations from Pfam. Non-coding variants receive context from ENCODE and Roadmap Epigenomics annotations capturing chromatin accessibility, histone modifications, and transcription factor binding.</p>
<p>Additional features capture local sequence context (GC content, CpG density), genomic architecture (segmental duplications, repetitive elements), and chromosomal position. The model learns how to weight and combine these heterogeneous signals from the data rather than from expert specification.</p>
<p>The feature engineering approach reaches a performance ceiling because manually designed features encode only what biologists already know. This limitation motivates the shift to learned representations examined in <a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a> for tokenization strategies and <a href="../part_3/p3-ch09-transfer.html#sec-ch09-feature-extraction" class="quarto-xref"><span>Section 9.3</span></a> for foundation model features. The contrast between hand-crafted features and learned representations illuminates the paradigm shift toward foundation models discussed in <a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-task-specific" class="quarto-xref"><span>Section 14.1</span></a>.</p>
</section>
<section id="sec-ch04-cadd-scoring" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="sec-ch04-cadd-scoring"><span class="header-section-number">4.3.3</span> Model Architecture and Scoring</h3>
<div class="callout callout-style-default callout-warning callout-titled" title="Mathematical Detail">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Detail
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section explains the PHRED scaling used for <em>CADD</em> scores. If the formula is unfamiliar, focus on the interpretation: higher scores indicate more extreme predicted deleteriousness, with each 10-point increase representing a 10-fold enrichment.</p>
</div>
</div>
<p>Raw classifier outputs are not directly interpretable as probabilities or biological effect sizes. A clinician presented with a <strong>support vector machine</strong> decision value has no intuitive understanding of what that number means. To address this, <em>CADD</em> defines PHRED-scaled scores based on the rank of each variant among all possible single-nucleotide substitutions in the reference genome. A scaled score of 10 indicates that a variant falls in the top 10% of predicted deleteriousness. A score of 20 indicates the top 1%, and a score of 30 indicates the top 0.1%. This rank-based transformation ensures comparability across <em>CADD</em> versions and provides immediate interpretability: a clinician can understand that a score of 25 places this variant among the most extreme 0.3% of possible mutations without needing to understand the underlying classifier.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Worked Example: CADD PHRED Scoring">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: CADD PHRED Scoring
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose <em>CADD’s</em> classifier assigns a raw score to a missense variant in <em>BRCA1</em>. To convert this to the interpretable scaled score, <em>CADD</em> ranks this variant against all ~8.6 billion possible single-nucleotide substitutions in the reference genome.</p>
<p><strong>Step 1:</strong> The classifier produces a raw score (e.g., 2.34 on the SVM decision boundary).</p>
<p><strong>Step 2:</strong> <em>CADD</em> determines where this score ranks among all possible variants. If this variant’s raw score places it at the 99th percentile (more extreme than 99% of possible variants), it receives a scaled score of 20.</p>
<p><strong>Step 3:</strong> The PHRED formula: scaled score = <span class="math inline">\(-10 \times \log_{10}(\text{percentile rank})\)</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Raw Percentile</th>
<th>Calculation</th>
<th>Scaled Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Top 10% (0.10)</td>
<td><span class="math inline">\(-10 \times \log_{10}(0.10)\)</span></td>
<td>10</td>
</tr>
<tr class="even">
<td>Top 1% (0.01)</td>
<td><span class="math inline">\(-10 \times \log_{10}(0.01)\)</span></td>
<td>20</td>
</tr>
<tr class="odd">
<td>Top 0.1% (0.001)</td>
<td><span class="math inline">\(-10 \times \log_{10}(0.001)\)</span></td>
<td>30</td>
</tr>
<tr class="even">
<td>Top 0.03% (0.0003)</td>
<td><span class="math inline">\(-10 \times \log_{10}(0.0003)\)</span></td>
<td>~35</td>
</tr>
</tbody>
</table>
<p>Each 10-point increase represents a 10-fold enrichment in predicted deleteriousness. A variant with a scaled score of 25 is rarer (more extreme) than 99.7% of all possible substitutions.</p>
</div>
</div>
<p><em>CADD’s</em> classifier operates on the high-dimensional feature vector assembled for each variant. The original <em>CADD</em> model (v1.0) used a linear support vector machine trained to discriminate proxy-neutral and proxy-deleterious variants based on approximately 30 million training examples. The choice of a linear model was deliberate and pragmatic: with tens of millions of training examples and dozens of features, a linear classifier is computationally tractable while capturing the main structure of the classification problem. More fundamentally, the proxy labeling strategy means training labels are inherently noisy: the proxy-neutral class contains some deleterious variants, and the proxy-deleterious class contains some neutral ones. A simple linear model is less likely to overfit to this label noise than a complex nonlinear model, which might learn to memorize spurious patterns in the noisy labels rather than the generalizable structure that distinguishes evolutionary constraint from neutrality. Subsequent versions (v1.1 onward) transitioned to logistic regression, which offers comparable discriminative performance while providing native probability outputs and faster scoring of new variants <span class="citation" data-cites="rentzsch_cadd-spliceimproving_2021">(<a href="../bib/references.html#ref-rentzsch_cadd-spliceimproving_2021" role="doc-biblioref">Rentzsch et al. 2021</a>)</span>. Version 1.7 expanded the feature set to include protein language model scores and regulatory predictions from deep learning models <span class="citation" data-cites="schubach_cadd_2024">(<a href="../bib/references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practical Guidance: Interpreting CADD Scores">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Interpreting CADD Scores
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>CADD Score</th>
<th>Percentile</th>
<th>Clinical Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>Top 10%</td>
<td>Weak evidence; many benign variants here</td>
</tr>
<tr class="even">
<td>15</td>
<td>Top 3%</td>
<td>Modest evidence; consider with other factors</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Top 1%</td>
<td>Moderate evidence; commonly used filter threshold</td>
</tr>
<tr class="even">
<td>25</td>
<td>Top 0.3%</td>
<td>Strong evidence; most known pathogenic missense variants</td>
</tr>
<tr class="odd">
<td>30</td>
<td>Top 0.1%</td>
<td>Very strong evidence; enriched for severe effects</td>
</tr>
</tbody>
</table>
<p>Remember: <em>CADD</em> scores represent evolutionary tolerance, not clinical pathogenicity. A score of 30 does not mean “pathogenic”—it means “evolutionarily unusual.”</p>
</div>
</div>
<p>In clinical laboratories, <em>CADD</em> scaled scores commonly serve as filters to enrich for potentially pathogenic variants. Typical thresholds range from 15 (top 3%) to 20 (top 1%) or higher. Variants with scores at or above 20 are considered moderately high deleteriousness candidates, while scores at or above 30 are frequently interpreted as strongly enriched for functional impact. A diagnostic pipeline might use <em>CADD</em> greater than or equal to 20 as an initial filter, reducing 25,000 exome variants to several hundred candidates for expert review. These filters serve as prioritization tools that reduce the variant burden to a manageable number rather than as definitive pathogenicity calls.</p>
</section>
<section id="sec-ch04-proxy-problem" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="sec-ch04-proxy-problem"><span class="header-section-number">4.3.4</span> Evolutionary Proxy Problem</h3>
<p><em>CADD’s</em> training signal derives entirely from evolutionary history: variants that survived natural selection versus those depleted by it. This creates a fundamental mismatch with clinical questions. Evolution optimizes for reproductive fitness across populations and timescales; clinical genetics asks whether a specific variant causes disease in a specific patient.</p>
<p>The mismatch manifests in predictable ways. Constraint varies across tissues and developmental stages, but <em>CADD</em> assigns a single genome-wide score. A variant in a deeply conserved neural enhancer receives a high score regardless of whether the patient presents with a cardiac or neurological phenotype. The constraint is real, but its clinical relevance depends on context <em>CADD</em> cannot assess.</p>
<p>More fundamentally, purifying selection only removes variants that reduce fitness before or during reproductive years. Late-onset diseases like Alzheimer’s or many cancers exert minimal selective pressure; variants causing these conditions may show little evolutionary depletion despite clear pathogenicity. Gain-of-function mutations present an even sharper challenge. A variant that creates a novel toxic function has no evolutionary precedent to deplete; <em>CADD’s</em> framework cannot recognize pathogenic mechanisms that evolution never encountered.</p>
<p>These limitations are not failures of implementation but consequences of the proxy relationship between evolutionary constraint and disease causation. <em>CADD</em> measures what evolution preserved and eliminated. Whether that corresponds to clinical pathogenicity depends on whether the disease mechanism falls within evolution’s purview.</p>
</section>
</section>
<section id="sec-ch04-ensemble-methods" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-ch04-ensemble-methods"><span class="header-section-number">4.4</span> Other Ensemble Methods</h2>
<p>The clinical geneticist focused exclusively on rare missense variants in Mendelian disease faces a different optimization problem than the researcher screening the entire genome for regulatory variants. <em>CADD’s</em> genome-wide generality may sacrifice accuracy within specific variant classes, accepting modest performance everywhere to achieve coverage anywhere. For diagnostic laboratories where missense variants in known disease genes dominate the caseload, specialized ensemble methods offer an alternative: models trained directly on curated disease variants, optimized for the specific task rather than general prioritization. This tension between generality and specialization recurs throughout computational biology, and different clinical contexts demand different tradeoffs.</p>
<p>Ensemble principles for combining multiple predictors connect to the deep ensemble approaches for uncertainty quantification examined in <a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-deep-ensembles" class="quarto-xref"><span>Section 24.4.1</span></a>. Integration strategies that combine classical scores with foundation model predictions are examined in <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-combining-evidence" class="quarto-xref"><span>Section 18.4</span></a>.</p>
<section id="sec-ch04-revel" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="sec-ch04-revel"><span class="header-section-number">4.4.1</span> <em>REVEL</em></h3>
<p>A missense variant in a known disease gene presents a narrower interpretive challenge than an arbitrary variant anywhere in the genome. The variant is protein-coding, the gene has established disease associations, and the question is specifically whether this amino acid substitution is pathogenic. This focused scope permits a different training strategy than <em>CADD’s</em> evolutionary proxy approach.</p>
<p><em>REVEL</em> represents a missense-specific ensemble predictor widely used in clinical laboratories <span class="citation" data-cites="ioannidis_revel_2016">(<a href="../bib/references.html#ref-ioannidis_revel_2016" role="doc-biblioref">Ioannidis et al. 2016</a>)</span>. Rather than training on evolutionary proxy labels, <em>REVEL</em> directly discriminates pathogenic missense variants (curated from HGMD and other disease databases) from rare putatively neutral missense variants observed in population datasets.</p>
<p><em>REVEL</em> integrates predictions from a panel of individual tools: <em>SIFT</em>, <em>PolyPhen-2</em>, <em>PROVEAN</em>, <em>MutationAssessor</em>, <em>FATHMM</em>, GERP++, phyloP, and phastCons, among others. A <strong>random forest</strong> model learns to combine these scores, weighting each according to its discriminative power for the pathogenic versus neutral classification. The training set is carefully constructed to avoid label contamination, excluding variants present in both disease and population databases.</p>
<p><em>REVEL</em> scores range from 0 to 1, with higher values implying greater pathogenicity likelihood. Common interpretation thresholds treat scores above 0.5 as supporting evidence for pathogenicity, with scores above 0.75 providing stronger evidence. <em>REVEL</em> is restricted to missense single-nucleotide variants, making it more specialized than <em>CADD</em> but often more accurate within its scope. This specialization reflects a deliberate choice: by giving up coverage of non-coding and structural variants, <em>REVEL</em> gains the ability to train on directly relevant labels rather than evolutionary proxies.</p>
</section>
<section id="sec-ch04-mcap" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="sec-ch04-mcap"><span class="header-section-number">4.4.2</span> <em>M-CAP</em></h3>
<p>Diagnostic laboratories evaluating potential Mendelian disease variants face asymmetric consequences for errors. Calling a benign variant pathogenic can lead to unnecessary surgeries, psychological burden, and inappropriate cascade testing of family members. Missing a pathogenic variant delays diagnosis but typically permits later reclassification as evidence accumulates. This asymmetry argues for prioritizing specificity over sensitivity in clinical settings.</p>
<p><em>M-CAP</em> addresses specifically the challenge of distinguishing pathogenic from benign rare missense variants in Mendelian disease contexts, with explicit attention to this asymmetry <span class="citation" data-cites="jagadeesh_m-cap_2016">(<a href="../bib/references.html#ref-jagadeesh_m-cap_2016" role="doc-biblioref">Jagadeesh et al. 2016</a>)</span>. The method uses <strong>gradient boosting</strong> on a feature set including conservation scores, protein structure features, and amino acid properties.</p>
<p><em>M-CAP</em> was explicitly designed to minimize false positives while maintaining reasonable sensitivity. The developers tuned their classifier to achieve less than 5% false positive rate on known pathogenic variants, accepting some reduction in sensitivity as a tradeoff. This design philosophy differs from methods that balance sensitivity and specificity equally, reflecting <em>M-CAP’s</em> intended use in diagnostic settings where false positive pathogenicity calls have serious consequences.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A clinical laboratory is evaluating tools for a rare disease diagnostic pipeline. They need high specificity (few false positives) because false pathogenic calls lead to unnecessary interventions. Which of <em>CADD</em>, <em>REVEL</em>, or <em>M-CAP</em> would you recommend for their primary filter, and why?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><em>M-CAP</em> is the best choice for this use case because it was explicitly designed to minimize false positives (high specificity) at the cost of some sensitivity. <em>REVEL</em> offers high accuracy for missense variants but balances sensitivity and specificity equally, while <em>CADD</em> provides genome-wide coverage but may have more false positives within specific variant classes.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-ch04-ensemble-comparison" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="sec-ch04-ensemble-comparison"><span class="header-section-number">4.4.3</span> Comparison and Selection</h3>
<p>A clinical laboratory must choose which computational predictors to incorporate into their diagnostic pipeline. Should they use CADD for its universal coverage, REVEL for its missense accuracy, or M-CAP for its low false-positive rate? The wrong choice can mean missing pathogenic variants or overwhelming clinical reviewers with false alarms. Understanding what each method optimizes for (and what it trades away) is essential for matching tools to clinical context.</p>
<p>No single ensemble method dominates across all variant types and clinical contexts. <em>CADD</em> provides the broadest coverage (genome-wide, all variant types) but may sacrifice accuracy within specific variant classes to achieve this generality. <em>REVEL</em> often outperforms <em>CADD</em> on missense-only benchmarks, reflecting its focused training objective. <em>M-CAP</em> prioritizes specificity over sensitivity, appropriate for clinical settings where avoiding false positives is paramount.</p>
<div id="tbl-ensemble-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ensemble-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Comparison of ensemble variant effect predictors
</figcaption>
<div aria-describedby="tbl-ensemble-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Coverage</th>
<th>Training Labels</th>
<th>Key Strength</th>
<th>Key Limitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>CADD</strong></td>
<td>All variants, genome-wide</td>
<td>Evolutionary proxy</td>
<td>Universal applicability</td>
<td>Measures evolutionary tolerance, not pathogenicity</td>
</tr>
<tr class="even">
<td><strong>REVEL</strong></td>
<td>Missense only</td>
<td>Curated pathogenic vs.&nbsp;neutral</td>
<td>Higher accuracy for missense</td>
<td>Cannot score non-coding variants</td>
</tr>
<tr class="odd">
<td><strong>M-CAP</strong></td>
<td>Rare missense</td>
<td>Pathogenic vs.&nbsp;benign</td>
<td>Low false positive rate</td>
<td>Lower sensitivity than alternatives</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Clinical variant interpretation typically incorporates multiple computational scores rather than relying on any single predictor. Different scores may agree, providing stronger evidence, or disagree, flagging variants requiring careful manual review. A variant with <em>CADD</em> greater than or equal to 25, <em>REVEL</em> greater than or equal to 0.8, and <em>M-CAP</em> “possibly pathogenic” presents a consistent computational picture; one where <em>CADD</em> and <em>REVEL</em> disagree prompts closer examination of the underlying features. Understanding the construction, training data, and intended use case of each method is essential for appropriate interpretation. The integration of these scores into clinical workflows is examined in detail in <a href="../part_7/p7-ch28-clinical-risk.html" class="quarto-xref"><span>Chapter 28</span></a> and <a href="../part_7/p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>, where computational evidence must be weighed alongside functional studies, segregation data, and clinical presentation.</p>
<div id="fig-ensemble-performance" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ensemble-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/05-fig-ensemble-performance.svg" class="img-fluid figure-img"></p>
<figcaption>ROC comparison of variant effect predictors</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ensemble-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Performance comparison of variant effect predictors on a held-out missense variant benchmark. ROC curves compare ensemble methods (CADD, REVEL, M-CAP; solid lines) against individual component scores (SIFT, PolyPhen-2, phyloP; dashed lines). Ensemble methods consistently outperform individual predictors by integrating multiple signals. Circular markers indicate common clinical operating thresholds with corresponding sensitivity and specificity values. Note that benchmark performance may be inflated by circularity: variants classified using these same predictors appear in clinical databases that form the evaluation set. True clinical utility may be lower than benchmark metrics suggest, particularly for novel variants in understudied genes.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch04-circularity" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-ch04-circularity"><span class="header-section-number">4.5</span> Circularity and Ascertainment Bias</h2>
<p>A diagnostic laboratory classifies a novel missense variant as pathogenic based partly on its high <em>CADD</em> score. That classification enters ClinVar. Two years later, a benchmarking study evaluates <em>CADD</em> performance on ClinVar pathogenic variants and reports excellent accuracy. Is the high performance genuine, or has the benchmark been contaminated by the predictor’s own influence on the labels it is evaluated against? This scenario illustrates the first of the pervasive problems affecting all variant effect predictors: circularity between scores and clinical databases. Compounding this circularity is <strong>ascertainment bias</strong> in available training and testing variants. These issues do not invalidate classical scores, but they counsel appropriate humility about performance claims and careful attention in both development and application. The broader methodological concerns around benchmark design and confounding are examined in <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a> and <a href="../part_3/p3-ch11-benchmarks.html" class="quarto-xref"><span>Chapter 11</span></a>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>The same scores used to classify variants end up in the databases used to evaluate those scores, creating a self-reinforcing loop. This circularity inflates apparent performance: methods appear to work better than they actually do because they influenced the labels they are tested against.</p>
</div>
</div>
<div id="fig-circularity-problem" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-circularity-problem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch04/06-fig-circularity-problem.svg" class="img-fluid figure-img"></p>
<figcaption>The circularity problem in variant effect prediction</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-circularity-problem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: The circularity problem in variant effect prediction. A self-reinforcing feedback loop operates between computational predictors and clinical databases. (1) A high computational score (e.g., CADD) contributes evidence supporting a pathogenic classification. (2) The classified variant enters ClinVar. (3) Benchmarking studies evaluate computational predictors on ClinVar variants. (4) Apparent high performance encourages clinical adoption. (5) Greater clinical use increases the influence of computational scores on future classifications, returning to step 1. This circularity inflates benchmark performance metrics because predictors are evaluated on labels they helped create. Intervention strategies include temporal holdouts (evaluating only on classifications made before predictor adoption), functional assay ground truth (using experimentally measured variant effects), and prospective evaluation (testing on newly classified variants not yet influenced by the predictor).
</figcaption>
</figure>
</div>
<section id="sec-ch04-circularity-definition" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="sec-ch04-circularity-definition"><span class="header-section-number">4.5.1</span> Circularity Problem</h3>
<p>ClinVar and similar clinical databases increasingly incorporate computational predictions as evidence supporting variant classification. When a clinical laboratory classifies a variant as pathogenic, the <em>CADD</em> score, <em>PolyPhen-2</em> prediction, or other computational evidence may have contributed to that determination. When <em>CADD</em> is subsequently evaluated on ClinVar pathogenic variants, its performance is artificially inflated: the benchmark contains variants that were labeled partly because <em>CADD</em> assigned them high scores. The predictor appears to perform well because it was already part of the labeling process.</p>
<p>This circularity operates through multiple pathways. Direct use occurs when clinical laboratories explicitly cite computational scores in their classifications. Indirect influence arises when computational predictions shape clinical suspicion, affecting which variants receive functional testing or expert review. Selection bias in benchmark construction can compound the problem: benchmark creators may preferentially include variants with strong computational evidence, excluding ambiguous cases that would provide a more stringent test.</p>
<p>The consequence is that benchmark performance may overestimate real-world utility. A method that has been widely adopted will appear to perform well on benchmarks populated by variants classified using that method, even if its true discriminative power is more limited. This concern applies to all established computational tools, including conservation scores, protein-level predictors, and ensemble methods. The more influential a method becomes, the more its benchmark performance becomes self-reinforcing.</p>
<p>Addressing circularity requires careful benchmark construction. Temporal holdouts (using only classifications made before a method’s widespread adoption) can reduce but not eliminate the problem. Functional assays that directly measure variant effects provide ground truth independent of computational predictions but are available for only a small fraction of variants. Prospective evaluation on newly classified variants offers the cleanest test but requires patience and ongoing data collection. The foundation model evaluations discussed in <a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a> face these same challenges, and the confounding issues examined in <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a> show how these problems persist and evolve as methods become more sophisticated.</p>
</section>
<section id="sec-ch04-ascertainment" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="sec-ch04-ascertainment"><span class="header-section-number">4.5.2</span> Ascertainment Bias</h3>
<p>Beyond circularity lies a more fundamental problem: the variants available for training and evaluation represent a systematically skewed sample of disease-causing mutations. Clinical databases are dominated by variants in well-studied genes, particularly those causing severe Mendelian phenotypes with clear inheritance patterns. Protein-coding variants are overrepresented because they are easier to interpret and more often tested. Variants in genes associated with common diagnostic panels appear frequently; those in rarely tested genes are sparse.</p>
<p>This ascertainment bias shapes what models learn and how they perform. A predictor trained predominantly on variants in constrained genes may learn that gene-level constraint is the primary signal for pathogenicity. When applied to variants in less constrained genes (where pathogenic variants also occur, but less frequently), the model may systematically underestimate risk. Similarly, models trained on European-ancestry samples may encode population-specific patterns that transfer poorly to other populations, compounding health disparities by providing less accurate predictions for underrepresented groups.</p>
<p>The consequences extend to evaluation. Benchmark variants inherit the ascertainment biases of their source databases. Strong performance on benchmark sets may not translate to the rare genes, unusual variant types, or underrepresented populations encountered in real clinical practice. Variants that are “easy” to classify (stop-gains in highly constrained genes) are overrepresented in benchmarks, while diagnostically challenging variants (missense variants in moderate-constraint genes, non-coding variants) are underrepresented. The benchmark tells us how well the method performs on the easy cases; it may reveal little about the hard cases where computational assistance is most needed.</p>
<p>Ascertainment bias in sequencing creates blind spots in difficult genomic regions (<a href="p1-ch01-ngs.html#sec-ch01-difficult" class="quarto-xref"><span>Section 1.6</span></a>). The circularity between training labels and evaluation benchmarks affects both classical and modern methods, as examined systematically in <a href="../part_3/p3-ch13-confounding.html#sec-ch13-label-circularity" class="quarto-xref"><span>Section 13.5</span></a>. Benchmark construction strategies that mitigate these issues appear in <a href="../part_3/p3-ch11-benchmarks.html#sec-ch11-benchmark-construction" class="quarto-xref"><span>Section 11.5</span></a>.</p>
</section>
<section id="sec-ch04-clinical-implications" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="sec-ch04-clinical-implications"><span class="header-section-number">4.5.3</span> Implications for Clinical Use</h3>
<p>These limitations do not render classical scores useless, but they counsel appropriate humility in interpretation. Computational predictions provide one line of evidence among several in variant interpretation. Strong scores in expected directions support clinical suspicion; unexpected scores prompt careful review. No computational score should override clear clinical or functional evidence, and borderline scores in complex cases may warrant agnosticism rather than confident prediction.</p>
<p>The ACMG-AMP framework for variant classification appropriately treats computational predictions as supporting evidence (PP3 for predictions supporting pathogenicity, BP4 for predictions supporting benign status) rather than standalone criteria <span class="citation" data-cites="richards_standards_2015">(<a href="../bib/references.html#ref-richards_standards_2015" role="doc-biblioref">Richards et al. 2015</a>)</span>. Multiple lines of computational evidence may be combined, but the weight assigned should reflect the limitations outlined here. Variants classified primarily on computational grounds should be flagged for potential reclassification as additional evidence emerges. The ACMG-AMP framework’s integration of computational evidence is detailed in <a href="../part_7/p7-ch29-rare-disease.html#sec-ch29-acmg-amp" class="quarto-xref"><span>Section 29.2</span></a> for complete clinical workflows. Calibration of computational scores to ACMG evidence strength levels is examined in <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-acmg-mapping" class="quarto-xref"><span>Section 18.5.3</span></a> for foundation model approaches.</p>
</section>
</section>
<section id="sec-ch04-feature-limitations" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="sec-ch04-feature-limitations"><span class="header-section-number">4.6</span> Limitations of the Feature Engineering Paradigm</h2>
<p>Classical variant effect prediction achieved substantial success in prioritizing potentially pathogenic variants and established conceptual foundations that persist in modern methods. The integration of diverse annotations, use of evolutionary signals as proxy labels, and genome-wide precomputation all anticipate contemporary practices. Yet a fundamental tension remains: manually designed features encode only what biologists already know, and the complexity of genotype-phenotype relationships exceeds what explicit feature engineering can capture. The features are not wrong; they are incomplete in ways that cannot be remedied by adding more of the same.</p>
<section id="sec-ch04-feature-ceiling" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="sec-ch04-feature-ceiling"><span class="header-section-number">4.6.1</span> Feature Ceiling</h3>
<p>Feature-engineered methods encode human knowledge about which genomic properties matter for variant function. Conservation scores capture evolutionary constraint; protein-level predictors encode structural intuitions; regulatory annotations mark biochemically active regions. This encoded knowledge is valuable but necessarily incomplete. Biologists cannot specify all relevant patterns in advance, and the interactions between features may be too complex for simple combination rules to capture.</p>
<p>The performance of feature-engineered methods is therefore bounded by the quality and completeness of the features themselves. Adding more features provides diminishing returns as the most informative signals are exhausted. Interactions between features (a variant in a conserved enhancer within a constrained gene) may require explicit specification or rely on simple combination rules that miss nonlinear relationships. The linear SVM at the heart of <em>CADD</em> cannot represent the complex feature interactions that characterize biological regulation.</p>
</section>
<section id="sec-ch04-limited-context" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="sec-ch04-limited-context"><span class="header-section-number">4.6.2</span> Limited Context</h3>
<p>Classical features typically describe variants in isolation or with minimal context. Conservation scores examine each position independently. Protein-level predictors consider amino acid substitutions without full protein context. Gene-level features apply uniformly across entire genes regardless of position-specific effects. This limited context prevents classical methods from learning the complex sequence patterns that determine variant effects.</p>
<p>A variant disrupting a critical transcription factor binding motif may escape detection if the motif is not annotated, even though the underlying sequence pattern is learnable from data. A missense variant at a protein-protein interface may be more damaging than one in a loop region, but capturing this distinction requires understanding protein structure and interactions that feature engineering incompletely represents. The local sequence context surrounding a variant often matters, but which contexts matter and how requires learning from data rather than specification by experts.</p>
</section>
<section id="sec-ch04-measurement-gap" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="sec-ch04-measurement-gap"><span class="header-section-number">4.6.3</span> Persistent Gap Between Measurement and Need</h3>
<p>Each classical method measures something related to but distinct from clinical pathogenicity. Conservation scores measure evolutionary constraint. Protein-level predictors measure functional disruption. <em>CADD</em> measures evolutionary tolerance. Each provides genuine biological signal, but none directly answers the clinical question: will this variant cause disease in this patient?</p>
<p>This gap is not merely a limitation of specific methods but reflects something deeper about the variant interpretation problem. The clinically relevant question depends on context (which tissue, which genetic background, which environmental exposures) that no current method captures. Even perfect prediction of functional disruption would not resolve questions of penetrance, expressivity, and disease mechanism. Classical methods provide important evidence for variant interpretation, but they cannot substitute for the integrative clinical reasoning examined in <a href="../part_7/p7-ch28-clinical-risk.html" class="quarto-xref"><span>Chapter 28</span></a>.</p>
</section>
<section id="sec-ch04-features-to-representations" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="sec-ch04-features-to-representations"><span class="header-section-number">4.6.4</span> From Features to Representations</h3>
<p>The transition from <em>CADD</em> to deep learning methods represents a fundamental shift in how variant effect prediction is approached: from encoding biological knowledge as hand-crafted features to learning representations directly from sequence data. Where <em>SIFT</em> computes conservation from explicit multiple sequence alignments, <em>ESM-2</em> learns similar signals implicitly through masked language modeling on protein sequences. Where <em>PolyPhen-2</em> engineers features from solved protein structures, <em>AlphaFold2</em> learns geometric constraints from evolutionary covariation (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>). The tokenization strategies and embedding approaches that enable this representation learning are detailed in <a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a>. The shift is real and consequential.</p>
<p>Yet learned representations do not automatically overcome the limitations that constrain classical methods. The circularity between training labels and evaluation benchmarks affects transformer-based predictors exactly as it affects logistic regression. A model trained on ClinVar pathogenic variants inherits ClinVar’s ascertainment biases whether it uses 100 features or 100 million parameters. Rare variants remain difficult because they are rare in training data. Novel mechanisms remain invisible because no labeled examples exist. The variant effect prediction problem is fundamentally difficult, and methodology alone cannot resolve difficulties rooted in data availability and biological complexity. The zero-shot scoring paradigm (<a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-zeroshot-supervised" class="quarto-xref"><span>Section 18.1.1</span></a>) offers a partial escape from label circularity by deriving variant scores from unsupervised pretraining objectives rather than explicit pathogenicity annotations, though this approach introduces its own assumptions about what pretraining captures.</p>
<p>Classical methods remain valuable: as baselines that establish the performance floor modern methods must exceed, as interpretable components when understanding matters as much as prediction, and as reminders of what the field has learned about which signals carry predictive information. Foundation models have advanced variant effect prediction (<a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>), but honest evaluation requires understanding what classical methods achieved and where all approaches, classical and modern alike, continue to struggle. The evaluation methodology required to fairly assess both classical and learned approaches is detailed in <a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a>, with genomics-specific metric considerations in <a href="../part_3/p3-ch12-evaluation.html#sec-ch12-metrics-genomic-tasks" class="quarto-xref"><span>Section 12.6</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>What do conservation scores like phyloP and GERP actually measure, and why is this different from clinical pathogenicity?</li>
<li>How do SIFT and PolyPhen-2 assess missense variant severity, and what are the key differences in their approaches?</li>
<li>Why did CADD use evolutionary proxy labels (observed vs.&nbsp;simulated variants) rather than clinical pathogenicity labels for training?</li>
<li>What is the circularity problem between variant effect predictors and clinical databases like ClinVar?</li>
<li>Why do classical variant effect predictors struggle with rare variants and novel mechanisms?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Conservation scores measure evolutionary constraint, not disease relevance</strong>: phyloP quantifies deviation from neutral evolution rates, while GERP estimates rejected substitutions across evolutionary time. These scores measure whether positions have been important for reproductive fitness across species, which differs from clinical pathogenicity because evolution cannot detect late-onset diseases, tissue-specific effects, or recently evolved human-specific functions.</p></li>
<li><p><strong>SIFT uses sequence homology alone, while PolyPhen-2 integrates structure</strong>: SIFT examines which amino acids appear at each position across homologous sequences and predicts that substitutions introducing amino acids not observed evolutionarily are deleterious. PolyPhen-2 extends this by incorporating protein structure features (solvent accessibility, secondary structure, proximity to functional sites) and physicochemical properties (Grantham distance, BLOSUM matrices) to assess whether substitutions are conservative or radical in their structural context.</p></li>
<li><p><strong>Evolutionary proxy labels provided millions of training examples from unlabeled data</strong>: Clinical pathogenicity labels were scarce (thousands of variants) and biased toward well-studied genes, while evolutionary proxy labels (observed human-derived alleles versus simulated variants) provided millions of training examples. The proxy-neutral class consists of variants that survived purifying selection, while the proxy-deleterious class represents mutations that could occur but are generally not observed at high frequency, allowing CADD to learn at scale despite measuring evolutionary tolerance rather than clinical pathogenicity directly.</p></li>
<li><p><strong>Circularity creates a self-reinforcing loop that inflates performance</strong>: Clinical laboratories use computational scores like CADD as evidence when classifying variants in ClinVar, then benchmarking studies evaluate those same predictors on ClinVar variants. This means predictors are tested on labels they helped create, artificially inflating their apparent performance because they influenced the ground truth labels used for evaluation.</p></li>
<li><p><strong>Rare variants and novel mechanisms lack training examples</strong>: Classical predictors learn from patterns observed in training data, so variants with mechanisms not represented in curated databases (gain-of-function mutations, human-specific regulatory elements, recently evolved functions) have no labeled examples to learn from. Ascertainment bias means training sets over-represent variants in well-studied genes with severe Mendelian phenotypes, while diagnostically challenging cases in rare genes or with unusual mechanisms are systematically underrepresented.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p><strong>Core concepts covered:</strong></p>
<ul>
<li><strong>Conservation scores</strong> (phyloP, GERP, phastCons) quantify evolutionary constraint by comparing observed substitution rates to neutral expectations</li>
<li><strong>Protein-level predictors</strong> (<em>SIFT</em>, <em>PolyPhen-2</em>) assess amino acid substitution severity using sequence homology and structural features</li>
<li><strong><em>CADD</em></strong> pioneered evolutionary proxy training, using observed vs.&nbsp;simulated variants to generate millions of training labels</li>
<li><strong>Ensemble methods</strong> (<em>REVEL</em>, <em>M-CAP</em>) combine multiple scores for improved performance on specific variant classes</li>
<li><strong>Circularity</strong> between predictors and clinical databases inflates apparent performance</li>
<li><strong>Ascertainment bias</strong> means benchmarks over-represent easy cases from well-studied genes</li>
</ul>
<p><strong>The fundamental insight:</strong> Every classical predictor measures a proxy for clinical relevance, not clinical relevance itself. Conservation reflects evolutionary fitness, not human disease. Protein disruption does not determine penetrance. Benchmark performance does not guarantee clinical utility.</p>
<p><strong>Looking ahead:</strong> The limitations of hand-crafted features motivate the shift to learned representations (<a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a>), where models learn relevant patterns from data rather than expert specification. Foundation models (<a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-defining" class="quarto-xref"><span>Section 14.2</span></a>) extend this approach by pretraining on massive unlabeled datasets, enabling variant effect prediction without the label circularity that affects supervised methods (<a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>).</p>
<p><strong>Key skills to retain:</strong></p>
<ol type="1">
<li>Given a conservation score (phyloP = 3.5, GERP = 4.2), explain what it means and what it does not mean</li>
<li>Compare what <em>SIFT</em> and <em>PolyPhen-2</em> measure and when each is most useful</li>
<li>Explain why <em>CADD</em> uses evolutionary proxy labels rather than clinical labels</li>
<li>Identify circularity concerns when interpreting benchmark performance</li>
</ol>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-adzhubei_method_2010" class="csl-entry" role="listitem">
Adzhubei, Ivan A., Steffen Schmidt, Leonid Peshkin, Vasily E. Ramensky, Anna Gerasimova, Peer Bork, Alexey S. Kondrashov, and Shamil R. Sunyaev. 2010. <span>“A Method and Server for Predicting Damaging Missense Mutations.”</span> <em>Nature Methods</em> 7 (4): 248–49. <a href="https://doi.org/10.1038/nmeth0410-248">https://doi.org/10.1038/nmeth0410-248</a>.
</div>
<div id="ref-davydov_identifying_2010" class="csl-entry" role="listitem">
Davydov, Eugene V., David L. Goode, Marina Sirota, Gregory M. Cooper, Arend Sidow, and Serafim Batzoglou. 2010. <span>“Identifying a <span>High</span> <span>Fraction</span> of the <span>Human</span> <span>Genome</span> to Be Under <span>Selective</span> <span>Constraint</span> <span>Using</span> <span>GERP</span>++.”</span> <em>PLOS Computational Biology</em> 6 (12): e1001025. <a href="https://doi.org/10.1371/journal.pcbi.1001025">https://doi.org/10.1371/journal.pcbi.1001025</a>.
</div>
<div id="ref-grantham_amino_1974" class="csl-entry" role="listitem">
Grantham, R. 1974. <span>“Amino <span>Acid</span> <span>Difference</span> <span>Formula</span> to <span>Help</span> <span>Explain</span> <span>Protein</span> <span>Evolution</span>.”</span> <em>Science</em> 185 (4154): 862–64. <a href="https://doi.org/10.1126/science.185.4154.862">https://doi.org/10.1126/science.185.4154.862</a>.
</div>
<div id="ref-henikoff_amino_1992" class="csl-entry" role="listitem">
Henikoff, S, and J G Henikoff. 1992. <span>“Amino Acid Substitution Matrices from Protein Blocks.”</span> <em>Proceedings of the National Academy of Sciences</em> 89 (22): 10915–19. <a href="https://doi.org/10.1073/pnas.89.22.10915">https://doi.org/10.1073/pnas.89.22.10915</a>.
</div>
<div id="ref-hubisz_exploring_2014" class="csl-entry" role="listitem">
Hubisz, Melissa J, and Katherine S Pollard. 2014. <span>“Exploring the Genesis and Functions of <span>Human</span> <span>Accelerated</span> <span>Regions</span> Sheds Light on Their Role in Human Evolution.”</span> <em>Current Opinion in Genetics &amp; Development</em>, Genetics of human evolution, 29 (December): 15–21. <a href="https://doi.org/10.1016/j.gde.2014.07.005">https://doi.org/10.1016/j.gde.2014.07.005</a>.
</div>
<div id="ref-ioannidis_revel_2016" class="csl-entry" role="listitem">
Ioannidis, Nilah M., Joseph H. Rothstein, Vikas Pejaver, Sumit Middha, Shannon K. McDonnell, Saurabh Baheti, Anthony Musolf, et al. 2016. <span>“<span>REVEL</span>: <span>An</span> <span>Ensemble</span> <span>Method</span> for <span>Predicting</span> the <span>Pathogenicity</span> of <span>Rare</span> <span>Missense</span> <span>Variants</span>.”</span> <em>The American Journal of Human Genetics</em> 99 (4): 877–85. <a href="https://doi.org/10.1016/j.ajhg.2016.08.016">https://doi.org/10.1016/j.ajhg.2016.08.016</a>.
</div>
<div id="ref-jagadeesh_m-cap_2016" class="csl-entry" role="listitem">
Jagadeesh, Karthik A., Aaron M. Wenger, Mark J. Berger, Harendra Guturu, Peter D. Stenson, David N. Cooper, Jonathan A. Bernstein, and Gill Bejerano. 2016. <span>“M-<span>CAP</span> Eliminates a Majority of Variants of Uncertain Significance in Clinical Exomes at High Sensitivity.”</span> <em>Nature Genetics</em> 48 (12): 1581–86. <a href="https://doi.org/10.1038/ng.3703">https://doi.org/10.1038/ng.3703</a>.
</div>
<div id="ref-kircher_general_2014" class="csl-entry" role="listitem">
Kircher, Martin, Daniela M. Witten, Preti Jain, Brian J. O’Roak, Gregory M. Cooper, and Jay Shendure. 2014. <span>“A General Framework for Estimating the Relative Pathogenicity of Human Genetic Variants.”</span> <em>Nature Genetics</em> 46 (3): 310–15. <a href="https://doi.org/10.1038/ng.2892">https://doi.org/10.1038/ng.2892</a>.
</div>
<div id="ref-ng_sift_2003" class="csl-entry" role="listitem">
Ng, Pauline C., and Steven Henikoff. 2003. <span>“<span>SIFT</span>: <span>Predicting</span> Amino Acid Changes That Affect Protein Function.”</span> <em>Nucleic Acids Research</em> 31 (13): 3812–14. <a href="https://doi.org/10.1093/nar/gkg509">https://doi.org/10.1093/nar/gkg509</a>.
</div>
<div id="ref-rentzsch_cadd-spliceimproving_2021" class="csl-entry" role="listitem">
Rentzsch, Philipp, Max Schubach, Jay Shendure, and Martin Kircher. 2021. <span>“<span>CADD</span>-<span>Splice</span>—Improving Genome-Wide Variant Effect Prediction Using Deep Learning-Derived Splice Scores.”</span> <em>Genome Medicine</em> 13 (1): 31. <a href="https://doi.org/10.1186/s13073-021-00835-9">https://doi.org/10.1186/s13073-021-00835-9</a>.
</div>
<div id="ref-rentzsch_cadd_2019" class="csl-entry" role="listitem">
Rentzsch, Philipp, Daniela Witten, Gregory M Cooper, Jay Shendure, and Martin Kircher. 2019. <span>“<span>CADD</span>: Predicting the Deleteriousness of Variants Throughout the Human Genome.”</span> <em>Nucleic Acids Research</em> 47 (D1): D886–94. <a href="https://doi.org/10.1093/nar/gky1016">https://doi.org/10.1093/nar/gky1016</a>.
</div>
<div id="ref-richards_standards_2015" class="csl-entry" role="listitem">
Richards, Sue, Nazneen Aziz, Sherri Bale, David Bick, Soma Das, Julie Gastier-Foster, Wayne W. Grody, et al. 2015. <span>“Standards and Guidelines for the Interpretation of Sequence Variants: A Joint Consensus Recommendation of the <span>American</span> <span>College</span> of <span>Medical</span> <span>Genetics</span> and <span>Genomics</span> and the <span>Association</span> for <span>Molecular</span> <span>Pathology</span>.”</span> <em>Genetics in Medicine</em> 17 (5): 405–24. <a href="https://doi.org/10.1038/gim.2015.30">https://doi.org/10.1038/gim.2015.30</a>.
</div>
<div id="ref-schubach_cadd_2024" class="csl-entry" role="listitem">
Schubach, Max, Thorben Maass, Lusiné Nazaretyan, Sebastian Röner, and Martin Kircher. 2024. <span>“<span>CADD</span> V1.7: Using Protein Language Models, Regulatory <span>CNNs</span> and Other Nucleotide-Level Scores to Improve Genome-Wide Variant Predictions.”</span> <em>Nucleic Acids Research</em> 52 (D1): D1143–54. <a href="https://doi.org/10.1093/nar/gkad989">https://doi.org/10.1093/nar/gkad989</a>.
</div>
<div id="ref-siepel_phastcons_2005" class="csl-entry" role="listitem">
Siepel, Adam, Gill Bejerano, Jakob S. Pedersen, Angie S. Hinrichs, Minmei Hou, Kate Rosenbloom, Hiram Clawson, et al. 2005. <span>“[<span>PhastCons</span>] <span>Evolutionarily</span> Conserved Elements in Vertebrate, Insect, Worm, and Yeast Genomes.”</span> <em>Genome Research</em> 15 (8): 1034–50. <a href="https://doi.org/10.1101/gr.3715005">https://doi.org/10.1101/gr.3715005</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_1/p1-ch03-gwas.html" class="pagination-link" aria-label="GWAS and Polygenic Scores">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_2/p2--architectures.html" class="pagination-link" aria-label="Part II: Architectures">
        <span class="nav-page-text">Part II: Architectures</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>