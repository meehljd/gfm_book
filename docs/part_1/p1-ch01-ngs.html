<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; From Reads to Variants – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_1/p1-ch02-data.html" rel="next">
<link href="../part_1/p1--foundations.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch01-challenges" id="toc-sec-ch01-challenges" class="nav-link active" data-scroll-target="#sec-ch01-challenges"><span class="header-section-number">1.1</span> NGS Data Challenges</a></li>
  <li><a href="#sec-ch01-targeting" id="toc-sec-ch01-targeting" class="nav-link" data-scroll-target="#sec-ch01-targeting"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-panels" id="toc-sec-ch01-panels" class="nav-link" data-scroll-target="#sec-ch01-panels"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</a></li>
  <li><a href="#sec-ch01-wes" id="toc-sec-ch01-wes" class="nav-link" data-scroll-target="#sec-ch01-wes"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</a></li>
  <li><a href="#sec-ch01-wgs" id="toc-sec-ch01-wgs" class="nav-link" data-scroll-target="#sec-ch01-wgs"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</a></li>
  <li><a href="#sec-ch01-longread" id="toc-sec-ch01-longread" class="nav-link" data-scroll-target="#sec-ch01-longread"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</a></li>
  </ul></li>
  <li><a href="#sec-ch01-classical" id="toc-sec-ch01-classical" class="nav-link" data-scroll-target="#sec-ch01-classical"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-alignment" id="toc-sec-ch01-alignment" class="nav-link" data-scroll-target="#sec-ch01-alignment"><span class="header-section-number">1.3.1</span> From Sequencer to Aligned Reads</a></li>
  <li><a href="#sec-ch01-persample" id="toc-sec-ch01-persample" class="nav-link" data-scroll-target="#sec-ch01-persample"><span class="header-section-number">1.3.2</span> Per-Sample Variant Calling</a></li>
  <li><a href="#sec-ch01-cohort" id="toc-sec-ch01-cohort" class="nav-link" data-scroll-target="#sec-ch01-cohort"><span class="header-section-number">1.3.3</span> Cohort Calling and Filtering</a></li>
  <li><a href="#sec-ch01-qc" id="toc-sec-ch01-qc" class="nav-link" data-scroll-target="#sec-ch01-qc"><span class="header-section-number">1.3.4</span> Sample-Level Quality Control</a></li>
  </ul></li>
  <li><a href="#sec-ch01-phasing" id="toc-sec-ch01-phasing" class="nav-link" data-scroll-target="#sec-ch01-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-phasing-importance" id="toc-sec-ch01-phasing-importance" class="nav-link" data-scroll-target="#sec-ch01-phasing-importance"><span class="header-section-number">1.4.1</span> Clinical and Analytical Importance</a></li>
  <li><a href="#sec-ch01-phasing-methods" id="toc-sec-ch01-phasing-methods" class="nav-link" data-scroll-target="#sec-ch01-phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</a></li>
  <li><a href="#sec-ch01-phasing-approaches" id="toc-sec-ch01-phasing-approaches" class="nav-link" data-scroll-target="#sec-ch01-phasing-approaches"><span class="header-section-number">1.4.3</span> Phasing Approaches</a></li>
  <li><a href="#sec-ch01-imputation" id="toc-sec-ch01-imputation" class="nav-link" data-scroll-target="#sec-ch01-imputation"><span class="header-section-number">1.4.4</span> Genotype Imputation and Refinement</a></li>
  <li><a href="#sec-ch01-hybrid" id="toc-sec-ch01-hybrid" class="nav-link" data-scroll-target="#sec-ch01-hybrid"><span class="header-section-number">1.4.5</span> Hybrid Sequencing and Coverage Boosting</a></li>
  </ul></li>
  <li><a href="#sec-ch01-errors" id="toc-sec-ch01-errors" class="nav-link" data-scroll-target="#sec-ch01-errors"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-mapping-bias" id="toc-sec-ch01-mapping-bias" class="nav-link" data-scroll-target="#sec-ch01-mapping-bias"><span class="header-section-number">1.5.1</span> Mapping Ambiguity and Reference Bias</a></li>
  <li><a href="#sec-ch01-artifacts" id="toc-sec-ch01-artifacts" class="nav-link" data-scroll-target="#sec-ch01-artifacts"><span class="header-section-number">1.5.2</span> Systematic Sequencing Artifacts</a></li>
  <li><a href="#sec-ch01-coverage" id="toc-sec-ch01-coverage" class="nav-link" data-scroll-target="#sec-ch01-coverage"><span class="header-section-number">1.5.3</span> Coverage Gaps and Allelic Imbalance</a></li>
  <li><a href="#sec-ch01-complex" id="toc-sec-ch01-complex" class="nav-link" data-scroll-target="#sec-ch01-complex"><span class="header-section-number">1.5.4</span> Complex Variants and Representation</a></li>
  </ul></li>
  <li><a href="#sec-ch01-difficult" id="toc-sec-ch01-difficult" class="nav-link" data-scroll-target="#sec-ch01-difficult"><span class="header-section-number">1.6</span> Difficult Regions: The Limits of Short-Read Calling</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-segdup" id="toc-sec-ch01-segdup" class="nav-link" data-scroll-target="#sec-ch01-segdup"><span class="header-section-number">1.6.1</span> Segmental Duplications and Gene Families</a></li>
  <li><a href="#sec-ch01-repeats" id="toc-sec-ch01-repeats" class="nav-link" data-scroll-target="#sec-ch01-repeats"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</a></li>
  <li><a href="#sec-ch01-hla" id="toc-sec-ch01-hla" class="nav-link" data-scroll-target="#sec-ch01-hla"><span class="header-section-number">1.6.3</span> HLA Region Complexity</a></li>
  </ul></li>
  <li><a href="#sec-ch01-benchmarks" id="toc-sec-ch01-benchmarks" class="nav-link" data-scroll-target="#sec-ch01-benchmarks"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-giab" id="toc-sec-ch01-giab" class="nav-link" data-scroll-target="#sec-ch01-giab"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</a></li>
  <li><a href="#sec-ch01-metrics" id="toc-sec-ch01-metrics" class="nav-link" data-scroll-target="#sec-ch01-metrics"><span class="header-section-number">1.7.2</span> Metrics and Their Meaning</a></li>
  <li><a href="#sec-ch01-benchmark-limits" id="toc-sec-ch01-benchmark-limits" class="nav-link" data-scroll-target="#sec-ch01-benchmark-limits"><span class="header-section-number">1.7.3</span> Limitations of Benchmarks</a></li>
  </ul></li>
  <li><a href="#sec-ch01-deepvariant" id="toc-sec-ch01-deepvariant" class="nav-link" data-scroll-target="#sec-ch01-deepvariant"><span class="header-section-number">1.8</span> DeepVariant: Variant Calling as Image Classification</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-pileup" id="toc-sec-ch01-pileup" class="nav-link" data-scroll-target="#sec-ch01-pileup"><span class="header-section-number">1.8.1</span> Pileup Images as Input</a></li>
  <li><a href="#sec-ch01-deepvariant-arch" id="toc-sec-ch01-deepvariant-arch" class="nav-link" data-scroll-target="#sec-ch01-deepvariant-arch"><span class="header-section-number">1.8.2</span> Architecture and Training</a></li>
  <li><a href="#sec-ch01-glnexus" id="toc-sec-ch01-glnexus" class="nav-link" data-scroll-target="#sec-ch01-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with GLnexus</a></li>
  <li><a href="#sec-ch01-deepvariant-comparison" id="toc-sec-ch01-deepvariant-comparison" class="nav-link" data-scroll-target="#sec-ch01-deepvariant-comparison"><span class="header-section-number">1.8.4</span> Comparison with Classical Approaches</a></li>
  </ul></li>
  <li><a href="#sec-ch01-implications" id="toc-sec-ch01-implications" class="nav-link" data-scroll-target="#sec-ch01-implications"><span class="header-section-number">1.9</span> Implications for Genomic Deep Learning</a>
  <ul class="collapse">
  <li><a href="#sec-ch01-atomic" id="toc-sec-ch01-atomic" class="nav-link" data-scroll-target="#sec-ch01-atomic"><span class="header-section-number">1.9.1</span> Variants as Atomic Units</a></li>
  <li><a href="#sec-ch01-inherited" id="toc-sec-ch01-inherited" class="nav-link" data-scroll-target="#sec-ch01-inherited"><span class="header-section-number">1.9.2</span> Inherited Biases and Blind Spots</a></li>
  <li><a href="#sec-ch01-effect-sizes" id="toc-sec-ch01-effect-sizes" class="nav-link" data-scroll-target="#sec-ch01-effect-sizes"><span class="header-section-number">1.9.3</span> Effect Sizes Across the Frequency Spectrum</a></li>
  </ul></li>
  <li><a href="#sec-ch01-reliability" id="toc-sec-ch01-reliability" class="nav-link" data-scroll-target="#sec-ch01-reliability"><span class="header-section-number">1.10</span> Reliability Landscape</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch01-ngs" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Variant calls are inferences, not observations.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 40-50 minutes</p>
<p><strong>Prerequisites:</strong> Basic understanding of DNA structure and the concept of genetic variants (mutations, SNPs). No prior knowledge of sequencing technology required.</p>
<p><strong>You will learn:</strong></p>
<ul>
<li>How next-generation sequencing produces data and its inherent limitations</li>
<li>The computational pipeline that transforms raw reads into variant calls</li>
<li>Where variant calling systematically fails and why this matters for downstream models</li>
<li>How deep learning (DeepVariant) reformulates variant calling as pattern recognition</li>
</ul>
<p><strong>Key insight:</strong> Variant calls are inferences, not observations. Every downstream model inherits the systematic errors and blind spots of the variant calling pipeline.</p>
</div>
</div>
<p>Every polygenic risk score, every variant pathogenicity prediction, every clinical interpretation of a patient’s genome begins with a prior assumption: that the variants being analyzed are real. Researchers download <code>VCF</code> files from biobanks, filter by allele frequency, and feed variants into predictive models without questioning whether those variants truly exist in the original biological sample. Yet the sequencer did not observe these variants. It produced millions of short reads with characteristic error profiles; alignment algorithms placed those reads against a reference genome with varying confidence; variant callers integrated the evidence into genotype calls that may or may not reflect biological reality. When this inference fails, every downstream analysis inherits errors that propagate silently through the entire computational pipeline.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variant calling is inference, not observation. Errors introduced at this stage propagate silently through every downstream analysis.</p>
</div>
</div>
<p>Short-read sequencing technologies produce reads of 100 to 300 base pairs with error rates near one percent, creating fundamental ambiguities in repetitive regions, segmental duplications, and regions of high sequence complexity. Classical variant callers addressed these challenges through probabilistic models that integrate multiple evidence types: base quality scores, mapping quality, strand balance, and population allele frequencies. Deep learning approaches, exemplified by <em>DeepVariant</em>, reformulated variant calling as image classification, learning to distinguish true variants from artifacts in ways that generalize across sequencing platforms and sample types.</p>
<p>The representational approach of encoding pileups as images anticipates the embedding strategies discussed in <a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a>. <em>DeepVariant’s</em> CNN architecture shares design principles with regulatory models like <em>DeepSEA</em> (<a href="../part_2/p2-ch06-cnn.html#sec-ch06-deepsea" class="quarto-xref"><span>Section 6.2</span></a>), though applied to different input modalities. Where <em>DeepVariant</em> learns variant-specific patterns from labeled training data, foundation models (<a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-defining" class="quarto-xref"><span>Section 14.2</span></a>) learn sequence representations from unlabeled genomes.</p>
<p>Understanding where variant calling succeeds and fails is essential context for genomic foundation models. The challenging regions of the genome (tandem repeats, segmental duplications, the major histocompatibility complex) that confound variant callers also challenge models trained on variant calls. The systematic errors introduced at this stage create systematic blind spots that no amount of sophisticated downstream modeling can correct. The evaluation challenges created by these blind spots are examined in detail in <a href="../part_3/p3-ch12-evaluation.html#sec-ch12-homology-aware-splitting" class="quarto-xref"><span>Section 12.2</span></a>.</p>
<section id="sec-ch01-challenges" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sec-ch01-challenges"><span class="header-section-number">1.1</span> NGS Data Challenges</h2>
<p>The human genome contains approximately three billion base pairs, yet no instrument can read this sequence in one continuous stretch. <strong>Next-generation sequencing (NGS)</strong> instead fragments DNA molecules into short pieces, sequences each fragment independently, and produces tens to hundreds of gigabases of sequence data per run <span class="citation" data-cites="goodwin_coming_2016">(<a href="../bib/references.html#ref-goodwin_coming_2016" role="doc-biblioref">Goodwin, McPherson, and McCombie 2016</a>)</span>. The typical output consists of paired-end Illumina reads spanning 100 to 300 base pairs each, with each base assigned a quality score reflecting the instrument’s confidence in that call. This abundance comes at a cost: every read carries non-trivial measurement uncertainty, including substitutions from miscalled bases, context-specific errors near homopolymers, and quality degradation toward read ends.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Short-read sequencing produces reads of 100-300 base pairs. What genomic features do you predict would be difficult to analyze with such short fragments? Consider features that span long distances or involve repetitive sequences.</p>
</div>
</div>
<p>Long-read technologies from Pacific Biosciences and Oxford Nanopore extend the observable space dramatically, producing reads of 10 kilobases to over a megabase in length <span class="citation" data-cites="wenger_accurate_2019 dabernig-heinz_multicenter_2024">(<a href="../bib/references.html#ref-wenger_accurate_2019" role="doc-biblioref">Wenger et al. 2019</a>; <a href="../bib/references.html#ref-dabernig-heinz_multicenter_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>. These platforms access genomic territory invisible to short reads, including complex structural variants, segmental duplications, and repetitive regions. They carry their own characteristic error profiles, however, and the choice of sequencing platform fundamentally shapes which variants are discoverable and which systematic biases enter downstream analyses. A variant residing within a repetitive element may be invisible to short reads but readily detected by long reads that span the entire repeat.</p>
<p>The central problem is deceptively simple in statement but profound in consequence: how do we turn raw reads into a reliable list of genomic variants? Answering this question requires disentangling three fundamentally different sources of signal that manifest identically as mismatches between reads and reference. Sequencing errors arise from instrument noise and PCR artifacts during library preparation, creating false variants that never existed in the original DNA. Alignment artifacts occur when reads are mapped to incorrect genomic locations, particularly in repetitive regions and paralogous gene families, causing true variants to appear at wrong positions or disappear entirely. Genuine biological variation encompasses germline variants inherited from parents, somatic mutations acquired during cellular division, and mosaicism where only a fraction of cells carry a particular change. Historically, complex modular pipelines combining probabilistic models and hand-crafted heuristics addressed this separation <span class="citation" data-cites="nielsen_genotype_2011">(<a href="../bib/references.html#ref-nielsen_genotype_2011" role="doc-biblioref">Nielsen et al. 2011</a>)</span>. Deep learning now plays an important role in simplifying and improving parts of this stack, but understanding the classical pipeline remains essential for interpreting what downstream models actually learn.</p>
<p>Germline variant calling in whole-exome and whole-genome sequencing presents the core technical challenge underlying most genomic deep learning applications. Somatic variant calling in cancer and RNA-seq-specific variant calling share many parallels but require additional considerations addressed elsewhere.</p>
</section>
<section id="sec-ch01-targeting" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-ch01-targeting"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</h2>
<p>Different clinical and scientific goals demand different sequencing strategies. A patient presenting with sudden cardiac arrest at age 35 needs deep, reliable coverage of <em>KCNQ1</em>, <em>KCNH2</em>, <em>SCN5A</em>, and other ion channel genes associated with long QT syndrome; sequencing her entire genome to find these variants would waste resources and delay clinical decisions. A biobank building training data for polygenic risk scores across hundreds of thousands of participants needs genome-wide coverage, even if individual sites have modest depth. A family searching for the cause of their child’s undiagnosed developmental delay needs comprehensive coverage that leaves no coding exon unexamined. These competing demands drive the choice between targeted panels, whole-exome sequencing, and whole-genome sequencing.</p>
<section id="sec-ch01-panels" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="sec-ch01-panels"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</h3>
<p>When clinicians already know which genes to examine, <strong>targeted gene panels</strong> capture tens to hundreds of genes selected for a specific clinical indication. Panels for cardiomyopathy, hereditary cancer syndromes, or epilepsy restrict sequencing to regions of known clinical relevance. By limiting the target to a small number of loci, panels achieve very deep coverage (often exceeding 500×) at modest cost, enabling sensitive detection of rare variants and some degree of mosaicism.</p>
<p>The narrow scope of panels limits their utility for deep learning and population-scale analysis. Panels miss novel disease genes outside their predefined targets, cannot be easily repurposed for new traits, and often have heterogeneous content across laboratories that complicates data aggregation. For large-scale genomic foundation models, panel data serve better as richly phenotyped anchors than as primary training material: they provide clean labels for specific variants but sparse genomic coverage overall. The sparse coverage of panel data creates specific challenges for transfer learning, as discussed in <a href="../part_3/p3-ch10-adaptation.html#sec-ch10-domain-shift-types" class="quarto-xref"><span>Section 10.5.1</span></a>.</p>
</section>
<section id="sec-ch01-wes" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="sec-ch01-wes"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</h3>
<p>Protein-coding sequence represents approximately 1 to 2 percent of the genome but harbors a disproportionate share of variants with known functional consequences. <strong>Whole-exome sequencing (WES)</strong> enriches coding exons and some splice-adjacent regions through hybridization probes that pull down targeted DNA, followed by short-read sequencing. Typical coverage ranges from 80 to 150× for exonic targets, sufficient for confident heterozygous variant calling in most regions.</p>
<p>WES has driven Mendelian disease gene discovery for over a decade and powered early biobank-scale efforts, including the exome subsets of gnomAD and many hospital-based cohorts <span class="citation" data-cites="karczewski_mutational_2020">(<a href="../bib/references.html#ref-karczewski_mutational_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. The capture-based approach introduces systematic biases that propagate into downstream analyses, however. Certain exons consistently fail to capture efficiently, particularly those with extreme GC content, high repetitive content, or unusual length. A variant in the first exon of <em>HTT</em> (the Huntington disease gene) might be missed entirely due to extreme GC richness, and a variant effect predictor trained on WES data will never encounter variants in poorly captured regions. These blind spots are invisible in standard benchmarks but can have substantial clinical consequences. Batch effects tied to reagent lots and evolving panel designs further complicate multi-cohort analyses. Technical confounding from batch effects is systematically analyzed in <a href="../part_3/p3-ch13-confounding.html#sec-ch13-batch-effects" class="quarto-xref"><span>Section 13.2.2</span></a>, with mitigation strategies in <a href="../part_3/p3-ch13-confounding.html#sec-ch13-mitigation" class="quarto-xref"><span>Section 13.9</span></a>.</p>
</section>
<section id="sec-ch01-wgs" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="sec-ch01-wgs"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</h3>
<p>Noncoding variants contribute substantially to human disease, and structural variants often span boundaries between exonic and intronic sequence. <strong>Whole-genome sequencing (WGS)</strong> samples nearly all bases in the genome at typical coverage of 30 to 60×, encompassing both coding and noncoding regions without the biases introduced by capture chemistry. Because there is no enrichment step, WGS produces more uniform depth than WES and enables detection of noncoding regulatory variants, structural variants, and copy-number changes alongside <strong>single nucleotide variants (SNVs)</strong> and <strong>indels</strong> (insertions and deletions).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Types of Genetic Variants">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Types of Genetic Variants
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> Genetic variants are classified by their size and mechanism:</p>
<p><strong>Single Nucleotide Variants (SNVs):</strong> A single base pair change (e.g., A→G). Also called SNPs (single nucleotide polymorphisms) when common in the population. The most frequent variant type and easiest to detect.</p>
<p><strong>Insertions and Deletions (Indels):</strong> Addition or removal of 1-50 base pairs. When occurring in coding regions, indels that aren’t multiples of 3 cause <em>frameshifts</em> that disrupt the entire downstream protein sequence.</p>
<p><strong>Structural Variants (SVs):</strong> Large-scale genomic rearrangements (&gt;50 bp):</p>
<ul>
<li><em>Deletions</em>: Loss of a genomic segment</li>
<li><em>Duplications</em>: Extra copies of a segment</li>
<li><em>Inversions</em>: A segment flipped in orientation</li>
<li><em>Translocations</em>: Segments moved between chromosomes</li>
</ul>
<p><strong>Copy Number Variants (CNVs):</strong> Changes in the number of copies of a genomic region, ranging from kilobases to megabases. Can encompass entire genes.</p>
<p>Detection difficulty increases with variant size: SNVs are reliably detected by short reads, while SVs often require long reads or specialized algorithms. Most variant effect predictors focus on SNVs and small indels; SVs require different computational approaches.</p>
</div>
</div>
<p>WGS has become increasingly favored for new large cohorts and rare disease studies. The UK Biobank’s release of 500,000 whole genomes and gnomAD’s expansion to include diverse populations both rely on WGS as the primary data type <span class="citation" data-cites="bycroft_uk_2018 karczewski_mutational_2020">(<a href="../bib/references.html#ref-bycroft_uk_2018" role="doc-biblioref">Bycroft et al. 2018</a>; <a href="../bib/references.html#ref-karczewski_mutational_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. The data are reusable for many downstream analyses, including GWAS (<a href="p1-ch03-gwas.html" class="quarto-xref"><span>Chapter 3</span></a>), polygenic score development, and rare variant burden tests, and the simplified pipeline eliminates the need to track changing capture designs across time and centers. Whole-genome models typically assume access to WGS-based variant calls, even when actual training sets combine WES and WGS data for practical reasons.</p>
</section>
<section id="sec-ch01-longread" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="sec-ch01-longread"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</h3>
<p>Short reads face a fundamental limitation rooted in information theory: sequences shorter than local repeats, segmental duplications, or structural variants cannot unambiguously resolve these features. Consider the <em>SMN1</em> and <em>SMN2</em> genes, which differ by only five nucleotides across their entire coding regions. Distinguishing them is clinically critical for diagnosing spinal muscular atrophy, yet short reads routinely fail this task because a 150-bp read maps equally well to either genomic location.</p>
<p>Pacific Biosciences (PacBio) HiFi sequencing produces reads of 10 to 25 kilobases with per-base accuracy exceeding 99.9% through circular consensus sequencing, where the same molecule is read multiple times to correct random errors <span class="citation" data-cites="wenger_accurate_2019">(<a href="../bib/references.html#ref-wenger_accurate_2019" role="doc-biblioref">Wenger et al. 2019</a>)</span>. Oxford Nanopore Technologies (ONT) instruments generate reads ranging from a few kilobases to over a megabase in length, with rapidly improving raw accuracy and unique capabilities including portable sequencers suitable for field deployment, direct RNA sequencing without reverse transcription, and real-time base calling during sequencing <span class="citation" data-cites="dabernig-heinz_multicenter_2024">(<a href="../bib/references.html#ref-dabernig-heinz_multicenter_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>. These technologies played central roles in the telomere-to-telomere (T2T) assembly of a complete human genome and in emerging human pangenome references that capture population diversity beyond what any single linear reference can represent <span class="citation" data-cites="nurk_complete_2022 liao_draft_2023">(<a href="../bib/references.html#ref-nurk_complete_2022" role="doc-biblioref">Nurk et al. 2022</a>; <a href="../bib/references.html#ref-liao_draft_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Long reads transform variant calling by traversing low-complexity and repetitive regions essentially invisible to short-read technologies. Dedicated variant callers such as PEPPER-Margin-DeepVariant, <em>Clair3</em>, <em>Sniffles2</em>, <code>pbsv</code>, and <em>cuteSV</em> exploit read length and alignment patterns to detect insertions, deletions, inversions, and complex rearrangements <span class="citation" data-cites="shafin_haplotype-aware_2021 zheng_symphonizing_2022 smolka_detection_2024 noauthor_pacificbiosciencespbsv_2025 jiang_long-read-based_2020">(<a href="../bib/references.html#ref-shafin_haplotype-aware_2021" role="doc-biblioref">Shafin et al. 2021</a>; <a href="../bib/references.html#ref-zheng_symphonizing_2022" role="doc-biblioref">Zheng et al. 2022</a>; <a href="../bib/references.html#ref-smolka_detection_2024" role="doc-biblioref">Smolka et al. 2024</a>; <a href="../bib/references.html#ref-noauthor_pacificbiosciencespbsv_2025" role="doc-biblioref"><span>“<span>PacificBiosciences</span>/Pbsv”</span> 2025</a>; <a href="../bib/references.html#ref-jiang_long-read-based_2020" role="doc-biblioref">Jiang et al. 2020</a>)</span>. Single molecules spanning multiple heterozygous sites provide direct phasing information for <strong>haplotype</strong> resolution without statistical inference. Long reads also inform graph-based references and pangenomes that better represent population diversity than traditional linear references <span class="citation" data-cites="liao_draft_2023">(<a href="../bib/references.html#ref-liao_draft_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Short-read pipelines remain the workhorse for large human cohorts due to cost and throughput advantages that will persist for years. Downstream models must accommodate variants discovered by either technology and must be evaluated on composite callsets that integrate short- and long-read information.</p>
<div id="tbl-sequencing-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sequencing-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1: Comparison of major sequencing platforms
</figcaption>
<div aria-describedby="tbl-sequencing-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Short-Read (Illumina)</th>
<th>Long-Read (PacBio HiFi)</th>
<th>Long-Read (ONT)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Read length</td>
<td>100-300 bp</td>
<td>10-25 kb</td>
<td>1 kb - 1 Mb</td>
</tr>
<tr class="even">
<td>Error rate</td>
<td>~0.1%</td>
<td>~0.1% (after CCS)</td>
<td>1-5% (improving)</td>
</tr>
<tr class="odd">
<td>Cost per Gb</td>
<td>Low</td>
<td>Higher</td>
<td>Moderate</td>
</tr>
<tr class="even">
<td>Repeat resolution</td>
<td>Poor</td>
<td>Good</td>
<td>Excellent</td>
</tr>
<tr class="odd">
<td>Best use case</td>
<td>Population scale</td>
<td>Structural variants</td>
<td>Real-time, field</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practical Guidance: Choosing a Sequencing Strategy">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Choosing a Sequencing Strategy
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Use targeted panels</strong> when: known genes, need deep coverage, cost-constrained, clinical turnaround time matters</li>
<li><strong>Use WES</strong> when: coding variants are primary interest, want reusable data, moderate cost tolerance</li>
<li><strong>Use WGS</strong> when: noncoding variants matter, structural variants expected, want maximally reusable data</li>
<li><strong>Use long-read</strong> when: repetitive regions critical, phasing essential, structural variants are focus</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check: Which Sequencing Strategy?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check: Which Sequencing Strategy?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For each clinical scenario, which sequencing approach would you recommend and why?</p>
<ol type="1">
<li><p>A 35-year-old patient presents with sudden cardiac arrest. Family history reveals a father who died suddenly at age 42. The cardiologist suspects long QT syndrome or hypertrophic cardiomyopathy.</p></li>
<li><p>A research team is building a training dataset for a polygenic risk score model across 50 complex traits, requiring genome-wide coverage in 100,000 participants.</p></li>
<li><p>A child with spinal muscular atrophy-like symptoms tests negative on standard <em>SMN1</em> gene panels. The neurologist suspects a structural variant affecting the <em>SMN1/SMN2</em> locus.</p></li>
<li><p>A rare disease patient remains undiagnosed after standard exome sequencing. Phenotyping suggests a syndromic condition, but no coding variants explain the presentation.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Targeted cardiac gene panel</strong>—Known disease genes, need for high coverage (&gt;500×) to detect mosaicism, rapid turnaround for clinical decision-making, and cost-effectiveness make panels ideal for suspected Mendelian cardiac conditions.</p></li>
<li><p><strong>Whole-genome sequencing (WGS)</strong>—Polygenic scores require genome-wide common variant coverage without capture biases; WGS provides uniform depth across coding and noncoding regions, enabling GWAS across all 50 traits from a single sequencing run.</p></li>
<li><p><strong>Long-read sequencing (PacBio or ONT)</strong>—The <em>SMN1/SMN2</em> locus is a known repetitive region where short reads fail due to the genes’ near-identical sequences; long reads spanning both genes can resolve copy number and structural variants invisible to short-read approaches.</p></li>
<li><p><strong>Whole-genome sequencing</strong>—Exome-negative cases often harbor noncoding regulatory variants, deep intronic splice variants, or structural variants outside exonic targets; WGS captures the full genomic landscape missed by exome enrichment.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch01-classical" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sec-ch01-classical"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</h2>
<p>Understanding classical approaches matters not merely for historical completeness but because deep learning models like <em>DeepVariant</em> still operate within this overall framework. They replace specific components rather than rebuilding from scratch. The GATK Best Practices, first formalized around 2011 and refined continuously since, represent accumulated wisdom from a decade of methodological development <span class="citation" data-cites="depristo_framework_2011 van_der_auwera_fastq_2018">(<a href="../bib/references.html#ref-depristo_framework_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="../bib/references.html#ref-van_der_auwera_fastq_2018" role="doc-biblioref">Van der Auwera et al. 2018</a>)</span>. These pipelines encode expert intuition about which quality metrics matter, how to balance sensitivity against specificity, and when borderline evidence should be trusted. Modern deep learning approaches inherit this structure even as they replace individual components with learned alternatives.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before continuing, can you articulate the three sources of signal that manifest as mismatches between reads and reference? (Answer: sequencing errors, alignment artifacts, and genuine biological variation)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The three sources are:</p>
<ol type="1">
<li><p>Sequencing errors from instrument noise and library preparation artifacts.</p></li>
<li><p>Alignment artifacts when reads map to incorrect genomic locations.</p></li>
<li><p>Genuine biological variation including germline variants, somatic mutations, and mosaicism.</p></li>
</ol>
<p>All three produce identical-looking mismatches in the data, making it impossible to distinguish them without sophisticated probabilistic models.</p>
</div>
</div>
</div>
</div>
</div>
<section id="sec-ch01-alignment" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="sec-ch01-alignment"><span class="header-section-number">1.3.1</span> From Sequencer to Aligned Reads</h3>
<p>Errors introduced at the earliest stages of data processing propagate through every downstream analysis; a miscalled base becomes a false variant, and a misaligned read places true variants at incorrect positions. The journey from DNA sample to variant calls begins when instrument software converts fluorescent images or electrical signals to base calls and quality scores through <strong>base calling</strong>. Reads are demultiplexed by sample barcode into <code>FASTQ</code> files, each containing millions of short sequences with associated Phred-scaled quality scores. These files serve as the raw material for all subsequent analysis, encoding both the sequence content and the instrument’s confidence in each base.</p>
<p>Each read must then find its position in a reference genome. Alignment algorithms use seed-and-extend strategies to map short sequences against references such as GRCh38 (the traditional linear reference) or T2T-CHM13 (the first complete telomere-to-telomere assembly), with tools like <code>BWA-MEM</code> and <code>minimap2</code> handling the computational challenge <span class="citation" data-cites="li_aligning_2013 li_minimap2_2018">(<a href="../bib/references.html#ref-li_aligning_2013" role="doc-biblioref">Li 2013</a>, <a href="../bib/references.html#ref-li_minimap2_2018" role="doc-biblioref">2018</a>)</span>. The difficulty is substantial: algorithms must cope with mismatches arising from both true variants and sequencing errors, small indels that shift the alignment frame, and repetitive sequences where multiple genomic locations match equally well. When a read could plausibly originate from several locations, the aligner must either choose one (potentially incorrectly), report multiple candidates, or assign a mapping quality score reflecting its uncertainty about the true origin.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Quality Scores in Sequencing">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Quality Scores in Sequencing
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> Two distinct quality scores propagate through variant calling:</p>
<p><strong>Base Quality (BQ):</strong> The sequencer’s confidence in each individual base call, typically Phred-scaled. A Phred score of 30 means a 1-in-1000 probability of error (99.9% accuracy). Quality typically degrades toward read ends. Base quality affects how much each base contributes to genotype likelihood calculations.</p>
<p><strong>Mapping Quality (MAPQ):</strong> The aligner’s confidence that a read originated from its reported genomic location rather than somewhere else. MAPQ = 0 means the read maps equally well to multiple locations (completely ambiguous). MAPQ = 60 typically indicates a uniquely mapping read with high confidence.</p>
<p><strong>Why both matter:</strong> A read might have perfect base quality (the sequencer is confident about what bases it saw) but zero mapping quality (the aligner cannot determine where in the genome those bases came from). Variants called from low-MAPQ reads in repetitive regions are unreliable regardless of base quality. Conversely, high MAPQ with low base quality still produces uncertain genotype calls.</p>
<p>Deep learning variant callers like <em>DeepVariant</em> implicitly learn to weight both quality types by processing the full pileup image rather than relying on summary statistics.</p>
</div>
</div>
<div id="fig-variant-calling-pipeline" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-variant-calling-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/01-fig-variant-pipeline.svg" class="img-fluid figure-img"></p>
<figcaption>The variant calling pipeline from DNA sample to VCF</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-variant-calling-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: The variant calling pipeline transforms raw sequencing data into genotype calls through multiple processing stages. DNA samples undergo fragmentation and library preparation before sequencing on short-read (Illumina) or long-read (PacBio, ONT) platforms. Base calling produces FASTQ files containing reads and quality scores. Alignment maps reads to a reference genome (GRCh38 or T2T-CHM13), generating BAM/CRAM files. Post-alignment processing marks PCR duplicates and recalibrates base quality scores. Per-sample variant calling produces genomic VCF (gVCF) files encoding genotype likelihoods at all positions. Joint genotyping across a cohort merges samples and applies population-informed priors. Final filtering separates high-confidence variants from probable artifacts. File sizes shown are approximate for 30× whole-genome sequencing.
</figcaption>
</figure>
</div>
<p>Before variant calling can begin, systematic artifacts require correction. PCR duplicates arise when multiple reads are amplified from the same original DNA fragment during library preparation; these inflate apparent coverage and can amplify sequencing errors into false variants that appear well-supported by independent evidence. Duplicate marking identifies and flags these reads based on identical alignment coordinates. Quality scores also require adjustment: <strong>base quality score recalibration (BQSR)</strong> models systematic errors by comparing observed mismatches to databases of known variants, producing scores that better reflect true error rates in each sequence context <span class="citation" data-cites="depristo_framework_2011">(<a href="../bib/references.html#ref-depristo_framework_2011" role="doc-biblioref">DePristo et al. 2011</a>)</span>. Older pipelines also performed local realignment around indels, though modern callers have largely internalized this step.</p>
</section>
<section id="sec-ch01-persample" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="sec-ch01-persample"><span class="header-section-number">1.3.2</span> Per-Sample Variant Calling</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Common Misconception">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Common Misconception
</div>
</div>
<div class="callout-body-container callout-body">
<p>A common misconception is that sequencing directly “reads out” the genotype at each position. In reality, variant calling is statistical inference: we observe noisy evidence (reads with errors) and must estimate the most likely underlying genotype. Understanding this distinction is essential for interpreting model confidence.</p>
</div>
</div>
<p>At each position in the genome, the fundamental question is: given the reads overlapping this site, what is the most likely genotype? For diploid humans at biallelic sites, three possibilities exist: homozygous reference (<code>0/0</code>), heterozygous (<code>0/1</code>), or homozygous alternate (<code>1/1</code>). The task is to compute <strong>genotype likelihoods</strong> that quantify the probability of the observed read data under each possible genotype, then combine these likelihoods with prior expectations to estimate posterior probabilities.</p>
<p><code>GATK HaplotypeCaller</code> approaches this by first identifying regions with evidence of variation, then locally assembling candidate haplotypes from the reads spanning that region, and finally computing likelihoods for each possible diploid genotype. The core calculation uses a <strong>pair hidden Markov model (pair-HMM)</strong> to marginalize over possible alignments between each read and each candidate haplotype, incorporating base quality scores to weight the contribution of each base <span class="citation" data-cites="depristo_framework_2011 li_towards_2014">(<a href="../bib/references.html#ref-depristo_framework_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="../bib/references.html#ref-li_towards_2014" role="doc-biblioref">Li 2014</a>)</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Mathematical Detail">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Detail
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section uses Bayesian probability notation. Readers unfamiliar with this framework can focus on the intuition: we calculate how likely the observed reads would be under each possible genotype, then choose the genotype that best explains the data.</p>
</div>
</div>
<p>The mathematical framework is Bayesian. At a given site, the posterior probability of genotype <em>G</em> given read data <em>D</em> follows from Bayes’ theorem. In plain terms, we want to know: given what the reads show, which genotype is most likely? The formula below formalizes this intuition by weighing the evidence from each read against our prior expectations about genotype frequencies:</p>
<p><span class="math display">\[
P(G \mid D) \propto P(G) \prod_{r \in \text{reads}} P(r \mid G)
\]</span></p>
<p>The prior <em>P(G)</em> often assumes Hardy-Weinberg equilibrium with a specified allele frequency, while the likelihood <em>P(r | G)</em> captures the probability of observing read <em>r</em> given that the true genotype is <em>G</em>. This formulation assumes conditional independence of reads given the genotype, an assumption violated in practice by systematic sequencing errors, read pair correlations, and library-level artifacts that create dependencies among observations. Classical pipelines attempt to correct for these violations through BQSR and ad hoc filters. Deep learning-based callers can learn these dependencies implicitly by processing entire pileups simultaneously, one of their key advantages.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Worked Example: Calculating Genotype Likelihoods">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: Calculating Genotype Likelihoods
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a genomic site with 30 overlapping reads: 14 support the reference allele (A) and 16 support an alternate allele (G).</p>
<p><strong>Step 1: Define the hypothesis space</strong></p>
<p>Three possible diploid genotypes: 0/0 (AA), 0/1 (AG), 1/1 (GG)</p>
<p><strong>Step 2: Calculate expected read proportions under each genotype</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Genotype</th>
<th>Expected Ref</th>
<th>Expected Alt</th>
<th>Observed (14A, 16G)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0/0 (AA)</td>
<td>~100%</td>
<td>~0%</td>
<td>Very unlikely</td>
</tr>
<tr class="even">
<td>0/1 (AG)</td>
<td>~50%</td>
<td>~50%</td>
<td>Good match!</td>
</tr>
<tr class="odd">
<td>1/1 (GG)</td>
<td>~0%</td>
<td>~100%</td>
<td>Very unlikely</td>
</tr>
</tbody>
</table>
<p><strong>Step 3: Compute likelihoods (simplified)</strong></p>
<p>Assuming base quality of Q30 (error rate ~0.001):</p>
<ul>
<li>P(data | 0/0): Probability of 16 “errors” from a homozygous reference site ≈ <span class="math inline">\((0.001)^{16}\)</span> → essentially zero</li>
<li>P(data | 0/1): Probability of 14:16 split from a heterozygote ≈ <span class="math inline">\(\binom{30}{14}(0.5)^{30}\)</span> → high</li>
<li>P(data | 1/1): Probability of 14 “errors” from a homozygous alternate site ≈ <span class="math inline">\((0.001)^{14}\)</span> → essentially zero</li>
</ul>
<p><strong>Step 4: Apply Bayes’ theorem</strong></p>
<p>The posterior strongly favors heterozygosity (0/1) because only this genotype explains the observed ~47:53 allelic ratio without invoking implausible error rates. This is reported as the called genotype with high genotype quality (GQ).</p>
</div>
</div>
<p>The per-read likelihoods aggregate into genotype likelihoods, which combine with priors to yield posterior probabilities. These posteriors become the <strong>genotype quality (GQ)</strong> scores that downstream analyses often treat as ground truth. Per-sample results are output as <code>gVCF</code> files encoding both variant calls and “reference blocks” with estimated confidence at non-variant positions, enabling later joint analysis across samples.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Try This: Transfer Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Try This: Transfer Practice
</div>
</div>
<div class="callout-body-container callout-body">
<p>Extend the genotype likelihood calculation to a more complex scenario: You have a site with 25 reads, 10 supporting reference allele A, 8 supporting alternate allele G, and 7 supporting a second alternate allele T. How would you modify the likelihood calculation to handle this tri-allelic site? Which diploid genotypes would you need to consider?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>With three alleles (A/G/T), you must consider <strong>six</strong> diploid genotypes: AA, AG, AT, GG, GT, TT. The 1/2 (GT) genotype best explains the 8:7 split between G and T alleles, though the 10 reference-supporting reads suggest possible sequencing errors or alignment artifacts.</p>
<p><strong>Key insight:</strong> The number of possible genotypes grows combinatorially with the number of alleles: <span class="math inline">\(\binom{n+1}{2}\)</span> genotypes for <span class="math inline">\(n\)</span> alternate alleles. This makes multi-allelic sites computationally expensive and more prone to calling errors.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="The VCF Format">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The VCF Format
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>VCF</code> Format The Variant Call Format (<code>VCF</code>) is the standard file format for storing variant calls. Each variant occupies one row with mandatory columns: <code>CHROM</code> and <code>POS</code> specify genomic location; <code>REF</code> and <code>ALT</code> give the reference and alternate alleles; <code>QUAL</code> provides a Phred-scaled quality score; <code>FILTER</code> indicates whether the variant passed quality filters; and <code>INFO</code> contains semicolon-delimited annotations such as allele frequency or functional predictions. For multi-sample files, a <code>FORMAT</code> column defines per-sample fields (typically <code>GT</code> for genotype, <code>GQ</code> for genotype quality, <code>DP</code> for depth), followed by one column per sample containing those values. Genotypes are encoded as allele indices separated by / (unphased) or | (phased), where 0 represents the reference allele and 1 the first alternate. A heterozygous call appears as <code>0/1</code>; a phased heterozygote as <code>0|1</code> or <code>1|0</code> depending on which allele was inherited maternally versus paternally.</p>
</div>
</div>
</section>
<section id="sec-ch01-cohort" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="sec-ch01-cohort"><span class="header-section-number">1.3.3</span> Cohort Calling and Filtering</h3>
<p>Individual samples rarely provide sufficient information for confident rare variant calling. A variant observed in only one sample with modest supporting reads might be a true rare variant or a systematic artifact; examining a single sample cannot distinguish these possibilities. Examining the same site across thousands of samples resolves this ambiguity: true variants appear in multiple individuals following population genetic expectations, while artifacts show patterns inconsistent with inheritance and population structure.</p>
<p>Joint genotyping combines <code>gVCF</code>s across many samples to produce a multi-sample <code>VCF</code>. This process ensures that all samples are evaluated at the same candidate sites, avoiding the problem of comparing different variant lists, and pools information across carriers to improve sensitivity for rare variants. A variant with marginal evidence in three individuals gains credibility when those individuals share ancestry and the variant frequency matches population expectations from external databases.</p>
<p>Filtering strategies separate high-confidence variants from probable artifacts. Early approaches applied independent thresholds on quality metrics such as depth, mapping quality, and strand bias, but these hard filters poorly captured the complex, multivariate patterns distinguishing true variants from errors. <strong>Variant Quality Score Recalibration (VQSR)</strong> instead trains a Gaussian mixture model on known true positives from validated resources (HapMap, 1000 Genomes) and likely false positives (identified by their failure to appear in established truth sets despite meeting other quality criteria), learning a composite quality score that integrates multiple annotation dimensions <span class="citation" data-cites="depristo_framework_2011">(<a href="../bib/references.html#ref-depristo_framework_2011" role="doc-biblioref">DePristo et al. 2011</a>)</span>. This approach dominated large-scale variant calling for a decade before machine learning methods began to replace it.</p>
</section>
<section id="sec-ch01-qc" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="sec-ch01-qc"><span class="header-section-number">1.3.4</span> Sample-Level Quality Control</h3>
<p>Before any downstream analysis or model training, variant callsets must pass through sample-level quality control. Sex checks compare reported sex to X chromosome heterozygosity and Y chromosome coverage to detect sample swaps or sex chromosome aneuploidy. Contamination analysis estimates whether DNA from multiple individuals mixed during sample preparation, which would create apparent heterozygosity at sites where the individual is actually homozygous. Relatedness detection identifies unexpected relatives or duplicate sequencing of the same individual, both of which confound association analyses and inflate apparent sample sizes. <strong>Ancestry inference</strong> estimates genetic ancestry using principal component analysis or model-based clustering, which matters for controlling population stratification in downstream analyses (<a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a>).</p>
<p>These QC steps determine which samples enter training sets, how models are stratified by ancestry, and which samples must be excluded due to technical artifacts. Any callset used for model training or evaluation implicitly assumes that careful QC has already been applied.</p>
</section>
</section>
<section id="sec-ch01-phasing" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="sec-ch01-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Reflection">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reflection
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a heterozygous patient with two variants in the same gene. Why does it matter clinically whether these variants are on the same chromosome (cis) or different chromosomes (trans)?</p>
</div>
</div>
<p>The clinical stakes of phasing emerge clearly in compound heterozygosity. Consider a child who inherits two rare, potentially pathogenic variants in <em>CFTR</em>, the cystic fibrosis gene. If both variants reside on the chromosome inherited from the mother (<em>in cis</em>), the child retains one functional copy from the father and may be unaffected or merely a carrier. If the variants are on opposite chromosomes (<em>in trans</em>), no functional copy exists and the child will develop cystic fibrosis. This scenario is examined in detail in <a href="../part_7/p7-ch29-rare-disease.html#sec-ch29-compound-het" class="quarto-xref"><span>Section 29.3.2</span></a>. Graph-based approaches to phasing connect to the network methods discussed in <a href="../part_5/p5-ch22-networks.html#sec-ch22-biological-networks" class="quarto-xref"><span>Section 22.1</span></a>.</p>
<p>Standard <code>VCF</code> genotypes cannot distinguish these scenarios, encoding only that heterozygous genotypes exist at two positions without specifying which alleles travel together on the same physical chromosome. The clinical implications are entirely different, yet the data appear identical without phase information. Diploid organisms carry two copies of each autosomal chromosome, one inherited from each parent. <strong>Haplotype phasing</strong> resolves the ambiguity in unphased genotype calls by assigning each allele to a specific parental chromosome, transforming genotypes such as <code>0/1</code> into phased representations like <code>0|1</code> or <code>1|0</code> where the delimiter indicates that phase has been determined.</p>
<section id="sec-ch01-phasing-importance" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="sec-ch01-phasing-importance"><span class="header-section-number">1.4.1</span> Clinical and Analytical Importance</h3>
<p>The distinction between <em>cis</em> and <em>trans</em> configurations drives clinical decisions for recessive conditions across hundreds of disease genes, from metabolic disorders to hearing loss to retinal degeneration. Beyond compound heterozygosity, phased haplotypes enable several critical analyses. <strong>Haplotype-specific expression</strong> studies reveal allelic imbalance where one parental copy is preferentially transcribed, a phenomenon with implications for imprinting disorders and variable penetrance. Accurate modeling of <strong>linkage disequilibrium (LD)</strong> structure in population genetics depends on knowing which alleles are inherited together. Reference panels used for genotype imputation are stored as phased haplotypes; inaccurate phasing in these panels propagates errors to every study that uses them for imputation.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>How would inaccurate phasing in reference panels affect genotype imputation accuracy? Consider both common and rare variants.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Inaccurate phasing in reference panels degrades imputation through two mechanisms:</p>
<p><strong>For common variants:</strong> Phasing errors break up true haplotype blocks, creating chimeric haplotypes that don’t actually exist in the population. When the imputation algorithm tries to match a target individual’s genotypes to reference haplotypes, it may select the wrong haplotype block, leading to incorrect imputation of nearby variants. The impact is moderate because multiple reference haplotypes may carry similar common variant patterns.</p>
<p><strong>For rare variants:</strong> The impact is much more severe. Rare variants are typically carried on specific ancestral haplotypes with distinctive patterns of linked common variants. If phasing errors separate a rare variant from its characteristic haplotype background, the imputation algorithm loses the primary signal for inferring that variant’s presence. This leads to systematic underimputation of rare variants, effectively making them invisible in imputed datasets.</p>
<p><strong>Consequence for models:</strong> Since imputation quality is better for common variants, models trained on imputed data will systematically underweight rare variants compared to models trained on directly sequenced data, potentially missing important rare variant associations.</p>
</div>
</div>
</div>
</div>
</div>
<p>For deep learning applications, phasing determines whether models receive unordered genotype pairs or structured, haplotype-resolved representations. This choice affects model architecture, training procedures, and ultimately performance. A model that processes phased haplotypes can learn patterns spanning multiple variant sites that would appear as noise in unphased data.</p>
</section>
<section id="sec-ch01-phasing-methods" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="sec-ch01-phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</h3>
<p>Different data types enable different phasing strategies, each with characteristic strengths and resolution. <strong>Read-backed phasing</strong> uses sequencing reads that span multiple heterozygous sites to assign alleles to the same physical molecule. Short reads typically phase variants within tens to hundreds of base pairs, limited by fragment length. Long reads extend this range to tens of kilobases or more, providing direct physical evidence of haplotype structure.</p>
<div id="fig-phasing-compound-het" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-phasing-compound-het-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/02-A-fig-phasing-compound-het.svg" class="img-fluid figure-img"></p>
<figcaption>Two chromosomes with variant positions</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/02-B-fig-phasing-compound-het.svg" class="img-fluid figure-img"></p>
<figcaption>Cis configuration: both variants on same chromosome</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/02-C-fig-phasing-compound-het.svg" class="img-fluid figure-img"></p>
<figcaption>Trans configuration: variants on opposite chromosomes</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-phasing-compound-het-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Haplotype phase determines clinical outcome in compound heterozygosity. (A) Two chromosomes carry the <em>CFTR</em> gene, with two pathogenic variant positions indicated. Standard VCF genotypes (0/1 at each site) cannot distinguish the configurations shown in (B) and (C). (B) <em>Cis</em> configuration: both variants reside on the maternal chromosome, leaving the paternal copy functional. The child is an unaffected carrier. (C) <em>Trans</em> configuration: one variant on each parental chromosome eliminates all functional copies. The child has cystic fibrosis. Phased VCF notation (using | delimiter) encodes this distinction: 0|1, 0|1 indicates both alternate alleles on the same haplotype (cis), while 1|0, 0|1 indicates alternate alleles on opposite haplotypes (trans).
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch01-phasing-approaches" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="sec-ch01-phasing-approaches"><span class="header-section-number">1.4.3</span> Phasing Approaches</h3>
<p>When read-based phasing reaches its limits, two complementary strategies extend phase inference across longer distances. Population-based methods exploit the fact that chromosomes are inherited in long blocks that persist across generations. Tools such as <em>SHAPEIT</em>, <em>Eagle</em>, and <em>Beagle</em> compare study samples against reference panels of previously phased haplotypes, identifying shared segments that reveal which alleles travel together <span class="citation" data-cites="oconnell_general_2014 loh_reference-based_2016 browning_fast_2021">(<a href="../bib/references.html#ref-oconnell_general_2014" role="doc-biblioref">O’Connell et al. 2014</a>; <a href="../bib/references.html#ref-loh_reference-based_2016" role="doc-biblioref">Loh et al. 2016</a>; <a href="../bib/references.html#ref-browning_fast_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>. When an individual’s genotypes match a known haplotype pattern, the algorithm can confidently assign alleles to chromosomes even without direct read evidence spanning the variants. These statistical approaches work well for common variation where linkage disequilibrium provides informative context but struggle with rare variants that lack haplotype representation in reference panels.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Recall">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Recall
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about family-based phasing, can you think of how parent-offspring genotype data could be used to determine phase? Consider a child who is heterozygous (0/1) at two nearby sites, with one parent homozygous 0/0 and the other heterozygous 0/1 at both sites.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The child must have inherited the 0 allele at both sites from the homozygous parent. Therefore, at both sites, the child’s alternate (1) allele must have come from the heterozygous parent. This means both alternate alleles are on the same chromosome (inherited together), allowing us to phase the child’s genotype as 0|1, 0|1 (both alts on the same haplotype) rather than 1|0, 0|1 (alts on different haplotypes).</p>
<p>More generally, any allele present in the child but absent in one parent must have come from the other parent. By comparing genotypes across the trio, we can determine which alleles were co-inherited on the same parental chromosome without requiring reads that physically span the variants.</p>
</div>
</div>
</div>
</div>
</div>
<p>Family data, when available, resolves phase through Mendelian logic rather than statistical inference. An allele present in a child and one parent but absent in the other must have been inherited from that parent. This deterministic reasoning makes <strong>pedigree-based phasing</strong> the gold standard for accuracy, though its applicability depends on recruiting family members for sequencing. The two approaches are complementary: <strong>statistical phasing</strong> provides genome-wide coverage for any individual, while family-based phasing offers higher confidence for the specific variants segregating within a pedigree.</p>
<div id="tbl-phasing-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-phasing-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2: Comparison of phasing approaches
</figcaption>
<div aria-describedby="tbl-phasing-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 20%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Range</th>
<th>Requirements</th>
<th>Strengths</th>
<th>Limitations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Read-backed</td>
<td>bp to kb</td>
<td>Sequencing data</td>
<td>Direct physical evidence</td>
<td>Limited by read/fragment length</td>
</tr>
<tr class="even">
<td>Population-based</td>
<td>Genome-wide</td>
<td>Reference panel</td>
<td>Works for any sample</td>
<td>Poor for rare variants</td>
</tr>
<tr class="odd">
<td>Pedigree-based</td>
<td>Genome-wide</td>
<td>Family samples</td>
<td>Deterministic, highest accuracy</td>
<td>Requires family recruitment</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Modern pipelines often combine these approaches, using statistical phasing anchored by a large reference panel, augmented by read-backed evidence where available, and refined by trio data when present. The resulting phase accuracy varies by variant frequency, local recombination rate, and representation in reference panels.</p>
</section>
<section id="sec-ch01-imputation" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="sec-ch01-imputation"><span class="header-section-number">1.4.4</span> Genotype Imputation and Refinement</h3>
<p>Sequencing every individual at high coverage is expensive, but statistical inference from population structure can fill gaps at much lower cost. <strong>Genotype imputation</strong> matches a cohort with incomplete genotype data (from array genotyping or low-coverage sequencing) against a reference panel of densely phased haplotypes. Statistical models infer missing genotypes and refine uncertain calls by leveraging LD patterns and shared haplotype segments with individuals in the reference <span class="citation" data-cites="browning_fast_2021">(<a href="../bib/references.html#ref-browning_fast_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>.</p>
<p>Two related processes deserve distinction. <strong>Imputation of untyped variants</strong> infers genotypes at positions not directly observed in the study cohort but present in the reference panel, dramatically increasing variant density without additional sequencing. A genotyping array measuring 500,000 SNPs can yield tens of millions of imputed variants through comparison with panels like the Haplotype Reference Consortium. <strong>Genotype refinement</strong> improves quality at sites where genotypes were already measured but with uncertainty, particularly useful in low-coverage WGS or WES where stochastic sampling creates noisy calls. Here the same statistical machinery strengthens existing calls rather than generating new ones.</p>
<p>Low-coverage sequencing presents a distinct opportunity for imputation-based refinement. At 1x genome coverage, any individual position may have zero, one, or a handful of supporting reads, creating high uncertainty in direct genotype calls. Tools like <em>GLIMPSE</em> leverage reference panels to convert these noisy read pileups into high-confidence genotype calls, reducing false call rates by approximately 90% compared to unrefined calls from the same low-coverage data <span class="citation" data-cites="rubinacci_efficient_2021">(<a href="../bib/references.html#ref-rubinacci_efficient_2021" role="doc-biblioref">Rubinacci et al. 2021</a>)</span>. The approach works because while any single position has sparse coverage, the aggregate pattern of reads across a haplotype block provides substantial information when matched against reference haplotypes. This principle underlies the growing interest in low-pass whole genome sequencing as a cost-effective alternative to arrays for population-scale studies.</p>
<p>Intuitively, the attenuation effect occurs because imputation errors act like measurement noise: when imputed genotypes sometimes differ from true genotypes, the observed association is diluted proportionally. The squared correlation between true and imputed genotypes acts as an attenuation factor: an association with true effect size <span class="math inline">\(\beta\)</span> behaves as if the effect were approximately <span class="math inline">\(r^2 \beta\)</span> in downstream analyses using imputed dosages.</p>
</section>
<section id="sec-ch01-hybrid" class="level3" data-number="1.4.5">
<h3 data-number="1.4.5" class="anchored" data-anchor-id="sec-ch01-hybrid"><span class="header-section-number">1.4.5</span> Hybrid Sequencing and Coverage Boosting</h3>
<p>Modern clinical sequencing increasingly combines multiple data types to balance cost, coverage, and completeness. Hybrid approaches blend deep whole exome sequencing with low-pass whole genome sequencing in a single assay. The exome component (typically 80-100x coverage) provides high-confidence variant calls in coding regions, while the low-pass genome backbone (1-5x coverage) enables genome-wide imputation of common variants comparable to traditional arrays <span class="citation" data-cites="cirulli_genome-wide_2020">(<a href="../bib/references.html#ref-cirulli_genome-wide_2020" role="doc-biblioref">Cirulli et al. 2020</a>)</span>. Helix’s Exome+ assay exemplifies this design: clinical-grade exome sequencing combined with approximately 300,000 genome-wide SNPs that support imputation accuracy equivalent to 0.5x whole genome sequencing.</p>
<p>A separate concept, often also called “boosting,” refers to assay design choices that enhance sequencing depth in specific regions. <strong>Coverage boosting</strong> through customized capture probe design targets regions prone to poor coverage in standard exome sequencing, including GC-rich exons, repetitive elements, and clinically critical genes like <em>CYP2D6</em> where complete star allele calling requires comprehensive coverage. Helix’s assay achieves greater than 99.5% call rates across approximately 600 medically relevant genes by boosting capture probe density in these regions <span class="citation" data-cites="cirulli_genome-wide_2020">(<a href="../bib/references.html#ref-cirulli_genome-wide_2020" role="doc-biblioref">Cirulli et al. 2020</a>)</span>. This physical enhancement of sequencing depth differs fundamentally from statistical imputation: boosted coverage produces more supporting reads at the problematic positions, while imputation infers genotypes from population patterns without additional sequencing.</p>
<p>The distinction matters for downstream applications. Imputed genotypes carry well-calibrated uncertainty (typically reported as dosages between 0 and 2) that reflects confidence in the inference, whereas directly sequenced variants from boosted coverage regions produce conventional genotype likelihoods based on read evidence. Imputation accuracy degrades systematically for rare variants (minor allele frequency below 1%) because population reference panels provide less information about uncommon haplotypes. Coverage boosting, in contrast, performs equivalently for rare and common variants within the targeted regions since it operates on direct sequencing evidence. For clinical applications requiring rare variant detection in specific genes, boosted coverage provides more reliable results than imputation; for genome-wide association studies leveraging common variants, imputation offers greater cost efficiency.</p>
<p>For downstream deep learning, these approaches have distinct implications. Imputation dramatically increases the number of variants available as input features for genotype-based models and produces well-calibrated dosages that probabilistic models can exploit rather than forcing hard calls. Imputation ties model performance to the composition and ancestry representation of the reference panel, however: imputation errors are systematically larger when target individuals come from populations underrepresented in the panel, reinforcing themes of bias and confounding addressed in <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a>. Coverage-boosted regions provide high-quality calls independent of reference panel ancestry, but only within the targeted regions. Models consuming hybrid sequencing data must account for this heterogeneity: a variant in a boosted exonic region carries different uncertainty characteristics than an imputed intronic variant, even when both appear in the same <code>VCF</code> with comparable quality scores.</p>
</section>
</section>
<section id="sec-ch01-errors" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sec-ch01-errors"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about error sources, list at least three ways that a variant call might be wrong. What could cause a false positive (calling a variant that isn’t really there)? What could cause a false negative (missing a true variant)?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>False positives can arise from sequencing errors (particularly in homopolymers), PCR duplicates amplifying early errors, and reads misaligned to paralogous regions. False negatives occur when coverage is insufficient to detect a heterozygous allele, when variants fall in difficult-to-map repetitive regions, or when reference bias causes reads carrying alternate alleles to be discarded during alignment.</p>
</div>
</div>
</div>
</div>
</div>
<p>Even with sophisticated pipelines, variant calls remain imperfect measurements of biological reality. These errors concentrate in specific genomic contexts and variant types, creating systematic blind spots in training data that downstream models inherit without warning <span class="citation" data-cites="li_towards_2014">(<a href="../bib/references.html#ref-li_towards_2014" role="doc-biblioref">Li 2014</a>)</span>. Understanding where errors arise, and why they cluster where they do, is essential for interpreting model performance and designing robust training strategies.</p>
<div id="fig-error-sources" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-error-sources-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/03-fig-error-sources.svg" class="img-fluid figure-img"></p>
<figcaption>Taxonomy of variant calling error sources</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-error-sources-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Variant calling errors arise from three distinct sources with different consequences. Sequencing artifacts from instrument noise and library preparation create false positive (FP) variant calls. Alignment artifacts from ambiguous mapping in repetitive regions cause both false positives (variants called at wrong locations) and false negatives (FN, true variants missed due to mapping uncertainty). Biological complexity including mosaicism and low allele fractions primarily causes false negatives, as genuine variants fail to meet detection thresholds. Understanding error sources is essential for interpreting callset limitations and designing robust training strategies for downstream models.
</figcaption>
</figure>
</div>
<section id="sec-ch01-mapping-bias" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="sec-ch01-mapping-bias"><span class="header-section-number">1.5.1</span> Mapping Ambiguity and Reference Bias</h3>
<p>When reads align almost equally well to multiple genomic locations, no algorithm can confidently determine their true origin. Segmental duplications, paralogous gene families, and repetitive elements create these ambiguous contexts throughout the genome. The consequences flow in both directions: misassigned reads create false positive variants at incorrect locations, while correctly placed reads may be discarded or down-weighted due to mapping uncertainty, creating false negatives.</p>
<p><strong>Reference bias</strong> compounds these problems by systematically favoring detection of reference alleles over alternate alleles. A read carrying a non-reference variant may align slightly worse than an identical read matching the reference due to the mismatch penalty, leading to preferential retention of reference-supporting evidence. This bias causes systematic undercalling of alternate alleles, particularly in highly polymorphic regions or for variants that substantially alter local sequence context. Populations divergent from the reference genome experience more severe reference bias, creating ancestry-correlated error patterns.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Reference bias systematically favors detection of reference alleles, and this bias is worse for populations divergent from the reference genome.</p>
</div>
</div>
</section>
<section id="sec-ch01-artifacts" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="sec-ch01-artifacts"><span class="header-section-number">1.5.2</span> Systematic Sequencing Artifacts</h3>
<p>Sequencing chemistry introduces predictable error patterns that differ qualitatively from random noise. Homopolymer runs (stretches of identical nucleotides such as AAAAAAA or GGGGGG) cause polymerase slippage during synthesis, generating false indels at rates far exceeding substitution errors. Why does slippage occur specifically at homopolymers? During DNA synthesis, the template and nascent strands can transiently dissociate and re-anneal. In non-repetitive sequence, there is only one correct re-annealing position. But in a homopolymer, multiple positions are sequence-identical, allowing the nascent strand to slip forward or backward and re-anneal at an offset position—adding or deleting nucleotides without creating a mismatch that would trigger correction. Certain sequence motifs, particularly those with extreme GC content, exhibit systematically elevated error rates that persist even at high coverage. PCR amplification during library preparation can introduce errors early in the process; these errors then propagate into multiple reads, creating correlated false positives that appear well-supported by independent evidence.</p>
<p>Index hopping occurs when sample barcodes are misassigned during multiplexed sequencing, causing variants from one sample to appear spuriously in others sharing the same flow cell. Strand bias, where variant-supporting reads cluster on one strand orientation, often indicates systematic artifact rather than true variation. These patterns create correlated errors that cluster by batch, lane, or library preparation method, and they are difficult to distinguish from rare true variants precisely because they can appear in multiple reads with reasonable quality scores.</p>
</section>
<section id="sec-ch01-coverage" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="sec-ch01-coverage"><span class="header-section-number">1.5.3</span> Coverage Gaps and Allelic Imbalance</h3>
<p>Stochastic sampling means some genomic regions receive fewer reads than average purely by chance, even when capture or sequencing is nominally uniform. In these low-coverage regions, one or both alleles may be missed entirely, and allelic balance can deviate substantially from the expected 50:50 ratio in heterozygotes. A heterozygous site with 20× coverage and 10 reads supporting each allele is confidently called; the same site with 4× coverage might show 4 reference reads and 0 alternate reads by chance alone, leading to a false homozygous reference call with no indication that an allele was missed.</p>
<p>Allelic imbalance extends beyond random sampling to encompass systematic biases introduced throughout the sequencing workflow. PCR amplification during library preparation preferentially amplifies certain alleles over others, particularly where one allele creates more stable secondary structure or where GC content differs between alleles. Capture-based enrichment exhibits similar biases: hybridization probes designed against the reference sequence bind reference alleles more efficiently than alternate alleles. These technical biases compound across steps, so a heterozygous variant might consistently show 60:40 or even 70:30 allelic ratios across independent samples processed through the same pipeline.</p>
<p>The clinical consequences become acute in contexts where allele fractions carry diagnostic meaning. Loss of heterozygosity in tumor samples, where one allele is deleted or silenced, produces genuine biological imbalance that must be distinguished from technical artifacts. A tumor suppressor gene showing 80:20 allelic ratio could indicate LOH with implications for prognosis and therapy, or could reflect nothing more than capture bias at a technically difficult locus. Without matched normal tissue or population-level calibration of expected allelic ratios, these scenarios remain ambiguous.</p>
<p>Somatic mosaic variants present at low allele fractions face similar detection challenges. A variant present in 10% of cells produces reads indistinguishable in individual quality from sequencing errors at typical coverage depths. The expected number of alternate reads follows a binomial distribution: at 30× coverage with 10% allele fraction, one expects only 3 alternate reads on average, with substantial probability of observing 0, 1, or 2 reads by chance. Distinguishing this signal from a sequencing error rate of 0.1% to 1% per base requires either much deeper sequencing or molecular techniques like unique molecular identifiers that distinguish true low-frequency variants from PCR duplicates carrying the same error.</p>
<p>Modern variant callers address these challenges by estimating site-specific or sample-specific bias parameters from the data itself, learning from known heterozygous sites throughout the genome rather than assuming uniform 50:50 ratios. These statistical innovations improve sensitivity for mosaic and somatic variant detection but require careful calibration to avoid introducing new sources of systematic error.</p>
</section>
<section id="sec-ch01-complex" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="sec-ch01-complex"><span class="header-section-number">1.5.4</span> Complex Variants and Representation</h3>
<p>Small indels near homopolymers, multi-nucleotide variants (MNVs), and overlapping indels present representation challenges beyond simple detection. The same biological event can often be encoded in multiple equivalent ways depending on alignment and normalization conventions. The variant <code>chr1:100 AT&gt;A</code> might alternatively appear as <code>chr1:101 T&gt;-</code>, with different callers and normalization tools potentially choosing different representations for the identical underlying mutation. These equivalent representations complicate comparisons across pipelines and benchmarks; two callsets may disagree on representation while agreeing on biology, or may appear to agree while representing different events.</p>
<p>Deep learning models inherit all these errors and uncertainties as their input. If a variant never enters the <code>VCF</code>, no model trained on <code>VCF</code>s can learn its effect. If genotype qualities are miscalibrated, models trained on hard calls may be systematically overconfident in regions where input data are fundamentally noisy. These inherited limitations propagate silently through the analysis chain.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="When to Worry">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When to Worry
</div>
</div>
<div class="callout-body-container callout-body">
<p>When should analysts be most skeptical of variant calls? Four scenarios warrant extra scrutiny:</p>
<ol type="1">
<li>Variants in segmental duplications or near paralogous genes</li>
<li>Indels in homopolymer or tandem repeat regions</li>
<li>Rare variants in underrepresented ancestries</li>
<li>Any variant in the HLA region from short-read data</li>
</ol>
</div>
</div>
</section>
</section>
<section id="sec-ch01-difficult" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="sec-ch01-difficult"><span class="header-section-number">1.6</span> Difficult Regions: The Limits of Short-Read Calling</h2>
<p>Certain genomic regions resist accurate variant calling regardless of algorithmic sophistication, with their difficulty stemming from fundamental properties of sequence structure that challenge alignment and assembly. These regions are disproportionately responsible for discordant calls between pipelines and technologies <span class="citation" data-cites="li_towards_2014">(<a href="../bib/references.html#ref-li_towards_2014" role="doc-biblioref">Li 2014</a>)</span>. Their clinical importance often exceeds their representation in training data.</p>
<div id="fig-difficult-regions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-difficult-regions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/04-fig-difficult-regions.svg" class="img-fluid figure-img"></p>
<figcaption>Difficult genomic regions for variant calling</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difficult-regions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Genomic regions where short-read variant calling systematically fails. Ideogram showing the human genome with difficult regions highlighted. Segmental duplications (yellow) including the <em>CYP2D6</em> pharmacogene region on chromosome 22q11 create mapping ambiguity. The HLA complex (orange) on chromosome 6p21 contains extreme polymorphism that confounds reference-based alignment. Centromeric and pericentromeric regions (gray) lack unique sequence. Tandem repeat disorder loci including <em>HTT</em> (Huntington disease, 4p16) and <em>FMR1</em> (fragile X, Xq27) resist accurate short-read genotyping. Inset (lower right) shows approximate genome fraction in each difficulty class. Inset (lower left) illustrates how long reads spanning entire difficult regions resolve ambiguities invisible to short reads.
</figcaption>
</figure>
</div>
<section id="sec-ch01-segdup" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="sec-ch01-segdup"><span class="header-section-number">1.6.1</span> Segmental Duplications and Gene Families</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the <em>CYP2D6</em> gene region, which contains the functional gene plus two pseudogenes (<em>CYP2D7</em>, <em>CYP2D8</em>) sharing over 90% sequence identity. What problems would you predict for short-read variant calling in this region?</p>
</div>
</div>
<p>The <em>CYP2D6</em> gene illustrates how sequence complexity creates clinical blind spots. This gene encodes a cytochrome P450 enzyme responsible for metabolizing approximately 25% of clinically used drugs, including codeine, tamoxifen, and many antidepressants <span class="citation" data-cites="zanger_cytochrome_2013 ingelman-sundberg_genetic_2004">(<a href="../bib/references.html#ref-zanger_cytochrome_2013" role="doc-biblioref">Zanger and Schwab 2013</a>; <a href="../bib/references.html#ref-ingelman-sundberg_genetic_2004" role="doc-biblioref">Ingelman-Sundberg 2004</a>)</span>. It resides in a complex genomic region alongside two pseudogenes (<em>CYP2D7</em> and <em>CYP2D8</em>) sharing over 90% sequence identity. Short reads from one copy map almost equally well to another, producing ambiguous alignments that either receive arbitrarily assigned positions or inflated mapping quality scores that mask the underlying uncertainty.</p>
<p>Variant callers operating in this region face an impossible choice between sensitivity and specificity. Conservative approaches undercall true variation to avoid false positives; aggressive approaches call spurious variants in the wrong paralog. A patient’s <em>CYP2D6</em> metabolizer status, critical for drug dosing decisions that can mean the difference between therapeutic efficacy and serious adverse events, may be incorrectly inferred from short-read data alone.</p>
</section>
<section id="sec-ch01-repeats" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="sec-ch01-repeats"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</h3>
<p>Homopolymers, short tandem repeats (STRs), and other low-complexity regions challenge both sequencing chemistry and alignment algorithms. Indel error rates are especially elevated in these contexts, and many pipelines mask or flag these regions as low confidence. Yet variation in repeats can be biologically critical. Triplet repeat expansion disorders including Huntington disease, fragile X syndrome, and myotonic dystrophy arise from unstable repeat sequences that standard short-read pipelines handle poorly. Models trained on callsets that exclude these regions inherit blind spots at clinically important loci.</p>
</section>
<section id="sec-ch01-hla" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="sec-ch01-hla"><span class="header-section-number">1.6.3</span> HLA Region Complexity</h3>
<p>The <strong>human leukocyte antigen (HLA)</strong> locus on chromosome 6p21 exemplifies both the biological importance and technical difficulty of complex genomic regions. HLA genes including <em>HLA-A</em>, <em>HLA-B</em>, <em>HLA-C</em>, and <em>HLA-DRB1</em> encode proteins central to immune recognition and represent some of the most polymorphic sequences in the human genome. The region spans several megabases of near-identical sequences interspersed with gene conversions, copy number variation, and pseudogenes.</p>
<p>Standard reference-based alignment fails in HLA because the extreme polymorphism means reads carrying common, well-characterized alleles may match the linear reference genome poorly. A read from the <em>HLA-B*57:01</em> allele (clinically important for predicting abacavir hypersensitivity in HIV treatment) may fail to align or align with low mapping quality, causing systematic undercalling of this medically actionable variant <span class="citation" data-cites="mallal_hla-b5701_2008">(<a href="../bib/references.html#ref-mallal_hla-b5701_2008" role="doc-biblioref">Mallal et al. 2008</a>)</span>. The same problems affect HLA typing for transplant matching, autoimmune disease association studies, and pharmacogenomic testing across diverse therapeutic areas <span class="citation" data-cites="robinson_ipd-imgthla_2020 sakaue_tutorial_2023">(<a href="../bib/references.html#ref-robinson_ipd-imgthla_2020" role="doc-biblioref">Robinson et al. 2020</a>; <a href="../bib/references.html#ref-sakaue_tutorial_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>.</p>
<p>Specialized tools address these challenges through alternative strategies. HLA imputation methods use dense reference panels to infer HLA alleles from array genotypes, enabling large-scale association studies that would otherwise require expensive targeted sequencing <span class="citation" data-cites="sakaue_tutorial_2023">(<a href="../bib/references.html#ref-sakaue_tutorial_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>. Sequence-based typing tools such as <em>T1K</em> perform HLA and <strong>KIR (killer immunoglobulin-like receptor)</strong> genotyping directly from WES, WGS, or RNA-seq data by aligning reads against allele databases rather than the linear reference <span class="citation" data-cites="song_t1k_2022">(<a href="../bib/references.html#ref-song_t1k_2022" role="doc-biblioref">Song et al. 2022</a>)</span>. Graph-based approaches incorporate known HLA alleles as alternate paths through the region, improving both alignment and variant calling <span class="citation" data-cites="garrison_variation_2018 liao_draft_2023">(<a href="../bib/references.html#ref-garrison_variation_2018" role="doc-biblioref">Garrison et al. 2018</a>; <a href="../bib/references.html#ref-liao_draft_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>HLA exemplifies a broader principle: regions that are biologically rich and clinically actionable are often technically difficult. Deep models trained on callsets that downweight or exclude these regions inherit their absence, creating blind spots precisely where accurate genotyping matters most.</p>
<p>These challenging regions create systematic evaluation problems for foundation models. The homology-aware data splitting strategies required to avoid leakage in these regions are detailed in <a href="../part_3/p3-ch12-evaluation.html#sec-ch12-homology-aware-splitting" class="quarto-xref"><span>Section 12.2</span></a>. HLA complexity motivates specialized network-based approaches discussed in <a href="../part_5/p5-ch22-networks.html#sec-ch22-biological-networks" class="quarto-xref"><span>Section 22.1</span></a>.</p>
</section>
</section>
<section id="sec-ch01-benchmarks" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="sec-ch01-benchmarks"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</h2>
<p>Evaluating variant callers requires high-confidence truth sets and standardized comparison tools. The challenge is that “ground truth” for variant calling is not actually true in any absolute sense; it represents consensus derived from multiple imperfect observations using different technologies and algorithms. Without careful benchmarking design, it is easy to overfit to specific datasets, underestimate errors in difficult regions, or misinterpret the practical significance of small metric improvements. Benchmark construction principles and their limitations for foundation model evaluation are examined comprehensively in <a href="../part_3/p3-ch11-benchmarks.html" class="quarto-xref"><span>Chapter 11</span></a> and <a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a>.</p>
<section id="sec-ch01-giab" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="sec-ch01-giab"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</h3>
<p>The <strong>Genome in a Bottle (GIAB)</strong> Consortium, coordinated by NIST, provides extensively characterized reference samples with validated variant calls across most of the genome <span class="citation" data-cites="zook_open_2019">(<a href="../bib/references.html#ref-zook_open_2019" role="doc-biblioref">Zook et al. 2019</a>)</span>. The primary sample is NA12878 (also known as HG001), a female of European ancestry from the CEPH/Utah pedigree with the longest history of multi-platform characterization. Additional samples span ancestral diversity and family structures: HG002 through HG004 comprise an Ashkenazi Jewish trio enabling trio-based validation, while HG005 through HG007 provide a Han Chinese trio.</p>
<p>For each sample, GIAB provides <strong>high-confidence variant calls</strong> representing consensus from multiple sequencing technologies and variant callers that constitute the best current estimate of true genotypes. Equally important are the <strong>high-confidence regions</strong>, genomic intervals where the truth set is believed to be reliable. Performance outside these regions remains formally unmeasured. Benchmarking tools such as <code>hap.py</code> and RTG Tools enable standardized comparison of test callsets against truth, implementing reproducible calculation of precision, recall, and F1 metrics by variant type <span class="citation" data-cites="krusche_best_2019 noauthor_realtimegenomicsrtg-core_2025">(<a href="../bib/references.html#ref-krusche_best_2019" role="doc-biblioref">Krusche et al. 2019</a>; <a href="../bib/references.html#ref-noauthor_realtimegenomicsrtg-core_2025" role="doc-biblioref"><span>“<span>RealTimeGenomics</span>/Rtg-Core”</span> 2025</a>)</span>.</p>
</section>
<section id="sec-ch01-metrics" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="sec-ch01-metrics"><span class="header-section-number">1.7.2</span> Metrics and Their Meaning</h3>
<p>Small differences in benchmark metrics can obscure large differences in clinical utility, while large headline improvements may concentrate in regions with little practical importance. Standard metrics for variant calling include <strong>recall (sensitivity)</strong>, the fraction of true variants in the benchmark successfully identified by the caller; <strong>precision (positive predictive value)</strong>, the fraction of called variants that are present in the benchmark truth set; and <strong>F1 score</strong>, the harmonic mean of precision and recall providing a single summary when both matter equally. These metrics are typically reported separately for SNVs and indels and may be stratified by genomic context to reveal where performance degrades.</p>
<p>Metrics can be defined at different levels: per-variant (did we identify the correct alternate allele?), per-genotype (did we correctly determine zygosity?), or per-site (did we recognize variation at this position regardless of allele?). For downstream models, genotype-level accuracy and sample-level completeness often matter more than simply counting variant matches. A model that receives incorrect genotypes at common regulatory variants will learn corrupted associations even if overall variant-level metrics appear strong.</p>
</section>
<section id="sec-ch01-benchmark-limits" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="sec-ch01-benchmark-limits"><span class="header-section-number">1.7.3</span> Limitations of Benchmarks</h3>
<p>GIAB truth sets derive primarily from a small number of deeply sequenced samples, predominantly of European ancestry in early releases, and initially focused on genomic regions where high confidence was achievable. High-confidence regions cover approximately 85 to 90 percent of the genome, leaving performance in excluded regions formally unknown. Performance in underrepresented ancestries, in complex structural variant regions, and for novel variant classes may differ substantially from headline GIAB metrics <span class="citation" data-cites="zook_open_2019 liao_draft_2023">(<a href="../bib/references.html#ref-zook_open_2019" role="doc-biblioref">Zook et al. 2019</a>; <a href="../bib/references.html#ref-liao_draft_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>When benchmarks are reused extensively for method development, the risk of overfitting to benchmark-specific patterns becomes substantial. Pipelines may be tuned to maximize F1 on GIAB-like samples without improving performance on real-world cohorts with different ancestry composition, sequencing protocols, or variant spectra. For deep learning-based callers with large capacity to absorb quirks in training data, this risk is especially acute. Similar concerns apply to benchmarking and evaluation of deep models more broadly (<a href="../part_3/p3-ch11-benchmarks.html" class="quarto-xref"><span>Chapter 11</span></a>).</p>
<p>Ongoing efforts from the T2T Consortium and the Human Pangenome Reference Consortium are expanding benchmark scope to include complete genome assemblies and diverse haplotype collections that better represent human genetic diversity <span class="citation" data-cites="nurk_complete_2022 liao_draft_2023">(<a href="../bib/references.html#ref-nurk_complete_2022" role="doc-biblioref">Nurk et al. 2022</a>; <a href="../bib/references.html#ref-liao_draft_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
</section>
</section>
<section id="sec-ch01-deepvariant" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="sec-ch01-deepvariant"><span class="header-section-number">1.8</span> DeepVariant: Variant Calling as Image Classification</h2>
<p>Classical variant calling pipelines encode accumulated expert intuition through hand-crafted features and carefully tuned heuristics developed over years of experience with sequencing data. <em>DeepVariant</em>, introduced by Google in 2018, posed a different question: what if we let the model learn these patterns directly from data?</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Classical variant callers use hand-crafted features like depth, strand bias, and mapping quality. If you were to reformulate variant calling for a neural network, how might you represent the raw read evidence? What representation would preserve maximum information?</p>
</div>
</div>
<p>The key insight was not better probabilistic modeling of sequencing errors but rather a reformulation of the problem itself. Variant calling becomes image classification, and convolutional neural networks learn to distinguish true variants from artifacts through the same pattern recognition that enables them to classify natural images <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="../bib/references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>DeepVariant’s innovation is representational: by encoding pileups as images, variant calling becomes pattern recognition, allowing the model to learn artifact signatures that human experts never explicitly defined.</p>
</div>
</div>
<section id="sec-ch01-pileup" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="sec-ch01-pileup"><span class="header-section-number">1.8.1</span> Pileup Images as Input</h3>
<p>Representing reads as image-like tensors allows the model to learn from raw evidence rather than predefined summary statistics. Patterns invisible to hand-crafted heuristics (strand-biased support clustered at read ends, quality degradation in specific contexts) become learnable. Around each candidate variant site, <em>DeepVariant</em> constructs a multi-channel tensor resembling an image. Each row corresponds to a read overlapping the site, with columns indexing positions relative to the candidate variant. Channels encode multiple features: match or mismatch with the reference, Phred-scaled base quality, mapping quality, strand orientation, support for different alleles, and additional alignment characteristics. The reference sequence and candidate alleles are overlaid as additional channels providing context.</p>
<p>This representation transforms the variant calling problem fundamentally. Rather than computing summary statistics (depth, allelic balance, strand bias) and feeding them to a classifier with predefined decision rules, <em>DeepVariant</em> presents the raw evidence to a neural network. The model learns that strand-biased support clustered at read ends looks different from balanced support distributed across read positions without anyone explicitly defining these features or their relative importance. Patterns invisible to hand-crafted heuristics become learnable.</p>
<div id="fig-deepvariant-pileup" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-deepvariant-pileup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch01/05-fig-deepvariant-pileup.svg" class="img-fluid figure-img"></p>
<figcaption>DeepVariant pileup tensor representation</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-deepvariant-pileup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: DeepVariant encodes read evidence as a multi-channel pileup tensor for CNN-based genotype classification. Each row represents a sequencing read overlapping the candidate variant position (center column). Multiple channels encode: base identity (matches in gray, mismatches color-coded by nucleotide), base quality (intensity gradient), mapping quality, strand orientation, and allele support. The reference sequence appears at top. This example shows a heterozygous SNV with approximately half of reads supporting each allele. The CNN processes this tensor representation and outputs posterior probabilities over three genotype classes. The called genotype (0/1) corresponds to the highest posterior probability (0.96).
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch01-deepvariant-arch" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="sec-ch01-deepvariant-arch"><span class="header-section-number">1.8.2</span> Architecture and Training</h3>
<p>The reformulation of variant calling as image classification enables borrowing architectures proven effective for natural images. <em>DeepVariant</em> uses an Inception-style CNN architecture originally developed for natural image classification. The convolutional architecture that makes this possible is examined in detail in <a href="../part_2/p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>. The network processes the pileup tensor through multiple convolutional layers, pooling operations, and nonlinearities, outputting posterior probabilities over three genotype classes (homozygous reference, heterozygous, homozygous alternate) for each candidate site <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="../bib/references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>.</p>
<p>Training uses high-confidence truth sets such as GIAB genomes. The model observes many examples of true variants and non-variants along with their associated pileup images, learning complex decision boundaries that integrate base quality, mapping quality, local sequence context, and read-level patterns. Where VQSR fits a separate model on hand-selected annotations after initial calling, <em>DeepVariant</em> processes raw evidence directly during the primary classification step.</p>
<p>The end-to-end training produces well-calibrated genotype likelihoods across a range of sequencing chemistries, instruments, and read lengths, particularly when fine-tuned for specific experimental contexts <span class="citation" data-cites="yun_accurate_2021">(<a href="../bib/references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. Once trained, the same architecture generalizes across whole-genome versus whole-exome data, PCR-free versus PCR-amplified libraries, and different sequencing instruments. This adaptability contrasts with classical pipelines where calibration is often a separate, <em>post hoc</em> step requiring platform-specific tuning by experts.</p>
<p>On GIAB benchmark HG002, DeepVariant achieved F1 of 99.7% for SNVs compared to 99.5% for GATK HaplotypeCaller, with larger gains for indels (99.4% vs 98.9%).</p>
</section>
<section id="sec-ch01-glnexus" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="sec-ch01-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with GLnexus</h3>
<p><em>DeepVariant</em> operates primarily at the per-sample level, producing a <code>gVCF</code> of genotype likelihoods for each individual sample. To generate a multi-sample <code>VCF</code> suitable for population-scale analysis, these per-sample results must be combined through joint genotyping.</p>
<p><em>GLnexus</em> provides cohort-level integration by combining the per-sample <code>gVCF</code> files introduced in <a href="#sec-ch01-persample" class="quarto-xref"><span>Section 1.3.2</span></a>, pooling the genotype likelihoods across samples <span class="citation" data-cites="yun_accurate_2021">(<a href="../bib/references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. The system merges per-sample likelihoods, applies cohort-level priors informed by observed allele frequencies, and performs multi-sample genotype refinement and filtering. Together, <em>DeepVariant</em> and <em>GLnexus</em> form a modular pipeline where deep learning replaces the per-sample likelihood engine while the overall architecture (per-sample calls, joint genotyping, cohort filtering) remains structurally similar to classical approaches.</p>
<p>Joint calling improves sensitivity for rare variants by pooling evidence across carriers, ensures consistent variant representation across all samples in a cohort, and enables cohort-level quality filters that identify systematic artifacts visible only across many samples. This combination has become a <em>de facto</em> standard for large WES and WGS projects, including recent releases from gnomAD and the UK Biobank <span class="citation" data-cites="karczewski_mutational_2020 bycroft_uk_2018">(<a href="../bib/references.html#ref-karczewski_mutational_2020" role="doc-biblioref">Karczewski et al. 2020</a>; <a href="../bib/references.html#ref-bycroft_uk_2018" role="doc-biblioref">Bycroft et al. 2018</a>)</span>.</p>
</section>
<section id="sec-ch01-deepvariant-comparison" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="sec-ch01-deepvariant-comparison"><span class="header-section-number">1.8.4</span> Comparison with Classical Approaches</h3>
<p>The fundamental difference between <em>DeepVariant</em> and classical pipelines lies in how evidence is combined. Recall that <code>HaplotypeCaller</code> uses pair-HMM models (see <a href="#sec-ch01-persample" class="quarto-xref"><span>Section 1.3.2</span></a>) that explicitly assume read independence–an assumption that DeepVariant’s CNN architecture circumvents by processing the entire pileup as a single input. <code>HaplotypeCaller</code> uses pair-HMM models with explicit assumptions about read independence and then applies VQSR to recalibrate quality scores using hand-selected annotation features. <em>DeepVariant</em> processes entire pileups simultaneously, implicitly learning correlations among reads that violate the independence assumptions built into classical probabilistic models.</p>
<div id="tbl-classical-vs-dl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-classical-vs-dl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.3: Comparison of classical and deep learning variant calling
</figcaption>
<div aria-describedby="tbl-classical-vs-dl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 42%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>HaplotypeCaller (Classical)</th>
<th>DeepVariant (Deep Learning)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Evidence combination</td>
<td>Pair-HMM with explicit independence assumption</td>
<td>CNN processes full pileup simultaneously</td>
</tr>
<tr class="even">
<td>Calibration</td>
<td>Separate VQSR step with hand-selected features</td>
<td>Emerges from end-to-end training</td>
</tr>
<tr class="odd">
<td>Artifact detection</td>
<td>Hand-crafted filters</td>
<td>Learned representations</td>
</tr>
<tr class="even">
<td>Transfer</td>
<td>Requires platform-specific tuning</td>
<td>Fine-tuning often sufficient</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>This end-to-end approach offers several practical advantages. Calibration emerges from training rather than requiring separate recalibration steps with their own parameter tuning. Transfer across platforms and even species often succeeds with modest fine-tuning rather than complete redevelopment. The model can detect subtle artifact patterns that escape hand-crafted filters, learning representations of error modes that human experts never explicitly described.</p>
<p>Both approaches share important limitations. Neither handles structural variants well; both focus primarily on SNVs and small indels. Both operate within the same overall pipeline framework: alignment, duplicate marking, and joint genotyping remain largely unchanged regardless of the per-sample caller used. <em>DeepVariant</em> is best understood as a drop-in replacement for the per-sample calling step, not a complete reimagining of variant discovery from raw data.</p>
</section>
</section>
<section id="sec-ch01-implications" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="sec-ch01-implications"><span class="header-section-number">1.9</span> Implications for Genomic Deep Learning</h2>
<p>NGS and variant calling establish the foundation for genomic deep learning. They determine what data downstream models receive, where coverage exists, and where systematic blind spots remain hidden. Understanding how variants are called, and where that process fails, is essential for interpreting the performance and limitations of every model built on this foundation.</p>
<section id="sec-ch01-atomic" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="sec-ch01-atomic"><span class="header-section-number">1.9.1</span> Variants as Atomic Units</h3>
<p>The output of WES and WGS pipelines (a <code>VCF</code> of SNVs, indels, and inferred genotypes) defines the atomic units that many downstream models operate on. Polygenic risk scores treat variants as weighted features summed across the genome (<a href="p1-ch03-gwas.html#sec-ch03-pgs-construction" class="quarto-xref"><span>Section 3.5</span></a>). GWAS summary statistics quantify associations at individual variant positions. Variant annotation tools classify each site by predicted functional consequence. Foundation models that operate on genotypes rather than raw sequence inherit the variant catalog as their effective vocabulary.</p>
<p>If a variant is never called, it cannot appear in training data, and no model can learn its effect. False positives introduce noise into labels and features, teaching models to associate spurious variants with phenotypes. False negatives create blind spots where models must extrapolate from incomplete information, often without any indication that data are missing. Choices about phasing, imputation, and variant representation determine whether models see haplotype-structured inputs, unordered genotypes, or scalar dosage summaries. The quality of variant calls directly limits the quality of everything built upon them.</p>
</section>
<section id="sec-ch01-inherited" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="sec-ch01-inherited"><span class="header-section-number">1.9.2</span> Inherited Biases and Blind Spots</h3>
<p>Upstream decisions constrain what downstream models can learn. If an assay rarely observes indels in certain repeat classes, models trained on those callsets effectively learn a world where such variants do not exist. If certain ancestries are underrepresented in reference panels or truth sets, models may perform poorly for those populations while appearing well-calibrated in benchmarks dominated by European samples. High-confidence region definitions determine which variants enter training sets; variants in excluded regions are invisible to models regardless of their biological importance.</p>
<p>For regulatory sequence models and variant effect predictors (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a> for DNA language models, <a href="../part_4/p4-ch17-regulatory.html#sec-ch17-enformer" class="quarto-xref"><span>Section 17.2</span></a> for regulatory models, <a href="../part_2/p2-ch06-cnn.html#sec-ch06-deepsea" class="quarto-xref"><span>Section 6.2</span></a> for CNNs, <a href="p1-ch04-vep-classical.html#sec-ch04-cadd" class="quarto-xref"><span>Section 4.3</span></a> for classical approaches), upstream variant calling determines which sites appear as candidates and how often certain sequence patterns are observed in association with functional outcomes. The HLA blind spot in short-read calling means that models trained primarily on short-read callsets will systematically underperform for immune-related variants despite their substantial clinical importance for autoimmune disease, transplant rejection, and drug hypersensitivity. The accuracy ceiling imposed by variant calling quality on downstream variant effect prediction is quantified in <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-combining-evidence" class="quarto-xref"><span>Section 18.4</span></a>, where multiple lines of evidence must be integrated despite systematic gaps in each.</p>
</section>
<section id="sec-ch01-effect-sizes" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="sec-ch01-effect-sizes"><span class="header-section-number">1.9.3</span> Effect Sizes Across the Frequency Spectrum</h3>
<p>Variant calling quality modulates the effective effect sizes that downstream models can detect, with different dynamics for common and rare variation. For common variants contributing to highly polygenic traits, modest genotype error acts as additional measurement noise that attenuates effect size estimates without creating spurious large effects. Improving variant calling in already “easy” genomic regions yields diminishing returns compared to simply increasing sample size.</p>
<p>For rare variants with large individual effects, the dynamics change substantially. Loss-of-function variants, damaging missense mutations, and splice-altering changes can have substantial effects on disease risk. Here, false negatives dominate the problem: if the variant is never called, its effect is invisible to association tests and to models trained on called genotypes. Small improvements in recall for clinically important rare variants can have outsized impact on gene discovery and interpretation.</p>
<p>Imputed variants introduce their own effect size modulation. The squared correlation between true and imputed genotypes acts as an attenuation factor: an association with true effect size <span class="math inline">\(\beta\)</span> behaves as if the effect were approximately <span class="math inline">\(r^2 \beta\)</span> in downstream analyses using imputed dosages. Improvements in imputation quality, particularly for underrepresented ancestries where current panels perform poorly, directly scale the effective signals that models can learn.</p>
<p>Clinically critical loci often present the most challenging technical contexts, creating a systematic mismatch between importance and data quality. Pharmacogenomic variants in CYP gene families, immune-related variants in HLA, and many other medically actionable sites reside in regions where standard pipelines perform poorly. Global accuracy metrics may change only slightly when these regions improve, but the clinical impact can be substantial.</p>
</section>
</section>
<section id="sec-ch01-reliability" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="sec-ch01-reliability"><span class="header-section-number">1.10</span> Reliability Landscape</h2>
<p>Variant calling produces the substrate on which every subsequent model operates. The quality of that substrate varies systematically: high-confidence calls in unique sequence with adequate coverage, uncertain calls in repetitive regions and structural variant breakpoints, systematic gaps where short reads cannot reach. These patterns are not random. They concentrate in genomic regions of particular biological importance: segmental duplications that drive gene family evolution, tandem repeats that modulate gene expression, HLA haplotypes that determine immune response.</p>
<p><em>DeepVariant</em> and related approaches demonstrate that learned representations can outperform hand-crafted heuristics, at least on established benchmarks. This paradigm recurs across genomic deep learning: sequence-to-function models that learn regulatory grammar directly from data (<a href="../part_4/p4-ch17-regulatory.html" class="quarto-xref"><span>Chapter 17</span></a>), splice predictors that discover motifs without explicit encoding (<a href="../part_2/p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>), language models that learn evolutionary constraint from sequence alone (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>). In each case, the central question is whether the additional model capacity captures genuine biological signal or overfits to artifacts in training data. The distinction between capturing biological signal versus overfitting to training artifacts is examined systematically in <a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a> for interpretability analysis and <a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a> for evaluation methodology.</p>
<p>The models that follow inherit whatever systematic biases exist in variant calls. A pathogenicity predictor trained on ClinVar labels inherits the sequencing technologies and population composition that generated those labels. A fine-mapping method that trusts variant calls uniformly will miscalibrate its posterior probabilities in difficult regions. Understanding where variant calling succeeds and fails is prerequisite to understanding where downstream models can be trusted.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>What are the three fundamentally different sources of signal that manifest as mismatches between reads and reference sequence?</li>
<li>Why is haplotype phasing clinically important, particularly for compound heterozygosity in recessive disorders?</li>
<li>What specific approach does DeepVariant use to distinguish true variants from artifacts, and how does this differ from classical variant callers?</li>
<li>Why do variant calling errors in difficult genomic regions create systematic blind spots for downstream machine learning models?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Three signal sources:</strong></p>
<ol type="1">
<li><p>Sequencing errors from instrument noise and library preparation.</p></li>
<li><p>Alignment artifacts when reads map to incorrect genomic locations.</p></li>
<li><p>Genuine biological variation including germline variants, somatic mutations, and mosaicism.</p></li>
</ol>
<p>All three produce identical-looking mismatches in the data.</p></li>
<li><p><strong>Phasing importance:</strong> Phasing determines whether two variants are on the same chromosome (cis) or different chromosomes (trans). For compound heterozygosity in recessive disorders like cystic fibrosis, cis configuration leaves one functional gene copy (carrier status), while trans configuration eliminates all functional copies (affected status). The clinical outcomes are entirely different despite identical unphased genotypes.</p></li>
<li><p><strong>DeepVariant approach:</strong> DeepVariant reformulates variant calling as image classification by encoding read pileups as multi-channel tensors and using a CNN to learn patterns distinguishing true variants from artifacts. Classical callers like HaplotypeCaller use explicit probabilistic models (pair-HMMs) with hand-crafted features and separate recalibration steps (VQSR). DeepVariant learns artifact signatures end-to-end from data rather than requiring expert-defined heuristics.</p></li>
<li><p><strong>Blind spots in downstream models:</strong> If a variant is never called due to systematic failures in difficult regions (segmental duplications, HLA, tandem repeats), it cannot appear in training data. Models trained on VCF files effectively learn from an incomplete representation of the genome where entire classes of clinically important variants are invisible. No amount of sophisticated downstream modeling can recover information lost at the variant calling stage.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p><strong>Key concepts:</strong> NGS data challenges, targeting strategies (panels/WES/WGS), classical variant calling pipelines, phasing, error sources, difficult genomic regions, benchmarking, DeepVariant</p>
<p><strong>Main takeaways:</strong></p>
<ol type="1">
<li>Variant calls are statistical inferences that carry systematic errors, especially in repetitive regions, segmental duplications, and the HLA complex</li>
<li>The choice of sequencing strategy (panel vs.&nbsp;WES vs.&nbsp;WGS, short-read vs.&nbsp;long-read) determines which variants are discoverable</li>
<li>Deep learning approaches like DeepVariant learn to distinguish variants from artifacts by processing raw pileup evidence as images</li>
<li>All downstream models inherit the blind spots of variant calling–regions that cannot be reliably called become invisible to models trained on VCF files</li>
</ol>
<p><strong>Connections to later chapters:</strong></p>
<ul>
<li>Embedding strategies: <a href="../part_2/p2-ch05-representations.html#sec-ch05-embeddings" class="quarto-xref"><span>Section 5.6</span></a></li>
<li>CNN architectures: <a href="../part_2/p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>, <a href="../part_2/p2-ch06-cnn.html#sec-ch06-deepsea" class="quarto-xref"><span>Section 6.2</span></a></li>
<li>Evaluation methodology: <a href="../part_3/p3-ch12-evaluation.html#sec-ch12-homology-aware-splitting" class="quarto-xref"><span>Section 12.2</span></a>, <a href="../part_3/p3-ch11-benchmarks.html#sec-ch11-benchmark-construction" class="quarto-xref"><span>Section 11.5</span></a></li>
<li>Confounding and bias: <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a></li>
<li>Foundation models: <a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-defining" class="quarto-xref"><span>Section 14.2</span></a>, <a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a></li>
<li>Regulatory models: <a href="../part_4/p4-ch17-regulatory.html" class="quarto-xref"><span>Chapter 17</span></a></li>
</ul>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-browning_fast_2021" class="csl-entry" role="listitem">
Browning, Brian L., Xiaowen Tian, Ying Zhou, and Sharon R. Browning. 2021. <span>“Fast Two-Stage Phasing of Large-Scale Sequence Data.”</span> <em>American Journal of Human Genetics</em> 108 (10): 1880–90. <a href="https://doi.org/10.1016/j.ajhg.2021.08.005">https://doi.org/10.1016/j.ajhg.2021.08.005</a>.
</div>
<div id="ref-bycroft_uk_2018" class="csl-entry" role="listitem">
Bycroft, Clare, Colin Freeman, Desislava Petkova, Gavin Band, Lloyd T. Elliott, Kevin Sharp, Allan Motyer, et al. 2018. <span>“The <span>UK</span> <span>Biobank</span> Resource with Deep Phenotyping and Genomic Data.”</span> <em>Nature</em> 562 (7726): 203–9. <a href="https://doi.org/10.1038/s41586-018-0579-z">https://doi.org/10.1038/s41586-018-0579-z</a>.
</div>
<div id="ref-cirulli_genome-wide_2020" class="csl-entry" role="listitem">
Cirulli, Elizabeth T., Simon White, Robert W. Read, Gai Elhanan, William J. Metcalf, Francisco Tanudjaja, Donna M. Fath, et al. 2020. <span>“Genome-Wide Rare Variant Analysis for Thousands of Phenotypes in over 70,000 Exomes from Two Cohorts.”</span> <em>Nature Communications</em> 11 (1): 542. <a href="https://doi.org/10.1038/s41467-020-14288-y">https://doi.org/10.1038/s41467-020-14288-y</a>.
</div>
<div id="ref-dabernig-heinz_multicenter_2024" class="csl-entry" role="listitem">
Dabernig-Heinz, Johanna, Mara Lohde, Martin Hölzer, Adriana Cabal, Rick Conzemius, Christian Brandt, Matthias Kohl, et al. 2024. <span>“A Multicenter Study on Accuracy and Reproducibility of Nanopore Sequencing-Based Genotyping of Bacterial Pathogens.”</span> <em>Journal of Clinical Microbiology</em> 62 (9): e00628–24. <a href="https://doi.org/10.1128/jcm.00628-24">https://doi.org/10.1128/jcm.00628-24</a>.
</div>
<div id="ref-depristo_framework_2011" class="csl-entry" role="listitem">
DePristo, Mark A., Eric Banks, Ryan Poplin, Kiran V. Garimella, Jared R. Maguire, Christopher Hartl, Anthony A. Philippakis, et al. 2011. <span>“A Framework for Variation Discovery and Genotyping Using Next-Generation <span>DNA</span> Sequencing Data.”</span> <em>Nature Genetics</em> 43 (5): 491–98. <a href="https://doi.org/10.1038/ng.806">https://doi.org/10.1038/ng.806</a>.
</div>
<div id="ref-garrison_variation_2018" class="csl-entry" role="listitem">
Garrison, Erik, Jouni Sirén, Adam M. Novak, Glenn Hickey, Jordan M. Eizenga, Eric T. Dawson, William Jones, et al. 2018. <span>“Variation Graph Toolkit Improves Read Mapping by Representing Genetic Variation in the Reference.”</span> <em>Nature Biotechnology</em> 36 (9): 875–79. <a href="https://doi.org/10.1038/nbt.4227">https://doi.org/10.1038/nbt.4227</a>.
</div>
<div id="ref-goodwin_coming_2016" class="csl-entry" role="listitem">
Goodwin, Sara, John D. McPherson, and W. Richard McCombie. 2016. <span>“Coming of Age: Ten Years of Next-Generation Sequencing Technologies.”</span> <em>Nature Reviews Genetics</em> 17 (6): 333–51. <a href="https://doi.org/10.1038/nrg.2016.49">https://doi.org/10.1038/nrg.2016.49</a>.
</div>
<div id="ref-ingelman-sundberg_genetic_2004" class="csl-entry" role="listitem">
Ingelman-Sundberg, M. 2004. <span>“Genetic Polymorphisms of Cytochrome <span>P450</span> <span>2D6</span> (<span>CYP2D6</span>): Clinical Consequences, Evolutionary Aspects and Functional Diversity.”</span> <em>The Pharmacogenomics Journal</em> 5 (1): 6–13. <a href="https://doi.org/10.1038/sj.tpj.6500285">https://doi.org/10.1038/sj.tpj.6500285</a>.
</div>
<div id="ref-jiang_long-read-based_2020" class="csl-entry" role="listitem">
Jiang, Tao, Yongzhuang Liu, Yue Jiang, Junyi Li, Yan Gao, Zhe Cui, Yadong Liu, Bo Liu, and Yadong Wang. 2020. <span>“Long-Read-Based Human Genomic Structural Variation Detection with <span class="nocase">cuteSV</span>.”</span> <em>Genome Biology</em> 21 (1): 189. <a href="https://doi.org/10.1186/s13059-020-02107-y">https://doi.org/10.1186/s13059-020-02107-y</a>.
</div>
<div id="ref-karczewski_mutational_2020" class="csl-entry" role="listitem">
Karczewski, Konrad J., Laurent C. Francioli, Grace Tiao, Beryl B. Cummings, Jessica Alföldi, Qingbo Wang, Ryan L. Collins, et al. 2020. <span>“The Mutational Constraint Spectrum Quantified from Variation in 141,456 Humans.”</span> <em>Nature</em> 581 (7809): 434–43. <a href="https://doi.org/10.1038/s41586-020-2308-7">https://doi.org/10.1038/s41586-020-2308-7</a>.
</div>
<div id="ref-krusche_best_2019" class="csl-entry" role="listitem">
Krusche, Peter, Len Trigg, Paul C. Boutros, Christopher E. Mason, Francisco M. De La Vega, Benjamin L. Moore, Mar Gonzalez-Porta, et al. 2019. <span>“Best <span>Practices</span> for <span>Benchmarking</span> <span>Germline</span> <span>Small</span> <span>Variant</span> <span>Calls</span> in <span>Human</span> <span>Genomes</span>.”</span> <em>Nature Biotechnology</em> 37 (5): 555–60. <a href="https://doi.org/10.1038/s41587-019-0054-x">https://doi.org/10.1038/s41587-019-0054-x</a>.
</div>
<div id="ref-li_aligning_2013" class="csl-entry" role="listitem">
Li, Heng. 2013. <span>“Aligning Sequence Reads, Clone Sequences and Assembly Contigs with <span>BWA</span>-<span>MEM</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1303.3997">https://doi.org/10.48550/arXiv.1303.3997</a>.
</div>
<div id="ref-li_towards_2014" class="csl-entry" role="listitem">
———. 2014. <span>“Towards <span>Better</span> <span>Understanding</span> of <span>Artifacts</span> in <span>Variant</span> <span>Calling</span> from <span>High</span>-<span>Coverage</span> <span>Samples</span>.”</span> <em>Bioinformatics</em> 30 (20): 2843–51. <a href="https://doi.org/10.1093/bioinformatics/btu356">https://doi.org/10.1093/bioinformatics/btu356</a>.
</div>
<div id="ref-li_minimap2_2018" class="csl-entry" role="listitem">
———. 2018. <span>“Minimap2: Pairwise Alignment for Nucleotide Sequences.”</span> <em>Bioinformatics</em> 34 (18): 3094–3100. <a href="https://doi.org/10.1093/bioinformatics/bty191">https://doi.org/10.1093/bioinformatics/bty191</a>.
</div>
<div id="ref-liao_draft_2023" class="csl-entry" role="listitem">
Liao, Wen-Wei, Mobin Asri, Jana Ebler, Daniel Doerr, Marina Haukness, Glenn Hickey, Shuangjia Lu, et al. 2023. <span>“A Draft Human Pangenome Reference.”</span> <em>Nature</em> 617 (7960): 312–24. <a href="https://doi.org/10.1038/s41586-023-05896-x">https://doi.org/10.1038/s41586-023-05896-x</a>.
</div>
<div id="ref-loh_reference-based_2016" class="csl-entry" role="listitem">
Loh, Po-Ru, Petr Danecek, Pier Francesco Palamara, Christian Fuchsberger, Yakir A Reshef, Hilary K Finucane, Sebastian Schoenherr, et al. 2016. <span>“Reference-Based Phasing Using the <span>Haplotype</span> <span>Reference</span> <span>Consortium</span> Panel.”</span> <em>Nature Genetics</em> 48 (11): 1443–48. <a href="https://doi.org/10.1038/ng.3679">https://doi.org/10.1038/ng.3679</a>.
</div>
<div id="ref-mallal_hla-b5701_2008" class="csl-entry" role="listitem">
Mallal, Simon, Elizabeth Phillips, Giampiero Carosi, Jean-Michel Molina, Cassy Workman, Janez Tomažič, Eva Jägel-Guedes, et al. 2008. <span>“<span>HLA</span>-<span>B</span>*5701 <span>Screening</span> for <span>Hypersensitivity</span> to <span>Abacavir</span>.”</span> <em>New England Journal of Medicine</em> 358 (6): 568–79. <a href="https://doi.org/10.1056/NEJMoa0706135">https://doi.org/10.1056/NEJMoa0706135</a>.
</div>
<div id="ref-nielsen_genotype_2011" class="csl-entry" role="listitem">
Nielsen, Rasmus, Joshua S. Paul, Anders Albrechtsen, and Yun S. Song. 2011. <span>“Genotype and <span>SNP</span> Calling from Next-Generation Sequencing Data.”</span> <em>Nature Reviews. Genetics</em> 12 (6): 443–51. <a href="https://doi.org/10.1038/nrg2986">https://doi.org/10.1038/nrg2986</a>.
</div>
<div id="ref-nurk_complete_2022" class="csl-entry" role="listitem">
Nurk, Sergey, Sergey Koren, Arang Rhie, Mikko Rautiainen, Andrey V. Bzikadze, Alla Mikheenko, Mitchell R. Vollger, et al. 2022. <span>“The Complete Sequence of a Human Genome.”</span> <em>Science</em> 376 (6588): 44–53. <a href="https://doi.org/10.1126/science.abj6987">https://doi.org/10.1126/science.abj6987</a>.
</div>
<div id="ref-oconnell_general_2014" class="csl-entry" role="listitem">
O’Connell, Jared, Deepti Gurdasani, Olivier Delaneau, Nicola Pirastu, Sheila Ulivi, Massimiliano Cocca, Michela Traglia, et al. 2014. <span>“A <span>General</span> <span>Approach</span> for <span>Haplotype</span> <span>Phasing</span> Across the <span>Full</span> <span>Spectrum</span> of <span>Relatedness</span>.”</span> <em>PLOS Genetics</em> 10 (4): e1004234. <a href="https://doi.org/10.1371/journal.pgen.1004234">https://doi.org/10.1371/journal.pgen.1004234</a>.
</div>
<div id="ref-noauthor_pacificbiosciencespbsv_2025" class="csl-entry" role="listitem">
<span>“<span>PacificBiosciences</span>/Pbsv.”</span> 2025. PacBio.
</div>
<div id="ref-poplin_deepvariant_2018" class="csl-entry" role="listitem">
Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. <span>“[<span>DeepVariant</span>] <span>A</span> Universal <span>SNP</span> and Small-Indel Variant Caller Using Deep Neural Networks.”</span> <em>Nature Biotechnology</em> 36 (10): 983–87. <a href="https://doi.org/10.1038/nbt.4235">https://doi.org/10.1038/nbt.4235</a>.
</div>
<div id="ref-noauthor_realtimegenomicsrtg-core_2025" class="csl-entry" role="listitem">
<span>“<span>RealTimeGenomics</span>/Rtg-Core.”</span> 2025. Real Time Genomics.
</div>
<div id="ref-robinson_ipd-imgthla_2020" class="csl-entry" role="listitem">
Robinson, James, Dominic J Barker, Xenia Georgiou, Michael A Cooper, Paul Flicek, and Steven G E Marsh. 2020. <span>“<span>IPD</span>-<span>IMGT</span>/<span>HLA</span> <span>Database</span>.”</span> <em>Nucleic Acids Research</em> 48 (D1): D948–55. <a href="https://doi.org/10.1093/nar/gkz950">https://doi.org/10.1093/nar/gkz950</a>.
</div>
<div id="ref-rubinacci_efficient_2021" class="csl-entry" role="listitem">
Rubinacci, Simone, Diogo M. Ribeiro, Robin J. Hofmeister, and Olivier Delaneau. 2021. <span>“Efficient Phasing and Imputation of Low-Coverage Sequencing Data Using Large Reference Panels.”</span> <em>Nature Genetics</em> 53 (1): 120–26. <a href="https://doi.org/10.1038/s41588-020-00756-0">https://doi.org/10.1038/s41588-020-00756-0</a>.
</div>
<div id="ref-sakaue_tutorial_2023" class="csl-entry" role="listitem">
Sakaue, Saori, Saisriram Gurajala, Michelle Curtis, Yang Luo, Wanson Choi, Kazuyoshi Ishigaki, Joyce B. Kang, et al. 2023. <span>“Tutorial: A Statistical Genetics Guide to Identifying <span>HLA</span> Alleles Driving Complex Disease.”</span> <em>Nature Protocols</em> 18 (9): 2625–41. <a href="https://doi.org/10.1038/s41596-023-00853-4">https://doi.org/10.1038/s41596-023-00853-4</a>.
</div>
<div id="ref-shafin_haplotype-aware_2021" class="csl-entry" role="listitem">
Shafin, Kishwar, Trevor Pesout, Pi-Chuan Chang, Maria Nattestad, Alexey Kolesnikov, Sidharth Goel, Gunjan Baid, et al. 2021. <span>“Haplotype-Aware Variant Calling with <span>PEPPER</span>-<span>Margin</span>-<span>DeepVariant</span> Enables High Accuracy in Nanopore Long-Reads.”</span> <em>Nature Methods</em> 18 (11): 1322–32. <a href="https://doi.org/10.1038/s41592-021-01299-w">https://doi.org/10.1038/s41592-021-01299-w</a>.
</div>
<div id="ref-smolka_detection_2024" class="csl-entry" role="listitem">
Smolka, Moritz, Luis F. Paulin, Christopher M. Grochowski, Dominic W. Horner, Medhat Mahmoud, Sairam Behera, Ester Kalef-Ezra, et al. 2024. <span>“Detection of Mosaic and Population-Level Structural Variants with <span>Sniffles2</span>.”</span> <em>Nature Biotechnology</em> 42 (10): 1571–80. <a href="https://doi.org/10.1038/s41587-023-02024-y">https://doi.org/10.1038/s41587-023-02024-y</a>.
</div>
<div id="ref-song_t1k_2022" class="csl-entry" role="listitem">
Song, Li, Gali Bai, X. Shirley Liu, Bo Li, and Heng Li. 2022. <span>“<span>T1K</span>: Efficient and Accurate <span>KIR</span> and <span>HLA</span> Genotyping with Next-Generation Sequencing Data.”</span> bioRxiv. <a href="https://doi.org/10.1101/2022.10.26.513955">https://doi.org/10.1101/2022.10.26.513955</a>.
</div>
<div id="ref-van_der_auwera_fastq_2018" class="csl-entry" role="listitem">
Van der Auwera, Geraldine A., Mauricio O. Carneiro, Christopher Hartl, Ryan Poplin, Guillermo del Angel, Ami Levy-Moonshine, Tadeusz Jordan, et al. 2018. <span>“From <span>FastQ</span> <span>Data</span> to <span>High</span>-<span>Confidence</span> <span>Variant</span> <span>Calls</span>: <span>The</span> <span>Genome</span> <span>Analysis</span> <span>Toolkit</span> <span>Best</span> <span>Practices</span> <span>Pipeline</span>.”</span> <em>Current Protocols in Bioinformatics</em> 43 (1): 11.10.1–33. <a href="https://doi.org/10.1002/0471250953.bi1110s43">https://doi.org/10.1002/0471250953.bi1110s43</a>.
</div>
<div id="ref-wenger_accurate_2019" class="csl-entry" role="listitem">
Wenger, Aaron M., Paul Peluso, William J. Rowell, Pi-Chuan Chang, Richard J. Hall, Gregory T. Concepcion, Jana Ebler, et al. 2019. <span>“Accurate Circular Consensus Long-Read Sequencing Improves Variant Detection and Assembly of a Human Genome.”</span> <em>Nature Biotechnology</em> 37 (10): 1155–62. <a href="https://doi.org/10.1038/s41587-019-0217-9">https://doi.org/10.1038/s41587-019-0217-9</a>.
</div>
<div id="ref-yun_accurate_2021" class="csl-entry" role="listitem">
Yun, Taedong, Helen Li, Pi-Chuan Chang, Michael F Lin, Andrew Carroll, and Cory Y McLean. 2021. <span>“Accurate, Scalable Cohort Variant Calls Using <span>DeepVariant</span> and <span>GLnexus</span>.”</span> <em>Bioinformatics</em> 36 (24): 5582–89. <a href="https://doi.org/10.1093/bioinformatics/btaa1081">https://doi.org/10.1093/bioinformatics/btaa1081</a>.
</div>
<div id="ref-zanger_cytochrome_2013" class="csl-entry" role="listitem">
Zanger, Ulrich M., and Matthias Schwab. 2013. <span>“Cytochrome <span>P450</span> Enzymes in Drug Metabolism: <span>Regulation</span> of Gene Expression, Enzyme Activities, and Impact of Genetic Variation.”</span> <em>Pharmacology &amp; Therapeutics</em> 138 (1): 103–41. <a href="https://doi.org/10.1016/j.pharmthera.2012.12.007">https://doi.org/10.1016/j.pharmthera.2012.12.007</a>.
</div>
<div id="ref-zheng_symphonizing_2022" class="csl-entry" role="listitem">
Zheng, Zhenxian, Shumin Li, Junhao Su, Amy Wing-Sze Leung, Tak-Wah Lam, and Ruibang Luo. 2022. <span>“Symphonizing Pileup and Full-Alignment for Deep Learning-Based Long-Read Variant Calling.”</span> <em>Nature Computational Science</em> 2 (12): 797–803. <a href="https://doi.org/10.1038/s43588-022-00387-x">https://doi.org/10.1038/s43588-022-00387-x</a>.
</div>
<div id="ref-zook_open_2019" class="csl-entry" role="listitem">
Zook, Justin M., Jennifer McDaniel, Nathan D. Olson, Justin Wagner, Hemang Parikh, Haynes Heaton, Sean A. Irvine, et al. 2019. <span>“An Open Resource for Accurately Benchmarking Small Variant and Reference Calls.”</span> <em>Nature Biotechnology</em> 37 (5): 561–66. <a href="https://doi.org/10.1038/s41587-019-0074-6">https://doi.org/10.1038/s41587-019-0074-6</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_1/p1--foundations.html" class="pagination-link" aria-label="Part I: Data Foundations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part I: Data Foundations</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_1/p1-ch02-data.html" class="pagination-link" aria-label="Data Landscape">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>