<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; GWAS and Polygenic Scores – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_1/p1-ch04-vep-classical.html" rel="next">
<link href="../part_1/p1-ch02-data.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch03-gwas.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Sequence Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmarks and Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch12-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch14-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch15-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch16-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch17-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch19-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch20-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch21-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch22-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Trust</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch24-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch25-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Causal Inference with Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch26-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Clinical Translation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch28-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch29-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch30-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch31-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch03-gwas-framework" id="toc-sec-ch03-gwas-framework" class="nav-link active" data-scroll-target="#sec-ch03-gwas-framework"><span class="header-section-number">3.1</span> GWAS Framework</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-linear-models" id="toc-sec-ch03-linear-models" class="nav-link" data-scroll-target="#sec-ch03-linear-models"><span class="header-section-number">3.1.1</span> Association Models for Quantitative Traits</a></li>
  <li><a href="#sec-ch03-logistic-models" id="toc-sec-ch03-logistic-models" class="nav-link" data-scroll-target="#sec-ch03-logistic-models"><span class="header-section-number">3.1.2</span> Association Models for Disease Outcomes</a></li>
  <li><a href="#sec-ch03-visualization" id="toc-sec-ch03-visualization" class="nav-link" data-scroll-target="#sec-ch03-visualization"><span class="header-section-number">3.1.3</span> Manhattan Plots and Q-Q Plots</a></li>
  <li><a href="#sec-ch03-population-structure" id="toc-sec-ch03-population-structure" class="nav-link" data-scroll-target="#sec-ch03-population-structure"><span class="header-section-number">3.1.4</span> Population Structure Control</a></li>
  </ul></li>
  <li><a href="#sec-ch03-heritability" id="toc-sec-ch03-heritability" class="nav-link" data-scroll-target="#sec-ch03-heritability"><span class="header-section-number">3.2</span> Heritability: What Genetics Can Explain</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-pedigree-heritability" id="toc-sec-ch03-pedigree-heritability" class="nav-link" data-scroll-target="#sec-ch03-pedigree-heritability"><span class="header-section-number">3.2.1</span> Pedigree Heritability</a></li>
  <li><a href="#sec-ch03-snp-heritability" id="toc-sec-ch03-snp-heritability" class="nav-link" data-scroll-target="#sec-ch03-snp-heritability"><span class="header-section-number">3.2.2</span> SNP-Heritability and the Missing Heritability Problem</a></li>
  <li><a href="#sec-ch03-heritability-implications" id="toc-sec-ch03-heritability-implications" class="nav-link" data-scroll-target="#sec-ch03-heritability-implications"><span class="header-section-number">3.2.3</span> Implications for GWAS and Polygenic Scores</a></li>
  </ul></li>
  <li><a href="#sec-ch03-ld" id="toc-sec-ch03-ld" class="nav-link" data-scroll-target="#sec-ch03-ld"><span class="header-section-number">3.3</span> Linkage Disequilibrium and the Association-Causation Gap</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-ld-structure" id="toc-sec-ch03-ld-structure" class="nav-link" data-scroll-target="#sec-ch03-ld-structure"><span class="header-section-number">3.3.1</span> Structure of Linkage Disequilibrium</a></li>
  <li><a href="#sec-ch03-causal-vs-tag" id="toc-sec-ch03-causal-vs-tag" class="nav-link" data-scroll-target="#sec-ch03-causal-vs-tag"><span class="header-section-number">3.3.2</span> Causal Variants, Tag Variants, and GWAS Catalogs</a></li>
  </ul></li>
  <li><a href="#sec-ch03-fine-mapping" id="toc-sec-ch03-fine-mapping" class="nav-link" data-scroll-target="#sec-ch03-fine-mapping"><span class="header-section-number">3.4</span> Fine-Mapping: From Loci to Causal Variants</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-fine-mapping-stats" id="toc-sec-ch03-fine-mapping-stats" class="nav-link" data-scroll-target="#sec-ch03-fine-mapping-stats"><span class="header-section-number">3.4.1</span> Statistical Framework</a></li>
  <li><a href="#sec-ch03-functional-priors" id="toc-sec-ch03-functional-priors" class="nav-link" data-scroll-target="#sec-ch03-functional-priors"><span class="header-section-number">3.4.2</span> Functional Annotation Priors</a></li>
  <li><a href="#sec-ch03-multi-ancestry-fine-mapping" id="toc-sec-ch03-multi-ancestry-fine-mapping" class="nav-link" data-scroll-target="#sec-ch03-multi-ancestry-fine-mapping"><span class="header-section-number">3.4.3</span> Multi-Ancestry Fine-Mapping</a></li>
  </ul></li>
  <li><a href="#sec-ch03-pgs-construction" id="toc-sec-ch03-pgs-construction" class="nav-link" data-scroll-target="#sec-ch03-pgs-construction"><span class="header-section-number">3.5</span> Polygenic Score Construction</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-clumping-thresholding" id="toc-sec-ch03-clumping-thresholding" class="nav-link" data-scroll-target="#sec-ch03-clumping-thresholding"><span class="header-section-number">3.5.1</span> Clumping and Thresholding</a></li>
  <li><a href="#sec-ch03-bayesian-pgs" id="toc-sec-ch03-bayesian-pgs" class="nav-link" data-scroll-target="#sec-ch03-bayesian-pgs"><span class="header-section-number">3.5.2</span> LD-Aware Bayesian Methods</a></li>
  <li><a href="#sec-ch03-fine-mapping-informed-pgs" id="toc-sec-ch03-fine-mapping-informed-pgs" class="nav-link" data-scroll-target="#sec-ch03-fine-mapping-informed-pgs"><span class="header-section-number">3.5.3</span> Fine-Mapping-Informed Scores</a></li>
  </ul></li>
  <li><a href="#sec-ch03-pgs-interpretation" id="toc-sec-ch03-pgs-interpretation" class="nav-link" data-scroll-target="#sec-ch03-pgs-interpretation"><span class="header-section-number">3.6</span> Polygenic Score Interpretation</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-relative-risk" id="toc-sec-ch03-relative-risk" class="nav-link" data-scroll-target="#sec-ch03-relative-risk"><span class="header-section-number">3.6.1</span> Relative Risk and Percentiles</a></li>
  <li><a href="#sec-ch03-absolute-risk" id="toc-sec-ch03-absolute-risk" class="nav-link" data-scroll-target="#sec-ch03-absolute-risk"><span class="header-section-number">3.6.2</span> Absolute Risk</a></li>
  <li><a href="#sec-ch03-variance-discrimination" id="toc-sec-ch03-variance-discrimination" class="nav-link" data-scroll-target="#sec-ch03-variance-discrimination"><span class="header-section-number">3.6.3</span> Explained Variance and Discrimination</a></li>
  </ul></li>
  <li><a href="#sec-ch03-portability" id="toc-sec-ch03-portability" class="nav-link" data-scroll-target="#sec-ch03-portability"><span class="header-section-number">3.7</span> Ancestry, Portability, and Fairness</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-portability-problem" id="toc-sec-ch03-portability-problem" class="nav-link" data-scroll-target="#sec-ch03-portability-problem"><span class="header-section-number">3.7.1</span> Portability Problem</a></li>
  <li><a href="#sec-ch03-fairness" id="toc-sec-ch03-fairness" class="nav-link" data-scroll-target="#sec-ch03-fairness"><span class="header-section-number">3.7.2</span> Fairness and Health Equity</a></li>
  </ul></li>
  <li><a href="#sec-ch03-phewas" id="toc-sec-ch03-phewas" class="nav-link" data-scroll-target="#sec-ch03-phewas"><span class="header-section-number">3.8</span> Phenome-Wide Association Studies</a>
  <ul class="collapse">
  <li><a href="#sec-ch03-phewas-framework" id="toc-sec-ch03-phewas-framework" class="nav-link" data-scroll-target="#sec-ch03-phewas-framework"><span class="header-section-number">3.8.1</span> PheWAS Framework</a></li>
  <li><a href="#sec-ch03-prs-phewas" id="toc-sec-ch03-prs-phewas" class="nav-link" data-scroll-target="#sec-ch03-prs-phewas"><span class="header-section-number">3.8.2</span> PheWAS for Polygenic Score Interpretation</a></li>
  <li><a href="#sec-ch03-phenotype-quality" id="toc-sec-ch03-phenotype-quality" class="nav-link" data-scroll-target="#sec-ch03-phenotype-quality"><span class="header-section-number">3.8.3</span> Phenotype Quality and PheWAS Power</a></li>
  <li><a href="#sec-ch03-deep-phenotyping" id="toc-sec-ch03-deep-phenotyping" class="nav-link" data-scroll-target="#sec-ch03-deep-phenotyping"><span class="header-section-number">3.8.4</span> Deep Phenotyping and Embedding-Enhanced GWAS</a></li>
  </ul></li>
  <li><a href="#sec-ch03-mechanism" id="toc-sec-ch03-mechanism" class="nav-link" data-scroll-target="#sec-ch03-mechanism"><span class="header-section-number">3.9</span> From Association to Mechanism</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_1/p1--foundations.html">Part I: Data Foundations</a></li><li class="breadcrumb-item"><a href="../part_1/p1-ch03-gwas.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch03-gwas" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>GWAS do not identify causes. They identify signposts.</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Prerequisites:</strong> Basic understanding of genetic variants (SNPs, alleles) from <a href="p1-ch01-ngs.html" class="quarto-xref"><span>Chapter 1</span></a> and familiarity with population genetics concepts. No prior statistics beyond introductory probability required.</p>
<p><strong>You will learn:</strong></p>
<ul>
<li>How genome-wide association studies identify genetic variants linked to traits and diseases</li>
<li>Why GWAS signals represent associations with genomic regions, not identifications of causal variants</li>
<li>How heritability partitions phenotypic variance into genetic and environmental components</li>
<li>How linkage disequilibrium creates the fundamental gap between statistical association and biological causation</li>
<li>How polygenic scores aggregate thousands of small effects into clinically meaningful risk predictions</li>
<li>Why polygenic scores perform differently across ancestral populations and what this means for equity</li>
</ul>
<p><strong>Key insight:</strong> GWAS identify signposts, not causes. The path from associated variant to biological mechanism requires additional methods, and the path from statistical association to equitable clinical utility requires attention to who was included in discovery cohorts.</p>
</div>
</div>
<p>When a <strong>genome-wide association study (GWAS)</strong> reports that a particular <strong>single nucleotide polymorphism (SNP)</strong> associates with coronary artery disease, that SNP is almost certainly not the variant that alters cardiac biology. It is correlated with the causal variant through linkage disequilibrium, the non-random association of nearby alleles that persists across generations. The statistical machinery of GWAS is exquisitely sensitive to these correlations but fundamentally agnostic about mechanism. It can identify a region of the genome that harbors trait-relevant variation without distinguishing the causal variant from its correlated neighbors, without explaining which genes or pathways are affected, and without revealing whether the same associations hold in populations with different linkage patterns.</p>
<p>This distinction between association and causation defines the central intellectual challenge of statistical genetics. GWAS have identified thousands of genomic regions associated with hundreds of complex traits, from height and blood pressure to schizophrenia and type 2 diabetes. These associations replicate across studies with remarkable consistency, confirming that the signals are real. Yet the path from associated region to biological mechanism remains obscure for most loci. The majority of GWAS signals fall in non-coding regions where there is no obvious gene to implicate. Even when a signal overlaps a gene, whether it affects expression, splicing, or protein function is rarely apparent from the association alone.</p>
<p>Polygenic scores aggregate these associations into predictions, summing risk alleles across thousands of loci to estimate an individual’s genetic predisposition. For some traits, these scores achieve clinically meaningful discrimination: individuals in the top percentile of coronary artery disease risk have odds ratios comparable to monogenic familial hypercholesterolemia. Yet polygenic scores inherit all the limitations of the associations they aggregate. They predict without explaining, correlate without identifying mechanism, and transfer poorly across populations with different allele frequencies and linkage patterns. Understanding both their power and their limitations is essential for mechanistic approaches where regulatory sequence models (<a href="../part_3/p3-ch16-regulatory.html" class="quarto-xref"><span>Chapter 16</span></a>) and variant effect predictors (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>) attempt to move from statistical association to biological explanation <span class="citation" data-cites="khera_genome-wide_2017">(<a href="../bib/references.html#ref-khera_genome-wide_2017" role="doc-biblioref">Khera and Kathiresan 2017</a>)</span>. The portability challenges of polygenic scores across populations motivate the fairness and equity considerations examined in <span class="quarto-unresolved-ref">?sec-ch22-ancestry-confounding</span> and <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-fairness" class="quarto-xref"><span>Section 27.8</span></a>.</p>
<section id="sec-ch03-gwas-framework" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec-ch03-gwas-framework"><span class="header-section-number">3.1</span> GWAS Framework</h2>
<p>Consider a clinician counseling a patient about cardiovascular disease risk. Traditional risk factors (age, smoking, cholesterol, blood pressure) explain roughly 50% of the variation in who develops disease <span class="citation" data-cites="khera_genome-wide_2017">(<a href="../bib/references.html#ref-khera_genome-wide_2017" role="doc-biblioref">Khera and Kathiresan 2017</a>)</span>. Family history suggests that genetics contributes substantially to the remainder, but which genetic variants matter, and how much does each contribute? GWAS provide a systematic approach to answering these questions by testing each of millions of variants for association with the trait of interest.</p>
<p>The scale required for well-powered GWAS explains why large-scale biobanks (<a href="p1-ch02-data.html#sec-ch02-biobanks" class="quarto-xref"><span>Section 2.3</span></a> for comprehensive biobank descriptions, <a href="p1-ch02-data.html#sec-ch02-constraints" class="quarto-xref"><span>Section 2.9</span></a> for data composition biases) have become essential infrastructure for statistical genetics. UK Biobank, with its 500,000 participants genotyped across hundreds of thousands of variants and linked to extensive phenotypic data, has enabled GWAS for thousands of traits at sample sizes that were unimaginable a decade ago. Similar resources, including the Million Veteran Program, FinnGen, and All of Us, continue to expand the scope of discoverable associations. The biobank paradigm of combining dense genotyping with rich phenotyping at population scale has transformed GWAS from underpowered fishing expeditions into reliable discovery engines.</p>
<p>The core logic is straightforward. For each variant in turn, researchers ask whether individuals carrying more copies of a particular allele tend to have higher or lower values of the phenotype (for quantitative traits) or higher or lower probability of disease (for binary outcomes). They estimate an effect size, compute a test statistic under the null hypothesis of no association, and record a p-value. After testing millions of variants, those exceeding a stringent significance threshold are identified, the associated loci reported, and interpretation begins regarding which genes and pathways might be involved.</p>
<p>This apparently simple procedure requires careful attention to study design, quality control, and statistical modeling. The phenotype must be measured consistently across individuals. The genotypes must be accurate and the variants well-defined. Confounders that correlate with both genotype and phenotype (most notably population structure) must be controlled. Multiple testing across millions of variants demands stringent significance thresholds. Only after addressing these challenges can GWAS results be trusted and translated into downstream applications.</p>
<section id="sec-ch03-linear-models" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="sec-ch03-linear-models"><span class="header-section-number">3.1.1</span> Association Models for Quantitative Traits</h3>
<p>Choosing the wrong statistical model for a GWAS does not merely introduce imprecision; it distorts effect size estimates in ways that propagate through every downstream analysis, from fine-mapping to polygenic scores to drug target prioritization. A height GWAS and a schizophrenia GWAS require fundamentally different approaches because one outcome is continuous and the other binary. Applying linear regression to a binary outcome produces fitted values outside the 0-1 probability range and residuals that violate normality assumptions.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Mathematical Detail">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Detail
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following sections introduce statistical models using mathematical notation. Readers unfamiliar with regression can focus on the conceptual intuition: for each variant, we ask whether people with more copies of one allele tend to have higher or lower values of the trait, after accounting for confounding factors like age, sex, and ancestry.</p>
</div>
</div>
<p>For continuous phenotypes such as height, LDL cholesterol, or blood pressure, the standard approach is linear regression. Let <span class="math inline">\(y_i\)</span> denote the phenotype for individual <span class="math inline">\(i\)</span>, and let <span class="math inline">\(g_{ij}\)</span> denote the genotype dosage at variant <span class="math inline">\(j\)</span>, encoded as <span class="math inline">\(0\)</span>, <span class="math inline">\(1\)</span>, or <span class="math inline">\(2\)</span> copies of the alternative allele (or as a fractional value for imputed genotypes). The model is:</p>
<p><span class="math display">\[
y_i = \alpha + \beta_j g_{ij} + \gamma^\top c_i + \varepsilon_i
\]</span></p>
<p>The coefficient <span class="math inline">\(\beta_j\)</span> represents the expected change in phenotype per additional copy of the alternative allele, holding covariates <span class="math inline">\(c_i\)</span> fixed. When phenotypes are standardized to zero mean and unit variance, <span class="math inline">\(\beta_j\)</span> is expressed in standard deviation units per allele. The vector <span class="math inline">\(c_i\)</span> typically includes age, sex, genotyping batch, and principal components capturing ancestry (discussed below). The residual <span class="math inline">\(\varepsilon_i\)</span> captures unexplained variation, assumed to be independent and identically distributed across individuals.</p>
<p>For each variant, a test statistic is computed for the null hypothesis <span class="math inline">\(H_0: \beta_j = 0\)</span>. In large samples, the t-statistic follows approximately a standard normal distribution under the null, yielding a two-sided p-value. With <span class="math inline">\(M\)</span> variants tested (typically <span class="math inline">\(10^6\)</span> to <span class="math inline">\(10^7\)</span> after imputation), multiple comparison correction is essential. The conventional <strong>genome-wide significance threshold</strong> of <span class="math inline">\(5 \times 10^{-8}\)</span> approximates a Bonferroni correction for roughly one million effectively independent tests, accounting for correlation among variants due to linkage disequilibrium <span class="citation" data-cites="risch_future_1996 peer_estimation_2008">(<a href="../bib/references.html#ref-risch_future_1996" role="doc-biblioref">Risch and Merikangas 1996</a>; <a href="../bib/references.html#ref-peer_estimation_2008" role="doc-biblioref">Pe’er et al. 2008</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Multiple Testing Correction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Multiple Testing Correction
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> Testing millions of variants creates a massive multiple testing problem:</p>
<p><strong>The problem:</strong> If you test 1 million variants at <span class="math inline">\(\alpha = 0.05\)</span>, you expect 50,000 false positives by chance alone. GWAS must distinguish true signals from this noise.</p>
<p><strong>Bonferroni correction:</strong> Divide <span class="math inline">\(\alpha\)</span> by the number of tests. For 1 million tests: <span class="math inline">\(0.05 / 1{,}000{,}000 = 5 \times 10^{-8}\)</span>. This threshold has become the conventional genome-wide significance cutoff.</p>
<p><strong>Why it works:</strong> Variants in linkage disequilibrium are correlated, so there are roughly 1 million <em>effectively independent</em> tests even when testing 10 million variants. The <span class="math inline">\(5 \times 10^{-8}\)</span> threshold controls the family-wise error rate (FWER)—the probability of any false positive.</p>
<p><strong>Consequences for ML:</strong></p>
<ul>
<li>GWAS hits represent extremely strong statistical signals (typically hundreds or thousands of samples carry each risk allele)</li>
<li>Marginal effects (variants that contribute but don’t reach significance) are systematically excluded</li>
<li>Polygenic scores must handle the millions of “sub-threshold” variants that collectively explain substantial heritability</li>
</ul>
</div>
</div>
</section>
<section id="sec-ch03-logistic-models" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="sec-ch03-logistic-models"><span class="header-section-number">3.1.2</span> Association Models for Disease Outcomes</h3>
<p>Binary outcomes create a specific statistical problem that, if ignored, systematically distorts effect size estimates in ways that compound through downstream applications. When the phenotype is disease status (affected or unaffected), linear regression produces nonsensical predictions: fitted values outside the 0-1 probability range and residuals that violate normality assumptions. The consequence extends beyond statistical inelegance. Effect sizes estimated under the wrong model propagate into polygenic scores and risk prediction, potentially misclassifying patients who sit near clinical decision thresholds where intervention recommendations change.</p>
<p>For binary phenotypes, <strong>logistic regression</strong> replaces linear regression. The model relates genotype to the log-odds of disease:</p>
<p><span class="math display">\[
\log \frac{P(y_i = 1)}{P(y_i = 0)} = \alpha + \beta_j g_{ij} + \gamma^\top c_i
\]</span></p>
<p>Here <span class="math inline">\(\beta_j\)</span> is the log-odds ratio per allele, and <span class="math inline">\(\exp(\beta_j)\)</span> gives the <strong>odds ratio (OR)</strong>. An odds ratio of <span class="math inline">\(1.2\)</span> means that each additional copy of the alternative allele increases the odds of disease by <span class="math inline">\(20\%\)</span>. For rare diseases (prevalence below approximately <span class="math inline">\(10\%\)</span>), odds ratios approximate relative risks, but the distinction matters for common conditions and when communicating absolute risk to patients.</p>
<p>Case-control sampling, in which cases are enriched relative to their population frequency, distorts absolute risk estimates but preserves the validity of odds ratio estimation. This mathematical property explains why GWAS conducted in case-control designs can still produce effect sizes useful for polygenic scores, provided downstream applications account for baseline disease incidence. The likelihood function conditions on disease status, making the odds ratio identifiable regardless of sampling scheme.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a GWAS for type 2 diabetes with 10,000 cases and 10,000 controls, when the true population prevalence is only 8%. If you compute the raw proportion of cases in the study (50%), this clearly misrepresents population risk. Why does the odds ratio remain valid despite this artificial enrichment of cases? What would happen if you tried to convert this odds ratio to absolute risk without accounting for the sampling design?</p>
</div>
</div>
</section>
<section id="sec-ch03-visualization" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="sec-ch03-visualization"><span class="header-section-number">3.1.3</span> Manhattan Plots and Q-Q Plots</h3>
<p>The <strong>Manhattan plot</strong> has become the iconic visualization of GWAS results, named for its resemblance to the New York City skyline. Each point represents a tested variant, with genomic position along the x-axis (ordered by chromosome) and negative log-transformed p-value on the y-axis. Variants with stronger associations rise higher; those exceeding the genome-wide significance threshold of <span class="math inline">\(5 \times 10^{-8}\)</span> (typically drawn as a horizontal line at <span class="math inline">\(-\log_{10}(5 \times 10^{-8}) \approx 7.3\)</span>) are considered significant hits.</p>
<p>The Manhattan plot reveals both the successes and limitations of GWAS at a glance. Prominent peaks indicate genomic regions harboring trait-associated variants, but each peak typically contains dozens or hundreds of correlated variants rather than a single causal nucleotide. The width of peaks reflects local linkage disequilibrium structure: broader peaks indicate regions where many variants are correlated with the lead signal. The height reflects statistical strength, which depends on effect size, allele frequency, and sample size. Tall, narrow peaks suggest strong, well-localized signals; broad peaks spanning megabases indicate that fine-mapping will be challenging.</p>
<p>Quantile-quantile (Q-Q) plots complement Manhattan plots by assessing whether the observed p-value distribution matches theoretical expectations under the null hypothesis. Systematic deviation from the diagonal (genomic inflation) suggests either true polygenic signal or residual confounding from population structure. The genomic inflation factor <em>λ</em> quantifies this deviation, with values substantially above 1.0 warranting investigation of potential confounders.</p>
<div id="fig-manhattan-anatomy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-manhattan-anatomy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/01-fig-manhattan-anatomy.svg" class="img-fluid figure-img"></p>
<figcaption>Annotated Manhattan plot from genome-wide association study</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-manhattan-anatomy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Anatomy of a Manhattan plot from genome-wide association study. Each point represents a tested genetic variant, with genomic position along the x-axis (chromosomes color-alternated) and statistical significance (-log10 p-value) on the y-axis. The horizontal dashed line marks the genome-wide significance threshold (P = 5 x 10<sup>-8</sup>). Prominent peaks identify associated loci, but each peak typically contains dozens to hundreds of correlated variants in linkage disequilibrium (LD) rather than a single causal nucleotide. The width of peaks reflects local LD structure. Inset: quantile-quantile (Q-Q) plot comparing observed to expected p-value distributions, with genomic inflation factor (lambda) indicating adequate control of population stratification when near 1.0.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch03-population-structure" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="sec-ch03-population-structure"><span class="header-section-number">3.1.4</span> Population Structure Control</h3>
<p>Population structure poses a fundamental challenge to GWAS interpretation because it can generate association signals indistinguishable from true biological effects. If allele frequencies differ systematically across subpopulations and the phenotype also varies across these groups for non-genetic reasons (differences in environment, diet, healthcare access, socioeconomic status), naive association testing will detect variants that mark ancestry rather than causal biology. A variant that is simply more common in one population will appear associated with any trait that differs between populations, regardless of biological mechanism. The resulting false positives waste resources on follow-up studies and, more insidiously, can embed ancestry-related confounding into polygenic scores that are then deployed as if they measured pure genetic risk.</p>
<p><strong>Principal component analysis (PCA)</strong> on the genotype matrix captures the major axes of genetic variation across individuals <span class="citation" data-cites="price_pca_2006 patterson_population_2006">(<a href="../bib/references.html#ref-price_pca_2006" role="doc-biblioref">Price et al. 2006</a>; <a href="../bib/references.html#ref-patterson_population_2006" role="doc-biblioref">Patterson, Price, and Reich 2006</a>)</span>. The leading principal components often correspond to continental ancestry gradients or finer-scale population structure within a study. PCA works for population structure correction because it exploits a fundamental property of population genetics: allele frequency differences between populations accumulate across thousands of variants in correlated patterns. A variant that is 5% more common in one population is likely to have neighbors that show similar frequency differences, and this genome-wide correlation structure is exactly what PCA captures. By including the top principal components as covariates, the regression model can distinguish true genetic associations (where the variant itself affects the trait) from population stratification artifacts (where the variant merely tags ancestry). Including these PCs as covariates in the regression model attenuates spurious associations driven by ancestry stratification.</p>
<p>This correction is imperfect. Subtle structure not captured by the included PCs, cryptic relatedness among individuals, and the interweaving of genetic ancestry with environmental exposures all complicate interpretation. The challenges extend far beyond technical statistical adjustment: ancestry is entangled with healthcare access, environmental exposures, and socioeconomic factors in ways that simple covariate correction cannot fully resolve. These issues become critical when translating GWAS results to clinical applications and when evaluating whether polygenic scores perform equitably across populations. The full complexity of ancestry as a confounder is addressed in <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Population structure control is a statistical partial fix for a deeper problem. PCA covariates remove associations driven purely by ancestry, but they cannot disentangle genetic effects from environmental factors that correlate with ancestry. A variant associated with a trait after PCA adjustment may still reflect gene-environment correlation rather than direct biological causation.</p>
</div>
</div>
</section>
</section>
<section id="sec-ch03-heritability" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-ch03-heritability"><span class="header-section-number">3.2</span> Heritability: What Genetics Can Explain</h2>
<p>Before GWAS can identify specific variants, a more fundamental question must be answered: how much of the variation in a trait is attributable to genetics at all? A trait entirely determined by environment would yield no GWAS hits regardless of sample size. A trait entirely determined by genetics would, in principle, be fully predictable from genotype. <strong>Heritability</strong> quantifies where traits fall along this spectrum, but the concept is more subtle than it first appears, and different estimation methods yield systematically different answers.</p>
<div id="fig-heritability-decomposition" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heritability-decomposition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/02-fig-heritability-decomposition.svg" class="img-fluid figure-img"></p>
<figcaption>Decomposition of phenotypic variance showing heritability components</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heritability-decomposition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Decomposition of phenotypic variance for a highly heritable trait (height). The outermost ring represents total phenotypic variance. The first partition separates genetic (blue, ~80%) from environmental (green, ~20%) contributions. Within the genetic component, additive effects (narrow-sense heritability) dominate over non-additive effects (dominance, epistasis). Within additive heritability, SNP-heritability (~50-60% for height) represents variance captured by common variants on genotyping arrays, while the remainder reflects ‘missing heritability’: rare variants, structural variants, and imperfect tagging of causal alleles. This nested structure explains why GWAS-significant hits explain only a fraction of trait heritability and why polygenic scores built on common variants face a performance ceiling.
</figcaption>
</figure>
</div>
<section id="sec-ch03-pedigree-heritability" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-ch03-pedigree-heritability"><span class="header-section-number">3.2.1</span> Pedigree Heritability</h3>
<p>Classical genetics estimated heritability by comparing phenotypic similarity among relatives. Identical twins share all their genetic variation; fraternal twins share on average half; full siblings also share half; parents and offspring share half; cousins share one-eighth. If genetic variation influences a trait, closer relatives should be more similar. The correlation structure across relationship types allows partitioning of phenotypic variance into genetic and environmental components.</p>
<p><strong>Narrow-sense heritability</strong> (<span class="math inline">\(h^2\)</span>) represents the proportion of phenotypic variance attributable to additive genetic effects. For height, pedigree studies consistently estimate <span class="math inline">\(h^2\)</span> around <span class="math inline">\(0.80\)</span>, meaning that <span class="math inline">\(80\%\)</span> of the variation in height across individuals in the studied population can be attributed to genetic differences <span class="citation" data-cites="visscher_heritability_2008">(<a href="../bib/references.html#ref-visscher_heritability_2008" role="doc-biblioref">Visscher, Hill, and Wray 2008</a>)</span>. For schizophrenia, twin studies estimate <span class="math inline">\(h^2\)</span> around <span class="math inline">\(0.80\)</span> as well <span class="citation" data-cites="hilker_heritability_2018">(<a href="../bib/references.html#ref-hilker_heritability_2018" role="doc-biblioref">Hilker et al. 2018</a>)</span>. For body mass index, estimates cluster around <span class="math inline">\(0.50\)</span> to <span class="math inline">\(0.80\)</span> depending on the population, age group, and study design <span class="citation" data-cites="elks_variability_2012">(<a href="../bib/references.html#ref-elks_variability_2012" role="doc-biblioref">Elks et al. 2012</a>)</span>.</p>
<p>These high heritability estimates established that genetics substantially influences most traits of biomedical interest, motivating the search for specific causal variants. If 80% of height variation is genetic, then genetic variants collectively must explain most of that variation. Finding those variants became the goal of GWAS.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A twin study finds that identical twins have a correlation of 0.90 for height, while fraternal twins have a correlation of 0.45. Using the classical formula <span class="math inline">\(h^2 = 2 \times (r_{MZ} - r_{DZ})\)</span>, what is the estimated heritability? Does this match the published estimates mentioned above? What assumptions does this calculation make about shared versus non-shared environmental influences?</p>
</div>
</div>
</section>
<section id="sec-ch03-snp-heritability" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-ch03-snp-heritability"><span class="header-section-number">3.2.2</span> SNP-Heritability and the Missing Heritability Problem</h3>
<p>GWAS delivered a puzzle. For height, even the largest studies with hundreds of significant hits explained only a fraction of the heritability estimated from family studies. Early GWAS collectively explained perhaps 5% of height variance when pedigree studies suggested 80% should be genetic. This gap, termed <strong>missing heritability</strong>, sparked intense debate about where the remaining genetic variance might hide <span class="citation" data-cites="manolio_finding_2009">(<a href="../bib/references.html#ref-manolio_finding_2009" role="doc-biblioref">Manolio et al. 2009</a>)</span>.</p>
<p>The concept of <strong>SNP-heritability</strong> (<span class="math inline">\(h^2_{\mathrm{SNP}}\)</span>) emerged to parse this puzzle into more tractable components. Rather than asking how much variance is explained by genome-wide significant variants, researchers asked how much variance is explained by all common SNPs on genotyping arrays, including those that fail to reach significance. Methods such as GCTA-GREML estimate this quantity by modeling phenotypic similarity as a function of genetic similarity computed across all SNPs <span class="citation" data-cites="yang_common_2010">(<a href="../bib/references.html#ref-yang_common_2010" role="doc-biblioref">Yang et al. 2010</a>)</span>. For height, SNP-heritability estimates reach approximately <span class="math inline">\(0.50\)</span> to <span class="math inline">\(0.60\)</span>, substantially higher than variance explained by significant hits alone but still below pedigree estimates.</p>
<p>This intermediate value revealed that missing heritability actually comprises two distinct gaps. The first gap separates SNP-heritability from variance explained by GWAS-significant variants. This <strong>polygenic gap</strong> reflects the architecture of complex traits: thousands of variants each contribute effects too small to reach genome-wide significance individually, yet they collectively explain substantial variance when modeled together. As sample sizes grow and more variants cross the significance threshold, this gap narrows. The polygenic gap is not truly “missing” heritability; the variance is captured by common SNPs, just distributed across too many variants to detect individually.</p>
<p>The second gap separates pedigree heritability from SNP-heritability. This <strong>hidden heritability</strong> reflects genetic variation genuinely absent from common SNP arrays: rare variants below minor allele frequency thresholds, structural variants poorly tagged by single nucleotide polymorphisms, copy number variations, and variants not in linkage disequilibrium with array content. Unlike the polygenic gap, this component cannot be recovered by increasing GWAS sample size; it requires different data types entirely, such as whole-genome sequencing that captures rare variation directly.</p>
<p>The distinction matters for how foundation models might contribute. Models trained on common variant data inherit the SNP-heritability ceiling; they cannot learn patterns from variation they never observe. Integrating rare variant data, structural variant calls, or multi-omic measurements represents not merely incremental improvement but access to a fundamentally different component of genetic architecture.</p>
<p>The following table summarizes how different heritability concepts relate to each other and to GWAS capabilities:</p>
<div id="tbl-heritability-components" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-heritability-components-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Heritability decomposition for height, illustrating the nested structure of genetic variance.
</figcaption>
<div aria-describedby="tbl-heritability-components-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Heritability Concept</th>
<th>Definition</th>
<th>Typical Value (Height)</th>
<th>What It Captures</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pedigree (<span class="math inline">\(h^2\)</span>)</td>
<td>Phenotypic variance explained by all genetic factors</td>
<td>~0.80</td>
<td>Upper bound from family resemblance</td>
</tr>
<tr class="even">
<td>SNP-heritability (<span class="math inline">\(h^2_{SNP}\)</span>)</td>
<td>Variance explained by common array SNPs</td>
<td>~0.50-0.60</td>
<td>What GWAS can potentially capture</td>
</tr>
<tr class="odd">
<td>Explained by GWAS hits</td>
<td>Variance from genome-wide significant variants</td>
<td>~0.25 (and rising)</td>
<td>What GWAS has actually found</td>
</tr>
<tr class="even">
<td>Polygenic gap</td>
<td><span class="math inline">\(h^2_{SNP}\)</span> minus GWAS-explained</td>
<td>~0.25-0.35</td>
<td>Discoverable with larger samples</td>
</tr>
<tr class="odd">
<td>Hidden heritability</td>
<td><span class="math inline">\(h^2\)</span> minus <span class="math inline">\(h^2_{SNP}\)</span></td>
<td>~0.20-0.30</td>
<td>Requires new data types (rare variants, SVs)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="sec-ch03-heritability-implications" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-ch03-heritability-implications"><span class="header-section-number">3.2.3</span> Implications for GWAS and Polygenic Scores</h3>
<p>The heritability landscape carries practical implications for what GWAS and polygenic scores can achieve. SNP-heritability sets an upper bound on the predictive accuracy of polygenic scores built from common variants: a PGS cannot explain more variance than is captured by the SNPs it uses. For height, with SNP-heritability around 0.50, the best possible common-variant PGS could explain at most half of phenotypic variance. Current PGS for height in European-ancestry populations approach this bound, explaining roughly 25% of variance with continued gains as sample sizes grow <span class="citation" data-cites="yengo_meta-analysis_2022">(<a href="../bib/references.html#ref-yengo_meta-analysis_2022" role="doc-biblioref">Yengo et al. 2022</a>)</span>.</p>
<p>For diseases, the relationship between heritability and predictive accuracy is more complex. A highly heritable disease might have low predictive accuracy if the causal variants are rare, if gene-environment interactions dominate, or if the heritability is distributed across thousands of variants each with tiny effects. Conversely, a moderately heritable disease with a few common variants of large effect might be more predictable. The architecture of genetic effects matters as much as total heritability.</p>
<p>Missing heritability also motivates the integration of rare variant analysis with GWAS of common variants. Whole-genome sequencing studies can capture rare variants invisible to genotyping arrays, potentially recovering some of the genetic variance missing from common-variant analyses. Foundation models trained on sequence data, rather than genotype arrays, may ultimately capture genetic effects across the full allele frequency spectrum, a possibility explored in <a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>.</p>
</section>
</section>
<section id="sec-ch03-ld" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-ch03-ld"><span class="header-section-number">3.3</span> Linkage Disequilibrium and the Association-Causation Gap</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Imagine you are conducting a GWAS and find that variant A shows a strong association with heart disease (p &lt; 10<sup>-20</sup>). You check and find that variant A is in strong linkage disequilibrium (r<sup>2</sup> = 0.95) with nearby variant B. Based on the GWAS result alone, can you determine which variant, if either, is causal? What additional information would you need?</p>
</div>
</div>
<p>GWAS test variants one at a time, but the genome is not inherited one variant at a time. Nearby variants travel together on haplotypes and are co-inherited across generations except when recombination separates them. This correlation structure, known as <strong>linkage disequilibrium (LD)</strong>, is both essential to GWAS power and the source of their fundamental interpretive limitation. Without LD, GWAS would need to genotype every variant in the genome directly; with LD, statistical association cannot distinguish cause from correlation.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Linkage Disequilibrium">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Linkage Disequilibrium
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For ML readers:</strong> Linkage disequilibrium (LD) is the non-random association of alleles at different genomic positions:</p>
<p><strong>Why it exists:</strong> During meiosis, chromosomes are inherited in large blocks. Variants that are physically close tend to be inherited together because recombination events between them are rare. Over many generations, recombination gradually breaks down these correlations.</p>
<p><strong>Measuring LD:</strong> The most common metric is <span class="math inline">\(r^2\)</span>, the squared correlation between allele counts at two positions:</p>
<ul>
<li><span class="math inline">\(r^2 = 1.0\)</span>: Perfect correlation (variants always inherited together)</li>
<li><span class="math inline">\(r^2 = 0.5\)</span>: Moderate correlation</li>
<li><span class="math inline">\(r^2 = 0\)</span>: No correlation (variants segregate independently)</li>
</ul>
<p><strong>LD decay:</strong> Correlation decreases with physical distance. In European populations, LD typically extends 10-100 kb; in African populations, LD decays faster due to older population history and more accumulated recombination events.</p>
<p><strong>Implications for genomics:</strong></p>
<ul>
<li><em>GWAS power</em>: A genotyping array with 1 million variants can “tag” most common variation because ungenotyped variants are correlated with genotyped ones</li>
<li><em>Causal ambiguity</em>: When variant A associates with disease, any variant B in high LD with A will also show association—GWAS cannot distinguish which is causal</li>
<li><em>Population specificity</em>: LD patterns differ across populations, causing polygenic scores to transfer poorly</li>
</ul>
</div>
</div>
<p>When a GWAS identifies a significant association at variant <em>j</em>, three possibilities exist. The variant itself may be causal, directly influencing the phenotype through some molecular mechanism. Alternatively, variant <em>j</em> may simply be correlated with a nearby causal variant <span class="math inline">\(k\)</span> due to LD, with the association signal reflecting this correlation rather than direct causation. In complex regions, multiple causal variants may exist, and the observed association pattern reflects their joint effects filtered through the local LD structure. Distinguishing these scenarios from GWAS summary statistics alone is often impossible. The causal variant and its tag look identical in the association data, yet only the causal variant represents a valid drug target or mechanistic insight.</p>
<p>Fine-mapping methods attempt to resolve this ambiguity by modeling LD structure explicitly. Reference panels from the 1000 Genomes Project (<a href="p1-ch02-data.html#sec-ch02-1000genomes" class="quarto-xref"><span>Section 2.2.2</span></a>) and gnomAD (<a href="p1-ch02-data.html#sec-ch02-gnomad" class="quarto-xref"><span>Section 2.2.3</span></a>) enable LD calculation across diverse populations, providing the correlation matrices these methods require. Statistical fine-mapping narrows the set of plausible causal variants but often cannot identify a single culprit. Incorporating functional priors from regulatory models and variant effect predictors can further prioritize candidates; this integration of foundation model representations into fine-mapping is examined in <span class="quarto-unresolved-ref">?sec-ch14-fm-paradigm</span>.</p>
<div id="fig-ld-tag-causal" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ld-tag-causal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/03-A-fig-ld-tag-causal.svg" class="img-fluid figure-img"></p>
<figcaption>Haplotype structure showing how nearby variants co-segregate</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/03-B-fig-ld-tag-causal.svg" class="img-fluid figure-img"></p>
<figcaption>LD matrix displaying pairwise correlations across a genomic region</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/03-C-fig-ld-tag-causal.svg" class="img-fluid figure-img"></p>
<figcaption>Population-specific LD patterns affecting PGS portability</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ld-tag-causal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Linkage disequilibrium and the distinction between causal and tag variants. (A) Haplotype structure showing how nearby variants co-segregate on ancestral chromosome segments. The causal variant (star) is statistically correlated with neighboring tag variants, making them indistinguishable in GWAS. (B) LD matrix displaying pairwise correlations (r<sup>2</sup>) across a genomic region, revealing block structure where many variants within blocks show high correlation. (C) Population-specific LD patterns: the same causal variant shows different correlation structures in populations with different demographic histories, explaining why polygenic scores derived in one population transfer poorly to others with different LD patterns.
</figcaption>
</figure>
</div>
<section id="sec-ch03-ld-structure" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-ch03-ld-structure"><span class="header-section-number">3.3.1</span> Structure of Linkage Disequilibrium</h3>
<p>Understanding why LD creates interpretive ambiguity requires understanding how LD arises and decays. Recombination during meiosis shuffles genetic material between parental chromosomes, with crossover events occurring at an average rate of roughly one per 100 megabases, meaning each chromosome arm typically experiences only one or two exchanges per generation. Over many generations, recombination breaks down long-range correlations between variants while preserving short-range structure. The timescale of this decay matters: LD between variants separated by a few kilobases persists for thousands of generations, while correlations spanning megabases decay within tens of generations. The result is a mosaic pattern: regions of high LD (haplotype blocks) where many variants are strongly correlated, interspersed with recombination hotspots where LD decays rapidly.</p>
<p>Recombination does not occur uniformly across the genome. Crossover hotspots, typically spanning 1 to 2 kilobases, concentrate the majority of recombination events into a small fraction of genomic sequence. These hotspots are enriched for specific sequence motifs recognized by the zinc finger protein PRDM9, which directs the recombination machinery to particular locations. The consequence is that haplotype blocks can extend for hundreds of kilobases across regions lacking hotspots, while adjacent blocks may be separated by sharp boundaries where recombination has effectively randomized allelic associations.</p>
<p>The squared correlation coefficient <span class="math inline">\(r^2\)</span> quantifies LD between pairs of variants. Unlike Pearson correlation, which measures linear relationships between continuous variables, <span class="math inline">\(r^2\)</span> for LD is computed from allele frequencies and haplotype counts in a <span class="math inline">\(2\times 2\)</span> contingency table. The metric equals <span class="math inline">\((p_{AB} - p_A p_B)^2 / (p_A p_a p_B p_b)\)</span>, where <span class="math inline">\(p_{AB}\)</span> is the frequency of the AB haplotype and <span class="math inline">\(p_A\)</span>, <span class="math inline">\(p_a\)</span>, <span class="math inline">\(p_B\)</span>, <span class="math inline">\(p_b\)</span> are the individual allele frequencies. This formulation captures the deviation from random association expected under linkage equilibrium. The notation unfortunately overlaps with the coefficient of determination from linear regression, but the quantities measure different phenomena: regression <span class="math inline">\(R^2\)</span> captures variance explained by a fitted model, while LD <span class="math inline">\(r^2\)</span> captures non-random association between alleles at two loci. When <span class="math inline">\(r^2\)</span> approaches <span class="math inline">\(1\)</span>, the two variants are nearly always observed together on the same haplotypes; when <span class="math inline">\(r^2\)</span> approaches <span class="math inline">\(0\)</span>, they segregate independently. From a GWAS perspective, if a causal variant <span class="math inline">\(k\)</span> has strong association with the phenotype and variant <span class="math inline">\(j\)</span> is in high LD with <span class="math inline">\(k\)</span> (high <span class="math inline">\(r^2\)</span>), then variant <span class="math inline">\(j\)</span> will also show strong association even if it has no direct causal role. The statistical signal propagates through LD, creating ambiguity about which variant is actually functional.</p>
<p>LD patterns vary across populations because demographic history shapes which haplotypes persist and at what frequencies. Founder effects occur when a small number of individuals establish a new population, carrying only a subset of the ancestral haplotype diversity. The Finnish population, descended from a small founder group roughly 4,000 years ago, exhibits extended LD blocks and elevated frequencies of otherwise rare disease alleles. Bottlenecks produce similar effects: dramatic population contractions eliminate rare haplotypes and reduce diversity, leaving survivors with correlated genetic backgrounds. In contrast, large stable populations accumulate recombination events over many generations, breaking down LD more completely. A variant that tags a causal allele effectively in one population may be a poor proxy in another where different recombination history has decoupled the correlation. This population-specificity of LD structure is one reason polygenic scores fail to transfer across ancestries, a problem examined in detail in <a href="#sec-ch03-portability" class="quarto-xref"><span>Section 3.7</span></a>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>LD is both the foundation and the limitation of GWAS. It enables discovery by allowing a limited set of genotyped variants to capture signals from ungenotyped causal variants. But it prevents identification of specific causal variants because the statistical signal cannot distinguish cause from correlation. This tension is fundamental and cannot be resolved by larger sample sizes alone.</p>
</div>
</div>
</section>
<section id="sec-ch03-causal-vs-tag" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="sec-ch03-causal-vs-tag"><span class="header-section-number">3.3.2</span> Causal Variants, Tag Variants, and GWAS Catalogs</h3>
<p>The distinction between causal and tag variants determines whether GWAS results can translate into biological insight or clinical action. A <strong>causal variant</strong> directly influences the phenotype, whether by altering protein sequence, disrupting transcription factor binding, affecting splicing, or modifying chromatin state. A <strong>tag variant</strong> is merely correlated with a causal variant through LD, serving as a statistical proxy without direct functional consequence. The distinction is invisible to GWAS: both produce association signals, and in the presence of strong LD, those signals are statistically indistinguishable.</p>
<p>GWAS catalogs therefore report associated loci, not causal variants. The “lead SNP” at each locus (the variant with the smallest p-value) is often a tag rather than the causal variant, particularly when the causal variant is rare, poorly genotyped, or not present on the array. Even when a locus is robustly associated, dozens or hundreds of correlated variants may be statistically indistinguishable from the lead SNP.</p>
<p>This limitation has concrete practical consequences. Drug development requires identifying causal genes and mechanisms, not just associated regions; targeting a tag variant or the wrong gene wastes years of development effort. Clinical variant interpretation needs to distinguish functional mutations from neutral passengers; reporting a tag as pathogenic misleads patients and clinicians. Polygenic scores built on tag SNPs may lose power when applied to populations with different LD patterns, since the tag-causal correlation that made the tag useful may not hold. The gap between association and causation motivates the fine-mapping approaches considered next.</p>
</section>
</section>
<section id="sec-ch03-fine-mapping" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sec-ch03-fine-mapping"><span class="header-section-number">3.4</span> Fine-Mapping: From Loci to Causal Variants</h2>
<p>A pharmaceutical company evaluating a GWAS hit for drug development faces a concrete problem: the associated locus spans 500 kilobases, contains 200 correlated variants, and overlaps three genes. Which gene should they target? Which variant drives the association? Investing hundreds of millions of dollars in a program targeting the wrong gene would be catastrophic, yet GWAS summary statistics alone cannot resolve the ambiguity. <strong>Fine-mapping</strong> attempts to address this gap, moving from “this region is associated” to “these specific variants are most likely causal” by exploiting the joint behavior of correlated variants under explicit statistical models.</p>
<section id="sec-ch03-fine-mapping-stats" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="sec-ch03-fine-mapping-stats"><span class="header-section-number">3.4.1</span> Statistical Framework</h3>
<p>The core insight of fine-mapping is that while multiple variants may show similar marginal association statistics, their joint behavior under a model that accounts for LD can discriminate among them. A causal variant should show association beyond what can be explained by LD with its neighbors; a tag variant should not. This distinction, invisible when variants are tested one at a time, becomes apparent when their correlations are modeled jointly.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Mathematical Detail">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Detail
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section presents the Bayesian framework for fine-mapping. The key intuition is that we compare how well different “causal configurations” (which variants are assumed causal) explain the observed data. Variants that consistently appear in high-probability configurations are more likely to be causal.</p>
</div>
</div>
<p>Bayesian fine-mapping methods approach the problem by specifying a prior distribution over which variants in a region might be causal, then computing posterior probabilities given the observed association statistics and local LD structure <span class="citation" data-cites="maller_bayesian_2012 hormozdiari_identifying_2014">(<a href="../bib/references.html#ref-maller_bayesian_2012" role="doc-biblioref">Maller et al. 2012</a>; <a href="../bib/references.html#ref-hormozdiari_identifying_2014" role="doc-biblioref">Hormozdiari et al. 2014</a>)</span>. The key outputs are <strong>posterior inclusion probabilities (PIPs)</strong>, which estimate the probability that each variant is among the causal set, and <strong>credible sets</strong>, which are minimal sets of variants that contain the true causal variant(s) with specified probability (commonly 95%).</p>
<p>The mathematical foundation rests on comparing models that differ in which variants are causal. Consider a region containing <span class="math inline">\(m\)</span> variants, and let <span class="math inline">\(\gamma\)</span> denote a configuration specifying which variants are causal (a binary vector of length <span class="math inline">\(m\)</span>). Under a linear model, the observed GWAS summary statistics (effect estimates <span class="math inline">\(\hat{\beta}\)</span> and their standard errors) follow a multivariate normal distribution whose mean depends on the true causal effects and whose covariance depends on the LD matrix <span class="math inline">\(\Sigma\)</span>. The LD matrix enters the likelihood because correlated variants produce correlated effect estimates: if variants A and B are in high LD, then when the causal variant is A, variant B will also show a strong effect estimate simply because individuals carrying A tend to carry B. The statistical model must account for this correlation structure to determine which configuration of causal variants best explains the observed pattern of associations. The likelihood of observing the data under configuration <span class="math inline">\(\gamma\)</span> can be written as:</p>
<p><span class="math display">\[P(\hat{\beta} \mid \gamma, \Sigma) = \int P(\hat{\beta} \mid \beta_\gamma, \Sigma) \, P(\beta_\gamma) \, d\beta_\gamma\]</span></p>
<p>where <span class="math inline">\(\beta_\gamma\)</span> represents the true effect sizes for causal variants in configuration <span class="math inline">\(\gamma\)</span>, and <span class="math inline">\(P(\beta_\gamma)\)</span> is the prior on effect sizes (typically Gaussian with variance <span class="math inline">\(\sigma^2\)</span>) <span class="citation" data-cites="benner_finemap_2016">(<a href="../bib/references.html#ref-benner_finemap_2016" role="doc-biblioref">Benner et al. 2016</a>)</span>. This integral has a closed-form solution when both the likelihood and prior are Gaussian, yielding a Bayes factor comparing each configuration to the null model of no associations.</p>
<p>The posterior probability of configuration <span class="math inline">\(\gamma\)</span> follows from Bayes’ theorem:</p>
<p><span class="math display">\[P(\gamma \mid \hat{\beta}, \Sigma) = \frac{P(\hat{\beta} \mid \gamma, \Sigma) \, P(\gamma)}{\sum_{\gamma'} P(\hat{\beta} \mid \gamma', \Sigma) \, P(\gamma')}\]</span></p>
<p>The prior <span class="math inline">\(P(\gamma)\)</span> encodes assumptions about the number and distribution of causal variants. Common choices include a fixed maximum number of causal variants <span class="math inline">\(K\)</span> (often 1 to 5) with uniform probability across configurations of equal size, or a binomial prior where each variant has independent probability <span class="math inline">\(\pi\)</span> of being causal <span class="citation" data-cites="wang_simple_2020">(<a href="../bib/references.html#ref-wang_simple_2020" role="doc-biblioref">Wang et al. 2020</a>)</span>. The denominator sums over all possible configurations, a computation that becomes intractable for large regions (with <span class="math inline">\(m\)</span> variants and up to <span class="math inline">\(K\)</span> causal variants, the number of configurations scales as <span class="math inline">\(C(m, K)\)</span>).</p>
<p>The posterior inclusion probability for variant <span class="math inline">\(j\)</span> marginalizes over all configurations in which that variant appears:</p>
<p><span class="math display">\[\text{PIP}_j = \sum_{\gamma : j \in \gamma} P(\gamma \mid \hat{\beta}, \Sigma)\]</span></p>
<p>This quantity answers the question: given everything we observed, what is the probability that variant <span class="math inline">\(j\)</span> is among the causal variants? Methods like <em>FINEMAP</em>, <em>CAVIAR</em>, and <em>SuSiE</em> differ primarily in how they approximate the intractable sum over configurations and in their prior specifications, but all produce PIPs as their primary output <span class="citation" data-cites="benner_finemap_2016 hormozdiari_identifying_2014 wang_simple_2020">(<a href="../bib/references.html#ref-benner_finemap_2016" role="doc-biblioref">Benner et al. 2016</a>; <a href="../bib/references.html#ref-hormozdiari_identifying_2014" role="doc-biblioref">Hormozdiari et al. 2014</a>; <a href="../bib/references.html#ref-wang_simple_2020" role="doc-biblioref">Wang et al. 2020</a>)</span>.</p>
<p>Credible sets provide a complementary summary. A 95% credible set is the smallest set of variants whose cumulative PIP exceeds 0.95. When a single variant dominates (PIP above 0.95), the credible set contains only that variant. When LD distributes probability across many variants, credible sets expand accordingly. The <em>SuSiE</em> method produces one credible set per inferred causal signal, enabling regions with multiple independent associations to be decomposed into distinct sets <span class="citation" data-cites="wang_simple_2020">(<a href="../bib/references.html#ref-wang_simple_2020" role="doc-biblioref">Wang et al. 2020</a>)</span>.</p>
<p>Variants with high PIPs (above 0.5 or 0.9) are strong candidates for functional follow-up. Credible sets that contain few variants are more actionable than those containing dozens. The width of credible sets reflects both the strength of the association signal and the local LD structure: tight LD means many variants remain plausible even with strong statistical evidence. In some regions, fine-mapping narrows thousands of candidates to a handful; in others, the ambiguity remains irreducible given available data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A fine-mapping analysis reports that variant X has PIP = 0.35 and variant Y has PIP = 0.30, with X and Y in strong LD (r<sup>2</sup> = 0.92). The 95% credible set contains 5 variants including both X and Y. What can you conclude about whether X or Y is causal? What would make you more confident in one over the other?</p>
</div>
</div>
</section>
<section id="sec-ch03-functional-priors" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="sec-ch03-functional-priors"><span class="header-section-number">3.4.2</span> Functional Annotation Priors</h3>
<p>Statistical fine-mapping alone cannot resolve regions where multiple variants are in near-perfect LD; the data simply cannot distinguish variants that are always co-inherited. Functional annotations offer a path forward by incorporating biological plausibility: not all genomic positions are equally likely to harbor causal variants. Variants disrupting coding sequences, altering transcription factor binding sites, or falling within active enhancers carry higher prior probability of functional relevance than variants in unannotated intergenic regions.</p>
<p>Annotation-informed approaches update fine-mapping priors based on these external data sources. Variants in coding regions, promoters, enhancers, or regions of evolutionary constraint may be assigned higher prior probability of causality. Integration with chromatin accessibility data (from ATAC-seq or DNase-seq), transcription factor binding maps (from ChIP-seq), or expression quantitative trait loci (eQTL) can further prioritize variants with plausible regulatory mechanisms.</p>
<p>The functional scores introduced in <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> provide systematic frameworks for quantifying variant-level annotations. Scores such as <em>CADD</em>, <em>DANN</em>, and <em>Eigen</em> integrate diverse genomic features into single numbers that can inform fine-mapping priors <span class="citation" data-cites="kircher_general_2014 quang_dann_2015 ionita-laza_spectral_2016">(<a href="../bib/references.html#ref-kircher_general_2014" role="doc-biblioref">Kircher et al. 2014</a>; <a href="../bib/references.html#ref-quang_dann_2015" role="doc-biblioref">Quang, Chen, and Xie 2015</a>; <a href="../bib/references.html#ref-ionita-laza_spectral_2016" role="doc-biblioref">Ionita-Laza et al. 2016</a>)</span>. More recently, foundation models trained on genomic sequence have produced variant effect predictions that capture functional information beyond what traditional annotations provide (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>). These scores transform fine-mapping from a purely statistical exercise into an integrative analysis that combines association evidence with mechanistic plausibility.</p>
<p>Large-scale resources now link GWAS summary statistics, fine-mapping results, and functional genomic annotations across hundreds of traits and thousands of loci <span class="citation" data-cites="buniello_open_2025 mountjoy_open_2021">(<a href="../bib/references.html#ref-buniello_open_2025" role="doc-biblioref">Buniello et al. 2025</a>; <a href="../bib/references.html#ref-mountjoy_open_2021" role="doc-biblioref">Mountjoy et al. 2021</a>)</span>. These datasets enable systematic identification of variants that are both statistically prioritized and functionally plausible, though the biological validation required to confirm causal mechanisms remains laborious and is completed for only a small fraction of associated loci.</p>
</section>
<section id="sec-ch03-multi-ancestry-fine-mapping" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="sec-ch03-multi-ancestry-fine-mapping"><span class="header-section-number">3.4.3</span> Multi-Ancestry Fine-Mapping</h3>
<p>Single-ancestry fine-mapping encounters a fundamental resolution limit: when variants are in tight LD within the study population, no amount of statistical sophistication can distinguish them. Multi-ancestry approaches break through this limit by exploiting the population-specificity of LD structure. A variant in tight LD with twenty neighbors in Europeans may have only three correlated variants in African-ancestry populations, where shorter LD blocks (reflecting larger historical effective population size) provide greater resolution.</p>
<p>Joint fine-mapping across ancestries leverages these differences systematically <span class="citation" data-cites="kichaev_improved_2017">(<a href="../bib/references.html#ref-kichaev_improved_2017" role="doc-biblioref">Kichaev et al. 2017</a>)</span>. When a variant remains strongly associated across populations despite different local LD structure, confidence in its causal role increases. The logic is straightforward: a true causal variant should show consistent association regardless of which other variants happen to be correlated with it in any particular population. A tag variant, by contrast, may appear associated in one population (where it correlates with the causal variant) but not in another (where that correlation is absent).</p>
<p>Multi-ancestry approaches grow increasingly important as large biobanks expand to include diverse populations, though they require careful attention to potential effect size heterogeneity across populations. The core assumption that causal variants produce consistent effects worldwide can be violated through several mechanisms. Gene-environment interactions represent one such mechanism: a variant’s phenotypic effect may depend on environmental exposures that differ systematically across populations. The <em>FTO</em> obesity-associated variants, for instance, show stronger effects in sedentary populations than in physically active ones, and lactase persistence variants in <em>LCT</em> produce metabolic consequences only where dairy consumption is common. When populations differ in relevant environmental contexts, effect sizes will differ even for genuinely causal variants.</p>
<p>Genetic background effects present a second complication. A variant’s impact may depend on epistatic interactions with other loci, and if modifier variants differ in frequency across populations, the focal variant will appear to have population-specific effects. A causal variant might produce large effects only when a particular haplotype is present at an interacting locus; if that haplotype is common in one population but rare in another, the apparent effect of the causal variant will vary despite its genuine causal role. These complexities do not invalidate multi-ancestry fine-mapping, but they do mean that variants showing heterogeneous effects across populations should not be automatically dismissed. The method gains statistical power by assuming effect consistency, yet biological reality sometimes violates this assumption in ways that could exclude true causal variants or reduce confidence in them.</p>
</section>
</section>
<section id="sec-ch03-pgs-construction" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="sec-ch03-pgs-construction"><span class="header-section-number">3.5</span> Polygenic Score Construction</h2>
<p>A 35-year-old woman with a family history of breast cancer asks her physician whether she should begin mammography screening earlier than guidelines recommend. Traditional risk models incorporate family history, age, and reproductive factors, but cannot capture the cumulative effect of thousands of common variants, each conferring small increases in risk, that together may substantially elevate her probability of disease. <strong>Polygenic scores</strong> address this gap by aggregating variant effects across the genome into a single number:</p>
<p><span class="math display">\[
\text{PGS}_i = \sum_{j} w_j g_{ij}
\]</span></p>
<p>The weight <span class="math inline">\(w_j\)</span> reflects the estimated effect of variant <span class="math inline">\(j\)</span>, and <span class="math inline">\(g_{ij}\)</span> is the genotype dosage for individual <span class="math inline">\(i\)</span>. The simplest approach uses GWAS effect size estimates directly as weights; more sophisticated methods adjust for LD, apply shrinkage, or incorporate fine-mapping information. The clinical promise is substantial: for diseases with significant genetic components, polygenic scores can identify individuals at elevated risk years or decades before disease onset, potentially enabling targeted screening or prevention.</p>
<div id="fig-pgs-construction" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pgs-construction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/04-A-fig-pgs-construction.svg" class="img-fluid figure-img"></p>
<figcaption>Clumping and thresholding discards most variants</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/04-B-fig-pgs-construction.svg" class="img-fluid figure-img"></p>
<figcaption>LD-aware Bayesian methods retain all variants with modulated weights</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pgs-construction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Comparison of polygenic score construction approaches. (A) Clumping and thresholding (C+T) applies successive filters to GWAS summary statistics, discarding variants below a p-value threshold and pruning correlated variants to retain only independent lead SNPs. While computationally simple, this approach discards substantial genetic signal. (B) LD-aware Bayesian methods (LDpred, PRS-CS) model the correlation structure explicitly, applying shrinkage priors that modulate effect sizes based on local LD patterns while retaining contributions from all variants. The Bayesian approach preserves information distributed across correlated variants, typically improving prediction accuracy for highly polygenic traits where many variants each contribute small effects.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Terminology: PGS versus PRS">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology: PGS versus PRS
</div>
</div>
<div class="callout-body-container callout-body">
<p>The literature uses overlapping terminology. <strong>Polygenic risk score (PRS)</strong> is common in clinical contexts, emphasizing disease risk prediction. <strong>Polygenic score (PGS)</strong> is more general, encompassing both disease and quantitative trait prediction. <strong>Genomic risk score</strong> and related terms also appear, often interchangeably. This book uses PGS as the default, adding “risk” when specifically discussing disease outcomes. Methodological overviews provide detailed guidance on construction and evaluation <span class="citation" data-cites="choi_prs_2020">(<a href="../bib/references.html#ref-choi_prs_2020" role="doc-biblioref">Choi, Mak, and O’Reilly 2020</a>)</span>.</p>
</div>
</div>
<p>Integration of polygenic scores with foundation model features represents an emerging approach to clinical risk prediction. Feature extraction from genomic foundation models (<a href="../part_2/p2-ch09-transfer.html#sec-ch09-feature-extraction" class="quarto-xref"><span>Section 9.3</span></a>) can provide complementary signals to traditional PGS. The integration strategies for combining PGS with deep learning approaches are examined in <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-pgs-to-fm" class="quarto-xref"><span>Section 27.1</span></a>.</p>
<section id="sec-ch03-clumping-thresholding" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="sec-ch03-clumping-thresholding"><span class="header-section-number">3.5.1</span> Clumping and Thresholding</h3>
<p>The challenge of constructing a useful polygenic score is not mathematical but statistical: GWAS provide noisy estimates of millions of effects, many of which are correlated through LD, and naive summation produces scores dominated by noise rather than signal. <strong>Clumping and thresholding (C+T)</strong> represents the simplest solution: reduce both the noise and the correlation by aggressive filtering, accepting substantial information loss in exchange for robustness.</p>
<p>The procedure begins with clumping: variants are ranked by p-value, then iteratively the most significant variant is selected and all variants within a specified window (typically <span class="math inline">\(250\ \mathrm{kb}\)</span>) in LD above a threshold (typically <span class="math inline">\(r^2 &gt; 0.1\)</span>) are removed. This greedy selection prioritizes the most statistically significant variants under the assumption that they carry the strongest causal signals, while the LD pruning removes redundant variants that would otherwise inflate the score by counting the same underlying signal multiple times. This yields a set of approximately independent index variants. A p-value cutoff then retains only variants below threshold, which serves to exclude variants whose estimated effects are dominated by noise. Finally, weights are set equal to the GWAS effect size estimate for retained variants, and zero otherwise.</p>
<p>The hyperparameters (LD window, <span class="math inline">\(r^2\)</span> threshold, p-value threshold) are typically chosen by grid search to maximize predictive performance in a held-out validation set. This tuning introduces overfitting risk, particularly in small samples or when the validation population differs from the eventual deployment population.</p>
<p>C+T is transparent and computationally simple, but it discards substantial information. Most variants are excluded, LD is handled only through coarse pruning, and variants with modest p-values that collectively explain meaningful variance may be entirely omitted. For highly polygenic traits where thousands of variants each contribute small effects, this information loss substantially degrades prediction accuracy. The method treats LD as a problem to be eliminated rather than a correlation structure to be modeled, an approach that sacrifices power for simplicity.</p>
</section>
<section id="sec-ch03-bayesian-pgs" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="sec-ch03-bayesian-pgs"><span class="header-section-number">3.5.2</span> LD-Aware Bayesian Methods</h3>
<p>The information discarded by C+T is not random noise; it contains genuine signal about genetic effects distributed across correlated variants. Rather than pruning away this structure, a more principled approach models the joint distribution of effect sizes explicitly, treating the true effects <span class="math inline">\(\boldsymbol{\beta} = (\beta_1, \ldots, \beta_M)\)</span> as random variables drawn from a prior distribution. Given GWAS summary statistics and an LD reference panel, these methods infer posterior mean effect sizes that serve as PGS weights. The key insight is that LD becomes information rather than nuisance: correlated variants constrain each other’s likely effects, improving estimation for all.</p>
<p><em>LDpred</em> assumes that a fraction <span class="math inline">\(p\)</span> of variants have nonzero effects drawn from a Gaussian distribution, while the remainder have zero effect <span class="citation" data-cites="vilhjalmsson_modeling_2015">(<a href="../bib/references.html#ref-vilhjalmsson_modeling_2015" role="doc-biblioref">Vilhjálmsson et al. 2015</a>)</span>. The method uses GWAS summary statistics and LD from a reference panel (computed from a subset of individuals or external dataset matching the target ancestry) to compute approximate posterior effect sizes. The Bayesian framework provides principled shrinkage: variants with weak evidence (small effect estimates relative to their standard errors) are shrunk heavily toward zero, while variants with strong evidence retain most of their estimated effect. Crucially, the LD structure is incorporated so that when multiple correlated variants all show association, the posterior recognizes that they likely reflect a single causal signal and distributes the total effect appropriately rather than counting it multiple times. These posteriors shrink noisy estimates toward zero, borrow strength across correlated variants, and generally outperform C+T when properly tuned.</p>
<p><em>PRS-CS</em> extends this framework by placing a continuous shrinkage prior on effect sizes, which better accommodates the highly polygenic architecture of complex traits and reduces sensitivity to the sparsity hyperparameter <span class="citation" data-cites="ge_polygenic_2019">(<a href="../bib/references.html#ref-ge_polygenic_2019" role="doc-biblioref">Ge et al. 2019</a>)</span>. The continuous prior assigns most variants small but nonzero effects rather than forcing a binary causal/non-causal distinction. The method has shown strong performance across a range of traits and ancestries, though like all methods it requires an LD reference that reasonably matches the target population.</p>
<p>Related approaches (<em>lassosum</em>, <em>SBayesR</em>, and others) use different priors or optimization strategies but share the core insight: jointly modeling effect sizes under LD yields better predictions than pruning LD away. Performance differences among methods are often modest when each is well-tuned, and the choice may depend on computational resources, availability of validation data, and specific trait architecture.</p>
<p>The following table compares the major PGS construction approaches:</p>
<div id="tbl-pgs-methods" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pgs-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: Comparison of polygenic score construction methods. All methods use GWAS summary statistics as input.
</figcaption>
<div aria-describedby="tbl-pgs-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 18%">
<col style="width: 26%">
<col style="width: 29%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>LD Handling</th>
<th>Computational Cost</th>
<th>Key Hyperparameters</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>C+T</td>
<td>Prune away</td>
<td>Low</td>
<td>Window size, r<sup>2</sup> threshold, p-value threshold</td>
<td>Quick baseline, sparse architectures</td>
</tr>
<tr class="even">
<td>LDpred</td>
<td>Joint model</td>
<td>Medium</td>
<td>Fraction causal (p), LD radius</td>
<td>Moderately polygenic traits</td>
</tr>
<tr class="odd">
<td>PRS-CS</td>
<td>Continuous shrinkage</td>
<td>Medium-High</td>
<td>Global shrinkage, LD reference</td>
<td>Highly polygenic traits</td>
</tr>
<tr class="even">
<td>SBayesR</td>
<td>Mixture prior</td>
<td>High</td>
<td>Mixture components, LD reference</td>
<td>When architecture unknown</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="sec-ch03-fine-mapping-informed-pgs" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="sec-ch03-fine-mapping-informed-pgs"><span class="header-section-number">3.5.3</span> Fine-Mapping-Informed Scores</h3>
<p>Polygenic scores built on tag SNPs face a fundamental portability problem: the tag-causal correlation that justified including a variant may not hold in populations with different LD structure. Fine-mapping outputs, particularly posterior inclusion probabilities, offer a potential solution by identifying variants more likely to be causal. Causal variants should remain predictive regardless of population-specific LD patterns, since their effects are direct rather than mediated through correlation.</p>
<p>Two strategies incorporate fine-mapping information into PGS construction. Selection approaches retain only variants above a PIP threshold (typically 0.1 or 0.5), focusing the score on high-confidence causal candidates. Weighting approaches modulate each variant’s contribution by its PIP, downweighting likely tags while preserving information from variants with intermediate evidence.</p>
<p>Fine-mapping-informed approaches aim to concentrate weight on variants that are biologically meaningful rather than merely statistically associated. In principle, this should improve cross-ancestry transferability since causal variants remain causal regardless of population-specific LD patterns. In practice, gains depend on fine-mapping resolution, which is limited in regions of tight LD. The approaches remain an active area of methodological development, with potential for substantial improvement as multi-ancestry fine-mapping resources expand.</p>
</section>
</section>
<section id="sec-ch03-pgs-interpretation" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="sec-ch03-pgs-interpretation"><span class="header-section-number">3.6</span> Polygenic Score Interpretation</h2>
<p>A polygenic score is a number, but numbers do not make clinical decisions. A patient told they are in the 95th percentile of genetic risk may interpret this as near-certain disease development, while a physician may recognize it as modest risk elevation insufficient to change management. Converting a score into actionable information requires understanding what it represents, how it relates to disease risk or trait values, and where its interpretation breaks down. Miscommunication at this stage can transform a useful risk stratification tool into a source of inappropriate anxiety or false reassurance.</p>
<section id="sec-ch03-relative-risk" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="sec-ch03-relative-risk"><span class="header-section-number">3.6.1</span> Relative Risk and Percentiles</h3>
<p>The most immediate clinical question about a high polygenic score is: how much does it increase risk? Polygenic scores are most naturally interpreted in relative terms by fitting a logistic regression in a validation cohort:</p>
<p><span class="math display">\[
\log \frac{P(y_i = 1)}{P(y_i = 0)} = \alpha + \theta \cdot \mathrm{PGS}_i + \eta^\top z_i
\]</span></p>
<p>where <span class="math inline">\(z_i\)</span> contains covariates and <span class="math inline">\(\theta\)</span> captures the effect of the PGS. After standardizing the score to unit variance, <span class="math inline">\(\exp(\theta)\)</span> gives the odds ratio per standard deviation of the PGS. This metric allows statements such as “individuals one standard deviation above the mean have 1.5-fold higher odds of disease.”</p>
<p>Percentile-based communication is common in clinical contexts. The risk for individuals in the top 1% or 5% of the PGS distribution can be compared to those near the median or in the bottom percentiles. For some conditions, individuals in the top percentiles have risk comparable to or exceeding that conferred by single high-penetrance mutations: the top 8% of the coronary artery disease PGS distribution has risk equivalent to familial hypercholesterolemia carriers, and the top 1% of the breast cancer PGS distribution has lifetime risk approaching that of <em>BRCA2</em> mutation carriers <span class="citation" data-cites="khera_genome-wide_2017 mavaddat_polygenic_2019">(<a href="../bib/references.html#ref-khera_genome-wide_2017" role="doc-biblioref">Khera and Kathiresan 2017</a>; <a href="../bib/references.html#ref-mavaddat_polygenic_2019" role="doc-biblioref">Mavaddat et al. 2019</a>)</span>. This finding makes polygenic scores potentially relevant for clinical risk stratification, though the appropriate thresholds and clinical actions remain subjects of ongoing research and debate.</p>
<p>Translation of PGS into clinical decision-making requires careful attention to calibration and uncertainty quantification. Clinical risk prediction frameworks that integrate multiple evidence types are detailed in <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-defining-risk" class="quarto-xref"><span>Section 27.2</span></a>. Calibration requirements for clinical deployment appear in <a href="../part_5/p5-ch23-uncertainty.html#sec-ch23-calibration" class="quarto-xref"><span>Section 23.2</span></a> for general principles and <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-calibration" class="quarto-xref"><span>Section 27.6.2</span></a> for clinical-specific considerations.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>A direct-to-consumer genetics company reports that you are in the 90th percentile for coronary artery disease genetic risk. Before panicking (or celebrating if you were in the 10th percentile), what additional information would you need to interpret this result? Consider: What population was the percentile calculated from? What is your baseline risk given age, sex, and other factors? How does genetic risk interact with modifiable risk factors?</p>
</div>
</div>
</section>
<section id="sec-ch03-absolute-risk" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="sec-ch03-absolute-risk"><span class="header-section-number">3.6.2</span> Absolute Risk</h3>
<p>A physician cannot act on relative risk alone; clinical decisions require knowing the probability that this specific patient will develop disease over a specified time horizon. Relative risk statements can mislead when baseline risk varies substantially. A 1.5-fold increase in odds for a disease with 1% baseline risk means absolute risk rises from 1% to roughly 1.5%; the same relative increase for a disease with 20% baseline risk means absolute risk rises from 20% to roughly 26%. A patient told they have “50% higher risk” may react very differently depending on whether baseline risk is low or high.</p>
<p>Converting PGS to absolute risk requires combining the score with baseline incidence rates, which vary by age, sex, and other factors. The <strong>hazard ratio</strong> per standard deviation of PGS, combined with age-specific <strong>incidence curves</strong> from population registries, can yield personalized risk trajectories. Such calculations demand careful attention to calibration: the model must produce well-calibrated probabilities in the population where it will be deployed, not just the population where it was trained. A model calibrated in UK Biobank may systematically over- or under-estimate risk when applied to a U.S. clinical population with different baseline incidence rates or healthcare practices. Clinical deployment of PGS is addressed in detail in <a href="../part_6/p6-ch27-clinical-risk.html" class="quarto-xref"><span>Chapter 27</span></a>.</p>
</section>
<section id="sec-ch03-variance-discrimination" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="sec-ch03-variance-discrimination"><span class="header-section-number">3.6.3</span> Explained Variance and Discrimination</h3>
<p>Population-level performance metrics determine whether a polygenic score has any utility, but they can mask the substantial uncertainty that remains for any individual patient. For quantitative traits, the coefficient of determination (<span class="math inline">\(R^2\)</span>) between PGS and phenotype provides a direct measure of explanatory power. Height PGS now explain roughly <span class="math inline">\(25\%\)</span> of phenotypic variance in European-ancestry populations, approaching the theoretical maximum given current sample sizes and the heritability of the trait <span class="citation" data-cites="yengo_meta-analysis_2022">(<a href="../bib/references.html#ref-yengo_meta-analysis_2022" role="doc-biblioref">Yengo et al. 2022</a>)</span>. For binary traits, the <span class="math inline">\(R^2\)</span> on the <strong>liability scale</strong> (the underlying continuous risk) is more interpretable than the observed-scale <span class="math inline">\(R^2\)</span>, which depends on disease prevalence.</p>
<p>Area under the receiver operating characteristic curve (auROC) measures discrimination: the probability that a randomly selected case has a higher PGS than a randomly selected control. auROC values of 0.5 indicate no discrimination (random guessing); values approaching 1.0 indicate near-perfect separation. For most complex diseases, PGS achieve auROC values in the 0.55 to 0.70 range when used alone, with incremental gains when combined with traditional risk factors <span class="citation" data-cites="torkamani_personal_2018 lambert_polygenic_2019">(<a href="../bib/references.html#ref-torkamani_personal_2018" role="doc-biblioref">Torkamani, Wineinger, and Topol 2018</a>; <a href="../bib/references.html#ref-lambert_polygenic_2019" role="doc-biblioref">Lambert, Abraham, and Inouye 2019</a>)</span>. These values reflect meaningful stratification at the population level but limited utility for individual prediction.</p>
<p>Even a PGS that explains 10% of trait variance leaves 90% unexplained by factors genetic and environmental. High-risk individuals by PGS may never develop disease; low-risk individuals may be affected. Polygenic scores provide probabilistic risk stratification, not deterministic prediction. This distinction is critical for clinical communication and for setting appropriate expectations about what genomic risk information can and cannot offer.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>A PGS with auROC of 0.65 correctly ranks a random case above a random control only 65% of the time. At the individual level, this means substantial overlap between cases and controls in their score distributions. Polygenic scores are population stratification tools, not individual diagnostic tests. Their value lies in identifying subgroups warranting different management, not in predicting individual outcomes with certainty.</p>
</div>
</div>
</section>
</section>
<section id="sec-ch03-portability" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="sec-ch03-portability"><span class="header-section-number">3.7</span> Ancestry, Portability, and Fairness</h2>
<p>The vast majority of GWAS participants have been of European ancestry: as of 2019, approximately 78% of participants were European despite Europeans comprising roughly 16% of the global population <span class="citation" data-cites="martin_clinical_2019">(<a href="../bib/references.html#ref-martin_clinical_2019" role="doc-biblioref">Martin et al. 2019</a>)</span>. This historical imbalance has profound consequences for who benefits from polygenic scores and who may be harmed by their limitations. A technology that works well for some populations and poorly for others is not merely incomplete; deployed without appropriate caution, it risks widening existing health disparities rather than narrowing them.</p>
<p>Population structure creates systematic portability challenges that extend beyond GWAS to all genomic models. The sources of this population stratification are detailed in <a href="p1-ch02-data.html#sec-ch02-population" class="quarto-xref"><span>Section 2.2</span></a>, while systematic analysis of ancestry confounding appears in <span class="quarto-unresolved-ref">?sec-ch22-ancestry-confounding</span>. Training data diversity requirements for foundation models that generalize across populations are discussed in <a href="p1-ch02-data.html#sec-ch02-constraints" class="quarto-xref"><span>Section 2.9</span></a>.</p>
<div id="fig-pgs-portability" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pgs-portability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_1/ch03/05-fig-pgs-portability.svg" class="img-fluid figure-img"></p>
<figcaption>Polygenic score portability across ancestry groups</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pgs-portability-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Portability of polygenic scores across ancestry groups. Bar heights show relative prediction accuracy when European-derived polygenic scores are applied to individuals of different ancestries, with European performance as the reference (100%). Accuracy declines substantially for non-European populations, with African-ancestry individuals experiencing 40-75% reductions in predictive power. Multiple factors contribute to this portability gap: differences in linkage disequilibrium structure between populations, divergent allele frequencies that alter variant informativeness, potential heterogeneity in effect sizes across genetic backgrounds, and the overwhelming European composition of GWAS training data. These disparities raise fundamental questions about equitable deployment of polygenic risk prediction in diverse clinical populations.
</figcaption>
</figure>
</div>
<section id="sec-ch03-portability-problem" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="sec-ch03-portability-problem"><span class="header-section-number">3.7.1</span> Portability Problem</h3>
<p>Polygenic scores derived from European-ancestry GWAS show markedly reduced performance in other populations. African-ancestry individuals typically experience 40% to 75% reductions in prediction accuracy compared to European-ancestry individuals, even for the same trait measured in the same study <span class="citation" data-cites="duncan_analysis_2019 martin_clinical_2019">(<a href="../bib/references.html#ref-duncan_analysis_2019" role="doc-biblioref">Duncan et al. 2019</a>; <a href="../bib/references.html#ref-martin_clinical_2019" role="doc-biblioref">Martin et al. 2019</a>)</span>. The pattern holds across traits and across methods, though the magnitude varies with genetic architecture and the degree of shared causal variants.</p>
<p>Several factors contribute to this portability failure. LD structure differs across populations: tag SNPs that effectively proxy causal variants in Europeans may be poor proxies in populations with different recombination history. Allele frequencies differ: variants common in one population may be rare or absent in another. Effect sizes may genuinely differ across populations due to gene-environment interactions or genetic background effects. And GWAS in smaller non-European samples have less power to detect associations, yielding noisier effect estimates that further degrade prediction.</p>
<p>Multi-ancestry GWAS and methods designed to leverage diverse training data offer partial solutions. Including multiple ancestries in discovery improves transferability, and methods that explicitly model ancestry-specific LD or effect sizes can enhance performance <span class="citation" data-cites="marquez-luna_multiethnic_2017">(<a href="../bib/references.html#ref-marquez-luna_multiethnic_2017" role="doc-biblioref">Márquez-Luna et al. 2017</a>)</span>. Yet even state-of-the-art approaches do not fully close the gap, and substantial research is needed before PGS perform equitably across populations.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practical Guidance: Evaluating PGS Across Populations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Evaluating PGS Across Populations
</div>
</div>
<div class="callout-body-container callout-body">
<p>When assessing whether a polygenic score is appropriate for a given patient or population:</p>
<ol type="1">
<li><strong>Check training ancestry</strong>: Was the discovery GWAS conducted in a population matching the patient’s ancestry?</li>
<li><strong>Look for validation data</strong>: Has the score been validated in diverse populations? What was the performance gap?</li>
<li><strong>Consider clinical context</strong>: Would reduced accuracy change clinical utility? A score with 50% reduced accuracy may still provide useful stratification for some applications.</li>
<li><strong>Avoid false precision</strong>: Do not report exact percentile rankings in populations where the score was not validated.</li>
<li><strong>Document limitations</strong>: Explicitly note when scores are applied outside their validated populations.</li>
</ol>
</div>
</div>
</section>
<section id="sec-ch03-fairness" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="sec-ch03-fairness"><span class="header-section-number">3.7.2</span> Fairness and Health Equity</h3>
<p>The performance gap across ancestries is not merely a technical nuisance; it raises fundamental questions about fairness in precision medicine. If genomic models work primarily for individuals of European ancestry, deploying these models in diverse clinical populations risks exacerbating existing health disparities rather than ameliorating them. The communities historically excluded from genetic research would continue to receive inferior genomic medicine, now encoded in algorithmic form.</p>
<p>Consider a scenario where PGS are used for risk-stratified screening. If the score identifies high-risk individuals more accurately in Europeans than in other groups, Europeans receive more targeted and efficient screening while others receive either under-screening (if falsely classified as low risk) or over-screening (if falsely classified as high risk). The benefits of precision medicine accrue disproportionately to those already overrepresented in research, while the costs of miscalibration fall on those historically excluded.</p>
<p>These challenges extend beyond PGS to every genomic model. Foundation models can learn to exploit ancestry signals as shortcuts, achieving high benchmark performance while performing poorly on underrepresented groups. Aggregate performance metrics mask inequities across populations. Deployment in diverse clinical settings requires explicit evaluation of performance stratified by ancestry, along with transparent reporting of limitations and appropriate caution in populations where validation is limited. These issues receive comprehensive treatment in <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>, with governance and policy responses addressed in <a href="../part_5/p5-ch26-regulatory.html#sec-ch26-regulatory" class="quarto-xref"><span>Section 26.1</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="The 78 Percent Problem">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The 78 Percent Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>As of 2019, approximately 78% of GWAS participants were of European ancestry despite Europeans comprising roughly 16% of the global population <span class="citation" data-cites="martin_clinical_2019">(<a href="../bib/references.html#ref-martin_clinical_2019" role="doc-biblioref">Martin et al. 2019</a>)</span>. This disparity propagates through every layer of genomic medicine. Polygenic scores derived from European-ancestry GWAS show 40-75% reductions in prediction accuracy for African-ancestry individuals, even for the same trait measured in the same study. Variant databases like ClinVar contain far more pathogenic classifications for European-ancestry variants, leaving variants from underrepresented populations more likely to remain classified as VUS due to insufficient evidence. Foundation models inherit these biases at the root: a model trained on skewed data cannot be corrected <em>post hoc</em> to achieve the performance it would have achieved with representative training data.</p>
<p>The disparity is not merely statistical. If genomic risk scores are used for screening decisions, Europeans receive more accurate risk stratification while other populations receive either under-screening (if falsely classified as low risk) or over-screening (if falsely classified as high risk). The benefits of precision medicine accrue disproportionately to those already overrepresented in research.</p>
<p>This problem recurs throughout the book: in variant effect prediction (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>), model confounding (<a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>), clinical risk prediction (<a href="../part_6/p6-ch27-clinical-risk.html" class="quarto-xref"><span>Chapter 27</span></a>), and the governance frameworks needed to address it (<a href="../part_5/p5-ch26-regulatory.html#sec-ch26-regulatory" class="quarto-xref"><span>Section 26.1</span></a>) <span class="citation" data-cites="chen_rates_2023">(<a href="../bib/references.html#ref-chen_rates_2023" role="doc-biblioref"><strong>chen_rates_2023?</strong></a>)</span>.</p>
</div>
</div>
</section>
</section>
<section id="sec-ch03-phewas" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="sec-ch03-phewas"><span class="header-section-number">3.8</span> Phenome-Wide Association Studies</h2>
<p>GWAS answer a specific question: which variants associate with this phenotype? The reverse question is equally informative: which phenotypes associate with this variant, or with this set of variants aggregated into a polygenic score? <strong>Phenome-wide association studies (PheWAS)</strong> systematically test associations between genetic variants and hundreds or thousands of phenotypes, revealing pleiotropy that single-phenotype analyses cannot detect. A variant initially discovered for its association with coronary artery disease may also associate with type 2 diabetes, lipid levels, and blood pressure, connections that illuminate shared biology and inform variant interpretation.</p>
<p>This reversal of the GWAS paradigm has proven particularly valuable for understanding polygenic score biology. A polygenic score constructed for one trait often predicts other traits, sometimes to a surprising degree. The coronary artery disease PGS predicts not only heart attacks but also diabetes, hypertension, and mortality from other vascular causes. These cross-phenotype associations reflect the shared genetic architecture among related traits and the pleiotropic effects of common variants. They also reveal where phenotype definitions may be capturing overlapping constructs or where biological pathways connect seemingly distinct outcomes.</p>
<section id="sec-ch03-phewas-framework" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="sec-ch03-phewas-framework"><span class="header-section-number">3.8.1</span> PheWAS Framework</h3>
<p>PheWAS implementations parallel GWAS but with dimensions transposed. Rather than testing millions of variants against one phenotype, PheWAS tests one variant (or score) against hundreds of phenotypes. The phenotype vocabulary typically derives from EHR codes grouped into clinically meaningful categories. <strong>Phecodes</strong> collapse ICD-9 and ICD-10 billing codes into approximately 1,800 phenotype groups, aggregating related codes (such as the many ICD codes for diabetes mellitus) into unified disease concepts while distinguishing diseases that occupy nearby code ranges but represent different conditions.</p>
<p>The statistical framework mirrors GWAS: logistic regression for binary phenotypes, linear regression for quantitative traits, adjustment for covariates including age, sex, and genetic ancestry. Multiple testing correction accounts for the hundreds of tests performed; the Bonferroni threshold at <span class="math inline">\(1{,}800\)</span> phecodes requires <span class="math inline">\(p &lt; 2.8 \times 10^{-5}\)</span> for significance. False discovery rate control offers a less conservative alternative appropriate when characterizing the landscape of associations rather than declaring individual findings.</p>
<p>Interpretation requires attention to the correlation structure among phenotypes. A variant associated with obesity will, by mechanical consequence, associate with any phenotype more common in obese individuals. True pleiotropy (the variant affecting multiple traits through independent biological pathways) cannot be distinguished from mediated pleiotropy (the variant affecting one trait that causes others) through PheWAS alone. Colocalization analysis, conditional testing, and Mendelian randomization provide complementary evidence about whether associations reflect shared causal variants or confounded correlations.</p>
</section>
<section id="sec-ch03-prs-phewas" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="sec-ch03-prs-phewas"><span class="header-section-number">3.8.2</span> PheWAS for Polygenic Score Interpretation</h3>
<p>Single variants have modest effects on complex traits, limiting the power of variant-level PheWAS for common diseases. Polygenic scores aggregate these effects across thousands of variants, providing sufficient signal for phenome-wide characterization. PRS-PheWAS tests the association between a polygenic score and each phenotype in the vocabulary, revealing the full spectrum of traits that share genetic architecture with the index phenotype.</p>
<p>Xu et al.&nbsp;applied this framework to interpret EHR-embedding-based polygenic scores, finding that scores derived from cardiovascular-related embedding dimensions associated strongly with circulatory system diagnoses across the phenome <span class="citation" data-cites="xu_improving_2025">(<a href="../bib/references.html#ref-xu_improving_2025" role="doc-biblioref">Xu et al. 2025</a>)</span>. The PheWAS results explained why cardiovascular traits showed the largest improvements from embedding-enhanced prediction: the embeddings captured genetic signal shared across the cardiovascular phenotype cluster. This approach provides a systematic method for understanding what a polygenic score actually predicts and whether its cross-phenotype associations match biological expectations.</p>
<p>PRS-PheWAS also reveals unexpected associations that may indicate shared biology, confounding, or phenotype definition artifacts. A diabetes PGS that associates with billing codes for insulin pumps reflects healthcare utilization rather than disease biology. A depression PGS that associates with chronic pain diagnoses may indicate shared genetic liability, diagnostic conflation, or the medical consequences of depression. Distinguishing these possibilities requires domain knowledge and follow-up analyses that the PheWAS itself cannot provide.</p>
<p>PRS-PheWAS for clinical interpretation of polygenic scores is examined in detail in <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-prs-phewas" class="quarto-xref"><span>Section 27.4.3</span></a>, where phenome-wide associations inform which traits share genetic architecture and can benefit from multi-trait prediction.</p>
</section>
<section id="sec-ch03-phenotype-quality" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="sec-ch03-phenotype-quality"><span class="header-section-number">3.8.3</span> Phenotype Quality and PheWAS Power</h3>
<p>The power of PheWAS depends critically on phenotype quality, which varies enormously across the hundreds of conditions in a typical phecode vocabulary. Well-captured phenotypes with clear diagnostic criteria (type 2 diabetes, hypothyroidism) yield stronger associations than poorly captured phenotypes that depend on documentation practices (chronic fatigue syndrome, fibromyalgia). Rare phenotypes with few cases lack power regardless of effect size. Common phenotypes with high misclassification rates suffer attenuated effects.</p>
<p>This heterogeneity complicates interpretation of phenome-wide results. The absence of an association may reflect genuine lack of pleiotropy or insufficient power to detect it. The pattern of associations across phenotype categories may reflect genuine biological clustering or differential phenotype quality across clinical domains. Cardiovascular phenotypes in hospital-based EHRs are typically well-captured because they drive admissions and procedures; psychiatric phenotypes are poorly captured because they are often managed in outpatient settings that may not feed into the research EHR.</p>
<p>Recognition of these limitations has motivated phenotype quality assessment as a prerequisite for PheWAS. Metrics such as the proportion of cases with supporting laboratory values, the consistency of coding over time, and the agreement between algorithmic definitions and chart review provide evidence about which phenotypes can support reliable association testing. Restricting analyses to high-quality phenotypes improves specificity at the cost of comprehensiveness.</p>
<p>The phenotype quality challenges described here recur in multi-omic integration (<span class="quarto-unresolved-ref">?sec-ch19-clinical-integration</span>) and clinical deployment of risk models (<span class="quarto-unresolved-ref">?sec-ch25-evaluation</span>). Systematic approaches to phenotype quality assessment connect to label quality discussions in <span class="quarto-unresolved-ref">?sec-ch22-label-bias</span>.</p>
</section>
<section id="sec-ch03-deep-phenotyping" class="level3" data-number="3.8.4">
<h3 data-number="3.8.4" class="anchored" data-anchor-id="sec-ch03-deep-phenotyping"><span class="header-section-number">3.8.4</span> Deep Phenotyping and Embedding-Enhanced GWAS</h3>
<p>The limitations of binary phecode phenotypes have motivated alternative approaches that leverage richer phenotypic representations. Rather than testing association with categorical disease labels, these methods test association with continuous phenotypic embeddings that capture clinical similarity and co-occurrence structure. A patient’s position in embedding space reflects their full clinical profile rather than the presence or absence of specific diagnoses.</p>
<p>EHR-embedding GWAS treats each dimension of a phenotype embedding as a quantitative trait, conducting standard GWAS to identify variants associated with that dimension. Xu et al.&nbsp;found that such embedding dimensions show significant heritability and genetic correlation with diverse clinical traits, suggesting they capture biologically meaningful phenotypic variation <span class="citation" data-cites="xu_improving_2025">(<a href="../bib/references.html#ref-xu_improving_2025" role="doc-biblioref">Xu et al. 2025</a>)</span>. Hierarchical clustering of traits by their genetic correlation profiles with embedding dimensions recovered clinically coherent groups, including a cardiovascular cluster comprising coronary artery disease, ischemic stroke, peripheral artery disease, type 2 diabetes, and related conditions.</p>
<p>These embedding-based approaches offer several advantages over traditional phenotype definitions. They avoid the information loss inherent in binary case-control classification. They capture phenotypic relationships that expert-defined definitions may miss. They can be constructed from the same EHR data used for genotype-phenotype analysis, requiring no additional phenotyping effort. Their limitations include interpretability (what does association with embedding dimension 7 mean biologically?) and potential circularity (if embeddings capture coding practices, GWAS may identify variants associated with healthcare utilization rather than disease) <span class="citation" data-cites="mukherjee_embedgem_2024">(<a href="../bib/references.html#ref-mukherjee_embedgem_2024" role="doc-biblioref">Mukherjee et al. 2024</a>)</span>.</p>
<p>The integration of phenotype embeddings with polygenic prediction represents an active research frontier. Embedding-enhanced polygenic risk scores combine traditional single-trait scores with scores derived from EHR-embedding GWAS, leveraging the genetic correlations among related phenotypes to improve prediction for the target trait. For cardiovascular outcomes where phenotypes cluster together and share genetic architecture, this integration has shown substantial improvements over single-trait scores. The approach is examined in detail in <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-feature-integration" class="quarto-xref"><span>Section 27.3</span></a> for feature extraction strategies and <a href="../part_6/p6-ch27-clinical-risk.html#sec-ch27-ehr-integration" class="quarto-xref"><span>Section 27.4</span></a> for EHR embedding approaches.</p>
</section>
</section>
<section id="sec-ch03-mechanism" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="sec-ch03-mechanism"><span class="header-section-number">3.9</span> From Association to Mechanism</h2>
<p>GWAS and polygenic scores have delivered thousands of robust trait associations, clinically useful risk stratification for some conditions, and fundamental insights into the polygenic architecture of complex phenotypes. They have also exposed a persistent gap between statistical association and biological understanding. Most GWAS hits lie in noncoding regions, often within enhancers, promoters, or other regulatory elements. The variant is associated; the mechanism is obscure. Fine-mapping narrows the list of candidates but rarely identifies a single causal nucleotide with confidence. Even when a variant is prioritized, the path from sequence change to molecular consequence to cellular phenotype to disease remains opaque.</p>
<p>This mechanistic gap limits translation in concrete ways. Drug development requires actionable targets, not associated regions. Clinical variant interpretation needs to explain why a variant matters, not just that it correlates with disease. Polygenic scores stratify population risk but offer little guidance on individual intervention. Multiple complementary strategies address this gap: regulatory sequence models predict how variants alter transcription factor binding and chromatin accessibility (<a href="../part_3/p3-ch16-regulatory.html" class="quarto-xref"><span>Chapter 16</span></a>), variant effect predictors assess functional impact at nucleotide resolution (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>), and multi-omics integration approaches connect genetic variation to intermediate molecular phenotypes (<a href="../part_4/p4-ch22-multi-omics.html" class="quarto-xref"><span>Chapter 22</span></a>). Network-based approaches that integrate GWAS results with protein interaction networks and pathway information are examined in <span class="quarto-unresolved-ref">?sec-ch18-disease-gene</span> for gene prioritization and <span class="quarto-unresolved-ref">?sec-ch18-drug-target</span> for therapeutic target identification.</p>
<p>The goal is not to replace statistical genetics but to build on it. Association provides the map of where trait-relevant variation resides; mechanistic modeling attempts to explain how that variation produces its effects. The combination of statistical association and mechanistic interpretation offers the most promising path toward genomic medicine that is both predictive and understood.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key concepts covered:</strong></p>
<ul>
<li>Genome-wide association studies (GWAS), SNPs, effect sizes, odds ratios</li>
<li>Population structure and PCA-based correction</li>
<li>Heritability (pedigree, SNP-heritability, missing heritability)</li>
<li>Linkage disequilibrium (LD), r<sup>2</sup>, tag vs.&nbsp;causal variants</li>
<li>Fine-mapping, posterior inclusion probabilities, credible sets</li>
<li>Polygenic scores (PGS/PRS), C+T, LDpred, PRS-CS</li>
<li>Portability, ancestry bias, the 78% problem</li>
<li>PheWAS and phenome-wide characterization</li>
</ul>
<p><strong>Main takeaways:</strong></p>
<ol type="1">
<li><p><strong>GWAS identify signposts, not causes.</strong> Association signals point to genomic regions harboring trait-relevant variation, but linkage disequilibrium prevents identification of specific causal variants from statistics alone.</p></li>
<li><p><strong>Heritability has layers.</strong> Pedigree heritability sets the upper bound on genetic prediction; SNP-heritability sets the ceiling for common-variant polygenic scores; the gap between them represents genetic variation (rare variants, structural variants) that GWAS cannot capture.</p></li>
<li><p><strong>Polygenic scores aggregate risk across thousands of variants.</strong> For some conditions, individuals in the top percentiles have risk comparable to carriers of high-penetrance monogenic mutations, making PGS potentially clinically relevant.</p></li>
<li><p><strong>Portability is a fundamental challenge.</strong> European-derived PGS perform substantially worse in other populations due to LD differences, allele frequency differences, and training data bias. This creates equity concerns for clinical deployment.</p></li>
<li><p><strong>The path to mechanism requires additional tools.</strong> Foundation models for regulatory sequence and variant effect prediction (<a href="../part_3/p3-ch16-regulatory.html" class="quarto-xref"><span>Chapter 16</span></a>, <a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>) attempt to bridge the gap between statistical association and biological understanding.</p></li>
</ol>
<p><strong>Looking ahead:</strong> The statistical framework presented here provides the foundation for understanding how deep learning models can contribute to genetic analysis. <a href="p1-ch04-vep-classical.html" class="quarto-xref"><span>Chapter 4</span></a> examines how classical approaches predict variant effects, setting the stage for foundation model approaches in later chapters.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-benner_finemap_2016" class="csl-entry" role="listitem">
Benner, Christian, Chris C. A. Spencer, Aki S. Havulinna, Veikko Salomaa, Samuli Ripatti, and Matti Pirinen. 2016. <span>“<span>FINEMAP</span>: Efficient Variable Selection Using Summary Data from Genome-Wide Association Studies.”</span> <em>Bioinformatics</em> 32 (10): 1493–1501. <a href="https://doi.org/10.1093/bioinformatics/btw018">https://doi.org/10.1093/bioinformatics/btw018</a>.
</div>
<div id="ref-buniello_open_2025" class="csl-entry" role="listitem">
Buniello, Annalisa, Daniel Suveges, Carlos Cruz-Castillo, Manuel Bernal Llinares, Helena Cornu, Irene Lopez, Kirill Tsukanov, et al. 2025. <span>“Open <span>Targets</span> <span>Platform</span>: Facilitating Therapeutic Hypotheses Building in Drug Discovery.”</span> <em>Nucleic Acids Research</em> 53 (D1): D1467–75. <a href="https://doi.org/10.1093/nar/gkae1128">https://doi.org/10.1093/nar/gkae1128</a>.
</div>
<div id="ref-choi_prs_2020" class="csl-entry" role="listitem">
Choi, Shing Wan, Timothy Shin-Heng Mak, and Paul F. O’Reilly. 2020. <span>“[<span>PRS</span>] <span>Tutorial</span>: A Guide to Performing Polygenic Risk Score Analyses.”</span> <em>Nature Protocols</em> 15 (9): 2759–72. <a href="https://doi.org/10.1038/s41596-020-0353-1">https://doi.org/10.1038/s41596-020-0353-1</a>.
</div>
<div id="ref-duncan_analysis_2019" class="csl-entry" role="listitem">
Duncan, L., H. Shen, B. Gelaye, J. Meijsen, K. Ressler, M. Feldman, R. Peterson, and B. Domingue. 2019. <span>“Analysis of Polygenic Risk Score Usage and Performance in Diverse Human Populations.”</span> <em>Nature Communications</em> 10 (1): 3328. <a href="https://doi.org/10.1038/s41467-019-11112-0">https://doi.org/10.1038/s41467-019-11112-0</a>.
</div>
<div id="ref-elks_variability_2012" class="csl-entry" role="listitem">
Elks, Cathy E., Marcel Den Hoed, Jing Hua Zhao, Stephen J. Sharp, Nicholas J. Wareham, Ruth J. F. Loos, and Ken K. Ong. 2012. <span>“Variability in the <span>Heritability</span> of <span>Body</span> <span>Mass</span> <span>Index</span>: <span>A</span> <span>Systematic</span> <span>Review</span> and <span>Meta</span>-<span>Regression</span>.”</span> <em>Frontiers in Endocrinology</em> 3 (February). <a href="https://doi.org/10.3389/fendo.2012.00029">https://doi.org/10.3389/fendo.2012.00029</a>.
</div>
<div id="ref-ge_polygenic_2019" class="csl-entry" role="listitem">
Ge, Tian, Chia-Yen Chen, Yang Ni, Yen-Chen Anne Feng, and Jordan W. Smoller. 2019. <span>“Polygenic Prediction via <span>Bayesian</span> Regression and Continuous Shrinkage Priors.”</span> <em>Nature Communications</em> 10 (1): 1776. <a href="https://doi.org/10.1038/s41467-019-09718-5">https://doi.org/10.1038/s41467-019-09718-5</a>.
</div>
<div id="ref-hilker_heritability_2018" class="csl-entry" role="listitem">
Hilker, Rikke, Dorte Helenius, Birgitte Fagerlund, Axel Skytthe, Kaare Christensen, Thomas M. Werge, Merete Nordentoft, and Birte Glenthøj. 2018. <span>“Heritability of <span>Schizophrenia</span> and <span>Schizophrenia</span> <span>Spectrum</span> <span>Based</span> on the <span>Nationwide</span> <span>Danish</span> <span>Twin</span> <span>Register</span>.”</span> <em>Biological Psychiatry</em>, Novel <span>Mechanisms</span> in <span>Schizophrenia</span> <span>Pathophysiology</span>, 83 (6): 492–98. <a href="https://doi.org/10.1016/j.biopsych.2017.08.017">https://doi.org/10.1016/j.biopsych.2017.08.017</a>.
</div>
<div id="ref-hormozdiari_identifying_2014" class="csl-entry" role="listitem">
Hormozdiari, Farhad, Emrah Kostem, Eun Yong kang, Bogdan Pasaniuc, and Eleazar Eskin. 2014. <span>“Identifying Causal Variants at Loci with Multiple Signals of Association.”</span> In <em>Proceedings of the 5th <span>ACM</span> <span>Conference</span> on <span>Bioinformatics</span>, <span>Computational</span> <span>Biology</span>, and <span>Health</span> <span>Informatics</span></em>, 610–11. <span>BCB</span> ’14. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/2649387.2660800">https://doi.org/10.1145/2649387.2660800</a>.
</div>
<div id="ref-ionita-laza_spectral_2016" class="csl-entry" role="listitem">
Ionita-Laza, Iuliana, Kenneth McCallum, Bin Xu, and Joseph D. Buxbaum. 2016. <span>“A Spectral Approach Integrating Functional Genomic Annotations for Coding and Noncoding Variants.”</span> <em>Nature Genetics</em> 48 (2): 214–20. <a href="https://doi.org/10.1038/ng.3477">https://doi.org/10.1038/ng.3477</a>.
</div>
<div id="ref-khera_genome-wide_2017" class="csl-entry" role="listitem">
Khera, Amit V., and Sekar Kathiresan. 2017. <span>“Genetics of Coronary Artery Disease: Discovery, Biology and Clinical Translation.”</span> <em>Nature Reviews Genetics</em> 18 (6): 331–44. <a href="https://doi.org/10.1038/nrg.2016.160">https://doi.org/10.1038/nrg.2016.160</a>.
</div>
<div id="ref-kichaev_improved_2017" class="csl-entry" role="listitem">
Kichaev, Gleb, Megan Roytman, Ruth Johnson, Eleazar Eskin, Sara Lindström, Peter Kraft, and Bogdan Pasaniuc. 2017. <span>“Improved Methods for Multi-Trait Fine Mapping of Pleiotropic Risk Loci.”</span> <em>Bioinformatics</em> 33 (2): 248–55. <a href="https://doi.org/10.1093/bioinformatics/btw615">https://doi.org/10.1093/bioinformatics/btw615</a>.
</div>
<div id="ref-kircher_general_2014" class="csl-entry" role="listitem">
Kircher, Martin, Daniela M. Witten, Preti Jain, Brian J. O’Roak, Gregory M. Cooper, and Jay Shendure. 2014. <span>“A General Framework for Estimating the Relative Pathogenicity of Human Genetic Variants.”</span> <em>Nature Genetics</em> 46 (3): 310–15. <a href="https://doi.org/10.1038/ng.2892">https://doi.org/10.1038/ng.2892</a>.
</div>
<div id="ref-lambert_polygenic_2019" class="csl-entry" role="listitem">
Lambert, Samuel A, Gad Abraham, and Michael Inouye. 2019. <span>“Towards Clinical Utility of Polygenic Risk Scores.”</span> <em>Human Molecular Genetics</em> 28 (R2): R133–42. <a href="https://doi.org/10.1093/hmg/ddz187">https://doi.org/10.1093/hmg/ddz187</a>.
</div>
<div id="ref-maller_bayesian_2012" class="csl-entry" role="listitem">
Maller, Julian B., Gilean McVean, Jake Byrnes, Damjan Vukcevic, Kimmo Palin, Zhan Su, Joanna M. M. Howson, et al. 2012. <span>“Bayesian Refinement of Association Signals for 14 Loci in 3 Common Diseases.”</span> <em>Nature Genetics</em> 44 (12): 1294–1301. <a href="https://doi.org/10.1038/ng.2435">https://doi.org/10.1038/ng.2435</a>.
</div>
<div id="ref-manolio_finding_2009" class="csl-entry" role="listitem">
Manolio, Teri A., Francis S. Collins, Nancy J. Cox, David B. Goldstein, Lucia A. Hindorff, David J. Hunter, Mark I. McCarthy, et al. 2009. <span>“Finding the Missing Heritability of Complex Diseases.”</span> <em>Nature</em> 461 (7265): 747–53. <a href="https://doi.org/10.1038/nature08494">https://doi.org/10.1038/nature08494</a>.
</div>
<div id="ref-marquez-luna_multiethnic_2017" class="csl-entry" role="listitem">
Márquez-Luna, Carla, Po-Ru Loh, South Asian Type 2 Diabetes (SAT2D) Consortium, The SIGMA Type 2 Diabetes Consortium, and Alkes L. Price. 2017. <span>“Multiethnic Polygenic Risk Scores Improve Risk Prediction in Diverse Populations.”</span> <em>Genetic Epidemiology</em> 41 (8): 811–23. <a href="https://doi.org/10.1002/gepi.22083">https://doi.org/10.1002/gepi.22083</a>.
</div>
<div id="ref-martin_clinical_2019" class="csl-entry" role="listitem">
Martin, Alicia R., Masahiro Kanai, Yoichiro Kamatani, Yukinori Okada, Benjamin M. Neale, and Mark J. Daly. 2019. <span>“Clinical Use of Current Polygenic Risk Scores May Exacerbate Health Disparities.”</span> <em>Nature Genetics</em> 51 (4): 584–91. <a href="https://doi.org/10.1038/s41588-019-0379-x">https://doi.org/10.1038/s41588-019-0379-x</a>.
</div>
<div id="ref-mavaddat_polygenic_2019" class="csl-entry" role="listitem">
Mavaddat, Nasim, Kyriaki Michailidou, Joe Dennis, Michael Lush, Laura Fachal, Andrew Lee, Jonathan P. Tyrer, et al. 2019. <span>“Polygenic <span>Risk</span> <span>Scores</span> for <span>Prediction</span> of <span>Breast</span> <span>Cancer</span> and <span>Breast</span> <span>Cancer</span> <span>Subtypes</span>.”</span> <em>The American Journal of Human Genetics</em> 104 (1): 21–34. <a href="https://doi.org/10.1016/j.ajhg.2018.11.002">https://doi.org/10.1016/j.ajhg.2018.11.002</a>.
</div>
<div id="ref-mountjoy_open_2021" class="csl-entry" role="listitem">
Mountjoy, Edward, Ellen M. Schmidt, Miguel Carmona, Jeremy Schwartzentruber, Gareth Peat, Alfredo Miranda, Luca Fumis, et al. 2021. <span>“An Open Approach to Systematically Prioritize Causal Variants and Genes at All Published Human <span>GWAS</span> Trait-Associated Loci.”</span> <em>Nature Genetics</em> 53 (11): 1527–33. <a href="https://doi.org/10.1038/s41588-021-00945-5">https://doi.org/10.1038/s41588-021-00945-5</a>.
</div>
<div id="ref-mukherjee_embedgem_2024" class="csl-entry" role="listitem">
Mukherjee, Sumit, Zachary R. McCaw, Jingwen Pei, Anna Merkoulovitch, Tom Soare, Raghav Tandon, David Amar, et al. 2024. <span>“<span>EmbedGEM</span>: A Framework to Evaluate the Utility of Embeddings for Genetic Discovery.”</span> <em>Bioinformatics Advances</em> 4 (1). <a href="https://doi.org/10.1093/bioadv/vbae135">https://doi.org/10.1093/bioadv/vbae135</a>.
</div>
<div id="ref-patterson_population_2006" class="csl-entry" role="listitem">
Patterson, Nick, Alkes L. Price, and David Reich. 2006. <span>“Population <span>Structure</span> and <span>Eigenanalysis</span>.”</span> <em>PLOS Genetics</em> 2 (12): e190. <a href="https://doi.org/10.1371/journal.pgen.0020190">https://doi.org/10.1371/journal.pgen.0020190</a>.
</div>
<div id="ref-peer_estimation_2008" class="csl-entry" role="listitem">
Pe’er, Itsik, Roman Yelensky, David Altshuler, and Mark J. Daly. 2008. <span>“Estimation of the Multiple Testing Burden for Genomewide Association Studies of Nearly All Common Variants.”</span> <em>Genetic Epidemiology</em> 32 (4): 381–85. <a href="https://doi.org/10.1002/gepi.20303">https://doi.org/10.1002/gepi.20303</a>.
</div>
<div id="ref-price_pca_2006" class="csl-entry" role="listitem">
Price, Alkes L., Nick J. Patterson, Robert M. Plenge, Michael E. Weinblatt, Nancy A. Shadick, and David Reich. 2006. <span>“Principal Components Analysis Corrects for Stratification in Genome-Wide Association Studies.”</span> <em>Nature Genetics</em> 38 (8): 904–9. <a href="https://doi.org/10.1038/ng1847">https://doi.org/10.1038/ng1847</a>.
</div>
<div id="ref-quang_dann_2015" class="csl-entry" role="listitem">
Quang, Daniel, Yifei Chen, and Xiaohui Xie. 2015. <span>“<span>DANN</span>: A Deep Learning Approach for Annotating the Pathogenicity of Genetic Variants.”</span> <em>Bioinformatics</em> 31 (5): 761–63. <a href="https://doi.org/10.1093/bioinformatics/btu703">https://doi.org/10.1093/bioinformatics/btu703</a>.
</div>
<div id="ref-risch_future_1996" class="csl-entry" role="listitem">
Risch, Neil, and Kathleen Merikangas. 1996. <span>“The <span>Future</span> of <span>Genetic</span> <span>Studies</span> of <span>Complex</span> <span>Human</span> <span>Diseases</span>.”</span> <em>Science</em> 273 (5281): 1516–17. <a href="https://doi.org/10.1126/science.273.5281.1516">https://doi.org/10.1126/science.273.5281.1516</a>.
</div>
<div id="ref-torkamani_personal_2018" class="csl-entry" role="listitem">
Torkamani, Ali, Nathan E. Wineinger, and Eric J. Topol. 2018. <span>“The Personal and Clinical Utility of Polygenic Risk Scores.”</span> <em>Nature Reviews Genetics</em> 19 (9): 581–90. <a href="https://doi.org/10.1038/s41576-018-0018-x">https://doi.org/10.1038/s41576-018-0018-x</a>.
</div>
<div id="ref-vilhjalmsson_modeling_2015" class="csl-entry" role="listitem">
Vilhjálmsson, Bjarni J., Jian Yang, Hilary K. Finucane, Alexander Gusev, Sara Lindström, Stephan Ripke, Giulio Genovese, et al. 2015. <span>“Modeling <span>Linkage</span> <span>Disequilibrium</span> <span>Increases</span> <span>Accuracy</span> of <span>Polygenic</span> <span>Risk</span> <span>Scores</span>.”</span> <em>American Journal of Human Genetics</em> 97 (4): 576–92. <a href="https://doi.org/10.1016/j.ajhg.2015.09.001">https://doi.org/10.1016/j.ajhg.2015.09.001</a>.
</div>
<div id="ref-visscher_heritability_2008" class="csl-entry" role="listitem">
Visscher, Peter M., William G. Hill, and Naomi R. Wray. 2008. <span>“Heritability in the Genomics Era — Concepts and Misconceptions.”</span> <em>Nature Reviews Genetics</em> 9 (4): 255–66. <a href="https://doi.org/10.1038/nrg2322">https://doi.org/10.1038/nrg2322</a>.
</div>
<div id="ref-wang_simple_2020" class="csl-entry" role="listitem">
Wang, Gao, Abhishek Sarkar, Peter Carbonetto, and Matthew Stephens. 2020. <span>“A <span>Simple</span> <span>New</span> <span>Approach</span> to <span>Variable</span> <span>Selection</span> in <span>Regression</span>, with <span>Application</span> to <span>Genetic</span> <span>Fine</span> <span>Mapping</span>.”</span> <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em> 82 (5): 1273–1300. <a href="https://doi.org/10.1111/rssb.12388">https://doi.org/10.1111/rssb.12388</a>.
</div>
<div id="ref-xu_improving_2025" class="csl-entry" role="listitem">
Xu, Leqi, Wangjie Zheng, Jiaqi Hu, Yingxin Lin, Jia Zhao, Gefei Wang, Tianyu Liu, and Hongyu Zhao. 2025. <span>“Improving Polygenic Risk Prediction Performance by Integrating Electronic Health Records Through Phenotype Embedding.”</span> <em>The American Journal of Human Genetics</em> 112 (12): 3030–45. <a href="https://doi.org/10.1016/j.ajhg.2025.11.006">https://doi.org/10.1016/j.ajhg.2025.11.006</a>.
</div>
<div id="ref-yang_common_2010" class="csl-entry" role="listitem">
Yang, Jian, Beben Benyamin, Brian P. McEvoy, Scott Gordon, Anjali K. Henders, Dale R. Nyholt, Pamela A. Madden, et al. 2010. <span>“Common <span>SNPs</span> Explain a Large Proportion of the Heritability for Human Height.”</span> <em>Nature Genetics</em> 42 (7): 565–69. <a href="https://doi.org/10.1038/ng.608">https://doi.org/10.1038/ng.608</a>.
</div>
<div id="ref-yengo_meta-analysis_2022" class="csl-entry" role="listitem">
Yengo, Loïc, Sailaja Vedantam, Eirini Marouli, Julia Sidorenko, Eric Bartell, Saori Sakaue, Marielisa Graff, et al. 2022. <span>“A Saturated Map of Common Genetic Variants Associated with Human Height.”</span> <em>Nature</em> 610 (7933): 704–12. <a href="https://doi.org/10.1038/s41586-022-05275-y">https://doi.org/10.1038/s41586-022-05275-y</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_1/p1-ch02-data.html" class="pagination-link" aria-label="Data Landscape">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_1/p1-ch04-vep-classical.html" class="pagination-link" aria-label="Classical Variant Prediction">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>