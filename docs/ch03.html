<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Establishing Genome-Wide Deleteriousness Scores (CADD) – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch04.html" rel="next">
<link href="./ch02.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch01.html">Part I: Foundations of Genomic Data and Pre-DL Interpretation</a></li><li class="breadcrumb-item"><a href="./ch03.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Establishing Genome-Wide Deleteriousness Scores (CADD)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Foundations of Genomic Data and Pre-DL Interpretation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Next-Generation Sequencing (NGS) and High-Fidelity Variant Calling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Polygenic Risk Scores and GWAS Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch03.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Establishing Genome-Wide Deleteriousness Scores (CADD)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Foundational Functional Genomics Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Pioneering Sequence-to-Function Deep Learning (CNN Era)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Predicting Transcriptional Effects (ExPecto)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Specialized Prediction – Splicing (SpliceAI)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Architectural Shift to Attention and Foundation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: The Age of Transformers and Long-Range Context (Hybrid Era)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Integrating Long-Range Interactions for Expression Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">State-of-the-Art in VEP – Missense, Multi-Modality, and Conservation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Scaling Sequence Context Beyond Attention</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: Modern Frontiers – GFMs, Specialized Systems, and Multi-omics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Integrating Multi-omics and Systems Context</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-variant-prioritization-challenge" id="toc-the-variant-prioritization-challenge" class="nav-link active" data-scroll-target="#the-variant-prioritization-challenge"><span class="header-section-number">3.1</span> The Variant Prioritization Challenge</a></li>
  <li><a href="#the-evolutionary-proxy-training-strategy" id="toc-the-evolutionary-proxy-training-strategy" class="nav-link" data-scroll-target="#the-evolutionary-proxy-training-strategy"><span class="header-section-number">3.2</span> The Evolutionary Proxy Training Strategy</a>
  <ul class="collapse">
  <li><a href="#proxy-neutral-variants" id="toc-proxy-neutral-variants" class="nav-link" data-scroll-target="#proxy-neutral-variants"><span class="header-section-number">3.2.1</span> Proxy-Neutral Variants</a></li>
  <li><a href="#proxy-deleterious-variants" id="toc-proxy-deleterious-variants" class="nav-link" data-scroll-target="#proxy-deleterious-variants"><span class="header-section-number">3.2.2</span> Proxy-Deleterious Variants</a></li>
  <li><a href="#training-objective" id="toc-training-objective" class="nav-link" data-scroll-target="#training-objective"><span class="header-section-number">3.2.3</span> Training Objective</a></li>
  </ul></li>
  <li><a href="#integration-of-diverse-annotations" id="toc-integration-of-diverse-annotations" class="nav-link" data-scroll-target="#integration-of-diverse-annotations"><span class="header-section-number">3.3</span> Integration of Diverse Annotations</a>
  <ul class="collapse">
  <li><a href="#gene-model-annotations" id="toc-gene-model-annotations" class="nav-link" data-scroll-target="#gene-model-annotations"><span class="header-section-number">3.3.1</span> Gene Model Annotations</a></li>
  <li><a href="#conservation-and-constraint" id="toc-conservation-and-constraint" class="nav-link" data-scroll-target="#conservation-and-constraint"><span class="header-section-number">3.3.2</span> Conservation and Constraint</a></li>
  <li><a href="#epigenetic-and-regulatory-activity" id="toc-epigenetic-and-regulatory-activity" class="nav-link" data-scroll-target="#epigenetic-and-regulatory-activity"><span class="header-section-number">3.3.3</span> Epigenetic and Regulatory Activity</a></li>
  <li><a href="#additional-features" id="toc-additional-features" class="nav-link" data-scroll-target="#additional-features"><span class="header-section-number">3.3.4</span> Additional Features</a></li>
  </ul></li>
  <li><a href="#model-architecture-and-scoring" id="toc-model-architecture-and-scoring" class="nav-link" data-scroll-target="#model-architecture-and-scoring"><span class="header-section-number">3.4</span> Model Architecture and Scoring</a>
  <ul class="collapse">
  <li><a href="#machine-learning-framework" id="toc-machine-learning-framework" class="nav-link" data-scroll-target="#machine-learning-framework"><span class="header-section-number">3.4.1</span> Machine Learning Framework</a></li>
  <li><a href="#phred-scaled-scores" id="toc-phred-scaled-scores" class="nav-link" data-scroll-target="#phred-scaled-scores"><span class="header-section-number">3.4.2</span> PHRED-Scaled Scores</a></li>
  </ul></li>
  <li><a href="#cadd-v1.7-integration-of-deep-learning-predictions" id="toc-cadd-v1.7-integration-of-deep-learning-predictions" class="nav-link" data-scroll-target="#cadd-v1.7-integration-of-deep-learning-predictions"><span class="header-section-number">3.5</span> CADD v1.7: Integration of Deep Learning Predictions</a>
  <ul class="collapse">
  <li><a href="#protein-language-model-features" id="toc-protein-language-model-features" class="nav-link" data-scroll-target="#protein-language-model-features"><span class="header-section-number">3.5.1</span> Protein Language Model Features</a></li>
  <li><a href="#regulatory-cnn-predictions" id="toc-regulatory-cnn-predictions" class="nav-link" data-scroll-target="#regulatory-cnn-predictions"><span class="header-section-number">3.5.2</span> Regulatory CNN Predictions</a></li>
  <li><a href="#extended-conservation-scores" id="toc-extended-conservation-scores" class="nav-link" data-scroll-target="#extended-conservation-scores"><span class="header-section-number">3.5.3</span> Extended Conservation Scores</a></li>
  <li><a href="#performance-improvements" id="toc-performance-improvements" class="nav-link" data-scroll-target="#performance-improvements"><span class="header-section-number">3.5.4</span> Performance Improvements</a></li>
  </ul></li>
  <li><a href="#benchmarking-against-alternative-approaches" id="toc-benchmarking-against-alternative-approaches" class="nav-link" data-scroll-target="#benchmarking-against-alternative-approaches"><span class="header-section-number">3.6</span> Benchmarking Against Alternative Approaches</a>
  <ul class="collapse">
  <li><a href="#coding-variants" id="toc-coding-variants" class="nav-link" data-scroll-target="#coding-variants"><span class="header-section-number">3.6.1</span> Coding Variants</a></li>
  <li><a href="#non-coding-variants" id="toc-non-coding-variants" class="nav-link" data-scroll-target="#non-coding-variants"><span class="header-section-number">3.6.2</span> Non-coding Variants</a></li>
  <li><a href="#population-frequency-correlation" id="toc-population-frequency-correlation" class="nav-link" data-scroll-target="#population-frequency-correlation"><span class="header-section-number">3.6.3</span> Population Frequency Correlation</a></li>
  </ul></li>
  <li><a href="#significance-for-genomic-deep-learning" id="toc-significance-for-genomic-deep-learning" class="nav-link" data-scroll-target="#significance-for-genomic-deep-learning"><span class="header-section-number">3.7</span> Significance for Genomic Deep Learning</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch01.html">Part I: Foundations of Genomic Data and Pre-DL Interpretation</a></li><li class="breadcrumb-item"><a href="./ch03.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Establishing Genome-Wide Deleteriousness Scores (CADD)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Establishing Genome-Wide Deleteriousness Scores (CADD)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-variant-prioritization-challenge" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-variant-prioritization-challenge"><span class="header-section-number">3.1</span> The Variant Prioritization Challenge</h2>
<p>The human genome harbors millions of genetic variants, the vast majority of which have unknown functional consequences. While Chapter 1 addressed distinguishing true variants from sequencing artifacts and Chapter 2 examined statistical association with phenotypes, a complementary challenge remains: predicting which variants are likely deleterious across the entire genome, including both coding and non-coding regions.</p>
<p>Traditional approaches to variant prioritization suffer from critical limitations:</p>
<ul>
<li><strong>Single-feature scores</strong>: Most methods exploit a single information type (e.g., conservation) and cannot integrate diverse signals</li>
<li><strong>Restricted scope</strong>: Many tools focus exclusively on missense variants or specific genomic contexts</li>
<li><strong>Training set bias</strong>: Supervised methods trained on ClinVar or HGMD pathogenic variants inherit biases toward well-studied genes and variant types</li>
</ul>
<p>Combined Annotation-Dependent Depletion (CADD) addresses these limitations through a fundamentally different approach: rather than training directly on known pathogenic variants, CADD learns to distinguish variants that survived evolutionary selection from those that did not <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref"><strong>rentzsch_cadd_2019?</strong></a>)</span>.</p>
</section>
<section id="the-evolutionary-proxy-training-strategy" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="the-evolutionary-proxy-training-strategy"><span class="header-section-number">3.2</span> The Evolutionary Proxy Training Strategy</h2>
<p>CADD’s innovation lies in its training data construction. Rather than relying on curated pathogenic/benign labels—which are sparse, biased, and incomplete—CADD exploits evolutionary history as a proxy for deleteriousness.</p>
<section id="proxy-neutral-variants" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="proxy-neutral-variants"><span class="header-section-number">3.2.1</span> Proxy-Neutral Variants</h3>
<p>The proxy-neutral training set consists of approximately 15 million SNVs and 1.8 million indels that are:</p>
<ul>
<li><strong>Human-derived</strong>: Present in modern humans but absent in the inferred human-ape ancestor genome</li>
<li><strong>Fixed or nearly fixed</strong>: Allele frequency of 95–100% in human populations</li>
</ul>
<p>These variants have persisted through millions of years of purifying selection since the human-chimpanzee divergence. By virtue of reaching fixation, they are overwhelmingly neutral or at most weakly deleterious—strong deleterious effects would have been purged by natural selection.</p>
</section>
<section id="proxy-deleterious-variants" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="proxy-deleterious-variants"><span class="header-section-number">3.2.2</span> Proxy-Deleterious Variants</h3>
<p>The proxy-deleterious set is generated through simulation, matching the sequence composition, substitution frequencies, and local mutation rate patterns of the proxy-neutral variants. These simulated “de novo” variants are free from selective pressure—they represent the full spectrum of possible mutations, including those that would be deleterious in a real genome.</p>
<p>While many simulated variants are indeed neutral, an unknown but substantial fraction would be harmful if they occurred in an individual. The key insight is that the <em>relative enrichment</em> of deleterious variants differs systematically between the two sets: proxy-neutral variants are depleted for deleterious alleles, while proxy-deleterious variants contain a representative sample.</p>
</section>
<section id="training-objective" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="training-objective"><span class="header-section-number">3.2.3</span> Training Objective</h3>
<p>A machine learning classifier trained to distinguish proxy-neutral from proxy-deleterious variants effectively learns which annotation features characterize variants likely to be “observed” (survived selection) versus “simulated” (potentially deleterious). Higher CADD scores indicate variants more similar to the simulated set—and thus more likely to have functional consequences.</p>
<p>This approach provides several advantages over pathogenicity-based training:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Aspect</th>
<th>CADD Approach</th>
<th>Pathogenicity Training</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Training set size</td>
<td>~30 million variants</td>
<td>Thousands of variants</td>
</tr>
<tr class="even">
<td>Genome coverage</td>
<td>All regions equally</td>
<td>Biased toward coding</td>
</tr>
<tr class="odd">
<td>Gene bias</td>
<td>Minimal</td>
<td>Concentrated in disease genes</td>
</tr>
<tr class="even">
<td>Variant type bias</td>
<td>Minimal</td>
<td>Biased toward missense</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="integration-of-diverse-annotations" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="integration-of-diverse-annotations"><span class="header-section-number">3.3</span> Integration of Diverse Annotations</h2>
<p>CADD’s strength derives from integrating more than 60 distinct genomic annotations into a unified framework. These annotations span multiple categories:</p>
<section id="gene-model-annotations" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="gene-model-annotations"><span class="header-section-number">3.3.1</span> Gene Model Annotations</h3>
<p>Ensembl Variant Effect Predictor (VEP) provides consequence predictions including:</p>
<ul>
<li>Transcript location (exon, intron, UTR, intergenic)</li>
<li>Protein-coding effects (synonymous, missense, nonsense, frameshift)</li>
<li>Distance to splice sites and transcript features</li>
<li>Amino acid properties for missense variants</li>
</ul>
</section>
<section id="conservation-and-constraint" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="conservation-and-constraint"><span class="header-section-number">3.3.2</span> Conservation and Constraint</h3>
<p>Multiple evolutionary conservation scores capture selective pressure across different timescales:</p>
<ul>
<li><strong>PhyloP</strong>: Position-specific conservation across 46 vertebrate species</li>
<li><strong>PhastCons</strong>: Probability of negative selection estimated from multiple alignments</li>
<li><strong>GERP++</strong>: Rejected substitution scores indicating purifying selection</li>
<li><strong>GerpN/GerpS</strong>: Neutral evolution and constrained element scores</li>
</ul>
</section>
<section id="epigenetic-and-regulatory-activity" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="epigenetic-and-regulatory-activity"><span class="header-section-number">3.3.3</span> Epigenetic and Regulatory Activity</h3>
<p>Data from ENCODE and NIH Roadmap Epigenomics provide chromatin state information:</p>
<ul>
<li>DNase I hypersensitivity</li>
<li>Histone modifications (H3K4me1, H3K4me3, H3K27ac, etc.)</li>
<li>Transcription factor binding sites</li>
<li>Chromatin accessibility across cell types</li>
</ul>
</section>
<section id="additional-features" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="additional-features"><span class="header-section-number">3.3.4</span> Additional Features</h3>
<ul>
<li>CpG dinucleotide context and mutation rates</li>
<li>Sequence properties (GC content, repeat regions)</li>
<li>Population genetics metrics (allele frequency distributions)</li>
<li>Protein domain annotations</li>
</ul>
</section>
</section>
<section id="model-architecture-and-scoring" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="model-architecture-and-scoring"><span class="header-section-number">3.4</span> Model Architecture and Scoring</h2>
<section id="machine-learning-framework" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="machine-learning-framework"><span class="header-section-number">3.4.1</span> Machine Learning Framework</h3>
<p>CADD v1.0 employed a support vector machine (SVM) with a linear kernel. Subsequent versions transitioned to logistic regression, which provides:</p>
<ul>
<li>Faster training and inference</li>
<li>Interpretable feature weights</li>
<li>Efficient handling of crossed features</li>
</ul>
<p>To capture non-linear relationships between annotations, CADD creates crossed feature annotations—for example, combining conservation scores with consequence labels to allow the model to weight conservation differently for missense versus synonymous variants.</p>
</section>
<section id="phred-scaled-scores" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="phred-scaled-scores"><span class="header-section-number">3.4.2</span> PHRED-Scaled Scores</h3>
<p>Raw CADD scores are difficult to interpret across genomic contexts. To enable meaningful comparisons, CADD transforms raw scores into PHRED-like scaled scores based on genome-wide rank:</p>
<p><span class="math display">\[\text{CADD}_\text{PHRED} = -10 \cdot \log_{10}\left(\frac{\text{rank}}{N}\right)\]</span></p>
<p>where <span class="math inline">\(N\)</span> ≈ 9 billion represents all possible single nucleotide substitutions in the reference genome. A CADD score of 10 indicates the variant is in the top 10% most deleterious; a score of 20 indicates the top 1%; a score of 30 indicates the top 0.1%.</p>
<p>This scaling provides intuitive interpretation: CADD 15–20 typically indicates likely functional variants, while CADD &gt; 30 suggests strong deleteriousness.</p>
</section>
</section>
<section id="cadd-v1.7-integration-of-deep-learning-predictions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="cadd-v1.7-integration-of-deep-learning-predictions"><span class="header-section-number">3.5</span> CADD v1.7: Integration of Deep Learning Predictions</h2>
<p>The most recent CADD release (v1.7) demonstrates how the annotation integration framework can incorporate predictions from deep learning models <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>. This represents a bridge between traditional annotation-based approaches and the sequence-to-function models covered in subsequent chapters.</p>
<section id="protein-language-model-features" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="protein-language-model-features"><span class="header-section-number">3.5.1</span> Protein Language Model Features</h3>
<p>CADD v1.7 incorporates scores from Meta ESM-1v, a protein language model trained on millions of protein sequences. ESM-1v provides:</p>
<ul>
<li>Per-residue fitness predictions based on evolutionary plausibility</li>
<li>Improved missense variant prioritization</li>
<li>Context-aware amino acid substitution scoring</li>
</ul>
<p>These features substantially improve CADD’s performance on coding variants, particularly for missense mutations in conserved protein regions.</p>
</section>
<section id="regulatory-cnn-predictions" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="regulatory-cnn-predictions"><span class="header-section-number">3.5.2</span> Regulatory CNN Predictions</h3>
<p>For non-coding variants, CADD v1.7 integrates predictions from a custom convolutional neural network trained on regions of open chromatin. This model:</p>
<ul>
<li>Predicts regulatory activity from DNA sequence</li>
<li>Provides variant effect scores for regulatory elements</li>
<li>Captures sequence patterns associated with transcription factor binding</li>
</ul>
</section>
<section id="extended-conservation-scores" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="extended-conservation-scores"><span class="header-section-number">3.5.3</span> Extended Conservation Scores</h3>
<p>The Zoonomia project’s alignment of &gt;240 mammalian genomes provides deeper evolutionary context through:</p>
<ul>
<li>Broader phylogenetic sampling</li>
<li>Improved resolution of constrained elements</li>
<li>Better detection of lineage-specific selection</li>
</ul>
</section>
<section id="performance-improvements" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="performance-improvements"><span class="header-section-number">3.5.4</span> Performance Improvements</h3>
<p>Evaluation on multiple benchmarks demonstrates consistent gains:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Benchmark</th>
<th>CADD v1.6</th>
<th>CADD v1.7</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ClinVar pathogenic vs.&nbsp;common</td>
<td>0.94</td>
<td>0.95</td>
<td>+1%</td>
</tr>
<tr class="even">
<td>Deep mutational scanning (31 datasets)</td>
<td>0.78</td>
<td>0.81</td>
<td>+3%</td>
</tr>
<tr class="odd">
<td>Regulatory saturation mutagenesis</td>
<td>0.68</td>
<td>0.72</td>
<td>+4%</td>
</tr>
</tbody>
</table>
<p>The regulatory variant improvements are particularly notable, as this has historically been CADD’s weakest domain.</p>
</section>
</section>
<section id="benchmarking-against-alternative-approaches" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="benchmarking-against-alternative-approaches"><span class="header-section-number">3.6</span> Benchmarking Against Alternative Approaches</h2>
<p>CADD’s genome-wide applicability allows direct comparison with specialized scores:</p>
<section id="coding-variants" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="coding-variants"><span class="header-section-number">3.6.1</span> Coding Variants</h3>
<p>For missense variant classification separating ClinVar pathogenic from high-frequency ExAC variants, CADD performs comparably to dedicated tools like PolyPhen-2 and PROVEAN while maintaining broader applicability. The integration of ESM-1v features in v1.7 further improves coding variant prediction.</p>
</section>
<section id="non-coding-variants" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="non-coding-variants"><span class="header-section-number">3.6.2</span> Non-coding Variants</h3>
<p>CADD demonstrates strong performance on regulatory variants, though recent benchmarks suggest functional-genomics-supervised models like Enformer and Borzoi may perform better for certain variant classes. Interestingly, alignment-based models including CADD and GPN-MSA compare favorably for Mendelian and complex disease traits, while expression-predicting models excel for complex non-disease traits <span class="citation" data-cites="benegas_traitgym_2025">(<a href="references.html#ref-benegas_traitgym_2025" role="doc-biblioref">Benegas, Eraslan, and Song 2025</a>)</span>.</p>
</section>
<section id="population-frequency-correlation" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="population-frequency-correlation"><span class="header-section-number">3.6.3</span> Population Frequency Correlation</h3>
<p>A key validation of CADD’s evolutionary proxy approach is the strong inverse correlation between CADD scores and population allele frequency. Higher-scoring variants are systematically rarer in population databases like gnomAD, consistent with purifying selection removing deleterious alleles—the same principle underlying the training strategy.</p>
</section>
</section>
<section id="significance-for-genomic-deep-learning" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="significance-for-genomic-deep-learning"><span class="header-section-number">3.7</span> Significance for Genomic Deep Learning</h2>
<p>CADD established several important paradigms that inform the deep learning approaches covered in subsequent chapters:</p>
<ol type="1">
<li><p><strong>Annotation integration</strong>: The principle of combining multiple information sources into unified predictions extends naturally to multi-headed neural network architectures that jointly predict diverse genomic features.</p></li>
<li><p><strong>Evolutionary training signals</strong>: Using evolutionary conservation as a proxy for function—rather than curated pathogenicity labels—avoids biases and provides genome-wide coverage. This approach reappears in protein language models and genomic foundation models.</p></li>
<li><p><strong>Genome-wide applicability</strong>: CADD demonstrated that a single framework could score any variant anywhere in the genome, setting expectations for the comprehensive coverage that sequence-to-function models now achieve.</p></li>
<li><p><strong>Continuous improvement through feature addition</strong>: The progression from CADD v1.0 to v1.7 shows how deep learning predictions can be incorporated as features into existing frameworks, providing a practical integration path.</p></li>
</ol>
<p>The chapters that follow trace how deep learning models moved from providing features to CADD-like integrators toward directly predicting variant effects from DNA sequence—learning the regulatory grammar that explains <em>why</em> evolutionary conservation patterns emerge.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-benegas_traitgym_2025" class="csl-entry" role="listitem">
Benegas, Gonzalo, Gökcen Eraslan, and Yun S. Song. 2025. <span>“[<span>TraitGym</span>] <span>Benchmarking</span> <span>DNA</span> <span>Sequence</span> <span>Models</span> for <span>Causal</span> <span>Regulatory</span> <span>Variant</span> <span>Prediction</span> in <span>Human</span> <span>Genetics</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2025.02.11.637758">https://doi.org/10.1101/2025.02.11.637758</a>.
</div>
<div id="ref-schubach_cadd_2024" class="csl-entry" role="listitem">
Schubach, Max, Thorben Maass, Lusiné Nazaretyan, Sebastian Röner, and Martin Kircher. 2024. <span>“<span>CADD</span> V1.7: Using Protein Language Models, Regulatory <span>CNNs</span> and Other Nucleotide-Level Scores to Improve Genome-Wide Variant Predictions.”</span> <em>Nucleic Acids Research</em> 52 (D1): D1143–54. <a href="https://doi.org/10.1093/nar/gkad989">https://doi.org/10.1093/nar/gkad989</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch02.html" class="pagination-link" aria-label="Polygenic Risk Scores and GWAS Foundations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Polygenic Risk Scores and GWAS Foundations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch04.html" class="pagination-link" aria-label="Foundational Functional Genomics Data">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Foundational Functional Genomics Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>