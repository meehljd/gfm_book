<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Variant Effect Prediction – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p5-ch21-confound.html" rel="next">
<link href="./p5-ch19-eval.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p5--eval-interp.html">Part V: Evaluation and Reliability</a></li><li class="breadcrumb-item"><a href="./p5-ch20-vep.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transformer Architecture for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-foundation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models: Concepts &amp; Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives &amp; Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning &amp; Deployment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">p4–multi-modal_multi-scale.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-vep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#from-handcrafted-scores-to-foundation-models" id="toc-from-handcrafted-scores-to-foundation-models" class="nav-link active" data-scroll-target="#from-handcrafted-scores-to-foundation-models"><span class="header-section-number">20.1</span> From Handcrafted Scores to Foundation Models</a></li>
  <li><a href="#zero-shot-protein-language-models-for-variant-scoring" id="toc-zero-shot-protein-language-models-for-variant-scoring" class="nav-link" data-scroll-target="#zero-shot-protein-language-models-for-variant-scoring"><span class="header-section-number">20.2</span> Zero-Shot Protein Language Models for Variant Scoring</a>
  <ul class="collapse">
  <li><a href="#evolutionary-models-over-msas-eve-and-popeve" id="toc-evolutionary-models-over-msas-eve-and-popeve" class="nav-link" data-scroll-target="#evolutionary-models-over-msas-eve-and-popeve"><span class="header-section-number">20.2.1</span> Evolutionary Models Over MSAs: EVE and popEVE</a></li>
  <li><a href="#large-protein-lms-esm-1v-and-related-models" id="toc-large-protein-lms-esm-1v-and-related-models" class="nav-link" data-scroll-target="#large-protein-lms-esm-1v-and-related-models"><span class="header-section-number">20.2.2</span> Large Protein LMs: ESM-1v and Related Models</a></li>
  <li><a href="#cross-protein-transfer-from-deep-mutational-scanning" id="toc-cross-protein-transfer-from-deep-mutational-scanning" class="nav-link" data-scroll-target="#cross-protein-transfer-from-deep-mutational-scanning"><span class="header-section-number">20.2.3</span> Cross-Protein Transfer from Deep Mutational Scanning</a></li>
  </ul></li>
  <li><a href="#alphamissense-proteome-wide-missense-pathogenicity" id="toc-alphamissense-proteome-wide-missense-pathogenicity" class="nav-link" data-scroll-target="#alphamissense-proteome-wide-missense-pathogenicity"><span class="header-section-number">20.3</span> AlphaMissense: Proteome-Wide Missense Pathogenicity</a>
  <ul class="collapse">
  <li><a href="#combining-sequence-and-structure" id="toc-combining-sequence-and-structure" class="nav-link" data-scroll-target="#combining-sequence-and-structure"><span class="header-section-number">20.3.1</span> Combining Sequence and Structure</a></li>
  <li><a href="#training-and-calibration" id="toc-training-and-calibration" class="nav-link" data-scroll-target="#training-and-calibration"><span class="header-section-number">20.3.2</span> Training and Calibration</a></li>
  <li><a href="#performance-and-clinical-utility" id="toc-performance-and-clinical-utility" class="nav-link" data-scroll-target="#performance-and-clinical-utility"><span class="header-section-number">20.3.3</span> Performance and Clinical Utility</a></li>
  <li><a href="#limitations-and-caveats" id="toc-limitations-and-caveats" class="nav-link" data-scroll-target="#limitations-and-caveats"><span class="header-section-number">20.3.4</span> Limitations and Caveats</a></li>
  </ul></li>
  <li><a href="#gpn-msa-alignment-based-dna-language-modeling" id="toc-gpn-msa-alignment-based-dna-language-modeling" class="nav-link" data-scroll-target="#gpn-msa-alignment-based-dna-language-modeling"><span class="header-section-number">20.4</span> GPN-MSA: Alignment-Based DNA Language Modeling</a>
  <ul class="collapse">
  <li><a href="#alignment-based-dna-language-model" id="toc-alignment-based-dna-language-model" class="nav-link" data-scroll-target="#alignment-based-dna-language-model"><span class="header-section-number">20.4.1</span> Alignment-Based DNA Language Model</a></li>
  <li><a href="#variant-scoring-strategies" id="toc-variant-scoring-strategies" class="nav-link" data-scroll-target="#variant-scoring-strategies"><span class="header-section-number">20.4.2</span> Variant Scoring Strategies</a></li>
  <li><a href="#benchmarking-and-applications" id="toc-benchmarking-and-applications" class="nav-link" data-scroll-target="#benchmarking-and-applications"><span class="header-section-number">20.4.3</span> Benchmarking and Applications</a></li>
  </ul></li>
  <li><a href="#evo-2-a-generalist-genomic-language-model" id="toc-evo-2-a-generalist-genomic-language-model" class="nav-link" data-scroll-target="#evo-2-a-generalist-genomic-language-model"><span class="header-section-number">20.5</span> Evo 2: A Generalist Genomic Language Model</a>
  <ul class="collapse">
  <li><a href="#scale-and-architecture" id="toc-scale-and-architecture" class="nav-link" data-scroll-target="#scale-and-architecture"><span class="header-section-number">20.5.1</span> Scale and Architecture</a></li>
  <li><a href="#zero-shot-variant-effect-scoring" id="toc-zero-shot-variant-effect-scoring" class="nav-link" data-scroll-target="#zero-shot-variant-effect-scoring"><span class="header-section-number">20.5.2</span> Zero-Shot Variant Effect Scoring</a></li>
  <li><a href="#fine-tuning-and-task-specific-heads" id="toc-fine-tuning-and-task-specific-heads" class="nav-link" data-scroll-target="#fine-tuning-and-task-specific-heads"><span class="header-section-number">20.5.3</span> Fine-Tuning and Task-Specific Heads</a></li>
  </ul></li>
  <li><a href="#alphagenome-unified-multi-omic-vep-at-1-mb-context" id="toc-alphagenome-unified-multi-omic-vep-at-1-mb-context" class="nav-link" data-scroll-target="#alphagenome-unified-multi-omic-vep-at-1-mb-context"><span class="header-section-number">20.6</span> AlphaGenome: Unified Multi-Omic VEP at 1 Mb Context</a>
  <ul class="collapse">
  <li><a href="#architecture-and-training" id="toc-architecture-and-training" class="nav-link" data-scroll-target="#architecture-and-training"><span class="header-section-number">20.6.1</span> Architecture and Training</a></li>
  <li><a href="#variant-effect-prediction-across-modalities" id="toc-variant-effect-prediction-across-modalities" class="nav-link" data-scroll-target="#variant-effect-prediction-across-modalities"><span class="header-section-number">20.6.2</span> Variant Effect Prediction Across Modalities</a></li>
  </ul></li>
  <li><a href="#comparing-design-choices-across-modern-vep-models" id="toc-comparing-design-choices-across-modern-vep-models" class="nav-link" data-scroll-target="#comparing-design-choices-across-modern-vep-models"><span class="header-section-number">20.7</span> Comparing Design Choices Across Modern VEP Models</a>
  <ul class="collapse">
  <li><a href="#specialized-vs-general-regulatory-models" id="toc-specialized-vs-general-regulatory-models" class="nav-link" data-scroll-target="#specialized-vs-general-regulatory-models"><span class="header-section-number">20.7.1</span> Specialized vs General Regulatory Models</a></li>
  <li><a href="#combining-predictors-in-practice" id="toc-combining-predictors-in-practice" class="nav-link" data-scroll-target="#combining-predictors-in-practice"><span class="header-section-number">20.7.2</span> Combining Predictors in Practice</a></li>
  </ul></li>
  <li><a href="#open-challenges-and-future-directions" id="toc-open-challenges-and-future-directions" class="nav-link" data-scroll-target="#open-challenges-and-future-directions"><span class="header-section-number">20.8</span> Open Challenges and Future Directions</a>
  <ul class="collapse">
  <li><a href="#ancestry-and-population-bias" id="toc-ancestry-and-population-bias" class="nav-link" data-scroll-target="#ancestry-and-population-bias"><span class="header-section-number">20.8.1</span> Ancestry and Population Bias</a></li>
  <li><a href="#complex-variant-patterns" id="toc-complex-variant-patterns" class="nav-link" data-scroll-target="#complex-variant-patterns"><span class="header-section-number">20.8.2</span> Complex Variant Patterns</a></li>
  <li><a href="#integrating-multi-omics-and-longitudinal-data" id="toc-integrating-multi-omics-and-longitudinal-data" class="nav-link" data-scroll-target="#integrating-multi-omics-and-longitudinal-data"><span class="header-section-number">20.8.3</span> Integrating Multi-Omics and Longitudinal Data</a></li>
  <li><a href="#interpretability-and-clinical-communication" id="toc-interpretability-and-clinical-communication" class="nav-link" data-scroll-target="#interpretability-and-clinical-communication"><span class="header-section-number">20.8.4</span> Interpretability and Clinical Communication</a></li>
  <li><a href="#safe-deployment-and-continual-learning" id="toc-safe-deployment-and-continual-learning" class="nav-link" data-scroll-target="#safe-deployment-and-continual-learning"><span class="header-section-number">20.8.5</span> Safe Deployment and Continual Learning</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p5--eval-interp.html">Part V: Evaluation and Reliability</a></li><li class="breadcrumb-item"><a href="./p5-ch20-vep.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-vep" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="from-handcrafted-scores-to-foundation-models" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="from-handcrafted-scores-to-foundation-models"><span class="header-section-number">20.1</span> From Handcrafted Scores to Foundation Models</h2>
<p>Variant effect prediction sits at the heart of modern genomics. Most variants discovered in clinical sequencing are rare and lack direct experimental evidence, yet clinicians must still decide whether a change is likely benign, pathogenic, or uncertain. The goal of variant effect prediction (VEP) is to map a variant and its context to a quantitative estimate of functional impact or disease risk that can support this decision.</p>
<p>Early computational approaches relied on hand-engineered features and relatively simple models. Conservation and heuristic-based scores such as SIFT and PolyPhen combine information about amino acid properties, sequence conservation, and protein domains to estimate whether a missense variant is damaging <span class="citation" data-cites="ng_sift_2003 adzhubei_polyphen_2010">(<a href="references.html#ref-ng_sift_2003" role="doc-biblioref">Ng and Henikoff 2003</a>; <a href="references.html#ref-adzhubei_polyphen_2010" role="doc-biblioref">Adzhubei et al. 2010</a>)</span>. CADD extends this idea to genome-wide scoring, integrating many annotations (e.g., conservation, regulatory marks, local sequence context) into a single pathogenicity score , <a href="p1-ch04-cadd.html" class="quarto-xref"><span>Chapter 4</span></a>. These methods were a major step forward, but they are fundamentally limited by the expressiveness of the hand-crafted features and by biases in the labeled data they use (<a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
<p>Deep learning methods widened the scope of VEP. Convolutional models like DeepSEA and ExPecto learn regulatory sequence features directly from raw DNA; splicing-focused models such as SpliceAI target specific molecular mechanisms, predicting how sequence changes alter splice donor/acceptor usage (<a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a>). Protein language models (<a href="p3-ch13-plm.html" class="quarto-xref"><span>Chapter 13</span></a>) learn high-dimensional representations of protein sequences that can be adapted for missense variant effect prediction, often outperforming feature-based scores.</p>
<p>The current frontier is defined by foundation models that treat DNA, RNA, and protein as languages, learning rich sequence representations from massive unlabeled corpora and then reusing those representations for variant interpretation. These models differ in their input modalities (protein vs DNA vs multi-species alignments), architectural choices (CNNs, transformers, state-space models), and training objectives (masked language modeling, autoregressive modeling, multi-task prediction), but they all aim to capture the evolutionary and regulatory constraints that shape observed variation.</p>
<p>This chapter focuses on four landmark systems that illustrate what modern foundation models look like when specialized for variant interpretation: AlphaMissense, a proteome-wide missense pathogenicity predictor that combines protein language models with structural context <span class="citation" data-cites="cheng_alphamissense_2023">(<a href="references.html#ref-cheng_alphamissense_2023" role="doc-biblioref">Cheng et al. 2023</a>)</span>; GPN-MSA, an alignment-based DNA language model that scores variants using multi-species sequence constraint <span class="citation" data-cites="benegas_gpn-msa_2024">(<a href="references.html#ref-benegas_gpn-msa_2024" role="doc-biblioref">Benegas et al. 2024</a>)</span>; Evo 2, a generalist genomic language model trained across species and modalities, providing zero-shot variant scores <span class="citation" data-cites="brixi_evo_2025 manzo_comparative_2025">(<a href="references.html#ref-brixi_evo_2025" role="doc-biblioref">Brixi et al. 2025</a>; <a href="references.html#ref-manzo_comparative_2025" role="doc-biblioref">Manzo, Borkowski, and Ovcharenko 2025</a>)</span>; and AlphaGenome, a unified 1 Mb context model that predicts multi-omic readouts and regulatory effects, enabling end-to-end noncoding VEP <span class="citation" data-cites="avsec_alphagenome_2025">(<a href="references.html#ref-avsec_alphagenome_2025" role="doc-biblioref">Avsec, Latysheva, and Cheng 2025</a>)</span>.</p>
<p>We first revisit zero-shot protein language model approaches, then dive into these four systems, compare their design choices, and close with open challenges for future VEP models.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – big-picture overview</strong></p>
<p>Add a small schematic showing the progression from: 1. Handcrafted scores (SIFT/PolyPhen/CADD) →<br>
2. Task-specific deep models (SpliceAI, regulatory CNNs) →<br>
3. Foundation-model-based VEP (protein LMs, Evo 2, AlphaGenome).</p>
<p>This could be a left-to-right timeline with example inputs (protein, DNA, MSA) and outputs (pathogenicity, regulatory effect, multi-omic profiles).</p>
</div>
</div>
</section>
<section id="zero-shot-protein-language-models-for-variant-scoring" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="zero-shot-protein-language-models-for-variant-scoring"><span class="header-section-number">20.2</span> Zero-Shot Protein Language Models for Variant Scoring</h2>
<p>Before specialized systems like AlphaMissense, a key development was the realization that unsupervised protein sequence models can already provide useful variant effect scores with no task-specific training.</p>
<section id="evolutionary-models-over-msas-eve-and-popeve" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="evolutionary-models-over-msas-eve-and-popeve"><span class="header-section-number">20.2.1</span> Evolutionary Models Over MSAs: EVE and popEVE</h3>
<p>EVE (Evolutionary model of Variant Effect) fits a generative model to a multiple sequence alignment (MSA) of homologs for a single protein <span class="citation" data-cites="frazer_eve_2021">(<a href="references.html#ref-frazer_eve_2021" role="doc-biblioref">Frazer et al. 2021</a>)</span>. The model learns a probability distribution over sequences such that variants that strongly violate evolutionary constraints (e.g., breaking conserved motifs or co-evolution patterns) receive low probability.</p>
<p>Variant effect scores are derived from log-likelihood differences: the change in sequence log-probability under the model when a reference amino acid is replaced by an alternative. These raw scores are then calibrated against labeled variants (e.g., ClinVar) to produce categorical calls and confidence levels analogous to ACMG evidence.</p>
<p>popEVE extends the approach by training models across many proteins and incorporating population allele frequencies, enabling proteome-wide scoring and better calibration across genes <span class="citation" data-cites="orenbuch_popeve_2025">(<a href="references.html#ref-orenbuch_popeve_2025" role="doc-biblioref">Orenbuch et al. 2025</a>)</span>. Together, these methods showed that strong performance is possible with purely unsupervised training on evolutionary data, MSA quality and depth critically influence performance and coverage, and calibration against clinical labels is essential for practical use (<a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
</section>
<section id="large-protein-lms-esm-1v-and-related-models" class="level3" data-number="20.2.2">
<h3 data-number="20.2.2" class="anchored" data-anchor-id="large-protein-lms-esm-1v-and-related-models"><span class="header-section-number">20.2.2</span> Large Protein LMs: ESM-1v and Related Models</h3>
<p>ESM-1v and related protein language models push beyond MSAs by training transformers on large corpora of unaligned protein sequences <span class="citation" data-cites="meier_esm-1v_2021">(<a href="references.html#ref-meier_esm-1v_2021" role="doc-biblioref">Meier et al. 2021</a>)</span>. These models use masked language modeling: given a sequence with masked amino acids, the model predicts the masked tokens, implicitly learning structural and functional constraints.</p>
<p>Zero-shot variant scoring follows the same principle as in EVE. The model computes the log-probability of the wild-type amino acid at a position, computes the log-probability of the mutant amino acid, and uses the difference as a variant effect score (often aggregated over both directions and context windows).</p>
<p>Compared to MSA-based models, large protein LMs provide much broader coverage since they do not require explicit MSAs per protein, capture global patterns such as secondary/tertiary structure and remote homology (<a href="p3-ch13-plm.html" class="quarto-xref"><span>Chapter 13</span></a>), and still require calibration and interpretation to be clinically useful.</p>
</section>
<section id="cross-protein-transfer-from-deep-mutational-scanning" class="level3" data-number="20.2.3">
<h3 data-number="20.2.3" class="anchored" data-anchor-id="cross-protein-transfer-from-deep-mutational-scanning"><span class="header-section-number">20.2.3</span> Cross-Protein Transfer from Deep Mutational Scanning</h3>
<p>Despite their success, zero-shot approaches face a persistent challenge: the gap between experimental fitness assays and clinical labels. Deep mutational scanning (DMS) experiments measure the functional effects of thousands of variants in a single protein, but only for a small subset of proteins. Conversely, clinical variant databases span many genes but are sparse and biased.</p>
<p>CPT-1 (Cross-Protein Transfer 1) is a recent approach that tries to bridge this gap <span class="citation" data-cites="jagota_cross-protein_2023">(<a href="references.html#ref-jagota_cross-protein_2023" role="doc-biblioref">Jagota et al. 2023</a>)</span>. The key idea is to leverage cross-protein transfer. For a subset of proteins with DMS data, the model extracts features from protein language models (e.g., ESM-derived embeddings), structure (experimental or AlphaFold2-predicted), and conservation and other biologically motivated descriptors. A shared predictor is trained that maps these features to DMS-measured effects, then this predictor is transferred to new proteins by feeding in the same feature types, even when no DMS data exist for that protein.</p>
<p>CPT-1 demonstrates substantial gains in high-sensitivity recall and ranking of pathogenic variants compared to purely zero-shot methods, complementarity between foundation model features and task-specific experimental supervision, and a template for systematically using DMS data as a bridge between large-scale representations and clinically relevant outcomes.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestions – zero-shot protein VEP</strong></p>
<ol type="1">
<li>Small cartoon comparing EVE vs ESM-1v:
<ul>
<li>EVE: MSA stack, generative model, Δ log-likelihood score.</li>
<li>ESM-1v: single sequence, transformer, masked token prediction.</li>
</ul></li>
<li>Schematic for CPT-1:
<ul>
<li>DMS assays (per-protein fitness landscapes) → feature extraction (LM embeddings, structure) → shared predictor → transfer to new proteins.</li>
</ul></li>
</ol>
</div>
</div>
</section>
</section>
<section id="alphamissense-proteome-wide-missense-pathogenicity" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="alphamissense-proteome-wide-missense-pathogenicity"><span class="header-section-number">20.3</span> AlphaMissense: Proteome-Wide Missense Pathogenicity</h2>
<p>AlphaMissense, developed by DeepMind, is a large-scale system that provides precomputed pathogenicity scores for essentially all possible missense variants in the human proteome <span class="citation" data-cites="cheng_alphamissense_2023">(<a href="references.html#ref-cheng_alphamissense_2023" role="doc-biblioref">Cheng et al. 2023</a>)</span>. It combines the strengths of protein language models and structural information from AlphaFold2 to produce calibrated probability scores interpretable as “pathogenic” vs “benign”.</p>
<section id="combining-sequence-and-structure" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="combining-sequence-and-structure"><span class="header-section-number">20.3.1</span> Combining Sequence and Structure</h3>
<p>AlphaMissense rests on two main pillars. First, sequence-based representations. A protein language model is used to encode the wild-type amino acid sequence and the position-specific context of a mutation. The model learns evolutionary constraints from massive protein sequence databases and captures subtle patterns such as remote homology, local structural motifs, and co-evolution across residues.</p>
<p>Second, structure-based representations. Structural information is derived from AlphaFold2 predictions, providing a 3D context around each residue. Features include local geometry (e.g., solvent exposure, secondary structure, packing density) and longer-range contacts. Mutations at buried sites or within critical interaction interfaces can be distinguished from those in flexible, solvent-exposed regions.</p>
<p>For a proposed missense variant, AlphaMissense integrates the wild-type sequence, the mutant amino acid at a specific position, and local structural features from AlphaFold2 into a neural network that outputs a continuous pathogenicity probability between 0 and 1.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – AlphaMissense architecture</strong></p>
<p>Insert an architecture schematic showing: - Input: protein sequence + AlphaFold2 structure, - Encoding: protein LM and structural feature extraction, - Fusion: joint network combining sequence and structure, - Output: pathogenicity probability.</p>
<p>A zoom-in panel could highlight how local 3D neighborhood (e.g., proximity to active site) modulates the score.</p>
</div>
</div>
</section>
<section id="training-and-calibration" class="level3" data-number="20.3.2">
<h3 data-number="20.3.2" class="anchored" data-anchor-id="training-and-calibration"><span class="header-section-number">20.3.2</span> Training and Calibration</h3>
<p>AlphaMissense uses a hybrid training strategy. Self-supervised pretraining on protein sequences and structures ensures that representations capture generic biophysical and evolutionary constraints. Supervised fine-tuning on labeled clinical and population data uses pathogenic and benign missense variants from ClinVar and other curated resources, along with high-frequency variants from population databases such as gnomAD, treated as likely benign under standard assumptions (<a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
<p>Raw model outputs are then calibrated so that scores near 0 correspond to variants observed to behave like benign in curated sets, scores near 1 correspond to variants consistently observed as pathogenic, and intermediate scores are interpretable as uncertain or conflicting evidence, which can be integrated into ACMG-like decision frameworks (<a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
</section>
<section id="performance-and-clinical-utility" class="level3" data-number="20.3.3">
<h3 data-number="20.3.3" class="anchored" data-anchor-id="performance-and-clinical-utility"><span class="header-section-number">20.3.3</span> Performance and Clinical Utility</h3>
<p>Across diverse benchmarks including ClinVar, expert-curated panels, and deep mutational scanning datasets, AlphaMissense achieves higher AUC and precision–recall than many prior missense predictors, strong correlation with experimental functional readouts, and robustness across different genes and variant spectra.</p>
<p>Its precomputed proteome-wide score release makes it particularly attractive in practice: users can simply look up scores instead of running heavy inference per variant. This facilitates downstream tasks such as prioritizing variants of uncertain significance (VUS), supporting gene discovery and burden tests, and annotating large sequencing cohorts.</p>
</section>
<section id="limitations-and-caveats" class="level3" data-number="20.3.4">
<h3 data-number="20.3.4" class="anchored" data-anchor-id="limitations-and-caveats"><span class="header-section-number">20.3.4</span> Limitations and Caveats</h3>
<p>Despite its strengths, AlphaMissense has several important limitations. It only handles missense variants; other coding and noncoding variant types require separate tools. Calibration depends on existing clinical and population labels, which are themselves biased by ascertainment and ancestry (<a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>). The model is largely opaque: it provides a scalar score but limited mechanistic explanations (<a href="p5-ch22-interp.html" class="quarto-xref"><span>Chapter 22</span></a>). Structural features rely on predicted rather than experimentally determined structures for most proteins; errors or uncertainties in AlphaFold2 predictions can propagate into scores.</p>
<p>Guidelines thus recommend using AlphaMissense as a strong supporting line of evidence, but not as a standalone decision-maker. Scores are best interpreted in combination with segregation data, population frequencies, functional assays, and gene-level context (<a href="p3-ch10-cnn.html#sec-trans" class="quarto-xref"><span>Section 10.2</span></a>).</p>
</section>
</section>
<section id="gpn-msa-alignment-based-dna-language-modeling" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="gpn-msa-alignment-based-dna-language-modeling"><span class="header-section-number">20.4</span> GPN-MSA: Alignment-Based DNA Language Modeling</h2>
<p>Noncoding variants present a different challenge: there is no straightforward notion of a “protein structure” to rely on, and the relevant functional constraints are often encoded in subtle motifs and long-range regulatory elements. GPN-MSA (Genomic Pre-trained Network with Multi-Species Alignments) addresses this by combining raw DNA sequence with multi-species conservation in a language modeling framework <span class="citation" data-cites="benegas_gpn-msa_2024">(<a href="references.html#ref-benegas_gpn-msa_2024" role="doc-biblioref">Benegas et al. 2024</a>)</span>.</p>
<section id="alignment-based-dna-language-model" class="level3" data-number="20.4.1">
<h3 data-number="20.4.1" class="anchored" data-anchor-id="alignment-based-dna-language-model"><span class="header-section-number">20.4.1</span> Alignment-Based DNA Language Model</h3>
<p>GPN-MSA extends earlier GPN models by ingesting multi-species sequence alignments over kilobase-scale genomic windows. For each genomic position, the input includes the reference DNA base in the focal species (e.g., human), the aligned bases (or gaps) from multiple other species, and masking patterns to indicate which positions and species are visible.</p>
<p>The model is trained with a masked language modeling objective analogous to BERT. The training procedure randomly masks bases across the alignment and predicts the masked bases given surrounding context across positions and species. Through this objective, GPN-MSA learns which bases are strongly constrained across evolution (highly predictable) and which positions tolerate more variability.</p>
</section>
<section id="variant-scoring-strategies" class="level3" data-number="20.4.2">
<h3 data-number="20.4.2" class="anchored" data-anchor-id="variant-scoring-strategies"><span class="header-section-number">20.4.2</span> Variant Scoring Strategies</h3>
<p>Several strategies map GPN-MSA outputs to variant effect scores. Likelihood-based scoring compares the log-likelihood of reference and alternative alleles at a position, capturing how much the variant deviates from conservation patterns. Contextual perturbation assesses how a variant perturbs model predictions or hidden representations across a window, capturing disruption of local motifs or multi-base patterns. Embedding-based features use learned representations as features in downstream supervised models for pathogenicity or specific regulatory phenotypes.</p>
<p>Because GPN-MSA directly uses multi-species alignments, it excels at capturing deep evolutionary constraint in genomic regions that are noncoding but functionally important, such as enhancers, promoters, and untranslated regions.</p>
</section>
<section id="benchmarking-and-applications" class="level3" data-number="20.4.3">
<h3 data-number="20.4.3" class="anchored" data-anchor-id="benchmarking-and-applications"><span class="header-section-number">20.4.3</span> Benchmarking and Applications</h3>
<p>On genome-wide variant pathogenicity benchmarks and regulatory variant datasets (e.g., from high-throughput reporter assays), GPN-MSA outperforms simpler conservation scores (e.g., phyloP, phastCons) when evaluated fairly, offers strong prefiltering ability by enriching for likely functional variants out of large candidate sets, and provides a principled way to combine alignment information with learned sequence features.</p>
<p>Its limitations include dependence on high-quality multi-species alignments, which may be missing or unreliable in repetitive regions, and coverage gaps for species or loci with poor comparative genomics resources.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – GPN-MSA input and objective</strong></p>
<p>Add a figure showing: - A stack of aligned sequences (species × position), - Masked tokens highlighted, - The model predicting masked bases across positions and species.</p>
<p>A side panel can illustrate how a single nucleotide variant changes the alignment column and how that translates into a Δ log-likelihood score.</p>
</div>
</div>
</section>
</section>
<section id="evo-2-a-generalist-genomic-language-model" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="evo-2-a-generalist-genomic-language-model"><span class="header-section-number">20.5</span> Evo 2: A Generalist Genomic Language Model</h2>
<p>Evo 2 pushes the foundation model paradigm further by acting as a generalist genomic language model: a single model trained across species and genomic contexts with very long input sequences <span class="citation" data-cites="brixi_evo_2025 manzo_comparative_2025">(<a href="references.html#ref-brixi_evo_2025" role="doc-biblioref">Brixi et al. 2025</a>; <a href="references.html#ref-manzo_comparative_2025" role="doc-biblioref">Manzo, Borkowski, and Ovcharenko 2025</a>)</span>. Conceptually, Evo 2 for genomes plays a similar role to large language models for text.</p>
<section id="scale-and-architecture" class="level3" data-number="20.5.1">
<h3 data-number="20.5.1" class="anchored" data-anchor-id="scale-and-architecture"><span class="header-section-number">20.5.1</span> Scale and Architecture</h3>
<p>Evo 2 introduces several distinctive features. Long context length is enabled by the StripedHyena 2 architecture, which efficiently handles context lengths up to approximately 1 Mb, enabling it to model both local motifs and long-range dependencies (e.g., enhancer-promoter links). The model is trained on a diverse corpus: OpenGenome2, a large collection of genomes spanning many branches of the tree of life. This cross-species training encourages learning general principles of genomic organization and constraint. Flexible tokenization strategies range from single nucleotides to longer k-mer or hybrid schemes, balancing resolution and efficiency (<a href="p2-ch05-tokens.html" class="quarto-xref"><span>Chapter 5</span></a>).</p>
<p>The training objective is primarily autoregressive or masked language modeling on raw DNA, learning to predict bases or tokens given the surrounding context.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – Evo 2 architecture</strong></p>
<p>Insert a high-level diagram of Evo 2: - Input: 1 Mb genomic window, - Backbone: StripedHyena 2 blocks (recurrent/state-space-like) enabling long-range context, - Output: per-position token probabilities.</p>
<p>A small inset could compare Evo 2’s context length to earlier CNN/transformer models (e.g., 1–10 kb vs 1 Mb).</p>
</div>
</div>
</section>
<section id="zero-shot-variant-effect-scoring" class="level3" data-number="20.5.2">
<h3 data-number="20.5.2" class="anchored" data-anchor-id="zero-shot-variant-effect-scoring"><span class="header-section-number">20.5.2</span> Zero-Shot Variant Effect Scoring</h3>
<p>Variant scoring with Evo 2 mirrors the logic of zero-shot protein LMs. The model computes token-level log-probabilities for the reference sequence, substitutes the variant allele in context, recomputes log-probabilities, and derives a score based on the log-likelihood change.</p>
<p>Because Evo 2 sees long genomic neighborhoods, its scores implicitly capture local motif disruption (e.g., TF binding sites), altered higher-order patterns (e.g., CpG content, nucleosome positioning signals), and constraints arising from interactions between multiple elements within the window. This makes Evo 2 particularly suited for noncoding and regulatory variants, where context far beyond the immediate base often matters.</p>
</section>
<section id="fine-tuning-and-task-specific-heads" class="level3" data-number="20.5.3">
<h3 data-number="20.5.3" class="anchored" data-anchor-id="fine-tuning-and-task-specific-heads"><span class="header-section-number">20.5.3</span> Fine-Tuning and Task-Specific Heads</h3>
<p>While zero-shot scores are already competitive, Evo 2 can be fine-tuned or paired with task-specific heads for regulatory prediction (e.g., chromatin accessibility, histone marks), splicing outcomes, and gene expression levels. Such adapters reuse Evo 2’s representations as a generic backbone, mirroring how text LLMs are adapted via lightweight fine-tuning and prompting (<a href="p2-ch07-foundation.html" class="quarto-xref"><span>Chapter 7</span></a>).</p>
</section>
</section>
<section id="alphagenome-unified-multi-omic-vep-at-1-mb-context" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="alphagenome-unified-multi-omic-vep-at-1-mb-context"><span class="header-section-number">20.6</span> AlphaGenome: Unified Multi-Omic VEP at 1 Mb Context</h2>
<p>AlphaGenome is a unified model that takes a 1 Mb DNA sequence as input and jointly predicts a wide panel of multi-omic readouts: chromatin accessibility, histone modifications, TF binding, 3D contacts, and splicing features <span class="citation" data-cites="avsec_alphagenome_2025">(<a href="references.html#ref-avsec_alphagenome_2025" role="doc-biblioref">Avsec, Latysheva, and Cheng 2025</a>)</span>. It can then be used to estimate how variants perturb these readouts, providing a mechanistic view of noncoding variant effects.</p>
<section id="architecture-and-training" class="level3" data-number="20.6.1">
<h3 data-number="20.6.1" class="anchored" data-anchor-id="architecture-and-training"><span class="header-section-number">20.6.1</span> Architecture and Training</h3>
<p>The AlphaGenome architecture combines multiple components. Convolutional front-ends extract local motif-level features (akin to models like DeepSEA and Enformer). Long-range attention or state-space blocks propagate information across hundreds of kilobases (<a href="p3-ch14-hybrid.html" class="quarto-xref"><span>Chapter 14</span></a>). Multi-task prediction heads handle different assay types (e.g., ATAC-seq, ChIP-seq marks, Hi-C contact maps, splice junction usage).</p>
<p>Training relies on large-scale functional genomics data from many cell types and assays (<a href="p3-ch10-cnn.html#sec-reg" class="quarto-xref"><span>Section 10.1</span></a>). The model is optimized to jointly predict 1D tracks (e.g., coverage profiles), 2D contact maps (e.g., Hi-C), and sequence-derived splicing features (e.g., junction usage, splice site scores).</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – AlphaGenome unified architecture</strong></p>
<p>Add a block diagram showing: - Input: 1 Mb DNA sequence, - Layers: convolutional encoder → long-range blocks → multi-task heads, - Outputs: example tracks (ATAC, H3K27ac), a 3D contact map panel, and splicing predictions.</p>
<p>Highlight that the same backbone supports all these modalities.</p>
</div>
</div>
</section>
<section id="variant-effect-prediction-across-modalities" class="level3" data-number="20.6.2">
<h3 data-number="20.6.2" class="anchored" data-anchor-id="variant-effect-prediction-across-modalities"><span class="header-section-number">20.6.2</span> Variant Effect Prediction Across Modalities</h3>
<p>For VEP, AlphaGenome compares predictions for the reference and alternate sequences. Regulatory impact is captured through changes in predicted chromatin accessibility or histone marks at enhancers/promoters. 3D genome structure effects appear as shifts in predicted contact maps, particularly enhancer-promoter interactions that may be weakened or strengthened. Splicing effects manifest as altered splice junction usage or cryptic splice site activation.</p>
<p>This enables multi-modal variant effect scores that unify many previously separate tools (e.g., promoter/enhancer predictors, splicing models, TAD-perturbation models). On benchmarks spanning regulatory MPRAs, splicing assays, and disease-associated noncoding variants, AlphaGenome achieves state-of-the-art performance while providing mechanistically interpretable outputs.</p>
<p>Its main challenges include heavy computational cost (1 Mb windows with many outputs), potential brittleness when extrapolating beyond the training distribution (e.g., rare tissues, extreme cell states), and the difficulty of calibrating multi-omic changes into clinical pathogenicity categories.</p>
</section>
</section>
<section id="comparing-design-choices-across-modern-vep-models" class="level2" data-number="20.7">
<h2 data-number="20.7" class="anchored" data-anchor-id="comparing-design-choices-across-modern-vep-models"><span class="header-section-number">20.7</span> Comparing Design Choices Across Modern VEP Models</h2>
<p>The models surveyed in this chapter span different points in a multidimensional design space. The table below summarizes some of the key axes:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 26%">
<col style="width: 11%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Input Modality</th>
<th>Context Length</th>
<th>Pretraining Data</th>
<th>Variant Types</th>
<th>Primary Outputs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AlphaMissense</td>
<td>Protein sequence + structure</td>
<td>Protein-length</td>
<td>Protein sequence corpora + AlphaFold2 structures</td>
<td>Missense only</td>
<td>Pathogenicity probability</td>
</tr>
<tr class="even">
<td>GPN-MSA</td>
<td>Multi-species DNA alignments</td>
<td>kb-scale windows</td>
<td>Whole-genome MSAs across many species</td>
<td>Coding + noncoding</td>
<td>Likelihood / embedding-based scores</td>
</tr>
<tr class="odd">
<td>Evo 2</td>
<td>Raw DNA sequence</td>
<td>Up to ~1 Mb</td>
<td>OpenGenome2 (multi-species genomes)</td>
<td>All variant types</td>
<td>Zero-shot likelihood-based scores + representations</td>
</tr>
<tr class="even">
<td>AlphaGenome</td>
<td>Raw DNA sequence</td>
<td>1 Mb</td>
<td>Human genome + multi-omic tracks across cell types</td>
<td>All variant types</td>
<td>Multi-omic tracks + delta effects</td>
</tr>
</tbody>
</table>
<p>Several key contrasts emerge. AlphaMissense focuses on proteins and missense variants, while GPN-MSA, Evo 2, and AlphaGenome operate directly on DNA, with varying emphasis on coding vs noncoding variants. Shorter context models (e.g., GPN-MSA) excel at capturing local conservation, whereas Evo 2 and AlphaGenome can model long-range regulatory interactions. AlphaMissense outputs a single pathogenicity probability; Evo 2 primarily offers likelihood-based scores and representations; AlphaGenome produces rich multi-omic profiles that can support mechanistic hypotheses (<a href="p5-ch22-interp.html" class="quarto-xref"><span>Chapter 22</span></a>). AlphaMissense and GPN-MSA emphasize evolutionary constraints; Evo 2 adds cross-species genomic syntax; AlphaGenome emphasizes functional genomics.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestions – comparative performance and design</strong></p>
<ol type="1">
<li><p>A bar chart or ROC/AUPRC plot comparing model performance on ClinVar (missense), MAVE/DMS datasets, and regulatory MPRA datasets.</p></li>
<li><p>A schematic table (expanded from the one above) highlighting modality, context length, training data types, output types, and example use cases (clinical vs research).</p></li>
</ol>
</div>
</div>
<section id="specialized-vs-general-regulatory-models" class="level3" data-number="20.7.1">
<h3 data-number="20.7.1" class="anchored" data-anchor-id="specialized-vs-general-regulatory-models"><span class="header-section-number">20.7.1</span> Specialized vs General Regulatory Models</h3>
<p>A recurring tension in regulatory VEP is whether to build specialized models for a specific tissue/assay or general models that span many contexts. TREDNet exemplifies the specialized strategy: it is trained to predict regulatory activity (e.g., TF binding, chromatin marks) for a specific cell type and assay configuration <span class="citation" data-cites="hudaiberdiev_trednet_2023">(<a href="references.html#ref-hudaiberdiev_trednet_2023" role="doc-biblioref">Hudaiberdiev et al. 2023</a>)</span>. Such specialization concentrates model capacity on a well-defined biological context, often yields strong performance for that context, and facilitates interpretation in terms of a particular regulatory program.</p>
<p>In contrast, models like AlphaGenome and Evo 2 are generalist backbones that can be adapted across many contexts via multi-task heads or fine-tuning. Generalist models provide a single representation that can be reused across tasks (<a href="p2-ch07-foundation.html" class="quarto-xref"><span>Chapter 7</span></a>), enable transfer to cell types or assays with limited data, and support unified analyses that integrate multiple regulatory modalities.</p>
<p>In practice, specialized vs general models are complementary. Specialized models may be preferable when the disease mechanism is tightly linked to a particular cell type and high-quality matched functional data exist for that context. Generalist backbones are more attractive when data are sparse or heterogeneous and we wish to systematically explore variant effects across many cell types and assays (<a href="p3-ch10-cnn.html#sec-reg" class="quarto-xref"><span>Section 10.1</span></a>).</p>
</section>
<section id="combining-predictors-in-practice" class="level3" data-number="20.7.2">
<h3 data-number="20.7.2" class="anchored" data-anchor-id="combining-predictors-in-practice"><span class="header-section-number">20.7.2</span> Combining Predictors in Practice</h3>
<p>No single VEP model is universally optimal. Practical workflows often combine multiple predictors. For example, use GPN-MSA or Evo 2 for initial genome-wide filtering, prioritizing variants under strong evolutionary or language-model-derived constraint. Use AlphaMissense for missense variants in protein-coding regions, especially when strong structural context is available. Use AlphaGenome (or similar regulatory models) to evaluate noncoding variants affecting enhancers, promoters, or splicing.</p>
<p>These combinations are typically integrated with population allele frequencies (e.g., gnomAD), gene-level constraint metrics, clinical and segregation data, and task-specific experimental assays when available (<a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>; <a href="p3-ch10-cnn.html#sec-trans" class="quarto-xref"><span>Section 10.2</span></a>).</p>
<p>A key challenge is to avoid overcounting correlated signals (e.g., multiple scores derived from similar evolutionary data) and to calibrate evidence contributions within frameworks like ACMG, as discussed further in Chapters 17 and 18 (<a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>; <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion – practical VEP workflow</strong></p>
<p>Add a workflow diagram showing: 1. Input: variant list from sequencing, 2. Branches by variant type (missense, synonymous, noncoding), 3. Tools used per branch (AlphaMissense, Evo 2, AlphaGenome, GPN-MSA, TREDNet), 4. Integration with population, gene-level, and clinical data, 5. Output: prioritized variant set and evidence summary.</p>
<p>This could be reused across later translation chapters.</p>
</div>
</div>
</section>
</section>
<section id="open-challenges-and-future-directions" class="level2" data-number="20.8">
<h2 data-number="20.8" class="anchored" data-anchor-id="open-challenges-and-future-directions"><span class="header-section-number">20.8</span> Open Challenges and Future Directions</h2>
<p>Even state-of-the-art systems like AlphaMissense, GPN-MSA, Evo 2, and AlphaGenome leave major gaps. These open challenges define the frontier of variant effect prediction research.</p>
<section id="ancestry-and-population-bias" class="level3" data-number="20.8.1">
<h3 data-number="20.8.1" class="anchored" data-anchor-id="ancestry-and-population-bias"><span class="header-section-number">20.8.1</span> Ancestry and Population Bias</h3>
<p>Training data and labels remain skewed toward certain ancestries, genes, and disease phenotypes. ClinVar submissions are dominated by variants from individuals of European ancestry, population databases underrepresent many global populations, and functional assays are concentrated on a limited set of genes and pathways. These biases can distort both calibration and ranking of variants across ancestries (<a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>). Future VEP models will need more diverse training datasets, explicit modeling of population structure, and evaluation frameworks that surface ancestry-specific performance disparities (<a href="p5-ch18-benchmarks.html" class="quarto-xref"><span>Chapter 18</span></a>).</p>
</section>
<section id="complex-variant-patterns" class="level3" data-number="20.8.2">
<h3 data-number="20.8.2" class="anchored" data-anchor-id="complex-variant-patterns"><span class="header-section-number">20.8.2</span> Complex Variant Patterns</h3>
<p>Most current models focus on single-nucleotide variants (SNVs) or single amino acid substitutions. However, real genomes contain indels and frameshifts, structural variants (SVs), haplotypes involving multiple nearby variants, and compound heterozygosity and gene-gene interactions. Extending models to capture combinatorial variant patterns is challenging: the space of possible multi-variant configurations is enormous, training data for interactions are sparse, and long-range and higher-order epistasis can be hard to represent even in large models. Foundation models with long contexts (like Evo 2 and AlphaGenome) provide a promising substrate, but new objectives and datasets will be needed to robustly model multi-variant effects.</p>
</section>
<section id="integrating-multi-omics-and-longitudinal-data" class="level3" data-number="20.8.3">
<h3 data-number="20.8.3" class="anchored" data-anchor-id="integrating-multi-omics-and-longitudinal-data"><span class="header-section-number">20.8.3</span> Integrating Multi-Omics and Longitudinal Data</h3>
<p>AlphaGenome takes a first step toward unified multi-omic prediction, but real tissues and organisms exhibit dynamic regulatory programs across development and aging, responses to environmental perturbations, and cell-type heterogeneity and spatial organization. Integrating single-cell, spatial, and longitudinal omics into VEP frameworks will be crucial for capturing context-specific variant effects (<a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>). This will likely require new multi-scale architectures that span from sequence to cell states, careful treatment of batch effects and confounders, and benchmarks that explicitly evaluate context-specific predictions (<a href="p5-ch18-benchmarks.html" class="quarto-xref"><span>Chapter 18</span></a>).</p>
</section>
<section id="interpretability-and-clinical-communication" class="level3" data-number="20.8.4">
<h3 data-number="20.8.4" class="anchored" data-anchor-id="interpretability-and-clinical-communication"><span class="header-section-number">20.8.4</span> Interpretability and Clinical Communication</h3>
<p>As models grow more complex, interpretability becomes a central concern (<a href="p5-ch22-interp.html" class="quarto-xref"><span>Chapter 22</span></a>). Clinicians need explanations that connect model scores to mechanism (e.g., “disrupts a conserved splice acceptor, predicted to cause exon skipping”). Researchers need tools to trace predictions back to motifs, domains, or 3D contacts that can be experimentally tested. Future work will involve model-based attribution methods adapted to sequence and structure, counterfactual reasoning over variant sets, and interfaces that present model outputs in clinically meaningful formats.</p>
</section>
<section id="safe-deployment-and-continual-learning" class="level3" data-number="20.8.5">
<h3 data-number="20.8.5" class="anchored" data-anchor-id="safe-deployment-and-continual-learning"><span class="header-section-number">20.8.5</span> Safe Deployment and Continual Learning</h3>
<p>Finally, VEP systems are increasingly deployed in clinical and research pipelines that continuously generate new data. This raises questions about continual learning (how to integrate new functional and clinical labels without destabilizing existing predictions), versioning and reproducibility (how to ensure that changes in models and training data are tracked and interpretable to downstream users), and safety and governance (how to prevent misuse, ensure transparency about limitations, and embed these tools within responsible clinical workflows) (<a href="p3-ch10-cnn.html#sec-trans" class="quarto-xref"><span>Section 10.2</span></a>; <a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
<p>In subsequent chapters, we connect these VEP systems to broader end-to-end frameworks for variant interpretation, including risk prediction, rare disease diagnosis, and therapeutic target discovery. Together with careful evaluation and interpretation, foundation-model-based VEP promises to transform how we understand and act on genomic variation.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-adzhubei_polyphen_2010" class="csl-entry" role="listitem">
Adzhubei, Ivan A., Steffen Schmidt, Leonid Peshkin, Vasily E. Ramensky, Anna Gerasimova, Peer Bork, Alexey S. Kondrashov, and Shamil R. Sunyaev. 2010. <span>“A Method and Server for Predicting Damaging Missense Mutations.”</span> <em>Nature Methods</em> 7 (4): 248–49. <a href="https://doi.org/10.1038/nmeth0410-248">https://doi.org/10.1038/nmeth0410-248</a>.
</div>
<div id="ref-avsec_alphagenome_2025" class="csl-entry" role="listitem">
Avsec, Ziga, Natasha Latysheva, and Jun Cheng. 2025. <span>“<span>AlphaGenome</span>: <span>AI</span> for Better Understanding the Genome.”</span> <em>Google DeepMind</em>. <a href="https://deepmind.google/discover/blog/alphagenome-ai-for-better-understanding-the-genome/">https://deepmind.google/discover/blog/alphagenome-ai-for-better-understanding-the-genome/</a>.
</div>
<div id="ref-benegas_gpn-msa_2024" class="csl-entry" role="listitem">
Benegas, Gonzalo, Carlos Albors, Alan J. Aw, Chengzhong Ye, and Yun S. Song. 2024. <span>“<span>GPN</span>-<span>MSA</span>: An Alignment-Based <span>DNA</span> Language Model for Genome-Wide Variant Effect Prediction.”</span> <em>bioRxiv</em>, April, 2023.10.10.561776. <a href="https://doi.org/10.1101/2023.10.10.561776">https://doi.org/10.1101/2023.10.10.561776</a>.
</div>
<div id="ref-brixi_evo_2025" class="csl-entry" role="listitem">
Brixi, Garyk, Matthew G. Durrant, Jerome Ku, Michael Poli, Greg Brockman, Daniel Chang, Gabriel A. Gonzalez, et al. 2025. <span>“[<span>Evo</span> 2] <span>Genome</span> Modeling and Design Across All Domains of Life with <span>Evo</span> 2.”</span> bioRxiv. <a href="https://doi.org/10.1101/2025.02.18.638918">https://doi.org/10.1101/2025.02.18.638918</a>.
</div>
<div id="ref-cheng_alphamissense_2023" class="csl-entry" role="listitem">
Cheng, Jun, Guido Novati, Joshua Pan, Clare Bycroft, Akvilė Žemgulytė, Taylor Applebaum, Alexander Pritzel, et al. 2023. <span>“[<span>AlphaMissense</span>] <span>Accurate</span> Proteome-Wide Missense Variant Effect Prediction with <span>AlphaMissense</span>.”</span> <em>Science</em> 381 (6664): eadg7492. <a href="https://doi.org/10.1126/science.adg7492">https://doi.org/10.1126/science.adg7492</a>.
</div>
<div id="ref-frazer_eve_2021" class="csl-entry" role="listitem">
Frazer, Jonathan, Pascal Notin, Mafalda Dias, Aidan Gomez, Joseph K. Min, Kelly Brock, Yarin Gal, and Debora S. Marks. 2021. <span>“[<span>EVE</span>] <span>Disease</span> Variant Prediction with Deep Generative Models of Evolutionary Data.”</span> <em>Nature</em> 599 (7883): 91–95. <a href="https://doi.org/10.1038/s41586-021-04043-8">https://doi.org/10.1038/s41586-021-04043-8</a>.
</div>
<div id="ref-hudaiberdiev_trednet_2023" class="csl-entry" role="listitem">
Hudaiberdiev, Sanjarbek, D. Leland Taylor, Wei Song, Narisu Narisu, Redwan M. Bhuiyan, Henry J. Taylor, Xuming Tang, et al. 2023. <span>“[<span>TREDNet</span>] <span>Modeling</span> Islet Enhancers Using Deep Learning Identifies Candidate Causal Variants at Loci Associated with <span>T2D</span> and Glycemic Traits.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (35): e2206612120. <a href="https://doi.org/10.1073/pnas.2206612120">https://doi.org/10.1073/pnas.2206612120</a>.
</div>
<div id="ref-jagota_cross-protein_2023" class="csl-entry" role="listitem">
Jagota, Milind, Chengzhong Ye, Carlos Albors, Ruchir Rastogi, Antoine Koehl, Nilah Ioannidis, and Yun S. Song. 2023. <span>“Cross-Protein Transfer Learning Substantially Improves Disease Variant Prediction.”</span> <em>Genome Biology</em> 24 (1): 182. <a href="https://doi.org/10.1186/s13059-023-03024-6">https://doi.org/10.1186/s13059-023-03024-6</a>.
</div>
<div id="ref-manzo_comparative_2025" class="csl-entry" role="listitem">
Manzo, Gaetano, Kathryn Borkowski, and Ivan Ovcharenko. 2025. <span>“Comparative <span>Analysis</span> of <span>Deep</span> <span>Learning</span> <span>Models</span> for <span>Predicting</span> <span>Causative</span> <span>Regulatory</span> <span>Variants</span>.”</span> <em>bioRxiv: The Preprint Server for Biology</em>, June, 2025.05.19.654920. <a href="https://doi.org/10.1101/2025.05.19.654920">https://doi.org/10.1101/2025.05.19.654920</a>.
</div>
<div id="ref-meier_esm-1v_2021" class="csl-entry" role="listitem">
Meier, Joshua, Roshan Rao, Robert Verkuil, Jason Liu, Tom Sercu, and Alexander Rives. 2021. <span>“[<span>ESM</span>-1v] <span>Language</span> Models Enable Zero-Shot Prediction of the Effects of Mutations on Protein Function.”</span> bioRxiv. <a href="https://doi.org/10.1101/2021.07.09.450648">https://doi.org/10.1101/2021.07.09.450648</a>.
</div>
<div id="ref-ng_sift_2003" class="csl-entry" role="listitem">
Ng, Pauline C., and Steven Henikoff. 2003. <span>“<span>SIFT</span>: <span>Predicting</span> Amino Acid Changes That Affect Protein Function.”</span> <em>Nucleic Acids Research</em> 31 (13): 3812–14. <a href="https://doi.org/10.1093/nar/gkg509">https://doi.org/10.1093/nar/gkg509</a>.
</div>
<div id="ref-orenbuch_popeve_2025" class="csl-entry" role="listitem">
Orenbuch, Rose, Courtney A. Shearer, Aaron W. Kollasch, Aviv D. Spinner, Thomas Hopf, Lood van Niekerk, Dinko Franceschi, Mafalda Dias, Jonathan Frazer, and Debora S. Marks. 2025. <span>“[<span class="nocase">popEVE</span>] <span>Proteome</span>-Wide Model for Human Disease Genetics.”</span> <em>Nature Genetics</em>, November, 1–10. <a href="https://doi.org/10.1038/s41588-025-02400-1">https://doi.org/10.1038/s41588-025-02400-1</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p5-ch19-eval.html" class="pagination-link" aria-label="Evaluation of Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p5-ch21-confound.html" class="pagination-link" aria-label="Confounders in Model Training">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>