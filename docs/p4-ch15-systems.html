<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Multi-Omics &amp; Systems Biology – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p5--eval-interp.html" rel="next">
<link href="./p4-ch14-networks.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4--multi-scale.html">Part IV: Multi-Scale Modeling</a></li><li class="breadcrumb-item"><a href="./p4-ch15-systems.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p4--multi-scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Multi-Scale Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch13-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch14-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch16-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Benchmarks in Genomic Deep Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch17-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Model Evaluation &amp; Benchmarks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch20-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch21-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch22-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Design Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Future Directions &amp; Ethical Considerations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">15.1</span> Introduction</a></li>
  <li><a href="#multi-omics-integration-strategies" id="toc-multi-omics-integration-strategies" class="nav-link" data-scroll-target="#multi-omics-integration-strategies"><span class="header-section-number">15.2</span> Multi-Omics Integration Strategies</a>
  <ul class="collapse">
  <li><a href="#early-fusion" id="toc-early-fusion" class="nav-link" data-scroll-target="#early-fusion"><span class="header-section-number">15.2.1</span> Early Fusion</a></li>
  <li><a href="#intermediate-fusion" id="toc-intermediate-fusion" class="nav-link" data-scroll-target="#intermediate-fusion"><span class="header-section-number">15.2.2</span> Intermediate Fusion</a></li>
  <li><a href="#late-fusion" id="toc-late-fusion" class="nav-link" data-scroll-target="#late-fusion"><span class="header-section-number">15.2.3</span> Late Fusion</a></li>
  <li><a href="#choosing-integration-strategies" id="toc-choosing-integration-strategies" class="nav-link" data-scroll-target="#choosing-integration-strategies"><span class="header-section-number">15.2.4</span> Choosing Integration Strategies</a></li>
  </ul></li>
  <li><a href="#cross-modal-foundation-models" id="toc-cross-modal-foundation-models" class="nav-link" data-scroll-target="#cross-modal-foundation-models"><span class="header-section-number">15.3</span> Cross-Modal Foundation Models</a>
  <ul class="collapse">
  <li><a href="#principles-of-cross-modal-learning" id="toc-principles-of-cross-modal-learning" class="nav-link" data-scroll-target="#principles-of-cross-modal-learning"><span class="header-section-number">15.3.1</span> Principles of Cross-Modal Learning</a></li>
  <li><a href="#examples-glue-life-code-and-related-models" id="toc-examples-glue-life-code-and-related-models" class="nav-link" data-scroll-target="#examples-glue-life-code-and-related-models"><span class="header-section-number">15.3.2</span> Examples: GLUE, Life-Code, and Related Models</a></li>
  </ul></li>
  <li><a href="#hierarchical-and-multi-scale-modeling" id="toc-hierarchical-and-multi-scale-modeling" class="nav-link" data-scroll-target="#hierarchical-and-multi-scale-modeling"><span class="header-section-number">15.4</span> Hierarchical and Multi-Scale Modeling</a>
  <ul class="collapse">
  <li><a href="#biological-hierarchy" id="toc-biological-hierarchy" class="nav-link" data-scroll-target="#biological-hierarchy"><span class="header-section-number">15.4.1</span> Biological Hierarchy</a></li>
  <li><a href="#g2pt-hierarchical-genotype-to-phenotype" id="toc-g2pt-hierarchical-genotype-to-phenotype" class="nav-link" data-scroll-target="#g2pt-hierarchical-genotype-to-phenotype"><span class="header-section-number">15.4.2</span> G2PT: Hierarchical Genotype-to-Phenotype</a></li>
  <li><a href="#multi-scale-regulatory-models" id="toc-multi-scale-regulatory-models" class="nav-link" data-scroll-target="#multi-scale-regulatory-models"><span class="header-section-number">15.4.3</span> Multi-Scale Regulatory Models</a></li>
  </ul></li>
  <li><a href="#rare-variants-in-systems-context" id="toc-rare-variants-in-systems-context" class="nav-link" data-scroll-target="#rare-variants-in-systems-context"><span class="header-section-number">15.5</span> Rare Variants in Systems Context</a>
  <ul class="collapse">
  <li><a href="#the-challenge-of-rare-variants" id="toc-the-challenge-of-rare-variants" class="nav-link" data-scroll-target="#the-challenge-of-rare-variants"><span class="header-section-number">15.5.1</span> The Challenge of Rare Variants</a></li>
  <li><a href="#deeprvat-set-based-burden-modeling" id="toc-deeprvat-set-based-burden-modeling" class="nav-link" data-scroll-target="#deeprvat-set-based-burden-modeling"><span class="header-section-number">15.5.2</span> DeepRVAT: Set-Based Burden Modeling</a></li>
  <li><a href="#from-burden-to-systems-level-risk" id="toc-from-burden-to-systems-level-risk" class="nav-link" data-scroll-target="#from-burden-to-systems-level-risk"><span class="header-section-number">15.5.3</span> From Burden to Systems-Level Risk</a></li>
  </ul></li>
  <li><a href="#systems-biology-principles-for-deep-learning" id="toc-systems-biology-principles-for-deep-learning" class="nav-link" data-scroll-target="#systems-biology-principles-for-deep-learning"><span class="header-section-number">15.6</span> Systems Biology Principles for Deep Learning</a>
  <ul class="collapse">
  <li><a href="#network-motifs-and-regulatory-logic" id="toc-network-motifs-and-regulatory-logic" class="nav-link" data-scroll-target="#network-motifs-and-regulatory-logic"><span class="header-section-number">15.6.1</span> Network Motifs and Regulatory Logic</a></li>
  <li><a href="#robustness-and-canalization" id="toc-robustness-and-canalization" class="nav-link" data-scroll-target="#robustness-and-canalization"><span class="header-section-number">15.6.2</span> Robustness and Canalization</a></li>
  <li><a href="#dynamical-systems-perspectives" id="toc-dynamical-systems-perspectives" class="nav-link" data-scroll-target="#dynamical-systems-perspectives"><span class="header-section-number">15.6.3</span> Dynamical Systems Perspectives</a></li>
  </ul></li>
  <li><a href="#systems-medicine-and-clinical-integration" id="toc-systems-medicine-and-clinical-integration" class="nav-link" data-scroll-target="#systems-medicine-and-clinical-integration"><span class="header-section-number">15.7</span> Systems Medicine and Clinical Integration</a>
  <ul class="collapse">
  <li><a href="#from-molecular-networks-to-patient-phenotypes" id="toc-from-molecular-networks-to-patient-phenotypes" class="nav-link" data-scroll-target="#from-molecular-networks-to-patient-phenotypes"><span class="header-section-number">15.7.1</span> From Molecular Networks to Patient Phenotypes</a></li>
  <li><a href="#multi-omic-risk-scores" id="toc-multi-omic-risk-scores" class="nav-link" data-scroll-target="#multi-omic-risk-scores"><span class="header-section-number">15.7.2</span> Multi-Omic Risk Scores</a></li>
  <li><a href="#fine-mapping-in-systems-context" id="toc-fine-mapping-in-systems-context" class="nav-link" data-scroll-target="#fine-mapping-in-systems-context"><span class="header-section-number">15.7.3</span> Fine-Mapping in Systems Context</a></li>
  </ul></li>
  <li><a href="#practical-challenges" id="toc-practical-challenges" class="nav-link" data-scroll-target="#practical-challenges"><span class="header-section-number">15.8</span> Practical Challenges</a>
  <ul class="collapse">
  <li><a href="#batch-effects-across-modalities" id="toc-batch-effects-across-modalities" class="nav-link" data-scroll-target="#batch-effects-across-modalities"><span class="header-section-number">15.8.1</span> Batch Effects Across Modalities</a></li>
  <li><a href="#sample-size-and-missing-modalities" id="toc-sample-size-and-missing-modalities" class="nav-link" data-scroll-target="#sample-size-and-missing-modalities"><span class="header-section-number">15.8.2</span> Sample Size and Missing Modalities</a></li>
  <li><a href="#population-diversity" id="toc-population-diversity" class="nav-link" data-scroll-target="#population-diversity"><span class="header-section-number">15.8.3</span> Population Diversity</a></li>
  <li><a href="#evaluation-complexity" id="toc-evaluation-complexity" class="nav-link" data-scroll-target="#evaluation-complexity"><span class="header-section-number">15.8.4</span> Evaluation Complexity</a></li>
  </ul></li>
  <li><a href="#toward-whole-patient-foundation-models" id="toc-toward-whole-patient-foundation-models" class="nav-link" data-scroll-target="#toward-whole-patient-foundation-models"><span class="header-section-number">15.9</span> Toward Whole-Patient Foundation Models</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">15.10</span> Summary</a></li>
  <li><a href="#why-single-omics-models-are-not-enough" id="toc-why-single-omics-models-are-not-enough" class="nav-link" data-scroll-target="#why-single-omics-models-are-not-enough"><span class="header-section-number">15.11</span> Why Single-Omics Models Are Not Enough</a></li>
  <li><a href="#multi-omics-integration-strategies-1" id="toc-multi-omics-integration-strategies-1" class="nav-link" data-scroll-target="#multi-omics-integration-strategies-1"><span class="header-section-number">15.12</span> Multi-Omics Integration Strategies</a>
  <ul class="collapse">
  <li><a href="#early-fusion-1" id="toc-early-fusion-1" class="nav-link" data-scroll-target="#early-fusion-1"><span class="header-section-number">15.12.1</span> Early Fusion</a></li>
  <li><a href="#intermediate-fusion-1" id="toc-intermediate-fusion-1" class="nav-link" data-scroll-target="#intermediate-fusion-1"><span class="header-section-number">15.12.2</span> Intermediate Fusion</a></li>
  <li><a href="#late-fusion-1" id="toc-late-fusion-1" class="nav-link" data-scroll-target="#late-fusion-1"><span class="header-section-number">15.12.3</span> Late Fusion</a></li>
  <li><a href="#graph-guided-integration" id="toc-graph-guided-integration" class="nav-link" data-scroll-target="#graph-guided-integration"><span class="header-section-number">15.12.4</span> Graph-Guided Integration</a></li>
  </ul></li>
  <li><a href="#graph-neural-networks-for-cancer-subtyping" id="toc-graph-neural-networks-for-cancer-subtyping" class="nav-link" data-scroll-target="#graph-neural-networks-for-cancer-subtyping"><span class="header-section-number">15.13</span> Graph Neural Networks for Cancer Subtyping</a>
  <ul class="collapse">
  <li><a href="#mogcn-patient-similarity-networks" id="toc-mogcn-patient-similarity-networks" class="nav-link" data-scroll-target="#mogcn-patient-similarity-networks"><span class="header-section-number">15.13.1</span> MoGCN: Patient Similarity Networks</a></li>
  <li><a href="#cgmega-gene-level-modules" id="toc-cgmega-gene-level-modules" class="nav-link" data-scroll-target="#cgmega-gene-level-modules"><span class="header-section-number">15.13.2</span> CGMega: Gene-Level Modules</a></li>
  <li><a href="#design-themes-in-cancer-subtyping" id="toc-design-themes-in-cancer-subtyping" class="nav-link" data-scroll-target="#design-themes-in-cancer-subtyping"><span class="header-section-number">15.13.3</span> Design Themes in Cancer Subtyping</a></li>
  </ul></li>
  <li><a href="#rare-variants-and-epistasis-in-systems-context" id="toc-rare-variants-and-epistasis-in-systems-context" class="nav-link" data-scroll-target="#rare-variants-and-epistasis-in-systems-context"><span class="header-section-number">15.14</span> Rare Variants and Epistasis in Systems Context</a>
  <ul class="collapse">
  <li><a href="#deeprvat-set-based-rare-variant-burden-modeling" id="toc-deeprvat-set-based-rare-variant-burden-modeling" class="nav-link" data-scroll-target="#deeprvat-set-based-rare-variant-burden-modeling"><span class="header-section-number">15.14.1</span> DeepRVAT: Set-Based Rare Variant Burden Modeling</a></li>
  <li><a href="#needl-network-based-epistasis-detection" id="toc-needl-network-based-epistasis-detection" class="nav-link" data-scroll-target="#needl-network-based-epistasis-detection"><span class="header-section-number">15.14.2</span> NeEDL: Network-Based Epistasis Detection</a></li>
  <li><a href="#g2pt-hierarchical-genotype-to-phenotype-transformers" id="toc-g2pt-hierarchical-genotype-to-phenotype-transformers" class="nav-link" data-scroll-target="#g2pt-hierarchical-genotype-to-phenotype-transformers"><span class="header-section-number">15.14.3</span> G2PT: Hierarchical Genotype-to-Phenotype Transformers</a></li>
  </ul></li>
  <li><a href="#deep-learning-enhanced-polygenic-risk-and-fine-mapping" id="toc-deep-learning-enhanced-polygenic-risk-and-fine-mapping" class="nav-link" data-scroll-target="#deep-learning-enhanced-polygenic-risk-and-fine-mapping"><span class="header-section-number">15.15</span> Deep Learning-Enhanced Polygenic Risk and Fine-Mapping</a>
  <ul class="collapse">
  <li><a href="#deep-learning-pgs-frameworks" id="toc-deep-learning-pgs-frameworks" class="nav-link" data-scroll-target="#deep-learning-pgs-frameworks"><span class="header-section-number">15.15.1</span> Deep-Learning PGS Frameworks</a></li>
  <li><a href="#mifm-and-multi-ancestry-fine-mapping" id="toc-mifm-and-multi-ancestry-fine-mapping" class="nav-link" data-scroll-target="#mifm-and-multi-ancestry-fine-mapping"><span class="header-section-number">15.15.2</span> MIFM and Multi-Ancestry Fine-Mapping</a></li>
  </ul></li>
  <li><a href="#design-patterns-across-multi-omics-models" id="toc-design-patterns-across-multi-omics-models" class="nav-link" data-scroll-target="#design-patterns-across-multi-omics-models"><span class="header-section-number">15.16</span> Design Patterns Across Multi-Omics Models</a></li>
  <li><a href="#practical-challenges-1" id="toc-practical-challenges-1" class="nav-link" data-scroll-target="#practical-challenges-1"><span class="header-section-number">15.17</span> Practical Challenges</a></li>
  <li><a href="#outlook-toward-whole-patient-foundation-models" id="toc-outlook-toward-whole-patient-foundation-models" class="nav-link" data-scroll-target="#outlook-toward-whole-patient-foundation-models"><span class="header-section-number">15.18</span> Outlook: Toward Whole-Patient Foundation Models</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="header-section-number">15.19</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4--multi-scale.html">Part IV: Multi-Scale Modeling</a></li><li class="breadcrumb-item"><a href="./p4-ch15-systems.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-systems" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>Add figure: Multi-omics integration strategies diagram showing early, intermediate, and late fusion approaches with representative models</li>
<li>Add figure: GNN-based cancer subtyping comparison showing MoGCN patient-level graphs vs.&nbsp;CGMega gene-level modules</li>
<li>Add figure: DeepRVAT set-based architecture showing variant aggregation into gene-level impairment scores</li>
<li>Add figure: G2PT hierarchical structure from variants → genes → systems → phenotypes</li>
<li>Add figure: Deep PGS architecture comparison showing Delphi and related approaches</li>
<li>Add table: Comparison of multi-omics integration methods (GLUE, MoGCN, CGMega, etc.) with columns for input modalities, graph type, primary use case, and scalability</li>
<li>Add table: Design patterns summary showing the five key patterns with representative methods and typical applications</li>
<li>Consider adding conceptual diagram showing the trajectory from single-omic models toward whole-patient foundation models</li>
</ul>
</div>
</div>
<p>The preceding chapter examined foundation models for individual data types: single-cell transcriptomics, DNA methylation, and three-dimensional genome structure. Real biological systems, however, do not respect these modality boundaries. Complex traits arise from systems-level interactions where genetic variants perturb molecular networks, networks span multiple omics layers, and these layers interact with environment, development, and clinical context. A model that sees only one layer rarely captures the full story.</p>
<p>This chapter surveys how deep learning extends beyond single-omics to integrate multiple data types into unified representations. We examine integration strategies that differ in when and how modalities are combined. We explore graph neural network approaches that use patient similarity networks and gene-level graphs for cancer subtyping and biomarker discovery. We address rare variants and epistasis through set-based architectures and hierarchical modeling that capture effects linear polygenic scores miss. We consider deep learning frameworks for polygenic risk and fine-mapping that extend the traditional PGS paradigm with nonlinear architectures and foundation model features. Throughout, the emphasis is on design patterns that recur across methods and on the trajectory toward whole-patient foundation models that jointly encode multiple omics and clinical data.# Chapter 15: Multi-Omics Integration and Systems Biology {#sec-systems}</p>
<section id="introduction" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">15.1</span> Introduction</h2>
<ul>
<li>Why single-omics models are insufficient</li>
<li>The promise of integrated multi-modal representations</li>
<li>Chapter scope: integration strategies, hierarchy, systems principles</li>
</ul>
</section>
<section id="multi-omics-integration-strategies" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="multi-omics-integration-strategies"><span class="header-section-number">15.2</span> Multi-Omics Integration Strategies</h2>
<section id="early-fusion" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="early-fusion"><span class="header-section-number">15.2.1</span> Early Fusion</h3>
<ul>
<li>Feature-level concatenation</li>
<li>Challenges: scale, dimensionality, missing data</li>
</ul>
</section>
<section id="intermediate-fusion" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="intermediate-fusion"><span class="header-section-number">15.2.2</span> Intermediate Fusion</h3>
<ul>
<li>Modality-specific encoders with shared latent spaces</li>
<li>Reconstruction and contrastive alignment</li>
<li>GLUE as exemplar</li>
</ul>
</section>
<section id="late-fusion" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="late-fusion"><span class="header-section-number">15.2.3</span> Late Fusion</h3>
<ul>
<li>Ensemble and meta-model approaches</li>
<li>Independence and robustness to missing modalities</li>
</ul>
</section>
<section id="choosing-integration-strategies" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="choosing-integration-strategies"><span class="header-section-number">15.2.4</span> Choosing Integration Strategies</h3>
<ul>
<li>When to use each approach</li>
<li>Hybrid strategies in practice</li>
</ul>
</section>
</section>
<section id="cross-modal-foundation-models" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="cross-modal-foundation-models"><span class="header-section-number">15.3</span> Cross-Modal Foundation Models</h2>
<section id="principles-of-cross-modal-learning" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="principles-of-cross-modal-learning"><span class="header-section-number">15.3.1</span> Principles of Cross-Modal Learning</h3>
<ul>
<li>Contrastive objectives across modalities</li>
<li>Translation between data types</li>
<li>Shared vs.&nbsp;modality-specific representations</li>
</ul>
</section>
<section id="examples-glue-life-code-and-related-models" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="examples-glue-life-code-and-related-models"><span class="header-section-number">15.3.2</span> Examples: GLUE, Life-Code, and Related Models</h3>
<ul>
<li>Multi-omic encoders and guidance graphs</li>
<li>Central dogma-inspired architectures</li>
<li>Handling unpaired and mosaic data</li>
</ul>
</section>
</section>
<section id="hierarchical-and-multi-scale-modeling" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="hierarchical-and-multi-scale-modeling"><span class="header-section-number">15.4</span> Hierarchical and Multi-Scale Modeling</h2>
<section id="biological-hierarchy" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="biological-hierarchy"><span class="header-section-number">15.4.1</span> Biological Hierarchy</h3>
<ul>
<li>Variants → genes → pathways → systems → phenotypes</li>
<li>Multi-resolution regulatory organization</li>
</ul>
</section>
<section id="g2pt-hierarchical-genotype-to-phenotype" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="g2pt-hierarchical-genotype-to-phenotype"><span class="header-section-number">15.4.2</span> G2PT: Hierarchical Genotype-to-Phenotype</h3>
<ul>
<li>Transformer blocks at each hierarchy level</li>
<li>Prior knowledge as structural constraints</li>
<li>Interpretable attention over biological systems</li>
</ul>
</section>
<section id="multi-scale-regulatory-models" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="multi-scale-regulatory-models"><span class="header-section-number">15.4.3</span> Multi-Scale Regulatory Models</h3>
<ul>
<li>Seq2PRINT and multi-scale footprinting</li>
<li>Cell type to tissue to organism scales</li>
</ul>
</section>
</section>
<section id="rare-variants-in-systems-context" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="rare-variants-in-systems-context"><span class="header-section-number">15.5</span> Rare Variants in Systems Context</h2>
<section id="the-challenge-of-rare-variants" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="the-challenge-of-rare-variants"><span class="header-section-number">15.5.1</span> The Challenge of Rare Variants</h3>
<ul>
<li>Individual rarity, collective importance</li>
<li>Limitations of per-variant statistics</li>
</ul>
</section>
<section id="deeprvat-set-based-burden-modeling" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="deeprvat-set-based-burden-modeling"><span class="header-section-number">15.5.2</span> DeepRVAT: Set-Based Burden Modeling</h3>
<ul>
<li>Variants as unordered sets within genes</li>
<li>Permutation-invariant aggregation</li>
<li>Gene-level impairment scores</li>
</ul>
</section>
<section id="from-burden-to-systems-level-risk" class="level3" data-number="15.5.3">
<h3 data-number="15.5.3" class="anchored" data-anchor-id="from-burden-to-systems-level-risk"><span class="header-section-number">15.5.3</span> From Burden to Systems-Level Risk</h3>
<ul>
<li>Connecting gene impairment to pathways</li>
<li>Aggregating across biological systems</li>
</ul>
</section>
</section>
<section id="systems-biology-principles-for-deep-learning" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="systems-biology-principles-for-deep-learning"><span class="header-section-number">15.6</span> Systems Biology Principles for Deep Learning</h2>
<section id="network-motifs-and-regulatory-logic" class="level3" data-number="15.6.1">
<h3 data-number="15.6.1" class="anchored" data-anchor-id="network-motifs-and-regulatory-logic"><span class="header-section-number">15.6.1</span> Network Motifs and Regulatory Logic</h3>
<ul>
<li>Feedforward loops, autoregulation, feedback</li>
<li>Alon’s design principles in gene circuits</li>
<li>Learning motif structure from data</li>
</ul>
</section>
<section id="robustness-and-canalization" class="level3" data-number="15.6.2">
<h3 data-number="15.6.2" class="anchored" data-anchor-id="robustness-and-canalization"><span class="header-section-number">15.6.2</span> Robustness and Canalization</h3>
<ul>
<li>Why biological networks are robust</li>
<li>Implications for model generalization</li>
<li>Redundancy and compensation</li>
</ul>
</section>
<section id="dynamical-systems-perspectives" class="level3" data-number="15.6.3">
<h3 data-number="15.6.3" class="anchored" data-anchor-id="dynamical-systems-perspectives"><span class="header-section-number">15.6.3</span> Dynamical Systems Perspectives</h3>
<ul>
<li>Attractor states and cell identity</li>
<li>State transitions and differentiation</li>
<li>Time-series modeling in systems context</li>
</ul>
</section>
</section>
<section id="systems-medicine-and-clinical-integration" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="systems-medicine-and-clinical-integration"><span class="header-section-number">15.7</span> Systems Medicine and Clinical Integration</h2>
<section id="from-molecular-networks-to-patient-phenotypes" class="level3" data-number="15.7.1">
<h3 data-number="15.7.1" class="anchored" data-anchor-id="from-molecular-networks-to-patient-phenotypes"><span class="header-section-number">15.7.1</span> From Molecular Networks to Patient Phenotypes</h3>
<ul>
<li>Disease as network perturbation</li>
<li>Personal omics profiles</li>
</ul>
</section>
<section id="multi-omic-risk-scores" class="level3" data-number="15.7.2">
<h3 data-number="15.7.2" class="anchored" data-anchor-id="multi-omic-risk-scores"><span class="header-section-number">15.7.2</span> Multi-Omic Risk Scores</h3>
<ul>
<li>Delphi and deep PGS frameworks</li>
<li>Beyond linear polygenic scores</li>
<li>Cross-ancestry generalization</li>
</ul>
</section>
<section id="fine-mapping-in-systems-context" class="level3" data-number="15.7.3">
<h3 data-number="15.7.3" class="anchored" data-anchor-id="fine-mapping-in-systems-context"><span class="header-section-number">15.7.3</span> Fine-Mapping in Systems Context</h3>
<ul>
<li>MIFM and foundation model features</li>
<li>Integrating functional annotations with GWAS</li>
</ul>
</section>
</section>
<section id="practical-challenges" class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="practical-challenges"><span class="header-section-number">15.8</span> Practical Challenges</h2>
<section id="batch-effects-across-modalities" class="level3" data-number="15.8.1">
<h3 data-number="15.8.1" class="anchored" data-anchor-id="batch-effects-across-modalities"><span class="header-section-number">15.8.1</span> Batch Effects Across Modalities</h3>
<ul>
<li>Platform and laboratory variation</li>
<li>Harmonization strategies</li>
</ul>
</section>
<section id="sample-size-and-missing-modalities" class="level3" data-number="15.8.2">
<h3 data-number="15.8.2" class="anchored" data-anchor-id="sample-size-and-missing-modalities"><span class="header-section-number">15.8.2</span> Sample Size and Missing Modalities</h3>
<ul>
<li>Imputation and partial observations</li>
<li>Transfer learning across cohorts</li>
</ul>
</section>
<section id="population-diversity" class="level3" data-number="15.8.3">
<h3 data-number="15.8.3" class="anchored" data-anchor-id="population-diversity"><span class="header-section-number">15.8.3</span> Population Diversity</h3>
<ul>
<li>Non-European representation in multi-omics</li>
<li>Equity considerations in systems models</li>
</ul>
</section>
<section id="evaluation-complexity" class="level3" data-number="15.8.4">
<h3 data-number="15.8.4" class="anchored" data-anchor-id="evaluation-complexity"><span class="header-section-number">15.8.4</span> Evaluation Complexity</h3>
<ul>
<li>Proxy metrics vs.&nbsp;clinical utility</li>
<li>Multi-level validation strategies</li>
</ul>
</section>
</section>
<section id="toward-whole-patient-foundation-models" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="toward-whole-patient-foundation-models"><span class="header-section-number">15.9</span> Toward Whole-Patient Foundation Models</h2>
<ul>
<li>Vision: unified patient representations</li>
<li>Integrating genotype, epigenome, transcriptome, proteome, EHR</li>
<li>Challenges: privacy, scale, causality</li>
<li>The path forward</li>
</ul>
</section>
<section id="summary" class="level2" data-number="15.10">
<h2 data-number="15.10" class="anchored" data-anchor-id="summary"><span class="header-section-number">15.10</span> Summary</h2>
</section>
<section id="why-single-omics-models-are-not-enough" class="level2" data-number="15.11">
<h2 data-number="15.11" class="anchored" data-anchor-id="why-single-omics-models-are-not-enough"><span class="header-section-number">15.11</span> Why Single-Omics Models Are Not Enough</h2>
<p>Earlier chapters emphasized how sequence-based models can predict variant effects from local DNA or protein context. These models already improve causal variant prioritization and polygenic risk scoring. However, they typically assume a narrow view of biology.</p>
<p>Most sequence models operate on a single molecular layer. A convolutional network or transformer may see only DNA sequence, or only expression values, without access to the other layers that mediate the flow of genetic information. Even when multiple outputs are predicted simultaneously, as in multi-task models like Enformer, the input remains a single modality.</p>
<p>Many downstream uses treat variant effects as additively summing across loci. The PGS framework from <a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> exemplifies this assumption: effects of individual variants are estimated independently and combined through weighted sums. While linear models have well-understood statistical properties and interpretability, they cannot capture interactions between variants or between molecular layers.</p>
<p>Models rarely account for dynamic cellular state. The same sequence may have different regulatory consequences depending on cell type, developmental stage, or environmental exposure. Static sequence-to-function models provide context-averaged predictions that may not reflect biology in any particular condition.</p>
<p>Real diseases violate all three of these assumptions. Regulation is inherently multi-layered: genetic variants alter chromatin accessibility and DNA methylation, which modulate transcription, which affects splicing and translation, which determines protein levels and modifications. A variant’s consequences propagate through this cascade in ways that single-layer models cannot fully capture.</p>
<p>Effects are context-dependent. A variant might be benign in one tissue and pathogenic in another, depending on which genes are expressed, which transcription factors are present, and how the local chromatin environment is configured.</p>
<p>Interactions between variants can be biologically important. Epistasis, where the effect of one variant depends on genotypes at other loci, is theoretically expected from network biology and has been documented empirically for many traits. Models that ignore interactions may miss important biology and underperform for individual-level prediction.</p>
</section>
<section id="multi-omics-integration-strategies-1" class="level2" data-number="15.12">
<h2 data-number="15.12" class="anchored" data-anchor-id="multi-omics-integration-strategies-1"><span class="header-section-number">15.12</span> Multi-Omics Integration Strategies</h2>
<p>How should multiple data types be combined? Three broad strategies have emerged, each with distinct tradeoffs.</p>
<section id="early-fusion-1" class="level3" data-number="15.12.1">
<h3 data-number="15.12.1" class="anchored" data-anchor-id="early-fusion-1"><span class="header-section-number">15.12.1</span> Early Fusion</h3>
<p>Early fusion, also called feature-level integration, concatenates normalized features from multiple omics and feeds them into a single model. This approach is straightforward to implement and allows the model to learn arbitrary interactions between features. However, early fusion is sensitive to differences in scale and dimensionality between modalities, handles missing data poorly since any sample lacking one modality must be imputed or excluded, and can be dominated by whichever modality has the most features or highest signal-to-noise ratio.</p>
</section>
<section id="intermediate-fusion-1" class="level3" data-number="15.12.2">
<h3 data-number="15.12.2" class="anchored" data-anchor-id="intermediate-fusion-1"><span class="header-section-number">15.12.2</span> Intermediate Fusion</h3>
<p>Intermediate fusion, also called shared latent space integration, learns modality-specific encoders that map each omic into a common embedding space. Alignment between modalities is encouraged through reconstruction losses that require each encoder’s latent representation to support decoding back to its original features, contrastive terms that pull together representations of the same biological entity across modalities, or graph constraints that enforce consistency with known biological relationships.</p>
<p>Intermediate fusion is the dominant design in modern multi-omics deep learning because it handles missing modalities gracefully (only the available encoder needs to fire), allows modality-specific preprocessing and architectures, and can incorporate biological prior knowledge through the alignment objectives. GLUE and related methods from <a href="p4-ch13-sc-epi.html" class="quarto-xref"><span>Chapter 13</span></a> exemplify this approach.</p>
</section>
<section id="late-fusion-1" class="level3" data-number="15.12.3">
<h3 data-number="15.12.3" class="anchored" data-anchor-id="late-fusion-1"><span class="header-section-number">15.12.3</span> Late Fusion</h3>
<p>Late fusion, also called prediction-level integration, trains separate models for each modality and combines their outputs through ensemble methods or a meta-model. This approach is robust to missing modalities since each sub-model operates independently, and it allows each modality to use whatever architecture works best for its data type. However, late fusion may underutilize cross-omic structure that could inform predictions, since interactions between modalities can only be captured at the final combination stage.</p>
</section>
<section id="graph-guided-integration" class="level3" data-number="15.12.4">
<h3 data-number="15.12.4" class="anchored" data-anchor-id="graph-guided-integration"><span class="header-section-number">15.12.4</span> Graph-Guided Integration</h3>
<p>Modern frameworks like GLUE and multi-omics graph neural networks predominantly adopt intermediate fusion, often augmented with graphs that encode known or inferred biological relationships. Gene-peak edges in single-cell multi-omics link chromatin accessibility peaks to the genes they regulate. Gene-transcription factor edges connect genes to the factors that bind their promoters and enhancers. Protein-protein interaction edges capture physical and functional relationships. Sample similarity edges connect patients or cells with similar molecular profiles.</p>
</section>
</section>
<section id="graph-neural-networks-for-cancer-subtyping" class="level2" data-number="15.13">
<h2 data-number="15.13" class="anchored" data-anchor-id="graph-neural-networks-for-cancer-subtyping"><span class="header-section-number">15.13</span> Graph Neural Networks for Cancer Subtyping</h2>
<p>Cancer classification provides a compelling use case for multi-omics integration. Tumors are characterized by complex molecular alterations spanning mutations, copy number changes, epigenetic modifications, and expression programs. Different subtypes may require different treatments, and identifying the molecular basis of subtypes can reveal therapeutic targets.</p>
<section id="mogcn-patient-similarity-networks" class="level3" data-number="15.13.1">
<h3 data-number="15.13.1" class="anchored" data-anchor-id="mogcn-patient-similarity-networks"><span class="header-section-number">15.13.1</span> MoGCN: Patient Similarity Networks</h3>
<p>MoGCN, a multi-omics integration model based on graph convolutional networks, was developed for cancer subtype classification and analysis <span class="citation" data-cites="li_mogcn_2022">(<a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>)</span>. The approach constructs patient similarity networks from multi-omic data and applies graph convolutions to learn subtype-discriminative representations.</p>
<p>The architecture proceeds in several stages. First, autoencoders reduce dimensionality for each omic layer, producing compressed representations of genomic, transcriptomic, and proteomic profiles. Second, similarity network fusion constructs a patient similarity network (PSN) from these reduced representations, connecting patients whose molecular profiles are similar across modalities. Third, the compressed features and the PSN are input to a graph convolutional network for subtype classification.</p>
<p>In analysis of multi-dimensional omics data for breast invasive carcinoma (BRCA) samples from TCGA, MoGCN achieved the highest accuracy in cancer subtype classification compared with several popular algorithms. Beyond classification, MoGCN can extract the most significant features of each omics layer and provide candidate functional molecules for further analysis. Network visualization showed that MoGCN could support clinically intuitive diagnosis by revealing the molecular relationships underlying subtype distinctions.</p>
</section>
<section id="cgmega-gene-level-modules" class="level3" data-number="15.13.2">
<h3 data-number="15.13.2" class="anchored" data-anchor-id="cgmega-gene-level-modules"><span class="header-section-number">15.13.2</span> CGMega: Gene-Level Modules</h3>
<p>While MoGCN operates at the patient level, connecting samples with similar profiles, CGMega takes a complementary approach by constructing gene-level graphs that capture multi-omic relationships among genes <span class="citation" data-cites="li_cgmega_2024">(<a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>. This gene-centric view enables identification of gene modules that drive subtype differences and provides more mechanistically interpretable results.</p>
<p>The architecture builds graphs where nodes represent genes and edges capture relationships across omics layers: co-expression from transcriptomics, co-methylation from epigenomics, and protein interactions from proteomics. Graph neural network layers learn gene embeddings that integrate information across these different relationship types. Gene-level importance scores derived from the model identify candidate biomarkers and therapeutic targets.</p>
</section>
<section id="design-themes-in-cancer-subtyping" class="level3" data-number="15.13.3">
<h3 data-number="15.13.3" class="anchored" data-anchor-id="design-themes-in-cancer-subtyping"><span class="header-section-number">15.13.3</span> Design Themes in Cancer Subtyping</h3>
<p>Common themes emerge across these methods. Modality-specific encoders with shared latent spaces appear repeatedly, allowing flexible handling of missing modalities while enabling cross-modal interactions. Graphs capturing patient-patient or gene-gene relationships structure the learning problem and provide interpretability. Emphasis on biological interpretability through clusters, modules, or attention patterns helps translate model outputs into biological hypotheses.</p>
<p>These cancer subtyping models illustrate how multi-omics integration naturally leads to graph-structured genomic foundation models. Sequences, epigenetics, and expression become nodes in learned biological networks, and the models learn to reason over these networks rather than treating each measurement in isolation.</p>
</section>
</section>
<section id="rare-variants-and-epistasis-in-systems-context" class="level2" data-number="15.14">
<h2 data-number="15.14" class="anchored" data-anchor-id="rare-variants-and-epistasis-in-systems-context"><span class="header-section-number">15.14</span> Rare Variants and Epistasis in Systems Context</h2>
<p><a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> discussed how standard PGS methods largely ignore rare variants and epistatic interactions, despite their importance for individual-level risk and disease mechanism. Rare variants, though individually uncommon, collectively explain substantial phenotypic variance and often have larger effect sizes than common variants. Epistasis, the non-additive interaction between variants, is theoretically expected from network biology and has been documented empirically for many traits. Multi-omics and systems models offer a framework to incorporate these effects more effectively than linear approaches.</p>
<section id="deeprvat-set-based-rare-variant-burden-modeling" class="level3" data-number="15.14.1">
<h3 data-number="15.14.1" class="anchored" data-anchor-id="deeprvat-set-based-rare-variant-burden-modeling"><span class="header-section-number">15.14.1</span> DeepRVAT: Set-Based Rare Variant Burden Modeling</h3>
<p>DeepRVAT, Deep Rare Variant Association Testing, addresses a fundamental statistical challenge: rare variants have too few carriers to achieve individual statistical significance, yet collectively they carry important phenotypic information <span class="citation" data-cites="clarke_deeprvat_2024">(<a href="references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>. Traditional burden tests collapse all rare variants in a gene into a single count, losing information about variant severity. DeepRVAT instead learns gene-level impairment scores from variant annotations using set neural networks.</p>
<p>The architecture treats each gene’s rare variants as an unordered set, reflecting the biological reality that the order of variants along a gene is not informative for their combined effect. Each variant is characterized by a vector of annotations including predicted functional impact, conservation, and structural features. A permutation-invariant neural network aggregates these annotations into a gene-level impairment score.</p>
<p>Crucially, DeepRVAT learns trait-agnostic representations. The gene impairment scores are trained to be predictive across multiple phenotypes simultaneously, which provides regularization and enables transfer to new traits. This multi-task learning encourages the model to learn biologically meaningful notions of gene damage rather than overfitting to any single phenotype.</p>
<p>The result improves both gene discovery and risk prediction. For gene discovery, DeepRVAT identifies more significant gene-trait associations than linear burden tests, particularly for genes where variant effects are heterogeneous. For risk prediction, the learned impairment scores identify individuals with high rare variant burden across multiple genes, enabling personalized risk assessment that linear PGS cannot capture.</p>
<p>DeepRVAT bridges the gap between variant-level annotations and gene-level burden, making it naturally compatible with sequence-based variant effect models from earlier chapters. Annotations from models like SpliceAI, AlphaMissense, or DNA foundation models can serve as input features, and the set neural network learns how to combine them into predictive gene-level scores.</p>
</section>
<section id="needl-network-based-epistasis-detection" class="level3" data-number="15.14.2">
<h3 data-number="15.14.2" class="anchored" data-anchor-id="needl-network-based-epistasis-detection"><span class="header-section-number">15.14.2</span> NeEDL: Network-Based Epistasis Detection</h3>
<p>NeEDL, Network-based Epistasis Detection via Local search, addresses the complementary challenge of identifying epistatic interactions among variants <span class="citation" data-cites="kessler_needl_2023">(<a href="references.html#ref-kessler_needl_2023" role="doc-biblioref"><strong>kessler_needl_2023?</strong></a>)</span>. The search space for epistasis is enormous: even considering only pairwise interactions among a million variants yields approximately 500 billion pairs to test. NeEDL uses network structure and optimization algorithms to make this search tractable.</p>
<p>The approach builds on network medicine principles. Genes and variants are embedded in a network based on biological prior knowledge, including protein-protein interactions, pathway membership, and co-expression relationships, as well as GWAS signals that suggest which variants influence the trait. Local search strategies explore combinations of variants that are close in this network and that jointly influence disease.</p>
<p>The optimization uses algorithms that efficiently explore the combinatorial space of variant combinations. Rather than exhaustively testing all pairs or higher-order combinations, the search focuses on biologically plausible interaction sets defined by network proximity.</p>
<p>NeEDL does not operate as a full genomic foundation model, but it points toward systems-level combinatorial reasoning that future models will need to support. The network structure provides biological constraints that make the epistasis search feasible, and the discovered interactions map onto interpretable pathways and cellular processes.</p>
</section>
<section id="g2pt-hierarchical-genotype-to-phenotype-transformers" class="level3" data-number="15.14.3">
<h3 data-number="15.14.3" class="anchored" data-anchor-id="g2pt-hierarchical-genotype-to-phenotype-transformers"><span class="header-section-number">15.14.3</span> G2PT: Hierarchical Genotype-to-Phenotype Transformers</h3>
<p>G2PT, Genotype-to-Phenotype Transformer, explicitly models the hierarchical structure connecting variants to phenotypes <span class="citation" data-cites="lee_g2pt_2025">(<a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. Rather than treating variants as independent features to be weighted and summed, G2PT organizes variants into genes, genes into systems such as pathways and tissues, and systems into phenotype predictions.</p>
<p>The architecture uses transformer blocks at each level of this hierarchy. Variant-level attention captures interactions between variants within a gene. Gene-level attention captures interactions between genes within a system. System-level attention captures how different pathways and tissues contribute to phenotype risk.</p>
<p>Prior biological knowledge structures these attention patterns. Gene-pathway membership from databases like KEGG and Reactome defines which genes belong to which systems. Tissue expression patterns from GTEx indicate where each gene is active. These priors constrain the attention patterns, ensuring that the model learns biologically plausible interaction structures rather than arbitrary statistical correlations.</p>
<p>The hierarchical structure provides interpretability. After training, attention weights can be examined to understand which variants, genes, and systems most strongly contribute to risk for a given individual. This enables explanations like “high risk is driven by variants in genes A and B that together perturb pathway X in tissue Y.”</p>
<p>As proof-of-concept, G2PT was applied to model the genetics of the triglycerides to high-density lipoprotein cholesterol ratio (TG/HDL), an indicator of metabolic health. G2PT predicted this trait via attention to 1,395 variants underlying at least 20 systems, including immune response and cholesterol transport, with accuracy exceeding state-of-the-art methods. It implicated 40 epistatic interactions, including epistasis between APOA4 and CETP in phospholipid transfer, a target pathway for cholesterol modification.</p>
<p>G2PT can be viewed as an early example of a systems-aware genomic foundation model for genotype data. It unifies additive and interaction effects within a single deep architecture, using prior knowledge to guide learning toward biologically meaningful structure.</p>
</section>
</section>
<section id="deep-learning-enhanced-polygenic-risk-and-fine-mapping" class="level2" data-number="15.15">
<h2 data-number="15.15" class="anchored" data-anchor-id="deep-learning-enhanced-polygenic-risk-and-fine-mapping"><span class="header-section-number">15.15</span> Deep Learning-Enhanced Polygenic Risk and Fine-Mapping</h2>
<p><a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> framed polygenic scores as linear weighted sums of variant effects. This approach has attractive statistical properties including interpretability, efficiency, and well-characterized uncertainty. However, it misses nonlinear effects, cannot incorporate rich sequence-based features, and struggles with rare variants and cross-ancestry generalization. Deep learning extends the PGS paradigm along each of these dimensions.</p>
<section id="deep-learning-pgs-frameworks" class="level3" data-number="15.15.1">
<h3 data-number="15.15.1" class="anchored" data-anchor-id="deep-learning-pgs-frameworks"><span class="header-section-number">15.15.1</span> Deep-Learning PGS Frameworks</h3>
<p>Deep-learning PGS frameworks like Delphi replace the linear combination of variant effects with flexible neural networks that learn complex functions of genotype and covariates <span class="citation" data-cites="georgantas_delphi_2024">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>)</span>.</p>
<p>The key technical contribution is enabling neural networks to handle genome-wide inputs. A typical GWAS includes hundreds of thousands to millions of variants, far more than can be naively input to a neural network. Delphi addresses this through efficient architectures that can process hundreds of thousands of variants while remaining computationally tractable.</p>
<p>The resulting models can capture dominance effects where heterozygotes differ from the midpoint of homozygotes, epistatic interactions where variant effects depend on genetic background, and gene-environment interactions where variant effects depend on non-genetic covariates. These effects are learned from data rather than specified a priori, allowing the model to discover whatever structure best predicts the phenotype.</p>
<p>Empirical evaluations demonstrate improved discrimination compared to linear PGS across several traits, with the gains being largest for traits where nonlinear effects are most important. Delphi showed relative increases in percentage variance explained of 11.4% for body mass index, 18.9% for systolic blood pressure, 7.5% for LDL cholesterol, 35% for C-reactive protein, 16.2% for height, and 29.6% for pulse rate compared to state-of-the-art linear methods.</p>
<p>Importantly, Delphi also shows improved cross-ancestry generalization: the learned representations transfer more effectively than linear weights to populations not well represented in training data. This suggests that deep learning can partially address the well-documented portability problem of polygenic scores.</p>
<p>From a systems perspective, deep-learning PGS frameworks represent a move toward whole-patient risk modeling. While still primarily based on genotype plus covariates without explicit multi-omics integration, they demonstrate that the linear PGS paradigm can be extended to capture more biological complexity.</p>
</section>
<section id="mifm-and-multi-ancestry-fine-mapping" class="level3" data-number="15.15.2">
<h3 data-number="15.15.2" class="anchored" data-anchor-id="mifm-and-multi-ancestry-fine-mapping"><span class="header-section-number">15.15.2</span> MIFM and Multi-Ancestry Fine-Mapping</h3>
<p>Fine-mapping addresses a fundamental challenge in human genetics: GWAS identifies loci but cannot usually pinpoint causal variants. Within each associated locus, linkage disequilibrium means that many variants are correlated with the causal variant and show similar association signals. Fine-mapping methods attempt to distinguish causal variants from these correlated passengers.</p>
<p>Multiple-instance fine-mapping frameworks like MIFM address the key bottleneck that per-variant causal labels are rarely available <span class="citation" data-cites="rakowski_mifm_2025">(<a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>. Instead, we typically know only that some variant or variants within a locus are causal. MIFM treats this as a multiple-instance learning problem where each locus is a “bag” of variants, only some of which are causal.</p>
<p>The framework learns to score variants based on sequence-derived features from genomic foundation models, conservation, and functional annotations. The training objective encourages the model to identify variants that distinguish causal loci from matched control regions, without requiring explicit labels for individual variants.</p>
<p>By incorporating foundation model embeddings, MIFM can leverage the rich sequence representations learned from large-scale pretraining. Variants in similar regulatory contexts receive similar scores, even if they have not been directly observed in fine-mapping studies. This enables transfer to new loci and populations where fine-mapping data are limited.</p>
</section>
</section>
<section id="design-patterns-across-multi-omics-models" class="level2" data-number="15.16">
<h2 data-number="15.16" class="anchored" data-anchor-id="design-patterns-across-multi-omics-models"><span class="header-section-number">15.16</span> Design Patterns Across Multi-Omics Models</h2>
<p>Several design patterns provide conceptual vocabulary for understanding existing methods and designing new ones.</p>
<p><strong>Modality-specific encoders with shared latent spaces</strong> appear in GLUE, CpGPT, and many multi-omics subtyping models. Each omic has its own encoder architecture tailored to its data characteristics, whether that involves treating methylation as a sequence, using variational autoencoders for scRNA-seq, or applying graph convolutions to patient similarity networks. These modality-specific encoders map into a common embedding space where downstream tasks operate. This design supports flexible inference with missing modalities, since only the available encoders need to fire, and allows incremental addition of new data types by training new encoders without retraining existing components.</p>
<p><strong>Graph-guided integration</strong> structures learning through biological prior knowledge. GLUE’s feature graph links peaks to genes and transcription factors. CGMega’s gene-level graphs encode multi-omic relationships. NeEDL’s epistasis networks capture pathway structure and protein interactions. Graph neural networks, graph transformers, and attention mechanisms over graph edges provide natural tools for encoding these biological networks and learning representations that respect network structure.</p>
<p><strong>Hierarchical modeling</strong> captures the organization of biological systems across scales. G2PT formalizes the hierarchy from variants to genes to systems to phenotypes. Similar hierarchies can be defined for omics layers: sequence gives rise to chromatin state, which influences methylation patterns, which affect transcription, which determines protein levels, which ultimately connect to clinical traits. Architectures that respect this hierarchy can learn more interpretable and generalizable representations than flat models that treat all features equivalently.</p>
<p><strong>Set-based and bag-based learning</strong> handles collections of variants or features that lack natural ordering. DeepRVAT treats variants within a gene as an unordered set, using permutation-invariant architectures to aggregate them into gene-level scores. MIFM treats variants within a fine-mapping locus as a bag, learning to identify causal variants without explicit per-variant labels. This pattern is crucial when sample sizes are large, labels are sparse, and biological order is meaningless.</p>
<p><strong>Foundation pretraining with task-specific adaptation</strong> follows the broader paradigm that defines foundation models. CpGPT is pretrained on massive methylation datasets covering diverse tissues and conditions, then adapted through fine-tuning or linear probing to specific tasks like age prediction or mortality risk. This pattern could extend to multi-omics pretraining, where models learn joint representations of sequence, chromatin, methylation, expression, and clinical data before specialization for particular applications.</p>
</section>
<section id="practical-challenges-1" class="level2" data-number="15.17">
<h2 data-number="15.17" class="anchored" data-anchor-id="practical-challenges-1"><span class="header-section-number">15.17</span> Practical Challenges</h2>
<p>Multi-omics foundation models introduce additional practical challenges beyond those facing single-modality approaches.</p>
<p>Batch effects multiply when combining data from multiple platforms, laboratories, and time points. Each modality may have its own batch structure, and batch effects can correlate with biological signals in complex ways. Harmonization methods must address batch effects within each modality while preserving cross-modal relationships.</p>
<p>Sample size limitations become more severe when requiring samples with measurements across all modalities. While imputation can address missing modalities, the reliability of imputed values depends on how well the relationship between modalities is captured by training data.</p>
<p>Most large multi-omics datasets come from European-ancestry populations in high-resource healthcare systems. Models trained on these data may perform poorly or behave differently in other populations. Multi-omics models risk amplifying disparities if trained primarily on non-representative cohorts, since the richer feature sets provide more opportunity for overfitting to population-specific patterns.</p>
<p>Evaluation complexity increases with the number of modalities and the breadth of potential applications. Multi-omics models can be evaluated at many levels: predictive performance on held-out data, biological consistency of learned representations with known biology, plausibility of inferred networks compared to experimental validation, and clinical utility when deployed in real-world settings. Overfitting to proxy metrics that are easy to compute may not translate to performance on the metrics that ultimately matter.</p>
<p>Interpretability and causal inference remain challenging. Attention scores and feature importance values provide some insight into model behavior, but they are not guarantees of causal mechanism. A model might attend to a feature because that feature is causal, or because it is correlated with something causal, or for spurious reasons related to batch effects or data collection. Integrating deep models with perturbation data from CRISPR screens and gene knockouts, and with robust causal inference frameworks, remains an open frontier.</p>
</section>
<section id="outlook-toward-whole-patient-foundation-models" class="level2" data-number="15.18">
<h2 data-number="15.18" class="anchored" data-anchor-id="outlook-toward-whole-patient-foundation-models"><span class="header-section-number">15.18</span> Outlook: Toward Whole-Patient Foundation Models</h2>
<p>The methods in this chapter sketch an endgame for genomic deep learning that extends far beyond sequence-only models. The trajectory moves through several stages that the book has traced across its chapters.</p>
<p>Genome-wide variant and sequence representation through hybrid CNN, transformer, and state-space model architectures established the foundation in earlier chapters. These models learn rich representations of sequence that capture regulatory grammar, variant effects, and long-range dependencies.</p>
<p>Single-cell and epigenomic foundation models from <a href="p4-ch13-sc-epi.html" class="quarto-xref"><span>Chapter 13</span></a> bring methylation, cellular identity, and 3D genome structure into the picture. CpGPT treats methylation as a foundation modeling problem. scGPT and Geneformer learn cellular representations from massive transcriptomic corpora. GLUE enables integration across modalities measured in different cells.</p>
<p>Multi-omics integration through graph-guided latent spaces adds new dimensions. MoGCN and CGMega demonstrate how graph neural networks can integrate patient-level or gene-level multi-omic data for cancer subtyping and biomarker discovery.</p>
<p>Systems-level reasoning about rare variants and epistasis addresses effects that linear models miss. DeepRVAT learns gene-level impairment from rare variant sets. NeEDL searches for epistatic interactions guided by network structure. G2PT provides hierarchical models that explicitly represent the flow from variants through genes and pathways to phenotypes.</p>
<p>Clinically oriented risk modeling with deep PGS and fine-mapping connects genomic representations to patient outcomes. Delphi-like frameworks extend PGS to capture nonlinear effects and improve cross-ancestry generalization. MIFM-like methods integrate sequence-based variant features with GWAS evidence for more accurate fine-mapping.</p>
<p>A future whole-patient foundation model might unify all these threads. Such a model would jointly encode genotype, methylome, chromatin state, expression, proteomics, imaging, and electronic health record data. It would provide unified representations across tissues, cell types, and time points, capturing the dynamic nature of biological state. It would offer calibrated, equitable predictions of disease risk and treatment response across diverse populations. It would support mechanistic queries like “which pathways mediate this variant’s effect in this tissue?” or “which interventions might counteract rare variant burden in this patient?”</p>
<p>Realizing this vision will require advances across multiple fronts. Data sharing and privacy-preserving learning must enable training on sensitive multi-omic and clinical data at scale. Scalable architecture design must handle the computational demands of truly multi-modal foundation models. Causal validation must distinguish correlative patterns from mechanistic understanding. Equity and fairness considerations must guide data collection and model development from the outset.</p>
<p>The methods surveyed here show that moving beyond single-omics is not merely incremental improvement but a qualitative change in what kinds of questions genomic models can address. The path from isolated sequence models to systems-level, clinically actionable genomics is becoming visible, even if substantial work remains to traverse it.</p>
</section>
<section id="summary-1" class="level2" data-number="15.19">
<h2 data-number="15.19" class="anchored" data-anchor-id="summary-1"><span class="header-section-number">15.19</span> Summary</h2>
<p>This chapter has surveyed how deep learning extends beyond single-omics to integrate multiple data types into unified representations. We examined integration strategies spanning early, intermediate, and late fusion, with intermediate fusion augmented by graph structure emerging as the dominant approach. Graph neural network methods including MoGCN and CGMega showed how patient-level and gene-level graphs can integrate genomics, transcriptomics, and proteomics for cancer subtyping. DeepRVAT, NeEDL, and G2PT addressed rare variants and epistasis through set-based architectures and hierarchical modeling. Deep learning frameworks for polygenic risk (Delphi) and fine-mapping (MIFM) extended the PGS paradigm with nonlinear architectures and foundation model features.</p>
<p>Several design patterns emerged as common threads: modality-specific encoders with shared latent spaces, graph-guided integration, hierarchical modeling, set-based learning, and foundation pretraining with task-specific adaptation. These patterns provide conceptual vocabulary for understanding existing methods and designing new ones.</p>
<p>Practical challenges including batch effects, sample size limitations, population diversity, and evaluation complexity require careful attention. But the trajectory toward whole-patient foundation models that jointly encode multiple omics and clinical data is becoming clear.</p>
<p>The remaining chapters will address cross-cutting issues of evaluation, confounding, and interpretability that apply across all the models surveyed in this book, then explore how genomic foundation models translate into clinical practice.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-clarke_deeprvat_2024" class="csl-entry" role="listitem">
Clarke, Brian, Eva Holtkamp, Hakime Öztürk, Marcel Mück, Magnus Wahlberg, Kayla Meyer, Felix Munzlinger, et al. 2024. <span>“[<span>DeepRVAT</span>] <span>Integration</span> of Variant Annotations Using Deep Set Networks Boosts Rare Variant Association Testing.”</span> <em>Nature Genetics</em> 56 (10): 2271–80. <a href="https://doi.org/10.1038/s41588-024-01919-z">https://doi.org/10.1038/s41588-024-01919-z</a>.
</div>
<div id="ref-georgantas_delphi_2024" class="csl-entry" role="listitem">
Georgantas, Costa, Zoltán Kutalik, and Jonas Richiardi. 2024. <span>“Delphi: <span>A</span> <span>Deep</span>-Learning <span>Method</span> for <span>Polygenic</span> <span>Risk</span> <span>Prediction</span>.”</span> medRxiv. <a href="https://doi.org/10.1101/2024.04.19.24306079">https://doi.org/10.1101/2024.04.19.24306079</a>.
</div>
<div id="ref-lee_g2pt_2025" class="csl-entry" role="listitem">
Lee, Ingoo, Zachary S. Wallace, Yuqi Wang, Sungjoon Park, Hojung Nam, Amit R. Majithia, and Trey Ideker. 2025. <span>“[<span>G2PT</span>] <span>A</span> Genotype-Phenotype Transformer to Assess and Explain Polygenic Risk.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.23.619940">https://doi.org/10.1101/2024.10.23.619940</a>.
</div>
<div id="ref-li_cgmega_2024" class="csl-entry" role="listitem">
Li, Hao, Zebei Han, Yu Sun, Fu Wang, Pengzhen Hu, Yuang Gao, Xuemei Bai, et al. 2024. <span>“<span>CGMega</span>: Explainable Graph Neural Network Framework with Attention Mechanisms for Cancer Gene Module Dissection.”</span> <em>Nature Communications</em> 15 (1): 5997. <a href="https://doi.org/10.1038/s41467-024-50426-6">https://doi.org/10.1038/s41467-024-50426-6</a>.
</div>
<div id="ref-li_mogcn_2022" class="csl-entry" role="listitem">
Li, Xiao, Jie Ma, Ling Leng, Mingfei Han, Mansheng Li, Fuchu He, and Yunping Zhu. 2022. <span>“<span>MoGCN</span>: <span>A</span> <span>Multi</span>-<span>Omics</span> <span>Integration</span> <span>Method</span> <span>Based</span> on <span>Graph</span> <span>Convolutional</span> <span>Network</span> for <span>Cancer</span> <span>Subtype</span> <span>Analysis</span>.”</span> <em>Frontiers in Genetics</em> 13 (February). <a href="https://doi.org/10.3389/fgene.2022.806842">https://doi.org/10.3389/fgene.2022.806842</a>.
</div>
<div id="ref-rakowski_mifm_2025" class="csl-entry" role="listitem">
Rakowski, Alexander, and Christoph Lippert. 2025. <span>“[<span>MIFM</span>] <span>Multiple</span> Instance Fine-Mapping: Predicting Causal Regulatory Variants with a Deep Sequence Model.”</span> medRxiv. <a href="https://doi.org/10.1101/2025.06.13.25329551">https://doi.org/10.1101/2025.06.13.25329551</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p4-ch14-networks.html" class="pagination-link" aria-label="Graphs, Networks, and Biology">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p5--eval-interp.html" class="pagination-link" aria-label="Part V: Evaluation and Reliability">
        <span class="nav-page-text">Part V: Evaluation and Reliability</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>