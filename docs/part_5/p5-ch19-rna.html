<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; RNA Structure and Function – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_5/p5-ch20-single-cell.html" rel="next">
<link href="../part_5/p5--cellular-context.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_5/p5--cellular-context.html">Part V: Cellular Context</a></li><li class="breadcrumb-item"><a href="../part_5/p5-ch19-rna.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch19-perspectives" id="toc-sec-ch19-perspectives" class="nav-link active" data-scroll-target="#sec-ch19-perspectives"><span class="header-section-number">19.1</span> RNA as Molecule Versus Transcriptome Readout</a></li>
  <li><a href="#sec-ch19-structure-challenge" id="toc-sec-ch19-structure-challenge" class="nav-link" data-scroll-target="#sec-ch19-structure-challenge"><span class="header-section-number">19.2</span> Why Secondary Structure Creates a Distinct Modeling Challenge</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-energy-landscape" id="toc-sec-ch19-energy-landscape" class="nav-link" data-scroll-target="#sec-ch19-energy-landscape"><span class="header-section-number">19.2.1</span> Flat Energy Landscape Problem</a></li>
  <li><a href="#sec-ch19-base-pairing" id="toc-sec-ch19-base-pairing" class="nav-link" data-scroll-target="#sec-ch19-base-pairing"><span class="header-section-number">19.2.2</span> Base Pairing and Long-Range Dependencies</a></li>
  <li><a href="#sec-ch19-pseudoknots" id="toc-sec-ch19-pseudoknots" class="nav-link" data-scroll-target="#sec-ch19-pseudoknots"><span class="header-section-number">19.2.3</span> Pseudoknots and Tertiary Complexity</a></li>
  </ul></li>
  <li><a href="#sec-ch19-classical" id="toc-sec-ch19-classical" class="nav-link" data-scroll-target="#sec-ch19-classical"><span class="header-section-number">19.3</span> Classical Approaches to Structure Prediction</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-thermodynamic" id="toc-sec-ch19-thermodynamic" class="nav-link" data-scroll-target="#sec-ch19-thermodynamic"><span class="header-section-number">19.3.1</span> Thermodynamic Folding Models</a></li>
  <li><a href="#sec-ch19-comparative" id="toc-sec-ch19-comparative" class="nav-link" data-scroll-target="#sec-ch19-comparative"><span class="header-section-number">19.3.2</span> Comparative and Covariation Methods</a></li>
  </ul></li>
  <li><a href="#sec-ch19-dl-structure" id="toc-sec-ch19-dl-structure" class="nav-link" data-scroll-target="#sec-ch19-dl-structure"><span class="header-section-number">19.4</span> Deep Learning for Secondary Structure Prediction</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-learned-patterns" id="toc-sec-ch19-learned-patterns" class="nav-link" data-scroll-target="#sec-ch19-learned-patterns"><span class="header-section-number">19.4.1</span> From Thermodynamics to Learned Patterns</a></li>
  <li><a href="#sec-ch19-structure-probing" id="toc-sec-ch19-structure-probing" class="nav-link" data-scroll-target="#sec-ch19-structure-probing"><span class="header-section-number">19.4.2</span> Structure Probing as Supervision</a></li>
  </ul></li>
  <li><a href="#sec-ch19-foundation" id="toc-sec-ch19-foundation" class="nav-link" data-scroll-target="#sec-ch19-foundation"><span class="header-section-number">19.5</span> RNA Foundation Models</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-scale-gap" id="toc-sec-ch19-scale-gap" class="nav-link" data-scroll-target="#sec-ch19-scale-gap"><span class="header-section-number">19.5.1</span> Scale Gap with Protein Language Models</a></li>
  <li><a href="#sec-ch19-architectures" id="toc-sec-ch19-architectures" class="nav-link" data-scroll-target="#sec-ch19-architectures"><span class="header-section-number">19.5.2</span> Architectures and Objectives</a></li>
  <li><a href="#sec-ch19-downstream" id="toc-sec-ch19-downstream" class="nav-link" data-scroll-target="#sec-ch19-downstream"><span class="header-section-number">19.5.3</span> Downstream Applications</a></li>
  </ul></li>
  <li><a href="#sec-ch19-codon" id="toc-sec-ch19-codon" class="nav-link" data-scroll-target="#sec-ch19-codon"><span class="header-section-number">19.6</span> Codon-Level Models for Coding RNA</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-codon-tokenization" id="toc-sec-ch19-codon-tokenization" class="nav-link" data-scroll-target="#sec-ch19-codon-tokenization"><span class="header-section-number">19.6.1</span> Beyond Nucleotide Tokenization</a></li>
  <li><a href="#sec-ch19-codon-advantages" id="toc-sec-ch19-codon-advantages" class="nav-link" data-scroll-target="#sec-ch19-codon-advantages"><span class="header-section-number">19.6.2</span> What Codon Models Add</a></li>
  </ul></li>
  <li><a href="#sec-ch19-utr" id="toc-sec-ch19-utr" class="nav-link" data-scroll-target="#sec-ch19-utr"><span class="header-section-number">19.7</span> UTR Models and Translation Regulation</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-utr-control" id="toc-sec-ch19-utr-control" class="nav-link" data-scroll-target="#sec-ch19-utr-control"><span class="header-section-number">19.7.1</span> Why UTRs Dominate Expression Control</a></li>
  <li><a href="#sec-ch19-expression-models" id="toc-sec-ch19-expression-models" class="nav-link" data-scroll-target="#sec-ch19-expression-models"><span class="header-section-number">19.7.2</span> Sequence-to-Expression Models</a></li>
  <li><a href="#sec-ch19-utr-design" id="toc-sec-ch19-utr-design" class="nav-link" data-scroll-target="#sec-ch19-utr-design"><span class="header-section-number">19.7.3</span> Integration with mRNA Design</a></li>
  </ul></li>
  <li><a href="#sec-ch19-mrna-design" id="toc-sec-ch19-mrna-design" class="nav-link" data-scroll-target="#sec-ch19-mrna-design"><span class="header-section-number">19.8</span> mRNA Design and Optimization</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-design-objectives" id="toc-sec-ch19-design-objectives" class="nav-link" data-scroll-target="#sec-ch19-design-objectives"><span class="header-section-number">19.8.1</span> Design Objectives and Trade-offs</a></li>
  <li><a href="#sec-ch19-covid-vaccines" id="toc-sec-ch19-covid-vaccines" class="nav-link" data-scroll-target="#sec-ch19-covid-vaccines"><span class="header-section-number">19.8.2</span> Lessons from COVID-19 Vaccines</a></li>
  <li><a href="#sec-ch19-model-design" id="toc-sec-ch19-model-design" class="nav-link" data-scroll-target="#sec-ch19-model-design"><span class="header-section-number">19.8.3</span> Model-Based Design Strategies</a></li>
  </ul></li>
  <li><a href="#sec-ch19-ncrna" id="toc-sec-ch19-ncrna" class="nav-link" data-scroll-target="#sec-ch19-ncrna"><span class="header-section-number">19.9</span> Noncoding RNA Classification and Function</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-ncrna-diversity" id="toc-sec-ch19-ncrna-diversity" class="nav-link" data-scroll-target="#sec-ch19-ncrna-diversity"><span class="header-section-number">19.9.1</span> Diversity of Noncoding RNA</a></li>
  <li><a href="#sec-ch19-ncrna-features" id="toc-sec-ch19-ncrna-features" class="nav-link" data-scroll-target="#sec-ch19-ncrna-features"><span class="header-section-number">19.9.2</span> From Handcrafted Features to Learned Representations</a></li>
  </ul></li>
  <li><a href="#sec-ch19-mirna" id="toc-sec-ch19-mirna" class="nav-link" data-scroll-target="#sec-ch19-mirna"><span class="header-section-number">19.10</span> miRNA Target Prediction</a></li>
  <li><a href="#sec-ch19-splicing" id="toc-sec-ch19-splicing" class="nav-link" data-scroll-target="#sec-ch19-splicing"><span class="header-section-number">19.11</span> Splicing and Transcript Processing Models</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-beyond-spliceai" id="toc-sec-ch19-beyond-spliceai" class="nav-link" data-scroll-target="#sec-ch19-beyond-spliceai"><span class="header-section-number">19.11.1</span> Beyond SpliceAI</a></li>
  </ul></li>
  <li><a href="#sec-ch19-limitations" id="toc-sec-ch19-limitations" class="nav-link" data-scroll-target="#sec-ch19-limitations"><span class="header-section-number">19.12</span> Limitations and Open Challenges</a>
  <ul class="collapse">
  <li><a href="#sec-ch19-sparse-data" id="toc-sec-ch19-sparse-data" class="nav-link" data-scroll-target="#sec-ch19-sparse-data"><span class="header-section-number">19.12.1</span> Sparse Structural Data</a></li>
  <li><a href="#sec-ch19-annotation-gaps" id="toc-sec-ch19-annotation-gaps" class="nav-link" data-scroll-target="#sec-ch19-annotation-gaps"><span class="header-section-number">19.12.2</span> Functional Annotation Gaps</a></li>
  <li><a href="#sec-ch19-maturity-gap" id="toc-sec-ch19-maturity-gap" class="nav-link" data-scroll-target="#sec-ch19-maturity-gap"><span class="header-section-number">19.12.3</span> Maturity Gap</a></li>
  </ul></li>
  <li><a href="#sec-ch19-bridge" id="toc-sec-ch19-bridge" class="nav-link" data-scroll-target="#sec-ch19-bridge"><span class="header-section-number">19.13</span> Bridge Between Sequence and Cell</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_5/p5--cellular-context.html">Part V: Cellular Context</a></li><li class="breadcrumb-item"><a href="../part_5/p5-ch19-rna.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch19-rna" class="quarto-section-identifier"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>A “silent” mutation that changes nothing can change everything.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 35-45 minutes</p>
<p><strong>Prerequisites:</strong> Understanding of DNA and protein foundation models from Part III (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>, <a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>), familiarity with self-supervised pretraining objectives (<a href="../part_3/p3-ch08-pretraining.html" class="quarto-xref"><span>Chapter 8</span></a>), and basic knowledge of transformer architectures (<a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a>).</p>
<p><strong>You will learn:</strong></p>
<ul>
<li>Why RNA modeling presents unique challenges distinct from DNA and protein modeling</li>
<li>How RNA secondary structure prediction differs fundamentally from protein folding</li>
<li>The current state of RNA foundation models and why they lag behind protein counterparts</li>
<li>How codon-level models capture translation dynamics invisible to protein language models</li>
<li>Practical applications in UTR optimization and therapeutic mRNA design</li>
</ul>
<p><strong>Key insight:</strong> RNA occupies a unique position in the central dogma—it is both the output of DNA transcription and the input to protein translation, yet its structure and regulation follow rules that neither DNA nor protein models capture. The flat energy landscapes, conformational dynamics, and sparse structural data that characterize RNA create modeling challenges that no other molecular domain faces at comparable scale.</p>
</div>
</div>
<p>A synonymous mutation changes the DNA codon but preserves the amino acid. By the logic of protein-centric biology, such mutations should be functionally neutral: same protein sequence, same structure, same function. Yet synonymous variants can dramatically alter gene expression, affect protein folding, and cause disease. The mechanisms operate at the RNA level: altered codon optimality changes translation speed, modified mRNA secondary structure affects ribosome processivity, disrupted regulatory motifs change transcript stability. A model that sees only DNA sequence or only protein sequence misses these effects entirely. DNA foundation models learn regulatory sequence patterns; protein language models learn amino acid constraints. Neither captures RNA-level biology: secondary structure stability, RBP binding accessibility, or the coupling between splicing and decay.</p>
<p>RNA occupies a distinct position in the central dogma, essential to every step from transcription to translation, yet historically receiving less computational attention than its neighbors. The disparity reflects data availability more than biological importance. Protein sequences accumulate over billions of years of evolution, providing the massive corpora that enabled <em>ESM</em> to learn structure from sequence (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>). DNA benefits from reference genomes, population sequencing, and functional genomics consortia generating petabytes of data (<a href="../part_1/p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a>). RNA databases remain comparatively sparse, structural annotations cover only well-characterized families, and no equivalent of <em>AlphaFold’s</em> crystallographic training set exists for RNA tertiary structure. The result is a modeling landscape where RNA foundation models exist but remain immature relative to protein and DNA counterparts.</p>
<p>The foundation models examined previously all manifest their predictions through RNA intermediates: <em>Enformer</em> predicts RNA-seq coverage (<a href="../part_4/p4-ch17-regulatory.html" class="quarto-xref"><span>Chapter 17</span></a>), protein models predict translation products (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>), <em>SpliceAI</em> models spliceosome recognition of RNA (<a href="../part_2/p2-ch06-cnn.html#sec-ch06-spliceai" class="quarto-xref"><span>Section 6.5</span></a>). RNA-specific models add a distinct layer, treating RNA not merely as a readout of DNA or a precursor to protein, but as a structured molecule with its own sequence constraints, folding landscapes, and functional roles. We examine secondary structure prediction, RNA foundation models, codon-level mRNA models, and noncoding RNA classification, while confronting the data limitations that constrain current approaches.</p>
<section id="sec-ch19-perspectives" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sec-ch19-perspectives"><span class="header-section-number">19.1</span> RNA as Molecule Versus Transcriptome Readout</h2>
<p>Two complementary perspectives frame computational approaches to RNA. The molecular view treats RNA as a physical object with primary sequence, secondary structure through base pairing, tertiary organization in three-dimensional space, and chemical modifications that alter its properties. In this view, modeling goals include predicting which bases pair with which, how the molecule folds, which proteins bind to it, and how synthetic RNAs might be designed with desired properties. The transcriptomic view treats RNA as a cellular readout: coverage profiles along the genome, splice junction usage, isoform abundances, expression levels that vary across cell types and conditions. Here the goal is explaining how genomic sequence and chromatin state give rise to these measurements.</p>
<p>Models that predict transcriptomic signals from DNA sequence (<em>Enformer</em>, <em>Borzoi</em>, and related architectures covered in <a href="../part_4/p4-ch17-regulatory.html" class="quarto-xref"><span>Chapter 17</span></a>) operate in the second paradigm. They take genomic sequence as input and output RNA-seq or CAGE profiles as predictions. These models never see RNA sequence directly; they learn the mapping from DNA context to transcriptional output. The molecular perspective treats RNA sequence as input and predicts structure, function, or design properties.</p>
<p>The distinction parallels the difference between protein language models and proteomics prediction models. <em>ESM</em> takes amino acid sequences and learns structural representations (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>). A model predicting protein abundance from genomic features would be solving a different problem. Both perspectives are valuable, and both ultimately concern RNA, but they operate at different levels of the biological hierarchy and require different architectures and training strategies.</p>
<div id="tbl-rna-perspectives" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rna-perspectives-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.1: Two perspectives on RNA modeling, distinguished by input modality and biological question.
</figcaption>
<div aria-describedby="tbl-rna-perspectives-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 27%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Perspective</th>
<th>Input</th>
<th>Output</th>
<th>Example Models</th>
<th>Key Questions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Molecular</strong></td>
<td>RNA sequence</td>
<td>Structure, binding, design</td>
<td><em>RNA-FM</em>, <em>SPOT-RNA</em>, structure probing models</td>
<td>How does this RNA fold? What binds it?</td>
</tr>
<tr class="even">
<td><strong>Transcriptomic</strong></td>
<td>DNA sequence + context</td>
<td>Expression, splicing, coverage</td>
<td><em>Enformer</em>, <em>Borzoi</em>, <em>SpliceAI</em></td>
<td>How much transcript is produced? Where is it spliced?</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The transcriptomic perspective becomes particularly important when RNA expression serves as the primary readout of cellular state. Single-cell foundation models (<a href="p5-ch20-single-cell.html" class="quarto-xref"><span>Chapter 20</span></a>) use gene expression vectors—fundamentally RNA measurements—as their input representation, learning to embed cells based on transcriptomic profiles. RNA-level regulation also intersects with chromatin architecture: 3D genome organization influences which enhancers contact which promoters, thereby determining which RNAs are transcribed and at what levels (<a href="p5-ch21-3d-genome.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
</section>
<section id="sec-ch19-structure-challenge" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sec-ch19-structure-challenge"><span class="header-section-number">19.2</span> Why Secondary Structure Creates a Distinct Modeling Challenge</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Proteins fold into stable three-dimensional structures, and protein language models have learned to predict these folds with remarkable accuracy. Before reading on, consider: why might RNA structure prediction be fundamentally harder than protein structure prediction, despite RNA having only 4 bases compared to 20 amino acids?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>RNA structure prediction is harder than protein structure prediction for three key reasons:</p>
<ol type="1">
<li><p><strong>Flat energy landscapes</strong>: While proteins fold into a single deep energy minimum, RNA sequences often have multiple competing structures with similar free energies—the sequence-to-structure mapping is many-to-many rather than one-to-one.</p></li>
<li><p><strong>Dynamic conformations</strong>: RNA can switch between alternative structures in response to cellular conditions, whereas most proteins maintain stable folds.</p></li>
<li><p><strong>Long-range base pairing</strong>: RNA secondary structure involves pairs spanning hundreds of nucleotides, creating dependencies that standard algorithms struggle to capture efficiently, especially when pseudoknots violate the nested structure assumption required for efficient dynamic programming.</p></li>
</ol>
<p>The apparent “simplicity” of 4 bases versus 20 amino acids is misleading—the real complexity lies in conformational dynamics, not alphabet size.</p>
</div>
</div>
</div>
</div>
</div>
<p>RNA secondary structure prediction differs fundamentally from protein structure prediction in ways that shape every modeling choice. Where DNA language models learn from linear sequence patterns (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>) and protein models exploit evolutionary constraints across homologs (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>), RNA models must contend with conformational dynamics that neither domain faces at comparable scale. Three interrelated challenges define the problem: thermodynamic landscapes with multiple competing minima, base-pairing interactions that span hundreds of nucleotides, and <strong>pseudoknot</strong> structures (configurations where bases in a loop pair with bases outside that loop, creating interleaved patterns that standard algorithms cannot efficiently handle) that violate the assumptions of efficient algorithms. Understanding these challenges clarifies why RNA structure remains harder to predict than protein structure despite the apparent simplicity of four bases versus twenty amino acids.</p>
<section id="sec-ch19-energy-landscape" class="level3" data-number="19.2.1">
<h3 data-number="19.2.1" class="anchored" data-anchor-id="sec-ch19-energy-landscape"><span class="header-section-number">19.2.1</span> Flat Energy Landscape Problem</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about RNA’s energy landscape, predict: if an RNA sequence can fold into multiple different structures with similar energies, what would this mean for predicting “the” structure of that RNA? How does this differ from protein folding?</p>
</div>
</div>
<p>RNA’s defining computational challenge emerges from thermodynamics. Proteins fold into stable three-dimensional structures because their energy landscapes contain deep minima: the native state sits in a pronounced funnel that guides the folding process. RNA energy landscapes are remarkably flatter—like a marble on a dinner plate with multiple shallow dents rather than a deep bowl. The marble settles in one dent but can easily roll to another with a small nudge. Multiple conformations compete for occupancy, with free energy differences often smaller than thermal fluctuations at cellular temperatures. A given RNA sequence may adopt several alternative structures with similar stabilities, and the dominant conformation can shift in response to ion concentrations, temperature, protein binding, or chemical modifications.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>RNA’s flat energy landscape means that the same sequence can adopt multiple different structures with similar stabilities. This creates a fundamental many-to-many relationship between sequence and structure that protein modeling largely avoids—most proteins have a single dominant fold. RNA models must somehow represent or accommodate this conformational heterogeneity.</p>
</div>
</div>
<p>This conformational plasticity has biological functions (riboswitches that change structure in response to ligand binding, RNA thermometers that regulate translation at different temperatures) but creates modeling difficulties. <strong>Minimum free energy (MFE)</strong> predictions, which identify the single lowest-energy structure, may miss functionally relevant alternative conformations. Partition function calculations that consider the full ensemble are more complete but computationally expensive and harder to interpret. Deep learning models that predict structure from sequence must somehow capture this many-to-many relationship between sequence and conformation, a challenge that protein structure prediction largely avoided because the sequence-to-structure mapping for most proteins is effectively one-to-one.</p>
<div id="fig-rna-energy-landscape" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rna-energy-landscape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/01-A-fig-rna-energy-landscape.svg" class="img-fluid figure-img"></p>
<figcaption>Protein folding shows deep funnel topology</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/01-B-fig-rna-energy-landscape.svg" class="img-fluid figure-img"></p>
<figcaption>RNA folding shows flat landscape with multiple minima</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rna-energy-landscape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.1: Energy landscape comparison between protein and RNA folding. (A) Proteins fold into deep energy minima, typically reaching a single stable native structure. (B) RNA energy landscapes are flatter, with multiple conformations competing at similar free energies—explaining why RNA can adopt alternative structures under different conditions.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch19-base-pairing" class="level3" data-number="19.2.2">
<h3 data-number="19.2.2" class="anchored" data-anchor-id="sec-ch19-base-pairing"><span class="header-section-number">19.2.2</span> Base Pairing and Long-Range Dependencies</h3>
<p>Secondary structure arises from Watson-Crick base pairing (A-U, G-C) and wobble pairs (G-U) that create stems, loops, bulges, and internal loops. Unlike protein secondary structure, where alpha helices and beta sheets are local motifs determined by nearby residues, RNA secondary structure involves long-range contacts. A base at position <em>i</em> may pair with a base at position <em>j</em> hundreds of nucleotides away. The intervening sequence must accommodate this pairing without introducing steric clashes or thermodynamically unfavorable arrangements.</p>
<p>This long-range dependency structure differs fundamentally from protein contact prediction, where most important contacts occur between residues close in primary sequence. RNA structure prediction must consider all possible pairings across the entire sequence, evaluate their compatibility, and identify the globally optimal (or near-optimal) arrangement. The number of possible secondary structures grows exponentially with sequence length, making exhaustive enumeration intractable for long RNAs.</p>
<p><strong>Worked Example:</strong> Consider a 100-nucleotide RNA. Position 10 might pair with position 90, creating a stem. But positions 10-15 might alternatively pair with positions 45-50, creating a different stem. These alternatives are mutually exclusive—a base can only pair with one partner—but both might have similar free energies. The algorithm must evaluate all such possibilities and find the globally best combination, not just locally optimal stems.</p>
</section>
<section id="sec-ch19-pseudoknots" class="level3" data-number="19.2.3">
<h3 data-number="19.2.3" class="anchored" data-anchor-id="sec-ch19-pseudoknots"><span class="header-section-number">19.2.3</span> Pseudoknots and Tertiary Complexity</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Standard RNA structure prediction algorithms use dynamic programming with O(n³) complexity by assuming nested base pairs. What happens to this assumption when bases in a loop pair with bases outside that loop? Why would this dramatically increase computational complexity?</p>
</div>
</div>
<p>Pseudoknots occur when bases in a loop pair with bases outside that loop, creating interleaved base-pairing patterns that violate the nested structure assumed by standard secondary structure algorithms. A typical pseudoknot involves two stem regions whose base pairs cross each other when drawn in standard notation. These structures are functionally important (the telomerase RNA catalytic core contains a pseudoknot essential for activity) but algorithmically challenging. Standard dynamic programming approaches for secondary structure prediction exclude pseudoknots because their inclusion increases computational complexity from <span class="math inline">\(O(n^3)\)</span> to <span class="math inline">\(O(n^6)\)</span> or worse. <em>[Citation Needed]</em> The complexity increase arises because nested base pairs can be solved by recursive decomposition—if positions <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> pair, the structure between them is independent of the structure outside—but pseudoknots violate this independence by creating dependencies between the “inside” and “outside” regions. The algorithm must therefore consider all possible ways the crossing pairs might interleave, leading to exponentially more states.</p>
<div id="fig-rna-structure-elements" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rna-structure-elements-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/02-A-fig-rna-structure-elements.svg" class="img-fluid figure-img"></p>
<figcaption>Basic structural elements: stems, loops, bulges</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/02-B-fig-rna-structure-elements.svg" class="img-fluid figure-img"></p>
<figcaption>Long-range base pairing spans hundreds of nucleotides</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/02-C-fig-rna-structure-elements.svg" class="img-fluid figure-img"></p>
<figcaption>Pseudoknots increase computational complexity</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/02-D-fig-rna-structure-elements.svg" class="img-fluid figure-img"></p>
<figcaption>Common notation systems for secondary structure</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rna-structure-elements-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.2: RNA secondary structure vocabulary. (A) Basic structural elements: stems, hairpin loops, internal loops, bulges, and multi-loop junctions. (B) Long-range base pairing: RNA pairs can span hundreds of nucleotides, unlike protein secondary structure. (C) Pseudoknots: interleaved base pairs that increase prediction complexity from O(n³) to O(n⁶). (D) Common notation systems for representing secondary structure.
</figcaption>
</figure>
</div>
<p>Tertiary structure involves the three-dimensional arrangement of secondary structure elements in space, including long-range interactions mediated by non-Watson-Crick base pairs, metal ion coordination, and RNA-RNA kissing loops. Predicting RNA tertiary structure remains far less developed than protein tertiary structure prediction. No RNA equivalent of <em>AlphaFold</em> exists, and the training data situation is dire: the Protein Data Bank contains over 200,000 protein structures but fewer than 2,000 RNA structures, many of which are ribosomal RNA fragments or tRNA variants from the same structural families. <em>[Citation Needed]</em></p>
</section>
</section>
<section id="sec-ch19-classical" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="sec-ch19-classical"><span class="header-section-number">19.3</span> Classical Approaches to Structure Prediction</h2>
<p>Before deep learning entered the field, two complementary paradigms dominated RNA structure prediction. Thermodynamic approaches compute minimum free energy structures from experimentally calibrated energy parameters, while comparative methods infer structure from patterns of compensatory mutations across homologous sequences. Both approaches remain valuable, and understanding their strengths and limitations illuminates what deep learning models must learn to surpass them.</p>
<section id="sec-ch19-thermodynamic" class="level3" data-number="19.3.1">
<h3 data-number="19.3.1" class="anchored" data-anchor-id="sec-ch19-thermodynamic"><span class="header-section-number">19.3.1</span> Thermodynamic Folding Models</h3>
<p>The dominant classical paradigm for RNA secondary structure prediction relies on nearest-neighbor thermodynamic models. These approaches assign free energy contributions to each base pair and structural element (loops, bulges, internal loops, multiloops) based on experimentally calibrated parameters. Given these parameters, dynamic programming algorithms identify the minimum free energy structure or compute the partition function over all possible structures.</p>
<p><em>Mfold</em> and the <em>ViennaRNA</em> package represent the most widely used implementations. <em>[Citation Needed]</em> These programs use dynamic programming to fill a table of optimal substructure scores: for each possible base pair <span class="math inline">\((i,j)\)</span>, they compute the minimum free energy achievable for the subsequence between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, building up from small subsequences to the full molecule. The algorithm works because RNA secondary structure is “nested”—if <span class="math inline">\((i,j)\)</span> pairs, then any other pair <span class="math inline">\((k,l)\)</span> either lies entirely within <span class="math inline">\((i,j)\)</span> or entirely outside it, never crossing. This nesting property enables the <span class="math inline">\(O(n^3)\)</span> dynamic programming solution.</p>
<p>These methods achieve reasonable accuracy for short, well-behaved RNAs where the thermodynamic parameters are most reliable. Limitations emerge for longer RNAs where the flat energy landscape means many structures have similar energies, for RNAs in complex cellular environments where proteins and other factors alter folding, and for RNAs with modifications or non-canonical interactions not captured by standard parameter sets. These methods also assume equilibrium conditions that may not hold for co-transcriptional folding or kinetically trapped states.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Thermodynamic folding methods find the minimum free energy structure. Given what you’ve learned about RNA’s flat energy landscape, what is the main limitation of this approach? (Hint: think about alternative conformations.)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The main limitation is that MFE methods predict only the single lowest-energy structure, missing functionally relevant alternative conformations that may have similar free energies. RNA’s flat energy landscape means multiple structures can coexist with comparable stability, so the global minimum may not be the only biologically important state.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-ch19-comparative" class="level3" data-number="19.3.2">
<h3 data-number="19.3.2" class="anchored" data-anchor-id="sec-ch19-comparative"><span class="header-section-number">19.3.2</span> Comparative and Covariation Methods</h3>
<p>For RNAs with sufficient homologous sequences, comparative approaches provide an orthogonal route to structure inference. If two positions exhibit compensatory mutations (G-C changing to A-U while maintaining complementarity), those positions likely base-pair. Databases like Rfam curate consensus secondary structures for RNA families based on these covariation signals <span class="citation" data-cites="kalvari_rfam_2021">(<a href="../bib/references.html#ref-kalvari_rfam_2021" role="doc-biblioref">Kalvari et al. 2021</a>)</span>.</p>
<p>Comparative methods are powerful but require multiple sequence alignments of homologous RNAs. Novel RNAs, rapidly evolving regulatory elements, or species-specific transcripts may lack sufficient homologs for reliable inference. The approach also assumes that structure is conserved across the aligned sequences, which breaks down for RNAs that have diverged in function or that adopt condition-specific alternative structures.</p>
<div id="tbl-structure-methods" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-structure-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.2: Comparison of RNA structure prediction approaches. Each has complementary strengths.
</figcaption>
<div aria-describedby="tbl-structure-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 26%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Strengths</th>
<th>Limitations</th>
<th>Best Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Thermodynamic (MFE)</strong></td>
<td>No homologs needed; well-understood parameters</td>
<td>Misses alternative structures; struggles with long RNAs</td>
<td>Short RNAs, initial prediction</td>
</tr>
<tr class="even">
<td><strong>Partition function</strong></td>
<td>Considers ensemble; provides base-pair probabilities</td>
<td>Computationally expensive; hard to interpret</td>
<td>Assessing structural confidence</td>
</tr>
<tr class="odd">
<td><strong>Comparative</strong></td>
<td>High accuracy when homologs available; reveals conserved structure</td>
<td>Requires homologs; assumes structure conservation</td>
<td>Well-characterized RNA families</td>
</tr>
<tr class="even">
<td><strong>Deep learning</strong></td>
<td>Learns complex patterns; can handle pseudoknots</td>
<td>Requires training data; may not generalize</td>
<td>Structure probing integration</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
<section id="sec-ch19-dl-structure" class="level2" data-number="19.4">
<h2 data-number="19.4" class="anchored" data-anchor-id="sec-ch19-dl-structure"><span class="header-section-number">19.4</span> Deep Learning for Secondary Structure Prediction</h2>
<p>Deep learning reframes secondary structure prediction as sequence-to-structure mapping, learning the relationship directly from data rather than encoding it through thermodynamic parameters. These models can capture patterns that classical approaches miss, particularly for complex structures and pseudoknots, though they require training data that remains limited compared to protein structure prediction. Two complementary training strategies have emerged: supervised learning from experimentally determined structures and semi-supervised approaches using structure probing data.</p>
<section id="sec-ch19-learned-patterns" class="level3" data-number="19.4.1">
<h3 data-number="19.4.1" class="anchored" data-anchor-id="sec-ch19-learned-patterns"><span class="header-section-number">19.4.1</span> From Thermodynamics to Learned Patterns</h3>
<p>Deep learning models for RNA structure prediction frame the task as sequence-to-structure mapping, analogous to protein contact prediction (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>). Given an RNA sequence, the model predicts base-pairing probabilities for all position pairs, contact maps indicating which bases interact, or per-nucleotide structural states (paired, unpaired, in loop, in stem).</p>
<p>Models like <em>SPOT-RNA</em> use convolutional or attention-based architectures to capture long-range dependencies in sequence <span class="citation" data-cites="singh_rna_2019">(<a href="../bib/references.html#ref-singh_rna_2019" role="doc-biblioref">Singh et al. 2019</a>)</span>. Some approaches directly predict pairing matrices as dense outputs; others output per-position classifications that are post-processed into structures. Training typically uses experimentally determined structures from databases like RNAstralign or bpRNA, supplemented by computationally predicted structures from thermodynamic models.</p>
<p>Performance on benchmark datasets often exceeds classical thermodynamic methods, particularly for RNAs with complex structures or pseudoknots where dynamic programming approaches struggle. The learned models can capture patterns beyond nearest-neighbor rules, potentially encoding longer-range sequence dependencies that contribute to folding but were not parameterized in classical approaches.</p>
</section>
<section id="sec-ch19-structure-probing" class="level3" data-number="19.4.2">
<h3 data-number="19.4.2" class="anchored" data-anchor-id="sec-ch19-structure-probing"><span class="header-section-number">19.4.2</span> Structure Probing as Supervision</h3>
<p>High-throughput structure probing experiments provide an alternative source of supervision. SHAPE (selective 2’-hydroxyl acylation analyzed by primer extension), DMS-seq, and icSHAPE measure nucleotide accessibility or flexibility across entire transcriptomes. Positions that are base-paired or buried in tertiary structure show lower reactivity than exposed positions <span class="citation" data-cites="spitale_structural_2015">(<a href="../bib/references.html#ref-spitale_structural_2015" role="doc-biblioref">Spitale et al. 2015</a>)</span>.</p>
<p>These data offer several advantages for model training. They cover far more RNAs than crystal structures, extending beyond well-characterized families to regulatory elements and novel transcripts. They capture structure in cellular context, reflecting the influence of proteins, modifications, and physiological conditions. And they provide soft constraints rather than binary pairing assignments, potentially better matching the conformational heterogeneity of real RNA populations.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Looking Forward: RNA Structure in Variant Interpretation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Looking Forward: RNA Structure in Variant Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>RNA secondary structure predictions feed directly into clinical variant interpretation. Variants that disrupt splice sites or create aberrant RNA structures can cause disease even when amino acid sequence is unchanged. These structural effects are integrated into foundation model-based variant interpretation pipelines (<a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>) and are particularly important in rare disease diagnosis (<a href="../part_7/p7-ch29-rare-disease.html#sec-ch29-fm-scoring" class="quarto-xref"><span>Section 29.1.4</span></a>), where splice-altering variants explain a substantial fraction of previously undiagnosed cases.</p>
</div>
</div>
<p>Models trained on structure probing data learn to predict accessibility profiles from sequence. These predictions can be integrated with thermodynamic models (using predicted accessibility as constraints) or used directly for downstream tasks like predicting RNA-protein binding or designing stable constructs.</p>
</section>
</section>
<section id="sec-ch19-foundation" class="level2" data-number="19.5">
<h2 data-number="19.5" class="anchored" data-anchor-id="sec-ch19-foundation"><span class="header-section-number">19.5</span> RNA Foundation Models</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Protein language models like ESM-2 trained on 65 million sequences and learned to predict protein structure from sequence alone. Before reading on, consider: what would an RNA foundation model need to achieve a similar breakthrough? What resources or data might be missing?</p>
</div>
</div>
<p>The success of protein language models naturally prompted attempts to apply the same paradigm to RNA. Train large transformers on massive sequence corpora following the scaling principles examined in <a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-scaling" class="quarto-xref"><span>Section 14.3</span></a>, learn representations through self-supervised objectives (<a href="../part_3/p3-ch08-pretraining.html" class="quarto-xref"><span>Chapter 8</span></a>), then transfer to downstream tasks. RNA foundation models exist and show promise, but they have not yet achieved the transformative impact of their protein counterparts. The reasons illuminate fundamental differences between protein and RNA modeling.</p>
<section id="sec-ch19-scale-gap" class="level3" data-number="19.5.1">
<h3 data-number="19.5.1" class="anchored" data-anchor-id="sec-ch19-scale-gap"><span class="header-section-number">19.5.1</span> Scale Gap with Protein Language Models</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>ESM-2</em> learned to predict protein structure from sequence alone, with attention patterns that correspond to 3D contacts—an emergent capability that surprised even its creators. Why haven’t RNA foundation models achieved a similar breakthrough? Before reading on, consider what differences between protein and RNA data might explain this gap.</p>
</div>
</div>
<p>RNA foundation models attempt to replicate the protein language model paradigm: train large transformers on massive sequence corpora using self-supervised objectives, then transfer learned representations to downstream tasks. The approach has produced working models, but the results lag substantially behind protein language models in both scale and demonstrated capabilities.</p>
<p>The comparison with <em>ESM</em> illustrates the gap. <em>ESM-2</em> trained on over 65 million protein sequences from UniRef, spanning the known diversity of protein families (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>). <em>RNA-FM</em>, one of the more successful RNA foundation models, trained on approximately 23 million noncoding RNA sequences from RNAcentral <span class="citation" data-cites="chen_rna-fm_2022">(<a href="../bib/references.html#ref-chen_rna-fm_2022" role="doc-biblioref">Chen et al. 2022</a>)</span>. While not a trivial corpus, this represents an order of magnitude fewer sequences, and the RNA sequences span a narrower range of structural and functional diversity than proteins. The consequences appear in downstream performance: <em>RNA-FM</em> improves over baselines on secondary structure prediction and family classification, but shows nothing like the emergent structure prediction that made <em>ESM-2’s</em> attention patterns predict contact maps without supervision.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>The gap between RNA and protein foundation models is not primarily about architecture or training objectives—it’s about data. Proteins have accumulated over 4 billion years of evolution across all domains of life, with rich structural annotations from crystallography and cryo-EM. RNA databases are smaller, biased toward well-characterized families, and lack equivalent structural training sets. Until this data gap closes, RNA foundation models will struggle to achieve protein-like breakthroughs.</p>
</div>
</div>
<p>Several factors explain the disparity. Protein sequences have accumulated over 4 billion years of evolution across all domains of life, with each functional protein family represented by thousands of homologs. RNA databases are biased toward well-characterized structural families (tRNAs, rRNAs, ribozymes) with sparser coverage of regulatory ncRNAs and lineage-specific transcripts. The epitranscriptomic modifications that alter RNA function are invisible in sequence databases, unlike protein post-translational modifications that at least occur at predictable sequence motifs.</p>
<div id="fig-rna-plm-gap" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rna-plm-gap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/03-A-fig-rna-plm-gap.svg" class="img-fluid figure-img"></p>
<figcaption>Key metrics comparison between protein and RNA FMs</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/03-B-fig-rna-plm-gap.svg" class="img-fluid figure-img"></p>
<figcaption>Training data composition differs dramatically</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/03-C-fig-rna-plm-gap.svg" class="img-fluid figure-img"></p>
<figcaption>Emergent capabilities comparison</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/03-D-fig-rna-plm-gap.svg" class="img-fluid figure-img"></p>
<figcaption>The fundamental structural data challenge</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rna-plm-gap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.3: The scale gap between protein and RNA foundation models. (A) Key metrics comparison showing protein models train on 3× more sequences with much greater diversity. (B) Training data composition: protein data span diverse families while RNA databases are dominated by well-characterized classes. (C) Emergent capabilities comparison showing protein models achieve structure prediction that RNA models lack. (D) The fundamental data challenge: fewer than 2,000 RNA structures versus over 200,000 protein structures in the PDB.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch19-architectures" class="level3" data-number="19.5.2">
<h3 data-number="19.5.2" class="anchored" data-anchor-id="sec-ch19-architectures"><span class="header-section-number">19.5.2</span> Architectures and Objectives</h3>
<p>Most RNA foundation models follow the <strong>masked language modeling (MLM)</strong> paradigm established by BERT (<a href="../part_2/p2-ch05-representations.html" class="quarto-xref"><span>Chapter 5</span></a>). <em>RNA-FM</em> uses a transformer encoder with nucleotide-level tokenization, predicting masked bases from surrounding context. The learned embeddings show some correspondence to secondary structure when probed with downstream tasks, though the correspondence is weaker than the structure-function relationship learned by protein language models.</p>
<p>Alternative architectures explore different design choices. Some models incorporate explicit structure tokens or operate on sequence-structure graphs, learning joint representations over both modalities. Others use codon-level tokenization for coding RNAs or explore state-space models and other efficient attention variants to handle longer sequences. <em>RNAErnie</em> and related models experiment with multi-task objectives that combine MLM with auxiliary predictions for structural features or family classification. <em>[Citation Needed]</em></p>
<p>The field remains in active development, with no clear consensus on optimal architecture, tokenization, or training strategy. Unlike protein modeling, where <em>ESM</em> established a dominant paradigm that subsequent work has refined, RNA modeling still explores fundamental design choices.</p>
</section>
<section id="sec-ch19-downstream" class="level3" data-number="19.5.3">
<h3 data-number="19.5.3" class="anchored" data-anchor-id="sec-ch19-downstream"><span class="header-section-number">19.5.3</span> Downstream Applications</h3>
<p>RNA foundation model embeddings support various downstream tasks. Secondary structure prediction fine-tunes the model to output pairing probabilities or SHAPE reactivity profiles. RNA-protein binding prediction uses CLIP-seq data to predict interactions with RNA-binding proteins. Family classification assigns sequences to Rfam families or functional categories (tRNA, rRNA, miRNA, lncRNA). Expression and stability tasks predict transcript half-life or steady-state levels from UTR sequences.</p>
<p>Performance varies substantially across tasks. For structurally constrained RNAs like tRNAs and rRNAs, where sequence motifs strongly determine structure and function, foundation model embeddings provide useful features. For regulatory lncRNAs that often lack stable secondary structures and conserved motifs, improvement over baseline methods is more modest. The diversity of RNA types and tasks complicates benchmarking (<a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a>), and models that excel on one task may struggle on others.</p>
</section>
</section>
<section id="sec-ch19-codon" class="level2" data-number="19.6">
<h2 data-number="19.6" class="anchored" data-anchor-id="sec-ch19-codon"><span class="header-section-number">19.6</span> Codon-Level Models for Coding RNA</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider two mRNA sequences that encode the exact same protein but differ in their codon choices (synonymous codons). A protein language model sees identical sequences. What biological information exists in the mRNA that the protein model completely misses?</p>
</div>
</div>
<p>Coding sequences present a modeling opportunity that neither DNA nor protein foundation models fully exploit. The genetic code’s synonymous redundancy means that mRNA sequence carries information beyond amino acid identity: codon choice affects translation speed, mRNA stability, and co-translational folding. Codon-level foundation models tokenize mRNA into three-nucleotide units, learning representations that capture these codon-specific signals invisible to protein language models.</p>
<section id="sec-ch19-codon-tokenization" class="level3" data-number="19.6.1">
<h3 data-number="19.6.1" class="anchored" data-anchor-id="sec-ch19-codon-tokenization"><span class="header-section-number">19.6.1</span> Beyond Nucleotide Tokenization</h3>
<p>Coding sequences occupy a special niche where protein and nucleic acid constraints intersect. The genetic code assigns 61 sense codons to 20 amino acids, creating synonymous redundancy where multiple codons encode the same amino acid. This redundancy is not functionally neutral: synonymous codons differ in tRNA availability, translation speed, co-translational folding effects, and mRNA stability. Protein language models, which operate on amino acid sequences, cannot capture these codon-level signals.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>A protein language model like <em>ESM</em> sees only amino acid sequence. A DNA language model like <em>DNABERT</em> sees nucleotide sequence but treats all positions equally. What information is lost by each approach when modeling a coding sequence? What could a codon-level model capture that neither can?</p>
</div>
</div>
<p>Codon-level foundation models address this gap by tokenizing mRNA into codons rather than nucleotides. Models like <em>cdsFM</em>, <em>EnCodon</em>, and <em>DeCodon</em> treat each three-nucleotide codon as a single token, training on masked codon prediction and related objectives <span class="citation" data-cites="naghipourfar_cdsfm_2024">(<a href="../bib/references.html#ref-naghipourfar_cdsfm_2024" role="doc-biblioref">Naghipourfar et al. 2024</a>)</span>. This tokenization encodes a biological prior: codons are the fundamental units of translation, and mutations at the codon level determine amino acid changes while mutations within synonymous codons affect expression without changing protein sequence.</p>
<p>The codon vocabulary contains 61 tokens (excluding stop codons) plus special tokens for noncoding regions and boundaries. This intermediate vocabulary size (between character-level nucleotide tokenization and typical BPE vocabularies of thousands of tokens) balances resolution with context length (<a href="../part_2/p2-ch05-representations.html" class="quarto-xref"><span>Chapter 5</span></a>). A 300-amino-acid protein corresponds to 900 nucleotides or 300 codons, making whole-gene modeling tractable within standard transformer context windows. The therapeutic implications of codon-level modeling are examined in <a href="../part_7/p7-ch31-design.html#sec-ch31-mrna-design" class="quarto-xref"><span>Section 31.4</span></a>, where these representations guide mRNA vaccine and protein replacement therapy design.</p>
<div id="fig-codon-tokenization" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-codon-tokenization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/04-A-fig-codon-tokenization.svg" class="img-fluid figure-img"></p>
<figcaption>Multiple mRNA sequences can encode the same protein</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/04-B-fig-codon-tokenization.svg" class="img-fluid figure-img"></p>
<figcaption>Codon selection affects multiple biological properties</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/04-C-fig-codon-tokenization.svg" class="img-fluid figure-img"></p>
<figcaption>Codon tokenization reduces sequence length</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/04-D-fig-codon-tokenization.svg" class="img-fluid figure-img"></p>
<figcaption>Different model types capture different information</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-codon-tokenization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.4: Codon-level modeling of mRNA. (A) Multiple mRNA sequences can encode the same protein through synonymous codon choices. (B) Codon selection affects tRNA availability, translation speed, mRNA structure, and stability. (C) Codon tokenization reduces sequence length while encoding biological priors about translation units. (D) Comparison of what protein, DNA, and codon language models can capture from coding sequences.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch19-codon-advantages" class="level3" data-number="19.6.2">
<h3 data-number="19.6.2" class="anchored" data-anchor-id="sec-ch19-codon-advantages"><span class="header-section-number">19.6.2</span> What Codon Models Add</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>You’re designing a therapeutic mRNA to express a protein in human cells. The amino acid sequence is fixed (you need that exact protein). But you have roughly 3^300 possible mRNA sequences to choose from for a 300-amino-acid protein. What criteria would guide your choice among synonymous alternatives?</p>
</div>
</div>
<p>Compared to protein language models, codon-level models enable direct modeling of mRNA design problems where amino acid sequence is fixed but codon choice is variable. They capture codon usage bias and its relationship to expression, model translation elongation dynamics that affect co-translational folding, and distinguish synonymous variants that are neutral at the protein level but affect mRNA properties.</p>
<p><em>Life-Code</em> extends this approach into a central-dogma-wide framework, linking DNA, RNA, and protein representations through shared or aligned embedding spaces <span class="citation" data-cites="liu_life-code_2025">(<a href="../bib/references.html#ref-liu_life-code_2025" role="doc-biblioref">Liu et al. 2025</a>)</span>. <em>CodonBERT</em> specifically targets mRNA design for vaccines and therapeutics, training on over 10 million mRNA sequences to learn representations that predict expression, stability, and immunogenicity <span class="citation" data-cites="li_codonbert_2023">(<a href="../bib/references.html#ref-li_codonbert_2023" role="doc-biblioref">Li et al. 2023</a>)</span>.</p>
<p>Codon models typically ignore mRNA secondary structure and modifications. Local structure affects ribosome access and translation rate; modifications like m6A influence stability and localization. Combining codon-aware tokenization with structure-aware representations remains an open direction, less mature than the parallel integration of sequence and structure in protein modeling (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>).</p>
<div id="tbl-codon-models" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-codon-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.3: Comparison of model types for coding sequences. Codon models fill a gap between DNA and protein approaches.
</figcaption>
<div aria-describedby="tbl-codon-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 27%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Model Type</th>
<th>Input</th>
<th>Captures Codon Bias</th>
<th>Captures Structure</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Protein LM</strong></td>
<td>Amino acids</td>
<td>No</td>
<td>Protein structure</td>
<td>Variant effects, function</td>
</tr>
<tr class="even">
<td><strong>DNA LM</strong></td>
<td>Nucleotides</td>
<td>Partially (no boundaries)</td>
<td>No</td>
<td>Regulatory sequence</td>
</tr>
<tr class="odd">
<td><strong>Codon LM</strong></td>
<td>Codons</td>
<td>Yes</td>
<td>No (typically)</td>
<td>mRNA design, translation</td>
</tr>
<tr class="even">
<td><strong>Hybrid</strong></td>
<td>Codon + structure</td>
<td>Yes</td>
<td>Yes</td>
<td>Future direction</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check: Which Model for This Coding Sequence Task?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check: Which Model for This Coding Sequence Task?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For each scenario, which model type (Protein LM, DNA LM, or Codon LM) would you choose?</p>
<ol type="1">
<li><p>Predicting whether a missense mutation (Val→Ile) disrupts protein function.</p></li>
<li><p>Optimizing codon usage for a therapeutic mRNA vaccine while keeping the amino acid sequence identical.</p></li>
<li><p>Assessing whether a synonymous SNP in a coding region affects a nearby splice enhancer motif.</p></li>
<li><p>Predicting translation speed and ribosome stalling patterns across a transcript.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Protein LM (ESM-2, AlphaMissense)</strong> - Missense effects depend on amino acid properties and protein structure, not codon choice. Protein LMs capture evolutionary constraints and structural context that determine functional impact.</p></li>
<li><p><strong>Codon LM (CodonBERT, cdsFM)</strong> - This is precisely what codon models are designed for: exploring the ~3^300 synonymous sequence space while predicting expression and stability. Protein LMs cannot distinguish synonymous alternatives.</p></li>
<li><p><strong>DNA LM (DNABERT, Nucleotide Transformer)</strong> - Splice enhancer motifs operate at the nucleotide level across exon-intron boundaries. DNA LMs see the nucleotide context; codon LMs would miss the splice signal since it spans codon boundaries.</p></li>
<li><p><strong>Codon LM</strong> - Translation dynamics depend on codon-level features: tRNA availability, codon pair effects, and ribosome decoding speed. DNA LMs lack codon boundary information; protein LMs lose synonymous codon information entirely.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch19-utr" class="level2" data-number="19.7">
<h2 data-number="19.7" class="anchored" data-anchor-id="sec-ch19-utr"><span class="header-section-number">19.7</span> UTR Models and Translation Regulation</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Two mRNAs encode identical proteins with identical codon sequences, but one produces 100-fold more protein than the other. Where would you look to explain this difference, and what mechanisms might be responsible?</p>
</div>
</div>
<p>The untranslated regions flanking a coding sequence determine how much protein an mRNA produces and how long the message survives in the cell. These regulatory effects operate through distinct mechanisms in the 5’ and 3’ UTRs, creating opportunities for both understanding endogenous regulation and engineering synthetic mRNAs with desired expression properties.</p>
<section id="sec-ch19-utr-control" class="level3" data-number="19.7.1">
<h3 data-number="19.7.1" class="anchored" data-anchor-id="sec-ch19-utr-control"><span class="header-section-number">19.7.1</span> Why UTRs Dominate Expression Control</h3>
<p>The protein output of an mRNA depends as much on its untranslated regions as on its coding sequence. A transcript’s 5’ UTR determines whether ribosomes find and engage the start codon; its 3’ UTR controls how long the message survives and where in the cell it localizes—like an expiration date stamped on perishable goods, except here the “date” is encoded in sequence features that cellular machinery reads to decide when to degrade the transcript. Two mRNAs encoding identical proteins can differ by orders of magnitude in expression if their UTRs differ. This regulatory leverage makes UTR modeling essential for both understanding endogenous gene regulation and designing synthetic mRNAs for therapeutic applications.</p>
<p>The 5’ UTR spans from the transcription start site to the start codon, typically 50 to 200 nucleotides in human mRNAs. Within this region, secondary structure can occlude the start codon and impede ribosome scanning, upstream open reading frames (uORFs) can capture ribosomes before they reach the main coding sequence, and internal ribosome entry sites (IRES) can enable cap-independent translation under stress conditions. The Kozak consensus sequence surrounding the start codon influences initiation efficiency, but context extending dozens of nucleotides in either direction modulates this effect. Predicting translation efficiency from 5’ UTR sequence requires integrating these overlapping signals.</p>
<p>The 3’ UTR extends from the stop codon to the poly-A tail, ranging from under 100 nucleotides to over 10 kilobases. This region harbors binding sites for RNA-binding proteins and microRNAs that collectively determine mRNA half-life, localization, and translational status. AU-rich elements (AREs) recruit decay machinery in response to cellular signals. Pumilio and other RNA-binding proteins recognize specific motifs to repress or activate translation. The density and arrangement of miRNA binding sites create combinatorial regulatory logic that varies across cell types depending on which miRNAs are expressed.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Practical Guidance: UTR Design Considerations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: UTR Design Considerations
</div>
</div>
<div class="callout-body-container callout-body">
<p>When designing or optimizing mRNAs for expression:</p>
<ul>
<li><strong>5’ UTR</strong>: Avoid strong secondary structure near start codon; eliminate upstream AUGs that create uORFs; ensure Kozak consensus (GCCRCCAUGG); consider GC content for stability vs.&nbsp;structure trade-offs</li>
<li><strong>3’ UTR</strong>: Consider borrowing UTRs from highly expressed endogenous genes (alpha-globin, beta-globin are common choices); avoid sequences resembling miRNA binding sites for target tissues; balance length (longer = more regulatory sites) against manufacturing constraints</li>
<li><strong>Integration</strong>: Remember that 5’ and 3’ effects interact—optimize iteratively, not independently</li>
</ul>
</div>
</div>
</section>
<section id="sec-ch19-expression-models" class="level3" data-number="19.7.2">
<h3 data-number="19.7.2" class="anchored" data-anchor-id="sec-ch19-expression-models"><span class="header-section-number">19.7.2</span> Sequence-to-Expression Models</h3>
<p>High-throughput reporter assays have enabled systematic modeling of UTR function. <strong>Massively parallel reporter assays (MPRAs)</strong> measure expression driven by thousands of UTR variants in a single experiment, providing training data at scales previously unavailable. Sample et al.&nbsp;used such data to train <em>Optimus 5-Prime</em>, a convolutional model that predicts ribosome load from 5’ UTR sequence with accuracy sufficient to guide synthetic UTR design <span class="citation" data-cites="sample_human_2019">(<a href="../bib/references.html#ref-sample_human_2019" role="doc-biblioref">Sample et al. 2019</a>)</span>. The model learned interpretable features corresponding to known regulatory elements (uORF presence, Kozak strength, secondary structure) while also capturing context-dependent interactions invisible to element-counting approaches.</p>
<p>For 3’ UTRs, models must contend with greater length and combinatorial complexity. A 2-kilobase 3’ UTR may contain dozens of potential regulatory sites whose effects depend on spacing, secondary structure context, and the expression levels of cognate binding proteins. Approaches range from motif-based models that score individual elements and sum contributions, to deep learning architectures that process entire UTR sequences and learn nonlinear interactions. Agarwal and Kelley trained models on endogenous mRNA stability measurements, demonstrating that 3’ UTR sequence features explain substantial variance in half-life across the transcriptome <span class="citation" data-cites="agarwal_predicting_2020">(<a href="../bib/references.html#ref-agarwal_predicting_2020" role="doc-biblioref">Agarwal and Shendure 2020</a>)</span>.</p>
<p>Transfer learning from RNA foundation models offers a complementary approach. Rather than training UTR-specific models from scratch, pretrained representations from <em>RNA-FM</em> or similar models can be fine-tuned on expression prediction tasks (<a href="../part_2/p2-ch05-representations.html" class="quarto-xref"><span>Chapter 5</span></a>). The pretrained embeddings encode sequence context and potential structural features that may transfer to UTR function prediction, though systematic comparisons between foundation model transfer and task-specific training remain limited.</p>
</section>
<section id="sec-ch19-utr-design" class="level3" data-number="19.7.3">
<h3 data-number="19.7.3" class="anchored" data-anchor-id="sec-ch19-utr-design"><span class="header-section-number">19.7.3</span> Integration with mRNA Design</h3>
<p>UTR optimization represents a distinct component of therapeutic mRNA design, complementing codon optimization. For a vaccine or protein replacement therapy, the coding sequence determines what protein is made while the UTRs determine how much protein is made and for how long. Current mRNA therapeutics typically use UTRs borrowed from highly expressed endogenous genes (human alpha-globin and beta-globin UTRs are common choices) rather than computationally optimized sequences. <em>[Citation Needed]</em></p>
<p>Model-guided UTR design could improve on this approach by optimizing for specific objectives: maximizing expression in target tissues, extending mRNA half-life to reduce dosing frequency, or minimizing immunogenicity by avoiding sequences that trigger innate immune sensors. The challenge lies in the combinatorial interaction between UTRs and coding sequence. Secondary structures can span the UTR-CDS boundary, and the optimal 5’ UTR for one coding sequence may perform poorly for another. Integrated models that jointly optimize UTRs and coding sequence represent an active research direction, though experimental validation of computationally designed UTRs remains limited compared to the extensive optimization of coding sequences. The design principles and optimization strategies for therapeutic mRNAs, including COVID-19 vaccine development, are detailed in <a href="../part_7/p7-ch31-design.html#sec-ch31-utr-design" class="quarto-xref"><span>Section 31.4.2</span></a>.</p>
</section>
</section>
<section id="sec-ch19-mrna-design" class="level2" data-number="19.8">
<h2 data-number="19.8" class="anchored" data-anchor-id="sec-ch19-mrna-design"><span class="header-section-number">19.8</span> mRNA Design and Optimization</h2>
<p>Therapeutic mRNA design requires navigating a vast sequence space where multiple objectives compete. Expression, stability, immunogenicity, and manufacturability all depend on sequence choices that interact in complex ways. The COVID-19 vaccines demonstrated that rational mRNA design can achieve clinical efficacy, while also revealing how much of current practice remains empirical rather than model-driven.</p>
<section id="sec-ch19-design-objectives" class="level3" data-number="19.8.1">
<h3 data-number="19.8.1" class="anchored" data-anchor-id="sec-ch19-design-objectives"><span class="header-section-number">19.8.1</span> Design Objectives and Trade-offs</h3>
<div class="callout callout-style-default callout-warning callout-titled" title="Mathematical Note">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mathematical Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section discusses the vast combinatorial space of possible mRNA sequences. The key intuition is that for any protein, there are astronomically many different mRNA sequences that could encode it (because multiple codons encode each amino acid). This space is far too large for exhaustive search, motivating model-guided optimization.</p>
</div>
</div>
<p>mRNA sequence design selects nucleotide sequences that encode a desired protein while optimizing expression, stability, safety, and manufacturability. For a 300-amino-acid protein, there are approximately <span class="math inline">\(3^{300}\)</span> possible synonymous mRNA sequences (roughly the number of synonymous codons raised to the protein length). This astronomical space cannot be exhaustively searched, motivating both classical heuristics and modern machine learning approaches.</p>
<p>Key objectives include high protein expression in target tissues, mRNA stability during manufacturing and <em>in vivo</em>, controlled translation kinetics that influence co-translational folding, and low immunogenicity for therapeutic applications. These objectives often conflict: increasing GC content may improve stability but introduce unwanted secondary structure, while avoiding rare codons may reduce expression if tRNA pools are limiting. The conflict between stability and expression illustrates a broader principle: GC-rich sequences form more stable base pairs (G-C has three hydrogen bonds versus two for A-U), which extends mRNA half-life but can also create secondary structures that impede ribosome scanning and translation initiation. The design challenge is finding the Pareto frontier where no objective can be improved without sacrificing another.</p>
<p><strong>Worked Example:</strong> Consider designing an mRNA to express a therapeutic enzyme in liver cells. You might:</p>
<ol type="1">
<li>Start with the wild-type human codon usage (baseline)</li>
<li>Replace rare codons with more frequent synonymous alternatives (increases expression)</li>
<li>Check for unwanted secondary structure in 5’ UTR region (may impede translation)</li>
<li>Verify absence of cryptic splice sites or premature polyadenylation signals</li>
<li>Assess GC content (&gt;60% may cause aggregation; &lt;40% may reduce stability)</li>
<li>Use models to predict expression and iterate</li>
</ol>
<p>Each choice affects multiple objectives—there is no single “optimal” sequence, only trade-offs.</p>
</section>
<section id="sec-ch19-covid-vaccines" class="level3" data-number="19.8.2">
<h3 data-number="19.8.2" class="anchored" data-anchor-id="sec-ch19-covid-vaccines"><span class="header-section-number">19.8.2</span> Lessons from COVID-19 Vaccines</h3>
<p>The COVID-19 mRNA vaccines provided a high-profile demonstration of mRNA design principles at unprecedented scale. The Pfizer-BioNTech and Moderna vaccines incorporated several design elements: N1-methylpseudouridine modification throughout the sequence to reduce innate immune activation, codon optimization to enhance expression in human cells, optimized 5’ and 3’ UTRs from highly expressed genes, and sequence modifications to stabilize the prefusion spike conformation. These choices drew on decades of basic research but were refined through empirical optimization rather than systematic model-based design. <em>[Citation Needed]</em></p>
<p>The vaccines’ success demonstrated that rationally designed mRNAs can achieve therapeutic efficacy at scale. It also revealed limitations in current understanding: the optimal combination of modifications, codons, and UTRs for a given protein target remains partly empirical, and transferring designs across proteins or therapeutic applications requires substantial optimization.</p>
</section>
<section id="sec-ch19-model-design" class="level3" data-number="19.8.3">
<h3 data-number="19.8.3" class="anchored" data-anchor-id="sec-ch19-model-design"><span class="header-section-number">19.8.3</span> Model-Based Design Strategies</h3>
<p>RNA and codon foundation models enable several approaches to systematic design. Scoring and screening use pretrained models to evaluate large candidate sets for predicted expression or stability, selecting top designs for experimental validation. When models are differentiable with respect to input embeddings, gradient-based methods can guide sequence optimization toward desired objectives. Generative approaches sample diverse high-scoring sequences subject to constraints like fixed amino acid sequence or avoided motifs.</p>
<p>Empirical results suggest that deep models trained on high-throughput reporter assays or ribosome profiling can outperform classical codon adaptation indices like CAI or tAI, particularly for context-specific expression prediction. Classical indices rely on genome-wide codon frequencies that may not reflect the relevant cellular context, while deep models can learn local effects of codon pairs, mRNA structure, and regulatory elements. These models require substantial training data and may not generalize across organisms or synthetic constructs far from natural sequences.</p>
<div id="fig-mrna-design-pipeline" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mrna-design-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_5/ch19/05-fig-mrna-design-pipeline.svg" class="img-fluid figure-img"></p>
<figcaption>Therapeutic mRNA design pipeline from target to optimized construct</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mrna-design-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.5: Therapeutic mRNA design pipeline. Starting from a target protein, the design process optimizes codon usage (selecting from ~3<sup>300</sup> possible synonymous sequences), engineers 5’ UTR elements for translation initiation, designs 3’ UTR for stability and localization, and selects chemical modifications (such as N1-methylpseudouridine) to reduce immunogenicity. Inset shows key design choices made for COVID-19 mRNA vaccines.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch19-ncrna" class="level2" data-number="19.9">
<h2 data-number="19.9" class="anchored" data-anchor-id="sec-ch19-ncrna"><span class="header-section-number">19.9</span> Noncoding RNA Classification and Function</h2>
<p>RNA that does not encode protein encompasses an extraordinary range of structures, functions, and regulatory mechanisms. Classifying these transcripts and predicting their functions presents challenges that differ from coding sequence analysis: the relevant features vary across RNA classes, functional annotations remain incomplete, and the boundary between functional ncRNA and transcriptional noise is often unclear.</p>
<section id="sec-ch19-ncrna-diversity" class="level3" data-number="19.9.1">
<h3 data-number="19.9.1" class="anchored" data-anchor-id="sec-ch19-ncrna-diversity"><span class="header-section-number">19.9.1</span> Diversity of Noncoding RNA</h3>
<p>RNA that does not encode protein spans an enormous functional and structural range. Housekeeping RNAs (tRNAs, rRNAs, snRNAs, snoRNAs) perform essential cellular functions with well-characterized structures. Regulatory RNAs (miRNAs, siRNAs, piRNAs, lncRNAs) control gene expression through diverse mechanisms. Structural and catalytic RNAs (ribozymes, riboswitches) adopt complex folds that enable enzymatic activity or ligand sensing. Circular RNAs (circRNAs) and other noncanonical species continue to expand the catalog of RNA diversity.</p>
<p>Each class has characteristic lengths, structural motifs, genomic contexts, and functional mechanisms. tRNAs are approximately 76 nucleotides with a conserved cloverleaf structure. miRNAs are approximately 22 nucleotides processed from longer hairpin precursors. lncRNAs span thousands of nucleotides with poorly conserved sequence and often no stable secondary structure. Unifying these classes under a single modeling framework is challenging, and models that excel on one class may fail on others.</p>
<div id="tbl-ncrna-classes" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ncrna-classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.4: Diversity of noncoding RNA classes. Each presents distinct modeling challenges.
</figcaption>
<div aria-describedby="tbl-ncrna-classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>ncRNA Class</th>
<th>Typical Length</th>
<th>Structure</th>
<th>Conservation</th>
<th>Function</th>
<th>Modeling Challenge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tRNA</td>
<td>~76 nt</td>
<td>Cloverleaf (conserved)</td>
<td>High</td>
<td>Amino acid delivery</td>
<td>Well-characterized; good models exist</td>
</tr>
<tr class="even">
<td>miRNA</td>
<td>~22 nt</td>
<td>Processed from hairpin</td>
<td>Moderate</td>
<td>Post-transcriptional silencing</td>
<td>Target prediction remains noisy</td>
</tr>
<tr class="odd">
<td>lncRNA</td>
<td>200 - &gt;10,000 nt</td>
<td>Variable/none</td>
<td>Low</td>
<td>Diverse</td>
<td>Functional annotation sparse</td>
</tr>
<tr class="even">
<td>circRNA</td>
<td>Variable</td>
<td>Circular backbone</td>
<td>Variable</td>
<td>miRNA sponge, other</td>
<td>Detection and quantification</td>
</tr>
<tr class="odd">
<td>rRNA</td>
<td>~1,500-5,000 nt</td>
<td>Complex, conserved</td>
<td>Very high</td>
<td>Ribosome structure</td>
<td>Well-characterized</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="sec-ch19-ncrna-features" class="level3" data-number="19.9.2">
<h3 data-number="19.9.2" class="anchored" data-anchor-id="sec-ch19-ncrna-features"><span class="header-section-number">19.9.2</span> From Handcrafted Features to Learned Representations</h3>
<p>Classical ncRNA classification relied on engineered features: k-mer frequencies, GC content, minimum free energy of predicted secondary structure, structural motif counts, and genomic context features like proximity to coding genes or chromatin marks. These features fed conventional classifiers (SVMs, random forests, shallow neural networks) that achieved reasonable performance for well-studied classes with strong sequence and structure signatures.</p>
<p>The limits of handcrafted features emerge most clearly for lncRNAs. These transcripts are defined partly by what they lack (no long open reading frame) rather than what they possess. Many lncRNAs show poor conservation, lack stable secondary structures, and have diverse, poorly characterized functions. Distinguishing functional lncRNAs from transcriptional noise remains difficult, and classical feature sets often collapse to generic statistics like length and GC content.</p>
<p>Foundation model embeddings offer a more flexible approach. Per-nucleotide representations can be pooled into fixed-dimensional vectors that support classification with simple downstream heads. For ncRNAs without strong sequence motifs, the pretrained embeddings may capture subtle distributional patterns learned during self-supervised training. <strong>Few-shot learning</strong> becomes possible: given a handful of newly characterized RNAs, their embeddings can seed new clusters in representation space, guiding annotation of related sequences.</p>
</section>
</section>
<section id="sec-ch19-mirna" class="level2" data-number="19.10">
<h2 data-number="19.10" class="anchored" data-anchor-id="sec-ch19-mirna"><span class="header-section-number">19.10</span> miRNA Target Prediction</h2>
<p>MicroRNAs regulate gene expression by guiding the RNA-induced silencing complex (RISC) to complementary sites in target mRNAs, typically in the 3’ UTR. A single miRNA can regulate hundreds of transcripts, and a single transcript can harbor binding sites for dozens of miRNAs. This regulatory network influences virtually every cellular process, and dysregulation of miRNA-target interactions contributes to cancer, cardiovascular disease, and neurodegeneration. Predicting which transcripts a given miRNA targets (and vice versa) has been a persistent computational challenge since the discovery of miRNA-mediated regulation.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>miRNA target prediction relies heavily on “seed complementarity”—perfect base pairing between nucleotides 2-7 of the miRNA and the target site. Why might focusing only on seed matches miss many functional targets? What other factors could influence whether a site is actually regulated?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Seed-only approaches miss functional targets because actual regulation depends on additional context: local RNA secondary structure may occlude seed matches, competing RNA-binding proteins may block access, miRNA and target abundance vary across cell types, and non-canonical binding modes exist without perfect seed pairing. The cellular context determines whether a seed match produces functional regulation.</p>
</div>
</div>
</div>
</div>
</div>
<p>The dominant paradigm centers on seed complementarity. Nucleotides 2 through 7 of the miRNA (the seed region) typically form perfect Watson-Crick pairs with target sites, while the remaining nucleotides contribute variably to binding affinity and regulatory effect. Classical algorithms like <em>TargetScan</em> identify conserved seed matches in 3’ UTRs and rank targets by evolutionary conservation, site type (8mer, 7mer-m8, 7mer-A1), and local sequence context <span class="citation" data-cites="agarwal_predicting_2020">(<a href="../bib/references.html#ref-agarwal_predicting_2020" role="doc-biblioref">Agarwal and Shendure 2020</a>)</span>. Additional features including AU content flanking the site, position within the UTR, and proximity to other miRNA sites improve prediction accuracy.</p>
<p>Despite decades of refinement, target prediction remains noisy. Experimental validation rates for top predictions rarely exceed 50%, and many functional targets lack canonical seed matches. <em>[Citation Needed]</em> The disconnect arises partly from context dependence: a site may be accessible in one cell type but occluded by RNA structure or competing protein binding in another. It arises partly from the limitations of reporter assays that measure binding in artificial contexts rather than endogenous regulatory effects. And it arises from the biology itself, where weak individual sites combine additively and miRNA-target interactions are probabilistic rather than deterministic.</p>
<p>Deep learning approaches attempt to improve on seed-based methods by learning complex sequence features from high-throughput binding data. Models trained on CLIP-seq experiments (which crosslink miRNA-target complexes and identify bound sites transcriptome-wide) can capture non-canonical binding modes and context effects invisible to seed-matching algorithms. These models often overfit to cell-type-specific binding patterns and generalize poorly across contexts (<a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a>). The fundamental challenge is that miRNA targeting depends on factors beyond sequence: miRNA and target abundance, competition among targets for limiting RISC, and cellular state variables that no sequence-based model can capture.</p>
<p>For clinical applications, target prediction informs both the mechanism of disease-associated miRNAs and the design of therapeutic interventions. AntimiR oligonucleotides that sequester specific miRNAs have entered clinical trials for hepatitis C (targeting miR-122) and other indications. Predicting off-target effects of such therapeutics requires understanding the full network of targets that will be derepressed when a miRNA is inhibited. Similarly, miRNA mimics designed to replace lost tumor-suppressor miRNAs must be evaluated for potential regulation of unintended targets. In both cases, computational target prediction provides a starting point that experimental validation must refine.</p>
</section>
<section id="sec-ch19-splicing" class="level2" data-number="19.11">
<h2 data-number="19.11" class="anchored" data-anchor-id="sec-ch19-splicing"><span class="header-section-number">19.11</span> Splicing and Transcript Processing Models</h2>
<p>Splicing models predict how pre-mRNA is processed into mature transcripts, a problem intimately connected to RNA biology even when the models operate on genomic DNA sequence. <em>SpliceAI</em> established the paradigm, but extensions address tissue specificity, branchpoint prediction, and quantitative splicing outcomes that the original model does not capture.</p>
<section id="sec-ch19-beyond-spliceai" class="level3" data-number="19.11.1">
<h3 data-number="19.11.1" class="anchored" data-anchor-id="sec-ch19-beyond-spliceai"><span class="header-section-number">19.11.1</span> Beyond SpliceAI</h3>
<p><em>SpliceAI</em> demonstrated that deep convolutional networks could predict splice sites with near-spliceosomal precision (<a href="../part_2/p2-ch06-cnn.html#sec-ch06-spliceai" class="quarto-xref"><span>Section 6.5</span></a>). The model’s success in identifying cryptic splice variants has made it a standard tool in clinical variant interpretation (<a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>). Splicing involves more than splice site recognition, and several extensions address aspects that <em>SpliceAI</em> does not fully capture.</p>
<p>Tissue-specific splicing patterns vary substantially across cell types and developmental stages. A splice site may be used in brain but skipped in liver due to differential expression of splicing factors. Models like <em>Pangolin</em> extend splice prediction by training on tissue-specific RNA-seq data, learning to predict not just whether a site is splice-competent but whether it is used in specific cellular contexts. <em>[Citation Needed]</em> These models enable variant interpretation that accounts for tissue-relevant splicing patterns rather than generic predictions. The integration of tissue-specific splice predictions into clinical variant interpretation workflows is addressed in <a href="../part_7/p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>.</p>
<p>Branchpoint prediction identifies the adenosine residue where the lariat intermediate forms during splicing. While <em>SpliceAI</em> focuses on donor and acceptor sites, branchpoint recognition involves distinct sequence features (typically a degenerate YURAY motif 18-40 nucleotides upstream of the acceptor) that specialized models can capture. Combined analysis of donor, acceptor, and branchpoint predictions provides more complete characterization of splice-altering variants.</p>
<p>Alternative splicing prediction moves beyond binary splice site identification to model exon inclusion rates and isoform usage. Models in this space attempt to predict not just whether an exon can be included but quantitative measures of inclusion across conditions, enabling analysis of splicing quantitative trait loci (sQTLs) and their effects on transcript diversity.</p>
</section>
</section>
<section id="sec-ch19-limitations" class="level2" data-number="19.12">
<h2 data-number="19.12" class="anchored" data-anchor-id="sec-ch19-limitations"><span class="header-section-number">19.12</span> Limitations and Open Challenges</h2>
<p>RNA modeling faces constraints that do not apply to protein or DNA foundation models. Data scarcity limits what can be learned from self-supervised training, functional annotations remain incomplete for most ncRNA classes, and the field has not yet achieved the breakthrough moment that <em>AlphaFold</em> represented for proteins. These limitations define the current frontier and point toward the advances needed for RNA foundation models to mature.</p>
<section id="sec-ch19-sparse-data" class="level3" data-number="19.12.1">
<h3 data-number="19.12.1" class="anchored" data-anchor-id="sec-ch19-sparse-data"><span class="header-section-number">19.12.1</span> Sparse Structural Data</h3>
<p>The fundamental limitation of RNA modeling is data scarcity. Protein structure prediction benefits from over 200,000 experimentally determined structures; RNA has fewer than 2,000, heavily biased toward ribosomal RNA and tRNA. <em>[Citation Needed]</em> This scarcity limits supervised learning for tertiary structure prediction and constrains the emergence of structural knowledge from self-supervised pretraining. Until high-throughput methods generate RNA structures at scale comparable to protein crystallography and cryo-EM, RNA tertiary structure prediction will remain a frontier problem rather than a solved one.</p>
<p>Secondary structure data is more abundant but still limited. Experimentally validated structures cover mainly well-characterized families, while computational predictions for novel sequences rely on thermodynamic models whose accuracy degrades for long RNAs and complex folds. Structure probing experiments provide genome-wide coverage but measure accessibility rather than pairing directly, requiring inference to convert reactivity profiles into structural models.</p>
</section>
<section id="sec-ch19-annotation-gaps" class="level3" data-number="19.12.2">
<h3 data-number="19.12.2" class="anchored" data-anchor-id="sec-ch19-annotation-gaps"><span class="header-section-number">19.12.2</span> Functional Annotation Gaps</h3>
<p>For many ncRNA classes, function remains poorly characterized. LncRNA annotations often specify only genomic location and expression pattern without mechanistic understanding. Circular RNA functions are emerging but incompletely cataloged. Even for better-characterized classes like miRNAs, target prediction remains noisy and context-dependent.</p>
<p>This annotation gap limits supervised learning for function prediction and complicates evaluation (<a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a>). When ground truth is uncertain, it becomes difficult to assess whether a model’s predictions reflect genuine biological insight or artifacts of incomplete training data. The field needs both experimental advances to characterize ncRNA function and computational approaches that can learn from weak or partial supervision.</p>
</section>
<section id="sec-ch19-maturity-gap" class="level3" data-number="19.12.3">
<h3 data-number="19.12.3" class="anchored" data-anchor-id="sec-ch19-maturity-gap"><span class="header-section-number">19.12.3</span> Maturity Gap</h3>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>The maturity gap between RNA and protein foundation models represents both a limitation and an opportunity. The protein modeling roadmap—large-scale self-supervised learning, attention mechanisms, scaling laws—exists and has been proven. Applying that roadmap to RNA requires addressing data scarcity through structure probing and synthetic data, developing architectures that handle conformational flexibility, and building comprehensive benchmarks covering RNA’s diversity.</p>
</div>
</div>
<p>RNA foundation models exist but have not achieved the transformative impact of protein language models. <em>ESM-2</em> enabled <em>ESMFold</em>, providing structure prediction from single sequences that nearly matches <em>AlphaFold</em>. No comparable RNA breakthrough has occurred. The reasons include data scarcity, the conformational complexity of RNA, and the diversity of RNA classes that makes unified modeling difficult.</p>
<p>This maturity gap represents both a limitation and an opportunity. The techniques that succeeded for proteins (large-scale self-supervised learning, attention mechanisms, scaling laws) provide a roadmap (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>). Applying that roadmap to RNA requires addressing the data challenge through structure probing, synthetic data generation, or more efficient use of limited experimental structures. It requires architectural innovations that handle RNA’s long-range base pairing and conformational flexibility. It requires benchmarks and evaluation frameworks that cover the full diversity of RNA types and tasks, following the rigorous evaluation principles established in <a href="../part_3/p3-ch12-evaluation.html" class="quarto-xref"><span>Chapter 12</span></a> and the benchmark construction guidelines in <a href="../part_3/p3-ch11-benchmarks.html" class="quarto-xref"><span>Chapter 11</span></a>.</p>
</section>
</section>
<section id="sec-ch19-bridge" class="level2" data-number="19.13">
<h2 data-number="19.13" class="anchored" data-anchor-id="sec-ch19-bridge"><span class="header-section-number">19.13</span> Bridge Between Sequence and Cell</h2>
<p>RNA occupies a distinctive position in genomic AI, bridging the sequence-level models of Part III with the cellular perspectives that follow. Splicing models like <em>SpliceAI</em> operate on pre-mRNA and predict transcript processing outcomes (<a href="../part_2/p2-ch06-cnn.html#sec-ch06-spliceai" class="quarto-xref"><span>Section 6.5</span></a>). Codon-level models capture translation dynamics invisible to protein language models. mRNA therapeutic design demonstrates practical value through codon optimization, UTR engineering, and stability prediction. These applications proceed despite the absence of the structure prediction breakthrough that transformed protein modeling; secondary structure prediction has advanced through deep learning, but tertiary structure accuracy lags protein structure by a wide margin.</p>
<p>The relationship between RNA models and other modalities reflects RNA’s position in the central dogma. RNA is the product of transcription that regulatory models predict (<a href="../part_4/p4-ch17-regulatory.html" class="quarto-xref"><span>Chapter 17</span></a>), the substrate for translation that protein models assume (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>), and the primary measurement that single-cell models use to represent cellular state (<a href="p5-ch23-multi-omics.html" class="quarto-xref"><span>Chapter 23</span></a>). Foundation models that learn from RNA sequence capture patterns distinct from those in DNA or protein: codon usage biases, secondary structure constraints, and post-transcriptional regulatory elements that neither genomic nor protein models directly represent.</p>
<p>Beyond sequence, biological understanding requires cellular and tissue context. Single-cell models treat RNA expression as the primary readout of cellular state, learning representations that capture cell type identity and perturbation response (<a href="p5-ch23-multi-omics.html" class="quarto-xref"><span>Chapter 23</span></a>). Three-dimensional genome models add spatial context that influences transcription. Network models integrate gene relationships that transcend individual sequences. RNA models provide sequence-level representations that feed into these higher-level frameworks, completing the molecular arc from DNA through RNA to protein while opening the path to systems-level integration.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>Why is RNA secondary structure prediction fundamentally harder than protein structure prediction, despite RNA having only 4 bases compared to 20 amino acids?</li>
<li>What information do codon-level foundation models capture that both DNA language models and protein language models miss?</li>
<li>Explain why the 5’ UTR and 3’ UTR both matter for therapeutic mRNA design, but through different mechanisms.</li>
<li>What is the primary data limitation preventing RNA foundation models from achieving breakthroughs comparable to protein language models like ESM-2?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>RNA structure is harder because:</strong> RNA has flat energy landscapes where multiple conformations have similar free energies (creating many-to-many sequence-structure relationships), long-range base pairing that creates global dependencies, and pseudoknots that violate the nested structure assumptions enabling efficient algorithms. Proteins typically fold to a single stable structure with a deep energy minimum.</p></li>
<li><p><strong>Codon models capture:</strong> Synonymous codon usage patterns that affect translation speed, mRNA stability, and co-translational folding. DNA language models see nucleotides but don’t know codon boundaries; protein language models see only amino acids and miss synonymous variation entirely. Codon models operate at the biologically meaningful unit of translation.</p></li>
<li><p><strong>UTR mechanisms differ:</strong> The 5’ UTR controls translation initiation through secondary structure accessibility, upstream ORFs, Kozak consensus strength, and ribosome recruitment. The 3’ UTR controls mRNA stability and localization through RBP binding sites, miRNA target sites, and AU-rich elements. Both affect expression but through distinct molecular mechanisms—initiation versus decay/localization.</p></li>
<li><p><strong>Primary data limitation:</strong> RNA has fewer than 2,000 experimentally determined 3D structures (versus 200,000+ for proteins), and sequence databases are 3× smaller with less functional diversity. Without massive structural training data, RNA foundation models cannot learn the sequence-to-structure mappings that enabled ESM-2’s breakthrough.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What we covered:</strong></p>
<ul>
<li>RNA occupies a unique position between DNA and protein, with distinct modeling challenges stemming from flat energy landscapes, long-range base pairing, and sparse structural data</li>
<li>Classical RNA structure prediction uses thermodynamic (MFE) or comparative (covariation) approaches; deep learning methods can capture patterns beyond nearest-neighbor rules and handle pseudoknots</li>
<li>RNA foundation models lag behind protein counterparts primarily due to data scarcity—fewer sequences, less structural diversity, and heavily biased training sets</li>
<li>Codon-level models fill a gap between DNA and protein approaches by capturing synonymous codon effects on translation and stability</li>
<li>UTR sequences dominate expression control; model-guided UTR design is an active area with therapeutic applications</li>
<li>The COVID-19 vaccines demonstrated mRNA design principles at scale, though much optimization remains empirical</li>
<li>miRNA target prediction remains noisy despite decades of work, limited by context dependence and the probabilistic nature of targeting</li>
<li>Splicing models extend beyond <em>SpliceAI</em> to tissue-specific predictions and quantitative alternative splicing</li>
</ul>
<p><strong>Key connections:</strong></p>
<ul>
<li><strong>Backward:</strong> RNA foundation models apply the same self-supervised paradigm as protein LMs (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>) and DNA LMs (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>), but with different data constraints</li>
<li><strong>Forward:</strong> Single-cell models (<a href="p5-ch20-single-cell.html" class="quarto-xref"><span>Chapter 20</span></a>) use RNA expression as primary cellular readout; therapeutic mRNA design (<a href="../part_7/p7-ch31-design.html#sec-ch31-mrna-design" class="quarto-xref"><span>Section 31.4</span></a>) applies the principles covered here</li>
</ul>
<p><strong>Open questions:</strong></p>
<ul>
<li>Can structure probing data compensate for limited crystallographic training sets?</li>
<li>What architectural innovations will enable RNA models to achieve protein-like breakthroughs?</li>
<li>How should models handle RNA’s inherent conformational heterogeneity?</li>
</ul>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-agarwal_predicting_2020" class="csl-entry" role="listitem">
Agarwal, Vikram, and Jay Shendure. 2020. <span>“Predicting <span class="nocase">mRNA</span> <span>Abundance</span> <span>Directly</span> from <span>Genomic</span> <span>Sequence</span> <span>Using</span> <span>Deep</span> <span>Convolutional</span> <span>Neural</span> <span>Networks</span>.”</span> <em>Cell Reports</em> 31 (7): 107663. <a href="https://doi.org/10.1016/j.celrep.2020.107663">https://doi.org/10.1016/j.celrep.2020.107663</a>.
</div>
<div id="ref-chen_rna-fm_2022" class="csl-entry" role="listitem">
Chen, Jiayang, Zhihang Hu, Siqi Sun, Qingxiong Tan, Yixuan Wang, Qinze Yu, Licheng Zong, et al. 2022. <span>“[<span>RNA</span>-<span>FM</span>] <span>Interpretable</span> <span>RNA</span> <span>Foundation</span> <span>Model</span> from <span>Unannotated</span> <span>Data</span> for <span>Highly</span> <span>Accurate</span> <span>RNA</span> <span>Structure</span> and <span>Function</span> <span>Predictions</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2204.00300">https://doi.org/10.48550/arXiv.2204.00300</a>.
</div>
<div id="ref-kalvari_rfam_2021" class="csl-entry" role="listitem">
Kalvari, Ioanna, Eric P. Nawrocki, Nancy Ontiveros-Palacios, Joanna Argasinska, Kevin Lamkiewicz, Manja Marz, Sam Griffiths-Jones, et al. 2021. <span>“Rfam 14: Expanded Coverage of Metagenomic, Viral and <span class="nocase">microRNA</span> Families.”</span> <em>Nucleic Acids Research</em> 49 (D1): D192–200. <a href="https://doi.org/10.1093/nar/gkaa1047">https://doi.org/10.1093/nar/gkaa1047</a>.
</div>
<div id="ref-li_codonbert_2023" class="csl-entry" role="listitem">
Li, Sizhen, Saeed Moayedpour, Ruijiang Li, Michael Bailey, Saleh Riahi, Milad Miladi, Jacob Miner, et al. 2023. <span>“<span>CodonBERT</span>: <span>Large</span> <span>Language</span> <span>Models</span> for <span class="nocase">mRNA</span> Design and Optimization.”</span> bioRxiv. <a href="https://doi.org/10.1101/2023.09.09.556981">https://doi.org/10.1101/2023.09.09.556981</a>.
</div>
<div id="ref-liu_life-code_2025" class="csl-entry" role="listitem">
Liu, Zicheng, Siyuan Li, Zhiyuan Chen, Fang Wu, Chang Yu, Qirong Yang, Yucheng Guo, Yujie Yang, Xiaoming Zhang, and Stan Z. Li. 2025. <span>“Life-<span>Code</span>: <span>Central</span> <span>Dogma</span> <span>Modeling</span> with <span>Multi</span>-<span>Omics</span> <span>Sequence</span> <span>Unification</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2502.07299">https://doi.org/10.48550/arXiv.2502.07299</a>.
</div>
<div id="ref-naghipourfar_cdsfm_2024" class="csl-entry" role="listitem">
Naghipourfar, Mohsen, Siyu Chen, Mathew K. Howard, Christian B. Macdonald, Ali Saberi, Timo Hagen, Mohammad R. K. Mofrad, Willow Coyote-Maestas, and Hani Goodarzi. 2024. <span>“[<span class="nocase">cdsFM</span> - <span>EnCodon</span>/<span>DeCodon</span>] <span>A</span> <span>Suite</span> of <span>Foundation</span> <span>Models</span> <span>Captures</span> the <span>Contextual</span> <span>Interplay</span> <span>Between</span> <span>Codons</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.10.617568">https://doi.org/10.1101/2024.10.10.617568</a>.
</div>
<div id="ref-sample_human_2019" class="csl-entry" role="listitem">
Sample, Paul J., Ban Wang, David W. Reid, Vlad Presnyak, Iain J. McFadyen, David R. Morris, and Georg Seelig. 2019. <span>“Human 5′ <span>UTR</span> Design and Variant Effect Prediction from a Massively Parallel Translation Assay.”</span> <em>Nature Biotechnology</em> 37 (7): 803–9. <a href="https://doi.org/10.1038/s41587-019-0164-5">https://doi.org/10.1038/s41587-019-0164-5</a>.
</div>
<div id="ref-singh_rna_2019" class="csl-entry" role="listitem">
Singh, Jaswinder, Jack Hanson, Kuldip Paliwal, and Yaoqi Zhou. 2019. <span>“<span>RNA</span> Secondary Structure Prediction Using an Ensemble of Two-Dimensional Deep Neural Networks and Transfer Learning.”</span> <em>Nature Communications</em> 10 (1): 5407. <a href="https://doi.org/10.1038/s41467-019-13395-9">https://doi.org/10.1038/s41467-019-13395-9</a>.
</div>
<div id="ref-spitale_structural_2015" class="csl-entry" role="listitem">
Spitale, Robert C., Ryan A. Flynn, Qiangfeng Cliff Zhang, Pete Crisalli, Byron Lee, Jee-Wook Jung, Hannes Y. Kuchelmeister, et al. 2015. <span>“Structural Imprints in Vivo Decode <span>RNA</span> Regulatory Mechanisms.”</span> <em>Nature</em> 519 (7544): 486–90. <a href="https://doi.org/10.1038/nature14263">https://doi.org/10.1038/nature14263</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_5/p5--cellular-context.html" class="pagination-link" aria-label="Part V: Cellular Context">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part V: Cellular Context</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_5/p5-ch20-single-cell.html" class="pagination-link" aria-label="Single-Cell Models">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>