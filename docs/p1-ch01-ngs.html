<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Sequencing: From Reads to Variants – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p1-ch02-data.html" rel="next">
<link href="./p1--foundations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation and Tokenization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Models for Genomic Sequence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Attention and Transformers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives and Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning and Adaptation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Long-Context Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Variant Effect Prediction with Foundation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p4--multi-scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Multi-Scale Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">RNA Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Single-Cell and Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">3D Genome and Spatial Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch18-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Gap Analysis: Chapter 18 Networks and Graph-Based Reasoning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch19-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic AI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Evaluation Methodology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch23-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch24-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretability and Mechanism</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Rare Disease and Variant Interpretation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Drug Discovery and Target Identification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch28-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Sequence Design and Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch29-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Regulatory, Ethical, and Future Considerations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Training Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-challenge-of-ngs-data" id="toc-the-challenge-of-ngs-data" class="nav-link active" data-scroll-target="#the-challenge-of-ngs-data"><span class="header-section-number">1.1</span> The Challenge of NGS Data</a></li>
  <li><a href="#targeting-strategies-panels-exomes-and-genomes" id="toc-targeting-strategies-panels-exomes-and-genomes" class="nav-link" data-scroll-target="#targeting-strategies-panels-exomes-and-genomes"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</a>
  <ul class="collapse">
  <li><a href="#targeted-and-panel-sequencing" id="toc-targeted-and-panel-sequencing" class="nav-link" data-scroll-target="#targeted-and-panel-sequencing"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</a></li>
  <li><a href="#whole-exome-sequencing" id="toc-whole-exome-sequencing" class="nav-link" data-scroll-target="#whole-exome-sequencing"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</a></li>
  <li><a href="#whole-genome-sequencing" id="toc-whole-genome-sequencing" class="nav-link" data-scroll-target="#whole-genome-sequencing"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</a></li>
  <li><a href="#long-read-sequencing-technologies" id="toc-long-read-sequencing-technologies" class="nav-link" data-scroll-target="#long-read-sequencing-technologies"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</a></li>
  </ul></li>
  <li><a href="#classical-variant-calling-pipelines" id="toc-classical-variant-calling-pipelines" class="nav-link" data-scroll-target="#classical-variant-calling-pipelines"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</a>
  <ul class="collapse">
  <li><a href="#from-sequencer-to-aligned-reads" id="toc-from-sequencer-to-aligned-reads" class="nav-link" data-scroll-target="#from-sequencer-to-aligned-reads"><span class="header-section-number">1.3.1</span> From Sequencer to Aligned Reads</a></li>
  <li><a href="#per-sample-variant-calling" id="toc-per-sample-variant-calling" class="nav-link" data-scroll-target="#per-sample-variant-calling"><span class="header-section-number">1.3.2</span> Per-Sample Variant Calling</a></li>
  <li><a href="#cohort-calling-and-filtering" id="toc-cohort-calling-and-filtering" class="nav-link" data-scroll-target="#cohort-calling-and-filtering"><span class="header-section-number">1.3.3</span> Cohort Calling and Filtering</a></li>
  <li><a href="#sample-level-quality-control" id="toc-sample-level-quality-control" class="nav-link" data-scroll-target="#sample-level-quality-control"><span class="header-section-number">1.3.4</span> Sample-Level Quality Control</a></li>
  </ul></li>
  <li><a href="#haplotype-phasing" id="toc-haplotype-phasing" class="nav-link" data-scroll-target="#haplotype-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</a>
  <ul class="collapse">
  <li><a href="#clinical-and-analytical-importance" id="toc-clinical-and-analytical-importance" class="nav-link" data-scroll-target="#clinical-and-analytical-importance"><span class="header-section-number">1.4.1</span> Clinical and Analytical Importance</a></li>
  <li><a href="#phasing-methods" id="toc-phasing-methods" class="nav-link" data-scroll-target="#phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</a></li>
  <li><a href="#genotype-imputation" id="toc-genotype-imputation" class="nav-link" data-scroll-target="#genotype-imputation"><span class="header-section-number">1.4.3</span> Genotype Imputation</a></li>
  </ul></li>
  <li><a href="#sources-of-error-and-uncertainty" id="toc-sources-of-error-and-uncertainty" class="nav-link" data-scroll-target="#sources-of-error-and-uncertainty"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</a>
  <ul class="collapse">
  <li><a href="#mapping-ambiguity-and-reference-bias" id="toc-mapping-ambiguity-and-reference-bias" class="nav-link" data-scroll-target="#mapping-ambiguity-and-reference-bias"><span class="header-section-number">1.5.1</span> Mapping Ambiguity and Reference Bias</a></li>
  <li><a href="#systematic-sequencing-artifacts" id="toc-systematic-sequencing-artifacts" class="nav-link" data-scroll-target="#systematic-sequencing-artifacts"><span class="header-section-number">1.5.2</span> Systematic Sequencing Artifacts</a></li>
  <li><a href="#coverage-gaps-and-allelic-imbalance" id="toc-coverage-gaps-and-allelic-imbalance" class="nav-link" data-scroll-target="#coverage-gaps-and-allelic-imbalance"><span class="header-section-number">1.5.3</span> Coverage Gaps and Allelic Imbalance</a></li>
  <li><a href="#complex-variants-and-representation" id="toc-complex-variants-and-representation" class="nav-link" data-scroll-target="#complex-variants-and-representation"><span class="header-section-number">1.5.4</span> Complex Variants and Representation</a></li>
  </ul></li>
  <li><a href="#difficult-regions-the-limits-of-short-read-calling" id="toc-difficult-regions-the-limits-of-short-read-calling" class="nav-link" data-scroll-target="#difficult-regions-the-limits-of-short-read-calling"><span class="header-section-number">1.6</span> Difficult Regions: The Limits of Short-Read Calling</a>
  <ul class="collapse">
  <li><a href="#segmental-duplications-and-gene-families" id="toc-segmental-duplications-and-gene-families" class="nav-link" data-scroll-target="#segmental-duplications-and-gene-families"><span class="header-section-number">1.6.1</span> Segmental Duplications and Gene Families</a></li>
  <li><a href="#low-complexity-and-repetitive-sequence" id="toc-low-complexity-and-repetitive-sequence" class="nav-link" data-scroll-target="#low-complexity-and-repetitive-sequence"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</a></li>
  <li><a href="#the-hla-region-a-case-study-in-complexity" id="toc-the-hla-region-a-case-study-in-complexity" class="nav-link" data-scroll-target="#the-hla-region-a-case-study-in-complexity"><span class="header-section-number">1.6.3</span> The HLA Region: A Case Study in Complexity</a></li>
  </ul></li>
  <li><a href="#benchmarking-and-ground-truth" id="toc-benchmarking-and-ground-truth" class="nav-link" data-scroll-target="#benchmarking-and-ground-truth"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</a>
  <ul class="collapse">
  <li><a href="#giab-reference-samples" id="toc-giab-reference-samples" class="nav-link" data-scroll-target="#giab-reference-samples"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</a></li>
  <li><a href="#metrics-and-their-meaning" id="toc-metrics-and-their-meaning" class="nav-link" data-scroll-target="#metrics-and-their-meaning"><span class="header-section-number">1.7.2</span> Metrics and Their Meaning</a></li>
  <li><a href="#limitations-of-benchmarks" id="toc-limitations-of-benchmarks" class="nav-link" data-scroll-target="#limitations-of-benchmarks"><span class="header-section-number">1.7.3</span> Limitations of Benchmarks</a></li>
  </ul></li>
  <li><a href="#sec-deepvar" id="toc-sec-deepvar" class="nav-link" data-scroll-target="#sec-deepvar"><span class="header-section-number">1.8</span> DeepVariant: Variant Calling as Image Classification</a>
  <ul class="collapse">
  <li><a href="#pileup-images-as-input" id="toc-pileup-images-as-input" class="nav-link" data-scroll-target="#pileup-images-as-input"><span class="header-section-number">1.8.1</span> Pileup Images as Input</a></li>
  <li><a href="#architecture-and-training" id="toc-architecture-and-training" class="nav-link" data-scroll-target="#architecture-and-training"><span class="header-section-number">1.8.2</span> Architecture and Training</a></li>
  <li><a href="#cohort-calling-with-glnexus" id="toc-cohort-calling-with-glnexus" class="nav-link" data-scroll-target="#cohort-calling-with-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with GLnexus</a></li>
  <li><a href="#comparison-with-classical-approaches" id="toc-comparison-with-classical-approaches" class="nav-link" data-scroll-target="#comparison-with-classical-approaches"><span class="header-section-number">1.8.4</span> Comparison with Classical Approaches</a></li>
  </ul></li>
  <li><a href="#implications-for-genomic-deep-learning" id="toc-implications-for-genomic-deep-learning" class="nav-link" data-scroll-target="#implications-for-genomic-deep-learning"><span class="header-section-number">1.9</span> Implications for Genomic Deep Learning</a>
  <ul class="collapse">
  <li><a href="#variants-as-atomic-units" id="toc-variants-as-atomic-units" class="nav-link" data-scroll-target="#variants-as-atomic-units"><span class="header-section-number">1.9.1</span> Variants as Atomic Units</a></li>
  <li><a href="#inherited-biases-and-blind-spots" id="toc-inherited-biases-and-blind-spots" class="nav-link" data-scroll-target="#inherited-biases-and-blind-spots"><span class="header-section-number">1.9.2</span> Inherited Biases and Blind Spots</a></li>
  <li><a href="#effect-sizes-across-the-frequency-spectrum" id="toc-effect-sizes-across-the-frequency-spectrum" class="nav-link" data-scroll-target="#effect-sizes-across-the-frequency-spectrum"><span class="header-section-number">1.9.3</span> Effect Sizes Across the Frequency Spectrum</a></li>
  <li><a href="#toward-end-to-end-learning" id="toc-toward-end-to-end-learning" class="nav-link" data-scroll-target="#toward-end-to-end-learning"><span class="header-section-number">1.9.4</span> Toward End-to-End Learning</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ngs" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Modern genomics rests on a paradox. We can sequence a human genome for a few hundred dollars and store millions of genomes in continental biobanks, yet we cannot reliably interpret most of the variants we discover. A newborn screening program can identify thousands of rare variants in an infant’s genome before discharge, but clinicians can confidently act on fewer than a hundred. The flood of sequence data vastly outpaces our ability to distinguish true biological variation from technical artifact, let alone to predict which variants matter for disease or drug response. Every analysis downstream, from polygenic scores to clinical variant interpretation, assumes that this upstream conversion from sequencing reads to variant calls has already succeeded. When it fails, every subsequent model inherits those errors.</p>
<p>This asymmetry between data generation and interpretation defines the central challenge of genomic medicine. Variant calls represent the atoms that later models operate on: polygenic risk scores treat variants as weighted features, regulatory sequence models learn from patterns around variant sites, and clinical interpretation systems classify individual variants as pathogenic or benign. None of these systems question whether the variants they receive are real. They assume the upstream pipeline has already solved the problem of separating signal from noise, true variation from systematic artifact, inherited germline mutations from somatic changes acquired during life. Understanding where that assumption breaks down, and how deep learning has begun to address those failures, establishes the foundation for everything that follows in this book.</p>
<section id="the-challenge-of-ngs-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-challenge-of-ngs-data"><span class="header-section-number">1.1</span> The Challenge of NGS Data</h2>
<p>The human genome contains approximately three billion base pairs, yet no instrument can read this sequence in one continuous stretch. <strong>Next-generation sequencing (NGS)</strong> instead fragments DNA molecules into short pieces, sequences each fragment independently, and produces tens to hundreds of gigabases of sequence data per run <span class="citation" data-cites="goodwin_10year_2016">(<a href="references.html#ref-goodwin_10year_2016" role="doc-biblioref">Goodwin, McPherson, and McCombie 2016</a>)</span>. The typical output consists of paired-end Illumina reads spanning 100 to 300 base pairs each, with each base assigned a quality score reflecting the instrument’s confidence in that call. This abundance comes at a cost: every read carries non-trivial measurement uncertainty, including substitutions from miscalled bases, context-specific errors near homopolymers, and quality degradation toward read ends.</p>
<p>Long-read technologies from Pacific Biosciences and Oxford Nanopore extend the observable space dramatically, producing reads of 10 kilobases to over a megabase in length <span class="citation" data-cites="wenger_pacbiohifi_2019 dabernig_ont_2024">(<a href="references.html#ref-wenger_pacbiohifi_2019" role="doc-biblioref">Wenger et al. 2019</a>; <a href="references.html#ref-dabernig_ont_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>. These platforms access genomic territory invisible to short reads, including complex structural variants, segmental duplications, and repetitive regions. They carry their own characteristic error profiles, however, and the choice of sequencing platform fundamentally shapes which variants are discoverable and which systematic biases enter downstream analyses. A variant residing within a repetitive element may be invisible to short reads but readily detected by long reads that span the entire repeat.</p>
<p>The central problem is deceptively simple in statement but profound in consequence: how do we turn raw reads into a reliable list of genomic variants? Answering this question requires disentangling three fundamentally different sources of signal that manifest identically as mismatches between reads and reference. Sequencing errors arise from instrument noise and PCR artifacts during library preparation, creating false variants that never existed in the original DNA. Alignment artifacts occur when reads are mapped to incorrect genomic locations, particularly in repetitive regions and paralogous gene families, causing true variants to appear at wrong positions or disappear entirely. Genuine biological variation encompasses germline variants inherited from parents, somatic mutations acquired during cellular division, and mosaicism where only a fraction of cells carry a particular change. Historically, complex modular pipelines combining probabilistic models and hand-crafted heuristics addressed this separation <span class="citation" data-cites="nielsen_error_2011">(<a href="references.html#ref-nielsen_error_2011" role="doc-biblioref">Nielsen et al. 2011</a>)</span>. Deep learning now plays an important role in simplifying and improving parts of this stack, but understanding the classical pipeline remains essential for interpreting what downstream models actually learn.</p>
<p>The scope of this chapter centers on germline variant calling in human whole-exome sequencing (WES) and whole-genome sequencing (WGS) data, the core technical challenge underlying most genomic deep learning applications. Somatic variant calling in cancer and RNA-seq-specific variant calling share many parallels but require additional considerations that fall outside Part I of this book.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Overview schematic of an NGS variant-calling workflow, from DNA sample → library prep → sequencer (short vs.&nbsp;long read) → FASTQ → alignment → duplicate marking → BQSR → variant calling → filtering → VCF.</p>
</div>
</div>
</section>
<section id="targeting-strategies-panels-exomes-and-genomes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="targeting-strategies-panels-exomes-and-genomes"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</h2>
<p>Different clinical and scientific goals demand different sequencing strategies. A patient presenting with sudden cardiac arrest at age 35 needs deep, reliable coverage of <em>KCNQ1</em>, <em>KCNH2</em>, <em>SCN5A</em>, and other ion channel genes associated with long QT syndrome; sequencing her entire genome to find these variants would waste resources and delay clinical decisions. A biobank building training data for polygenic risk scores across hundreds of thousands of participants needs genome-wide coverage, even if individual sites have modest depth. A family searching for the cause of their child’s undiagnosed developmental delay needs comprehensive coverage that leaves no coding exon unexamined. These competing demands drive the choice between targeted panels, whole-exome sequencing, and whole-genome sequencing.</p>
<section id="targeted-and-panel-sequencing" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="targeted-and-panel-sequencing"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</h3>
<p>When clinicians already know which genes to examine, <strong>targeted gene panels</strong> capture tens to hundreds of genes selected for a specific clinical indication. Panels for cardiomyopathy, hereditary cancer syndromes, or epilepsy restrict sequencing to regions of known clinical relevance. By limiting the target to a small number of loci, panels achieve very deep coverage (often exceeding 500×) at modest cost, enabling sensitive detection of rare variants and some degree of mosaicism.</p>
<p>The narrow scope of panels limits their utility for deep learning and population-scale analysis. Panels miss novel disease genes outside their predefined targets, cannot be easily repurposed for new traits, and often have heterogeneous content across laboratories that complicates data aggregation. For large-scale genomic foundation models, panel data serve better as richly phenotyped anchors than as primary training material: they provide clean labels for specific variants but sparse genomic coverage overall.</p>
</section>
<section id="whole-exome-sequencing" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="whole-exome-sequencing"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</h3>
<p>Protein-coding sequence represents approximately 1 to 2 percent of the genome but harbors a disproportionate share of variants with known functional consequences. <strong>Whole-exome sequencing (WES)</strong> enriches coding exons and some splice-adjacent regions through hybridization probes that pull down targeted DNA, followed by short-read sequencing. Typical coverage ranges from 80 to 150× for exonic targets, sufficient for confident heterozygous variant calling in most regions.</p>
<p>WES has driven Mendelian disease gene discovery for over a decade and powered early biobank-scale efforts, including the exome subsets of gnomAD and many hospital-based cohorts <span class="citation" data-cites="karczewski_gnomad_2020">(<a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. The capture-based approach introduces systematic biases that propagate into downstream analyses, however. Certain exons consistently fail to capture efficiently, particularly those with extreme GC content, high repetitive content, or unusual length. A variant in the first exon of <em>HTT</em> (the Huntington disease gene) might be missed entirely due to extreme GC richness, and a variant effect predictor trained on WES data will never encounter variants in poorly captured regions. These blind spots are invisible in standard benchmarks but can have substantial clinical consequences. Batch effects tied to reagent lots and evolving panel designs further complicate multi-cohort analyses.</p>
</section>
<section id="whole-genome-sequencing" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="whole-genome-sequencing"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</h3>
<p>Noncoding variants contribute substantially to human disease, and structural variants often span boundaries between exonic and intronic sequence. <strong>Whole-genome sequencing (WGS)</strong> samples nearly all bases in the genome at typical coverage of 30 to 60×, encompassing both coding and noncoding regions without the biases introduced by capture chemistry. Because there is no enrichment step, WGS produces more uniform depth than WES and enables detection of noncoding regulatory variants, structural variants, and copy-number changes alongside <strong>single nucleotide variants (SNVs)</strong> and <strong>indels</strong> (insertions and deletions).</p>
<p>WGS has become increasingly favored for new large cohorts and rare disease studies. The UK Biobank’s release of 500,000 whole genomes and gnomAD’s expansion to include diverse populations both rely on WGS as the primary data type <span class="citation" data-cites="bycroft_ukbiobank_2018 karczewski_gnomad_2020">(<a href="references.html#ref-bycroft_ukbiobank_2018" role="doc-biblioref">Bycroft et al. 2018</a>; <a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. The data are reusable for many downstream analyses, including GWAS, polygenic score development, and rare variant burden tests, and the simplified pipeline eliminates the need to track changing capture designs across time and centers. When subsequent chapters refer to “whole-genome models,” they implicitly assume access to WGS-based variant calls, even when actual training sets combine WES and WGS data for practical reasons.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Comparative table or radar plot for panels, WES, WGS (and possibly long-read WGS) summarizing target size, typical coverage depth, per-sample cost, ability to detect rare variants, and suitability for large-cohort foundation model training.</p>
</div>
</div>
</section>
<section id="long-read-sequencing-technologies" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="long-read-sequencing-technologies"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</h3>
<p>Short reads face a fundamental limitation rooted in information theory: sequences shorter than local repeats, segmental duplications, or structural variants cannot unambiguously resolve these features. Consider the <em>SMN1</em> and <em>SMN2</em> genes, which differ by only five nucleotides across their entire coding regions. Distinguishing them is clinically critical for diagnosing spinal muscular atrophy, yet short reads routinely fail this task because a 150-bp read maps equally well to either genomic location.</p>
<p>Pacific Biosciences (PacBio) HiFi sequencing produces reads of 10 to 25 kilobases with per-base accuracy exceeding 99.9% through circular consensus sequencing, where the same molecule is read multiple times to correct random errors <span class="citation" data-cites="wenger_pacbiohifi_2019">(<a href="references.html#ref-wenger_pacbiohifi_2019" role="doc-biblioref">Wenger et al. 2019</a>)</span>. Oxford Nanopore Technologies (ONT) instruments generate reads ranging from a few kilobases to over a megabase in length, with rapidly improving raw accuracy and unique capabilities including portable sequencers suitable for field deployment, direct RNA sequencing without reverse transcription, and real-time base calling during sequencing <span class="citation" data-cites="dabernig_ont_2024">(<a href="references.html#ref-dabernig_ont_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>. These technologies played central roles in the telomere-to-telomere (T2T) assembly of a complete human genome and in emerging human pangenome references that capture population diversity beyond what any single linear reference can represent <span class="citation" data-cites="nurk_complete_2022 liao_pangenome_2023">(<a href="references.html#ref-nurk_complete_2022" role="doc-biblioref">Nurk et al. 2022</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Long reads transform variant calling by traversing low-complexity and repetitive regions essentially invisible to short-read technologies. Dedicated variant callers such as PEPPER-Margin-DeepVariant <span class="citation" data-cites="shafin_pepper_2021">(<a href="references.html#ref-shafin_pepper_2021" role="doc-biblioref">Shafin et al. 2021</a>)</span>, Clair3 <span class="citation" data-cites="zheng_clair3_2022">(<a href="references.html#ref-zheng_clair3_2022" role="doc-biblioref">Zheng et al. 2022</a>)</span>, Sniffles2 <span class="citation" data-cites="smolka_sniffles2_2024">(<a href="references.html#ref-smolka_sniffles2_2024" role="doc-biblioref">Smolka et al. 2024</a>)</span>, <code>pbsv</code> <span class="citation" data-cites="noauthor_pbsv_2025">(<a href="references.html#ref-noauthor_pbsv_2025" role="doc-biblioref"><span>“<span>PacificBiosciences</span>/Pbsv”</span> 2025</a>)</span>, and cuteSV <span class="citation" data-cites="jiang_cutesv_2020">(<a href="references.html#ref-jiang_cutesv_2020" role="doc-biblioref">Jiang et al. 2020</a>)</span> exploit read length and alignment patterns to detect insertions, deletions, inversions, and complex rearrangements. Single molecules spanning multiple heterozygous sites provide direct phasing information for <strong>haplotype</strong> resolution without statistical inference. Long reads also inform graph-based references and pangenomes that better represent population diversity than traditional linear references <span class="citation" data-cites="liao_pangenome_2023">(<a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Short-read pipelines remain the workhorse for large human cohorts due to cost and throughput advantages that will persist for years. The models discussed in later chapters must accommodate variants discovered by either technology and must be evaluated on composite callsets that integrate short- and long-read information.</p>
</section>
</section>
<section id="classical-variant-calling-pipelines" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="classical-variant-calling-pipelines"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</h2>
<p>Understanding classical approaches matters not merely for historical completeness but because deep learning models like DeepVariant still operate within this overall framework. They replace specific components rather than rebuilding from scratch. The GATK Best Practices, first formalized around 2011 and refined continuously since, represent accumulated wisdom from a decade of methodological development <span class="citation" data-cites="depristo_gatk_2011 van_der_auwera_gatk_best_2018">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="references.html#ref-van_der_auwera_gatk_best_2018" role="doc-biblioref">Van der Auwera et al. 2018</a>)</span>. These pipelines encode expert intuition about which quality metrics matter, how to balance sensitivity against specificity, and when borderline evidence should be trusted. Modern deep learning approaches inherit this structure even as they replace individual components with learned alternatives.</p>
<section id="from-sequencer-to-aligned-reads" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="from-sequencer-to-aligned-reads"><span class="header-section-number">1.3.1</span> From Sequencer to Aligned Reads</h3>
<p>The journey from DNA sample to variant calls begins when instrument software converts fluorescent images or electrical signals to base calls and quality scores through <strong>base calling</strong>. Reads are demultiplexed by sample barcode into <code>FASTQ</code> files, each containing millions of short sequences with associated Phred-scaled quality scores. These files serve as the raw material for all subsequent analysis, encoding both the sequence content and the instrument’s confidence in each base.</p>
<p><strong>Read alignment</strong> maps each short read to its most likely position in a reference genome using seed-and-extend algorithms implemented in tools such as BWA-MEM and minimap2 <span class="citation" data-cites="li_bwa-mem_2013 li_minimap2_2018">(<a href="references.html#ref-li_bwa-mem_2013" role="doc-biblioref">Li 2013</a>, <a href="references.html#ref-li_minimap2_2018" role="doc-biblioref">2018</a>)</span>. The current standard references include GRCh38 (the traditional linear reference) and T2T-CHM13 (the first complete telomere-to-telomere assembly). The alignment challenge is substantial: algorithms must cope with mismatches arising from both true variants and sequencing errors, small indels that shift the alignment frame, and repetitive sequences where multiple genomic locations match equally well. When a read could plausibly originate from several locations, the aligner must either choose one (potentially incorrectly), report multiple candidates, or assign a mapping quality score reflecting its uncertainty about the true origin.</p>
<p><strong>Post-alignment processing</strong> addresses systematic artifacts that would otherwise corrupt variant calls. PCR duplicates arise when multiple reads are amplified from the same original DNA fragment during library preparation; these inflate apparent coverage and can amplify sequencing errors into false variants that appear well-supported. Duplicate marking identifies and flags these reads based on identical alignment coordinates. <strong>Base quality score recalibration (BQSR)</strong> models systematic quality score errors by comparing observed mismatches to databases of known variants, adjusting quality scores to better reflect true error rates in each sequence context <span class="citation" data-cites="depristo_gatk_2011">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>)</span>. Older pipelines also performed local realignment around indels, though modern callers have largely internalized this step.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Block diagram of a short-read variant calling pipeline, with each step (alignment, duplicate marking, BQSR, per-sample calling, joint genotyping, filtering) shown as a box and data formats (FASTQ, BAM/CRAM, gVCF, VCF) annotated along the arrows.</p>
</div>
</div>
</section>
<section id="per-sample-variant-calling" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="per-sample-variant-calling"><span class="header-section-number">1.3.2</span> Per-Sample Variant Calling</h3>
<p>At each position in the genome, the fundamental question is: given the reads overlapping this site, what is the most likely genotype? For diploid humans at biallelic sites, three possibilities exist: homozygous reference (0/0), heterozygous (0/1), or homozygous alternate (1/1). The task is to compute <strong>genotype likelihoods</strong> that quantify the probability of the observed read data under each possible genotype, then combine these likelihoods with prior expectations to estimate posterior probabilities.</p>
<p>GATK HaplotypeCaller approaches this by first identifying regions with evidence of variation, then locally assembling candidate haplotypes from the reads spanning that region, and finally computing likelihoods for each possible diploid genotype. The core calculation uses a <strong>pair hidden Markov model (pair-HMM)</strong> to marginalize over possible alignments between each read and each candidate haplotype, incorporating base quality scores to weight the contribution of each base <span class="citation" data-cites="depristo_gatk_2011 li_mapping_2014">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>.</p>
<p>The mathematical framework is Bayesian. At a given site, the posterior probability of genotype <span class="math inline">\(G\)</span> given read data <span class="math inline">\(D\)</span> follows from Bayes’ theorem:</p>
<p><span class="math display">\[
P(G \mid D) \propto P(G) \prod_{r \in \text{reads}} P(r \mid G)
\]</span></p>
<p>The prior <span class="math inline">\(P(G)\)</span> often assumes Hardy-Weinberg equilibrium with a specified allele frequency, while the likelihood <span class="math inline">\(P(r \mid G)\)</span> captures the probability of observing read <span class="math inline">\(r\)</span> given that the true genotype is <span class="math inline">\(G\)</span>. This formulation assumes conditional independence of reads given the genotype, an assumption violated in practice by systematic sequencing errors, read pair correlations, and library-level artifacts that create dependencies among observations. Classical pipelines attempt to correct for these violations through BQSR and ad hoc filters. Deep learning-based callers can learn these dependencies implicitly by processing entire pileups simultaneously, one of their key advantages.</p>
<p>The per-read likelihoods aggregate into genotype likelihoods, which combine with priors to yield posterior probabilities. These posteriors become the <strong>genotype quality (GQ)</strong> scores that downstream analyses often treat as ground truth. Per-sample results are output as <code>gVCF</code> files encoding both variant calls and “reference blocks” with estimated confidence at non-variant positions, enabling later joint analysis across samples.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Small schematic showing reads aligned at a single site, illustrating how each read contributes to the likelihood term in the Bayesian genotype model (e.g., three reads supporting the alternate allele with different base qualities).</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The VCF Format The Variant Call Format (VCF) is the standard file format for storing variant calls. Each variant occupies one row with mandatory columns: CHROM and POS specify genomic location; REF and ALT give the reference and alternate alleles; QUAL provides a Phred-scaled quality score; FILTER indicates whether the variant passed quality filters; and INFO contains semicolon-delimited annotations such as allele frequency or functional predictions. For multi-sample files, a FORMAT column defines per-sample fields (typically GT for genotype, GQ for genotype quality, DP for depth), followed by one column per sample containing those values. Genotypes are encoded as allele indices separated by / (unphased) or | (phased), where 0 represents the reference allele and 1 the first alternate. A heterozygous call appears as 0/1; a phased heterozygote as 0|1 or 1|0 depending on which allele was inherited maternally versus paternally.</p>
</div>
</div>
</section>
<section id="cohort-calling-and-filtering" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="cohort-calling-and-filtering"><span class="header-section-number">1.3.3</span> Cohort Calling and Filtering</h3>
<p>Individual samples rarely provide sufficient information for confident rare variant calling. A variant observed in only one sample with modest supporting reads might be a true rare variant or a systematic artifact; examining a single sample cannot distinguish these possibilities. Examining the same site across thousands of samples resolves this ambiguity: true variants appear in multiple individuals following population genetic expectations, while artifacts show patterns inconsistent with inheritance and population structure.</p>
<p>Joint genotyping combines gVCFs across many samples to produce a multi-sample <code>VCF</code>. This process ensures that all samples are evaluated at the same candidate sites, avoiding the problem of comparing different variant lists, and pools information across carriers to improve sensitivity for rare variants. A variant with marginal evidence in three individuals gains credibility when those individuals share ancestry and the variant frequency matches population expectations from external databases.</p>
<p>Filtering strategies separate high-confidence variants from probable artifacts. Early approaches applied independent thresholds on quality metrics such as depth, mapping quality, and strand bias, but these hard filters poorly captured the complex, multivariate patterns distinguishing true variants from errors. <strong>Variant Quality Score Recalibration (VQSR)</strong> instead trains a Gaussian mixture model on known true positives from validated resources (HapMap, 1000 Genomes) and likely false positives, learning a composite quality score that integrates multiple annotation dimensions <span class="citation" data-cites="depristo_gatk_2011">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>)</span>. This approach dominated large-scale variant calling for a decade before machine learning methods began to replace it.</p>
</section>
<section id="sample-level-quality-control" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="sample-level-quality-control"><span class="header-section-number">1.3.4</span> Sample-Level Quality Control</h3>
<p>Before any downstream analysis or model training, variant callsets must pass through sample-level quality control. Sex checks compare reported sex to X chromosome heterozygosity and Y chromosome coverage to detect sample swaps or sex chromosome aneuploidy. Contamination analysis estimates whether DNA from multiple individuals mixed during sample preparation, which would create apparent heterozygosity at sites where the individual is actually homozygous. Relatedness detection identifies unexpected relatives or duplicate sequencing of the same individual, both of which confound association analyses and inflate apparent sample sizes. <strong>Ancestry inference</strong> estimates genetic ancestry using principal component analysis or model-based clustering, which matters for controlling population stratification in downstream analyses (<a href="p5-ch22-confounding.html" class="quarto-xref"><span>Chapter 22</span></a>).</p>
<p>These QC steps determine which samples enter training sets, how models are stratified by ancestry, and which samples must be excluded due to technical artifacts. When subsequent chapters refer to “a callset,” they implicitly assume that careful QC has already been applied.</p>
</section>
</section>
<section id="haplotype-phasing" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="haplotype-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</h2>
<p>The clinical stakes of phasing emerge clearly in compound heterozygosity. Consider a child who inherits two rare, potentially pathogenic variants in <em>CFTR</em>, the cystic fibrosis gene. If both variants reside on the chromosome inherited from the mother (in <em>cis</em>), the child retains one functional copy from the father and may be unaffected or merely a carrier. If the variants are on opposite chromosomes (in <em>trans</em>), no functional copy exists and the child will develop cystic fibrosis. Standard <code>VCF</code> genotypes cannot distinguish these scenarios, encoding only that heterozygous genotypes exist at two positions without specifying which alleles travel together on the same physical chromosome. The clinical implications are entirely different, yet the data appear identical without phase information.</p>
<p>Diploid organisms carry two copies of each autosomal chromosome, one inherited from each parent. <strong>Haplotype phasing</strong> resolves the ambiguity in unphased genotype calls by assigning each allele to a specific parental chromosome, transforming genotypes such as <code>0/1</code> into phased representations like <code>0|1</code> or <code>1|0</code> where the delimiter indicates that phase has been determined.</p>
<section id="clinical-and-analytical-importance" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="clinical-and-analytical-importance"><span class="header-section-number">1.4.1</span> Clinical and Analytical Importance</h3>
<p>The distinction between <em>cis</em> and <em>trans</em> configurations drives clinical decisions for recessive conditions across hundreds of disease genes, from metabolic disorders to hearing loss to retinal degeneration. Beyond compound heterozygosity, phased haplotypes enable several critical analyses. <strong>Haplotype-specific expression</strong> studies reveal allelic imbalance where one parental copy is preferentially transcribed, a phenomenon with implications for imprinting disorders and variable penetrance. Accurate modeling of <strong>linkage disequilibrium (LD)</strong> structure in population genetics depends on knowing which alleles are inherited together. Reference panels used for genotype imputation are stored as phased haplotypes; inaccurate phasing in these panels propagates errors to every study that uses them for imputation.</p>
<p>For deep learning applications, phasing determines whether models receive unordered genotype pairs or structured, haplotype-resolved representations. This choice affects model architecture, training procedures, and ultimately performance. A model that processes phased haplotypes can learn patterns spanning multiple variant sites that would appear as noise in unphased data.</p>
</section>
<section id="phasing-methods" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</h3>
<p>Different data types enable different phasing strategies, each with characteristic strengths and resolution. <strong>Read-backed phasing</strong> uses sequencing reads that span multiple heterozygous sites to assign alleles to the same physical molecule. Short reads typically phase variants within tens to hundreds of base pairs, limited by fragment length. Long reads extend this range to tens of kilobases or more, providing direct physical evidence of haplotype structure.</p>
<p><strong>Statistical phasing</strong> tools such as SHAPEIT, Eagle, and Beagle use reference panels of previously phased haplotypes combined with linkage disequilibrium patterns to infer phase across much longer distances <span class="citation" data-cites="oconnell_shapeit2_2014 loh_eagle_2016 browning_beagle_2021">(<a href="references.html#ref-oconnell_shapeit2_2014" role="doc-biblioref">O’Connell et al. 2014</a>; <a href="references.html#ref-loh_eagle_2016" role="doc-biblioref">Loh et al. 2016</a>; <a href="references.html#ref-browning_beagle_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>. When a study sample shares long haplotype segments with individuals in the reference panel, the algorithm can confidently assign alleles to chromosomes even without direct read evidence. These methods work well for common variation where LD is informative but struggle with rare variants that lack haplotype context in reference panels.</p>
<p><strong>Pedigree-based phasing</strong> becomes possible when parent-offspring trios or larger families are available. Mendelian inheritance rules resolve phase with high confidence: an allele present in the child and one parent but absent in the other must have been inherited from that parent. The deterministic nature of this inference makes it the gold standard when family data exist.</p>
<p>Modern pipelines often combine these approaches, using statistical phasing anchored by a large reference panel, augmented by read-backed evidence where available, and refined by trio data when present. The resulting phase accuracy varies by variant frequency, local recombination rate, and representation in reference panels.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Table or multi-panel cartoon comparing phasing strategies: axes for input data (short reads, long reads, trios, population reference), typical genomic span per phased block, and typical use cases (imputation, rare disease, population genetics).</p>
</div>
</div>
</section>
<section id="genotype-imputation" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="genotype-imputation"><span class="header-section-number">1.4.3</span> Genotype Imputation</h3>
<p>Sequencing every individual at high coverage is expensive, but statistical inference from population structure can fill gaps at much lower cost. <strong>Genotype imputation</strong> matches a cohort with incomplete genotype data (from array genotyping or low-coverage sequencing) against a reference panel of densely phased haplotypes. Statistical models infer missing genotypes and refine uncertain calls by leveraging LD patterns and shared haplotype segments with individuals in the reference <span class="citation" data-cites="browning_beagle_2021">(<a href="references.html#ref-browning_beagle_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>.</p>
<p>Two related processes deserve distinction. <strong>Genotype refinement</strong> improves quality at sites where genotypes were already measured but with uncertainty, particularly useful in low-coverage WGS or WES where stochastic sampling creates noisy calls. <strong>Imputation of untyped variants</strong> infers genotypes at positions not directly observed in the study cohort but present in the reference panel, dramatically increasing variant density without additional sequencing.</p>
<p>For downstream deep learning, imputation has several important consequences. It increases the number of variants available as input features for genotype-based models. It produces well-calibrated genotype probabilities (dosages) that probabilistic models can exploit rather than forcing hard calls. It also ties model performance to the composition and ancestry representation of the reference panel: imputation errors are systematically larger when target individuals come from populations underrepresented in the panel, reinforcing themes of bias and confounding addressed in <a href="p5-ch22-confounding.html" class="quarto-xref"><span>Chapter 22</span></a>.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Cartoon showing how genotype imputation and boosting fill in missing genotypes and refine uncertain calls using a reference panel of phased haplotypes, with before/after views of a sparse vs.&nbsp;dense genotype matrix.</p>
</div>
</div>
</section>
</section>
<section id="sources-of-error-and-uncertainty" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sources-of-error-and-uncertainty"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</h2>
<p>Even with sophisticated pipelines, variant calls remain imperfect measurements of biological reality. These errors concentrate in specific genomic contexts and variant types, creating systematic blind spots in training data that downstream models inherit without warning <span class="citation" data-cites="li_mapping_2014">(<a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>. Understanding where errors arise, and why they cluster where they do, is essential for interpreting model performance and designing robust training strategies.</p>
<section id="mapping-ambiguity-and-reference-bias" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="mapping-ambiguity-and-reference-bias"><span class="header-section-number">1.5.1</span> Mapping Ambiguity and Reference Bias</h3>
<p>When reads align almost equally well to multiple genomic locations, no algorithm can confidently determine their true origin. Segmental duplications, paralogous gene families, and repetitive elements create these ambiguous contexts throughout the genome. The consequences flow in both directions: misassigned reads create false positive variants at incorrect locations, while correctly placed reads may be discarded or down-weighted due to mapping uncertainty, creating false negatives.</p>
<p><strong>Reference bias</strong> compounds these problems by systematically favoring detection of reference alleles over alternate alleles. A read carrying a non-reference variant may align slightly worse than an identical read matching the reference due to the mismatch penalty, leading to preferential retention of reference-supporting evidence. This bias causes systematic undercalling of alternate alleles, particularly in highly polymorphic regions or for variants that substantially alter local sequence context. Populations divergent from the reference genome experience more severe reference bias, creating ancestry-correlated error patterns.</p>
</section>
<section id="systematic-sequencing-artifacts" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="systematic-sequencing-artifacts"><span class="header-section-number">1.5.2</span> Systematic Sequencing Artifacts</h3>
<p>Sequencing chemistry introduces predictable error patterns that differ qualitatively from random noise. Homopolymer runs (stretches of identical nucleotides such as AAAAAAA or GGGGGG) cause polymerase slippage during synthesis, generating false indels at rates far exceeding substitution errors. Certain sequence motifs, particularly those with extreme GC content, exhibit systematically elevated error rates that persist even at high coverage. PCR amplification during library preparation can introduce errors early in the process; these errors then propagate into multiple reads, creating correlated false positives that appear well-supported by independent evidence.</p>
<p>Index hopping occurs when sample barcodes are misassigned during multiplexed sequencing, causing variants from one sample to appear spuriously in others sharing the same flow cell. Strand bias, where variant-supporting reads cluster on one strand orientation, often indicates systematic artifact rather than true variation. These patterns create correlated errors that cluster by batch, lane, or library preparation method, and they are difficult to distinguish from rare true variants precisely because they can appear in multiple reads with reasonable quality scores.</p>
</section>
<section id="coverage-gaps-and-allelic-imbalance" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="coverage-gaps-and-allelic-imbalance"><span class="header-section-number">1.5.3</span> Coverage Gaps and Allelic Imbalance</h3>
<p>Stochastic sampling means some genomic regions receive fewer reads than average purely by chance, even when capture or sequencing is nominally uniform. In these low-coverage regions, one or both alleles may be missed entirely, and allelic balance can deviate substantially from the expected 50:50 ratio in heterozygotes. A heterozygous site with 20× coverage and 10 reads supporting each allele is confidently called; the same site with 4× coverage might show 4 reference reads and 0 alternate reads by chance alone, leading to a false homozygous reference call with no indication that an allele was missed.</p>
<p>Somatic mosaic variants present at low allele fractions face similar detection challenges. A variant present in 10% of cells produces reads indistinguishable in individual quality from sequencing errors at typical coverage depths, requiring specialized statistical methods or very deep sequencing to detect reliably.</p>
</section>
<section id="complex-variants-and-representation" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="complex-variants-and-representation"><span class="header-section-number">1.5.4</span> Complex Variants and Representation</h3>
<p>Small indels near homopolymers, multi-nucleotide variants (MNVs), and overlapping indels present representation challenges beyond simple detection. The same biological event can often be encoded in multiple equivalent ways depending on alignment and normalization conventions. The variant <code>chr1:100 AT&gt;A</code> might alternatively appear as <code>chr1:101 T&gt;-</code>, with different callers and normalization tools potentially choosing different representations for the identical underlying mutation. These equivalent representations complicate comparisons across pipelines and benchmarks; two callsets may disagree on representation while agreeing on biology, or may appear to agree while representing different events.</p>
<p>The deep learning models discussed in later chapters inherit all these errors and uncertainties as their input. If a variant never enters the <code>VCF</code>, no model trained on VCFs can learn its effect. If genotype qualities are miscalibrated, models trained on hard calls may be systematically overconfident in regions where input data are fundamentally noisy. These inherited limitations propagate silently through the analysis chain.</p>
</section>
</section>
<section id="difficult-regions-the-limits-of-short-read-calling" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="difficult-regions-the-limits-of-short-read-calling"><span class="header-section-number">1.6</span> Difficult Regions: The Limits of Short-Read Calling</h2>
<p>Certain genomic regions resist accurate variant calling regardless of algorithmic sophistication, with their difficulty stemming from fundamental properties of sequence structure that challenge alignment and assembly. These regions are disproportionately responsible for discordant calls between pipelines and technologies <span class="citation" data-cites="li_mapping_2014">(<a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>. Their clinical importance often exceeds their representation in training data.</p>
<section id="segmental-duplications-and-gene-families" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="segmental-duplications-and-gene-families"><span class="header-section-number">1.6.1</span> Segmental Duplications and Gene Families</h3>
<p>The <em>CYP2D6</em> gene illustrates how sequence complexity creates clinical blind spots. This gene encodes a cytochrome P450 enzyme responsible for metabolizing approximately 25% of clinically used drugs, including codeine, tamoxifen, and many antidepressants. It resides in a complex genomic region alongside two pseudogenes (<em>CYP2D7</em> and <em>CYP2D8</em>) sharing over 90% sequence identity. Short reads from one copy map almost equally well to another, producing ambiguous alignments that either receive arbitrarily assigned positions or inflated mapping quality scores that mask the underlying uncertainty.</p>
<p>Variant callers operating in this region face an impossible choice between sensitivity and specificity. Conservative approaches undercall true variation to avoid false positives; aggressive approaches call spurious variants in the wrong paralog. A patient’s <em>CYP2D6</em> metabolizer status, critical for drug dosing decisions that can mean the difference between therapeutic efficacy and serious adverse events, may be incorrectly inferred from short-read data alone.</p>
</section>
<section id="low-complexity-and-repetitive-sequence" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="low-complexity-and-repetitive-sequence"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</h3>
<p>Homopolymers, short tandem repeats (STRs), and other low-complexity regions challenge both sequencing chemistry and alignment algorithms. Indel error rates are especially elevated in these contexts, and many pipelines mask or flag these regions as low confidence. Yet variation in repeats can be biologically critical. Triplet repeat expansion disorders including Huntington disease, fragile X syndrome, and myotonic dystrophy arise from unstable repeat sequences that standard short-read pipelines handle poorly. Models trained on callsets that exclude these regions inherit blind spots at clinically important loci.</p>
</section>
<section id="the-hla-region-a-case-study-in-complexity" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="the-hla-region-a-case-study-in-complexity"><span class="header-section-number">1.6.3</span> The HLA Region: A Case Study in Complexity</h3>
<p>The <strong>human leukocyte antigen (HLA)</strong> locus on chromosome 6p21 exemplifies both the biological importance and technical difficulty of complex genomic regions. HLA genes including <em>HLA-A</em>, <em>HLA-B</em>, <em>HLA-C</em>, and <em>HLA-DRB1</em> encode proteins central to immune recognition and represent some of the most polymorphic sequences in the human genome. The region spans several megabases of near-identical sequences interspersed with gene conversions, copy number variation, and pseudogenes.</p>
<p>Standard reference-based alignment fails in HLA because the extreme polymorphism means reads carrying common, well-characterized alleles may match the linear reference genome poorly. A read from the <em>HLA-B*57:01</em> allele (clinically important for predicting abacavir hypersensitivity in HIV treatment) may fail to align or align with low mapping quality, causing systematic undercalling of this medically actionable variant <span class="citation" data-cites="mallal_abacavir_2008">(<a href="references.html#ref-mallal_abacavir_2008" role="doc-biblioref">Mallal et al. 2008</a>)</span>. The same problems affect HLA typing for transplant matching, autoimmune disease association studies, and pharmacogenomic testing across diverse therapeutic areas <span class="citation" data-cites="robinson_hla-db_2020 sakaue_hla_2023">(<a href="references.html#ref-robinson_hla-db_2020" role="doc-biblioref">Robinson et al. 2020</a>; <a href="references.html#ref-sakaue_hla_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>.</p>
<p>Specialized tools address these challenges through alternative strategies. HLA imputation methods use dense reference panels to infer HLA alleles from array genotypes, enabling large-scale association studies that would otherwise require expensive targeted sequencing <span class="citation" data-cites="sakaue_hla_2023">(<a href="references.html#ref-sakaue_hla_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>. Sequence-based typing tools such as T1K perform HLA and <strong>KIR (killer immunoglobulin-like receptor)</strong> genotyping directly from WES, WGS, or RNA-seq data by aligning reads against allele databases rather than the linear reference <span class="citation" data-cites="song_t1k_2022">(<a href="references.html#ref-song_t1k_2022" role="doc-biblioref">Song et al. 2022</a>)</span>. Graph-based approaches incorporate known HLA alleles as alternate paths through the region, improving both alignment and variant calling <span class="citation" data-cites="garrison_vgtool_2018 liao_pangenome_2023">(<a href="references.html#ref-garrison_vgtool_2018" role="doc-biblioref">Garrison et al. 2018</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>HLA exemplifies a broader principle: regions that are biologically rich and clinically actionable are often technically difficult. Deep models trained on callsets that downweight or exclude these regions inherit their absence, creating blind spots precisely where accurate genotyping matters most.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Zoomed-in view of the HLA region comparing a linear reference vs.&nbsp;graph/pangenome representation, with multiple alternative haplotypes and structural variants, highlighting why linear alignment fails and how graph alignment improves recall.</p>
</div>
</div>
</section>
</section>
<section id="benchmarking-and-ground-truth" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="benchmarking-and-ground-truth"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</h2>
<p>Evaluating variant callers requires high-confidence truth sets and standardized comparison tools. The challenge is that “ground truth” for variant calling is not actually true in any absolute sense; it represents consensus derived from multiple imperfect observations using different technologies and algorithms. Without careful benchmarking design, it is easy to overfit to specific datasets, underestimate errors in difficult regions, or misinterpret the practical significance of small metric improvements.</p>
<section id="giab-reference-samples" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="giab-reference-samples"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</h3>
<p>The <strong>Genome in a Bottle (GIAB)</strong> Consortium, coordinated by NIST, provides extensively characterized reference samples with validated variant calls across most of the genome <span class="citation" data-cites="zook_giab_2019">(<a href="references.html#ref-zook_giab_2019" role="doc-biblioref">Zook et al. 2019</a>)</span>. The primary sample is NA12878 (also known as HG001), a female of European ancestry from the CEPH/Utah pedigree with the longest history of multi-platform characterization. Additional samples span ancestral diversity and family structures: HG002 through HG004 comprise an Ashkenazi Jewish trio enabling trio-based validation, while HG005 through HG007 provide a Han Chinese trio.</p>
<p>For each sample, GIAB provides <strong>high-confidence variant calls</strong> representing consensus from multiple sequencing technologies and variant callers that constitute the best current estimate of true genotypes. Equally important are the <strong>high-confidence regions</strong>, genomic intervals where the truth set is believed to be reliable. Performance outside these regions remains formally unmeasured. Benchmarking tools such as <code>hap.py</code> and RTG Tools enable standardized comparison of test callsets against truth, implementing reproducible calculation of precision, recall, and F1 metrics by variant type <span class="citation" data-cites="krusche_happy_2019 noauthor_rtg-core_2025">(<a href="references.html#ref-krusche_happy_2019" role="doc-biblioref">Krusche et al. 2019</a>; <a href="references.html#ref-noauthor_rtg-core_2025" role="doc-biblioref"><span>“<span>RealTimeGenomics</span>/Rtg-Core”</span> 2025</a>)</span>.</p>
</section>
<section id="metrics-and-their-meaning" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="metrics-and-their-meaning"><span class="header-section-number">1.7.2</span> Metrics and Their Meaning</h3>
<p>Standard metrics for variant calling include <strong>recall (sensitivity)</strong>, the fraction of true variants in the benchmark successfully identified by the caller; <strong>precision (positive predictive value)</strong>, the fraction of called variants that are present in the benchmark truth set; and <strong>F1 score</strong>, the harmonic mean of precision and recall providing a single summary when both matter equally. These metrics are typically reported separately for SNVs and indels and may be stratified by genomic context to reveal where performance degrades.</p>
<p>Metrics can be defined at different levels: per-variant (did we identify the correct alternate allele?), per-genotype (did we correctly determine zygosity?), or per-site (did we recognize variation at this position regardless of allele?). For downstream models, genotype-level accuracy and sample-level completeness often matter more than simply counting variant matches. A model that receives incorrect genotypes at common regulatory variants will learn corrupted associations even if overall variant-level metrics appear strong.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Example precision-recall or ROC curves for two variant callers evaluated on a GIAB-like benchmark, plus a small confusion-matrix-style illustration showing how false positives and false negatives map to the metrics.</p>
</div>
</div>
</section>
<section id="limitations-of-benchmarks" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="limitations-of-benchmarks"><span class="header-section-number">1.7.3</span> Limitations of Benchmarks</h3>
<p>GIAB truth sets derive primarily from a small number of deeply sequenced samples, predominantly of European ancestry in early releases, and initially focused on genomic regions where high confidence was achievable. High-confidence regions cover approximately 85 to 90 percent of the genome, leaving performance in excluded regions formally unknown. Performance in underrepresented ancestries, in complex structural variant regions, and for novel variant classes may differ substantially from headline GIAB metrics <span class="citation" data-cites="zook_giab_2019 liao_pangenome_2023">(<a href="references.html#ref-zook_giab_2019" role="doc-biblioref">Zook et al. 2019</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>When benchmarks are reused extensively for method development, the risk of overfitting to benchmark-specific patterns becomes substantial. Pipelines may be tuned to maximize F1 on GIAB-like samples without improving performance on real-world cohorts with different ancestry composition, sequencing protocols, or variant spectra. For deep learning-based callers with large capacity to absorb quirks in training data, this risk is especially acute. Later chapters revisit similar themes for benchmarking and evaluation of deep models more broadly (<a href="p5-ch20-benchmarks.html" class="quarto-xref"><span>Chapter 20</span></a>, <a href="p5-ch21-eval.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
<p>Ongoing efforts from the T2T Consortium and the Human Pangenome Reference Consortium are expanding benchmark scope to include complete genome assemblies and diverse haplotype collections that better represent human genetic diversity <span class="citation" data-cites="nurk_complete_2022 liao_pangenome_2023">(<a href="references.html#ref-nurk_complete_2022" role="doc-biblioref">Nurk et al. 2022</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
</section>
</section>
<section id="sec-deepvar" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="sec-deepvar"><span class="header-section-number">1.8</span> DeepVariant: Variant Calling as Image Classification</h2>
<p>Classical variant calling pipelines encode accumulated expert intuition through hand-crafted features and carefully tuned heuristics developed over years of experience with sequencing data. <em>DeepVariant</em>, introduced by Google in 2018, posed a different question: what if we let the model learn these patterns directly from data? The key insight was not better probabilistic modeling of sequencing errors but rather a reformulation of the problem itself. Variant calling becomes image classification, and convolutional neural networks learn to distinguish true variants from artifacts through the same pattern recognition that enables them to classify natural images <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>.</p>
<section id="pileup-images-as-input" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="pileup-images-as-input"><span class="header-section-number">1.8.1</span> Pileup Images as Input</h3>
<p>Around each candidate variant site, <em>DeepVariant</em> constructs a multi-channel tensor resembling an image. Each row corresponds to a read overlapping the site, with columns indexing positions relative to the candidate variant. Channels encode multiple features: match or mismatch with the reference, Phred-scaled base quality, mapping quality, strand orientation, support for different alleles, and additional alignment characteristics. The reference sequence and candidate alleles are overlaid as additional channels providing context.</p>
<p>This representation transforms the variant calling problem fundamentally. Rather than computing summary statistics (depth, allelic balance, strand bias) and feeding them to a classifier with predefined decision rules, <em>DeepVariant</em> presents the raw evidence to a neural network. The model learns that strand-biased support clustered at read ends looks different from balanced support distributed across read positions without anyone explicitly defining these features or their relative importance. Patterns invisible to hand-crafted heuristics become learnable.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Example DeepVariant-style pileup image with color channels labeled (reference, base identity, base quality, strand, mapping quality), showing how reads stack around a potential variant site.</p>
</div>
</div>
</section>
<section id="architecture-and-training" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="architecture-and-training"><span class="header-section-number">1.8.2</span> Architecture and Training</h3>
<p><em>DeepVariant</em> uses an Inception-style CNN architecture originally developed for natural image classification. The convolutional architecture that makes this possible is examined in detail in <a href="p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>. The network processes the pileup tensor through multiple convolutional layers, pooling operations, and nonlinearities, outputting posterior probabilities over three genotype classes (homozygous reference, heterozygous, homozygous alternate) for each candidate site <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>.</p>
<p>Training uses high-confidence truth sets such as GIAB genomes. The model observes many examples of true variants and non-variants along with their associated pileup images, learning complex decision boundaries that integrate base quality, mapping quality, local sequence context, and read-level patterns. Where VQSR fits a separate model on hand-selected annotations after initial calling, <em>DeepVariant</em> processes raw evidence directly during the primary classification step.</p>
<p>The end-to-end training produces well-calibrated genotype likelihoods across a range of sequencing chemistries, instruments, and read lengths, particularly when fine-tuned for specific experimental contexts <span class="citation" data-cites="yun_accurate_2021">(<a href="references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. Once trained, the same architecture generalizes across whole-genome versus whole-exome data, PCR-free versus PCR-amplified libraries, and different sequencing instruments. This adaptability contrasts with classical pipelines where calibration is often a separate, post hoc step requiring platform-specific tuning by experts.</p>
</section>
<section id="cohort-calling-with-glnexus" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="cohort-calling-with-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with GLnexus</h3>
<p><em>DeepVariant</em> operates primarily at the per-sample level, producing a <code>gVCF</code> of genotype likelihoods for each individual sample. To generate a multi-sample <code>VCF</code> suitable for population-scale analysis, these per-sample results must be combined through joint genotyping.</p>
<p>GLnexus provides this cohort-level integration for <em>DeepVariant</em> gVCFs <span class="citation" data-cites="yun_accurate_2021">(<a href="references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. The system merges per-sample likelihoods, applies cohort-level priors informed by observed allele frequencies, and performs multi-sample genotype refinement and filtering. Together, <em>DeepVariant</em> and GLnexus form a modular pipeline where deep learning replaces the per-sample likelihood engine while the overall architecture (per-sample calls, joint genotyping, cohort filtering) remains structurally similar to classical approaches.</p>
<p>Joint calling improves sensitivity for rare variants by pooling evidence across carriers, ensures consistent variant representation across all samples in a cohort, and enables cohort-level quality filters that identify systematic artifacts visible only across many samples. This combination has become a de facto standard for large WES and WGS projects, including recent releases from gnomAD and the UK Biobank <span class="citation" data-cites="karczewski_gnomad_2020 bycroft_ukbiobank_2018">(<a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>; <a href="references.html#ref-bycroft_ukbiobank_2018" role="doc-biblioref">Bycroft et al. 2018</a>)</span>.</p>
</section>
<section id="comparison-with-classical-approaches" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="comparison-with-classical-approaches"><span class="header-section-number">1.8.4</span> Comparison with Classical Approaches</h3>
<p>The fundamental difference between <em>DeepVariant</em> and classical pipelines lies in how evidence is combined. HaplotypeCaller uses pair-HMM models with explicit assumptions about read independence and then applies VQSR to recalibrate quality scores using hand-selected annotation features. <em>DeepVariant</em> processes entire pileups simultaneously, implicitly learning correlations among reads that violate the independence assumptions built into classical probabilistic models.</p>
<p>This end-to-end approach offers several practical advantages. Calibration emerges from training rather than requiring separate recalibration steps with their own parameter tuning. Transfer across platforms and even species often succeeds with modest fine-tuning rather than complete redevelopment. The model can detect subtle artifact patterns that escape hand-crafted filters, learning representations of error modes that human experts never explicitly described.</p>
<p>Both approaches share important limitations. Neither handles structural variants well; both focus primarily on SNVs and small indels. Both operate within the same overall pipeline framework: alignment, duplicate marking, and joint genotyping remain largely unchanged regardless of the per-sample caller used. <em>DeepVariant</em> is best understood as a drop-in replacement for the per-sample calling step, not a complete reimagining of variant discovery from raw data.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Side-by-side schematic of a classical GATK-style pipeline vs.&nbsp;a DeepVariant-enhanced pipeline, emphasizing which components are hand-crafted vs.&nbsp;learned, and where deep learning models plug into the overall workflow.</p>
</div>
</div>
</section>
</section>
<section id="implications-for-genomic-deep-learning" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="implications-for-genomic-deep-learning"><span class="header-section-number">1.9</span> Implications for Genomic Deep Learning</h2>
<p>NGS and variant calling establish the foundation for everything else in this book. They determine what data downstream models receive, where coverage exists, and where systematic blind spots remain hidden. Understanding how variants are called, and where that process fails, is essential for interpreting the performance and limitations of every model built on this foundation.</p>
<section id="variants-as-atomic-units" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="variants-as-atomic-units"><span class="header-section-number">1.9.1</span> Variants as Atomic Units</h3>
<p>The output of WES and WGS pipelines (a <code>VCF</code> of SNVs, indels, and inferred genotypes) defines the atomic units that many downstream models operate on. Polygenic risk scores treat variants as weighted features summed across the genome. GWAS summary statistics quantify associations at individual variant positions. Variant annotation tools classify each site by predicted functional consequence. Foundation models that operate on genotypes rather than raw sequence inherit the variant catalog as their effective vocabulary.</p>
<p>If a variant is never called, it cannot appear in training data, and no model can learn its effect. False positives introduce noise into labels and features, teaching models to associate spurious variants with phenotypes. False negatives create blind spots where models must extrapolate from incomplete information, often without any indication that data are missing. Choices about phasing, imputation, and variant representation determine whether models see haplotype-structured inputs, unordered genotypes, or scalar dosage summaries. The quality of variant calls directly limits the quality of everything built upon them.</p>
</section>
<section id="inherited-biases-and-blind-spots" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="inherited-biases-and-blind-spots"><span class="header-section-number">1.9.2</span> Inherited Biases and Blind Spots</h3>
<p>Upstream decisions constrain what downstream models can learn. If an assay rarely observes indels in certain repeat classes, models trained on those callsets effectively learn a world where such variants do not exist. If certain ancestries are underrepresented in reference panels or truth sets, models may perform poorly for those populations while appearing well-calibrated in benchmarks dominated by European samples. High-confidence region definitions determine which variants enter training sets; variants in excluded regions are invisible to models regardless of their biological importance.</p>
<p>For regulatory sequence models and variant effect predictors (<a href="p3-ch11-dna-lm.html" class="quarto-xref"><span>Chapter 11</span></a>, <a href="p3-ch13-regulatory.html" class="quarto-xref"><span>Chapter 13</span></a>, <a href="p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>, <a href="p1-ch04-vep-classical.html" class="quarto-xref"><span>Chapter 4</span></a>), upstream variant calling determines which sites appear as candidates and how often certain sequence patterns are observed in association with functional outcomes. The HLA blind spot in short-read calling means that models trained primarily on short-read callsets will systematically underperform for immune-related variants despite their substantial clinical importance for autoimmune disease, transplant rejection, and drug hypersensitivity. The accuracy ceiling imposed by variant calling on downstream effect prediction is examined quantitatively in <span class="quarto-unresolved-ref">?sec-vep</span>.</p>
</section>
<section id="effect-sizes-across-the-frequency-spectrum" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="effect-sizes-across-the-frequency-spectrum"><span class="header-section-number">1.9.3</span> Effect Sizes Across the Frequency Spectrum</h3>
<p>Variant calling quality modulates the effective effect sizes that downstream models can detect, with different dynamics for common and rare variation. For common variants contributing to highly polygenic traits, modest genotype error acts as additional measurement noise that attenuates effect size estimates without creating spurious large effects. Improving variant calling in already “easy” genomic regions yields diminishing returns compared to simply increasing sample size.</p>
<p>For rare variants with large individual effects, the dynamics change substantially. Loss-of-function variants, damaging missense mutations, and splice-altering changes can have substantial effects on disease risk. Here, false negatives dominate the problem: if the variant is never called, its effect is invisible to association tests and to models trained on called genotypes. Small improvements in recall for clinically important rare variants can have outsized impact on gene discovery and interpretation.</p>
<p>Imputed variants introduce their own effect size modulation. The squared correlation between true and imputed genotypes acts as an attenuation factor: an association with true effect size <span class="math inline">\(\beta\)</span> behaves as if the effect were approximately <span class="math inline">\(r^2 \beta\)</span> in downstream analyses using imputed dosages. Improvements in imputation quality, particularly for underrepresented ancestries where current panels perform poorly, directly scale the effective signals that models can learn.</p>
<p>Clinically critical loci often present the most challenging technical contexts, creating a systematic mismatch between importance and data quality. Pharmacogenomic variants in CYP gene families, immune-related variants in HLA, and many other medically actionable sites reside in regions where standard pipelines perform poorly. Global accuracy metrics may change only slightly when these regions improve, but the clinical impact can be substantial.</p>
</section>
<section id="toward-end-to-end-learning" class="level3" data-number="1.9.4">
<h3 data-number="1.9.4" class="anchored" data-anchor-id="toward-end-to-end-learning"><span class="header-section-number">1.9.4</span> Toward End-to-End Learning</h3>
<p><em>DeepVariant</em> exemplifies a broader paradigm that recurs throughout this book: replacing hand-engineered components with learned models. DeepSEA and Basenji learn regulatory grammars directly from sequence (<a href="p3-ch13-regulatory.html" class="quarto-xref"><span>Chapter 13</span></a>). SpliceAI predicts splicing outcomes from local sequence context (<a href="p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>). DNA language models learn representations from unlabeled genomes (<a href="p3-ch11-dna-lm.html" class="quarto-xref"><span>Chapter 11</span></a>). In each case, the central question is whether learned representations outperform hand-crafted features, and under what conditions the additional model capacity provides genuine benefit versus overfitting to training artifacts.</p>
<p>Some recent work pushes further upstream, modeling raw sequencing signal (nanopore current traces or minimally processed reads) with the goal of learning alignment and variant calling jointly rather than as separate pipeline stages. Others propose models that reason directly over reads and phenotypes, bypassing intermediate variant calls entirely. These directions blur the boundary between variant calling and downstream modeling, foreshadowing the joint, multi-scale foundation models discussed in later parts of this book.</p>
<p>The models that follow operate within the constraints established here: variant calls whose reliability varies systematically across the genome, across populations, and across the allele frequency spectrum from common to rare. This foundation shapes everything built upon it.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Conceptual “stack” figure showing raw sequence/signal → variant calling → variant-level representations (VCF, annotations) → genomic foundation models → downstream tasks (PGS, regulatory prediction, variant interpretation), with arrows indicating how errors/choices propagate upward.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-browning_beagle_2021" class="csl-entry" role="listitem">
Browning, Brian L., Xiaowen Tian, Ying Zhou, and Sharon R. Browning. 2021. <span>“Fast Two-Stage Phasing of Large-Scale Sequence Data.”</span> <em>American Journal of Human Genetics</em> 108 (10): 1880–90. <a href="https://doi.org/10.1016/j.ajhg.2021.08.005">https://doi.org/10.1016/j.ajhg.2021.08.005</a>.
</div>
<div id="ref-bycroft_ukbiobank_2018" class="csl-entry" role="listitem">
Bycroft, Clare, Colin Freeman, Desislava Petkova, Gavin Band, Lloyd T. Elliott, Kevin Sharp, Allan Motyer, et al. 2018. <span>“The <span>UK</span> <span>Biobank</span> Resource with Deep Phenotyping and Genomic Data.”</span> <em>Nature</em> 562 (7726): 203–9. <a href="https://doi.org/10.1038/s41586-018-0579-z">https://doi.org/10.1038/s41586-018-0579-z</a>.
</div>
<div id="ref-dabernig_ont_2024" class="csl-entry" role="listitem">
Dabernig-Heinz, Johanna, Mara Lohde, Martin Hölzer, Adriana Cabal, Rick Conzemius, Christian Brandt, Matthias Kohl, et al. 2024. <span>“A Multicenter Study on Accuracy and Reproducibility of Nanopore Sequencing-Based Genotyping of Bacterial Pathogens.”</span> <em>Journal of Clinical Microbiology</em> 62 (9): e00628–24. <a href="https://doi.org/10.1128/jcm.00628-24">https://doi.org/10.1128/jcm.00628-24</a>.
</div>
<div id="ref-depristo_gatk_2011" class="csl-entry" role="listitem">
DePristo, Mark A., Eric Banks, Ryan Poplin, Kiran V. Garimella, Jared R. Maguire, Christopher Hartl, Anthony A. Philippakis, et al. 2011. <span>“A Framework for Variation Discovery and Genotyping Using Next-Generation <span>DNA</span> Sequencing Data.”</span> <em>Nature Genetics</em> 43 (5): 491–98. <a href="https://doi.org/10.1038/ng.806">https://doi.org/10.1038/ng.806</a>.
</div>
<div id="ref-garrison_vgtool_2018" class="csl-entry" role="listitem">
Garrison, Erik, Jouni Sirén, Adam M. Novak, Glenn Hickey, Jordan M. Eizenga, Eric T. Dawson, William Jones, et al. 2018. <span>“Variation Graph Toolkit Improves Read Mapping by Representing Genetic Variation in the Reference.”</span> <em>Nature Biotechnology</em> 36 (9): 875–79. <a href="https://doi.org/10.1038/nbt.4227">https://doi.org/10.1038/nbt.4227</a>.
</div>
<div id="ref-goodwin_10year_2016" class="csl-entry" role="listitem">
Goodwin, Sara, John D. McPherson, and W. Richard McCombie. 2016. <span>“Coming of Age: Ten Years of Next-Generation Sequencing Technologies.”</span> <em>Nature Reviews Genetics</em> 17 (6): 333–51. <a href="https://doi.org/10.1038/nrg.2016.49">https://doi.org/10.1038/nrg.2016.49</a>.
</div>
<div id="ref-jiang_cutesv_2020" class="csl-entry" role="listitem">
Jiang, Tao, Yongzhuang Liu, Yue Jiang, Junyi Li, Yan Gao, Zhe Cui, Yadong Liu, Bo Liu, and Yadong Wang. 2020. <span>“Long-Read-Based Human Genomic Structural Variation Detection with <span class="nocase">cuteSV</span>.”</span> <em>Genome Biology</em> 21 (1): 189. <a href="https://doi.org/10.1186/s13059-020-02107-y">https://doi.org/10.1186/s13059-020-02107-y</a>.
</div>
<div id="ref-karczewski_gnomad_2020" class="csl-entry" role="listitem">
Karczewski, Konrad J., Laurent C. Francioli, Grace Tiao, Beryl B. Cummings, Jessica Alföldi, Qingbo Wang, Ryan L. Collins, et al. 2020. <span>“The Mutational Constraint Spectrum Quantified from Variation in 141,456 Humans.”</span> <em>Nature</em> 581 (7809): 434–43. <a href="https://doi.org/10.1038/s41586-020-2308-7">https://doi.org/10.1038/s41586-020-2308-7</a>.
</div>
<div id="ref-krusche_happy_2019" class="csl-entry" role="listitem">
Krusche, Peter, Len Trigg, Paul C. Boutros, Christopher E. Mason, Francisco M. De La Vega, Benjamin L. Moore, Mar Gonzalez-Porta, et al. 2019. <span>“Best <span>Practices</span> for <span>Benchmarking</span> <span>Germline</span> <span>Small</span> <span>Variant</span> <span>Calls</span> in <span>Human</span> <span>Genomes</span>.”</span> <em>Nature Biotechnology</em> 37 (5): 555–60. <a href="https://doi.org/10.1038/s41587-019-0054-x">https://doi.org/10.1038/s41587-019-0054-x</a>.
</div>
<div id="ref-li_bwa-mem_2013" class="csl-entry" role="listitem">
Li, Heng. 2013. <span>“Aligning Sequence Reads, Clone Sequences and Assembly Contigs with <span>BWA</span>-<span>MEM</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1303.3997">https://doi.org/10.48550/arXiv.1303.3997</a>.
</div>
<div id="ref-li_mapping_2014" class="csl-entry" role="listitem">
———. 2014. <span>“Towards <span>Better</span> <span>Understanding</span> of <span>Artifacts</span> in <span>Variant</span> <span>Calling</span> from <span>High</span>-<span>Coverage</span> <span>Samples</span>.”</span> <em>Bioinformatics</em> 30 (20): 2843–51. <a href="https://doi.org/10.1093/bioinformatics/btu356">https://doi.org/10.1093/bioinformatics/btu356</a>.
</div>
<div id="ref-li_minimap2_2018" class="csl-entry" role="listitem">
———. 2018. <span>“Minimap2: Pairwise Alignment for Nucleotide Sequences.”</span> <em>Bioinformatics</em> 34 (18): 3094–3100. <a href="https://doi.org/10.1093/bioinformatics/bty191">https://doi.org/10.1093/bioinformatics/bty191</a>.
</div>
<div id="ref-liao_pangenome_2023" class="csl-entry" role="listitem">
Liao, Wen-Wei, Mobin Asri, Jana Ebler, Daniel Doerr, Marina Haukness, Glenn Hickey, Shuangjia Lu, et al. 2023. <span>“A Draft Human Pangenome Reference.”</span> <em>Nature</em> 617 (7960): 312–24. <a href="https://doi.org/10.1038/s41586-023-05896-x">https://doi.org/10.1038/s41586-023-05896-x</a>.
</div>
<div id="ref-loh_eagle_2016" class="csl-entry" role="listitem">
Loh, Po-Ru, Petr Danecek, Pier Francesco Palamara, Christian Fuchsberger, Yakir A Reshef, Hilary K Finucane, Sebastian Schoenherr, et al. 2016. <span>“Reference-Based Phasing Using the <span>Haplotype</span> <span>Reference</span> <span>Consortium</span> Panel.”</span> <em>Nature Genetics</em> 48 (11): 1443–48. <a href="https://doi.org/10.1038/ng.3679">https://doi.org/10.1038/ng.3679</a>.
</div>
<div id="ref-mallal_abacavir_2008" class="csl-entry" role="listitem">
Mallal, Simon, Elizabeth Phillips, Giampiero Carosi, Jean-Michel Molina, Cassy Workman, Janez Tomažič, Eva Jägel-Guedes, et al. 2008. <span>“<span>HLA</span>-<span>B</span>*5701 <span>Screening</span> for <span>Hypersensitivity</span> to <span>Abacavir</span>.”</span> <em>New England Journal of Medicine</em> 358 (6): 568–79. <a href="https://doi.org/10.1056/NEJMoa0706135">https://doi.org/10.1056/NEJMoa0706135</a>.
</div>
<div id="ref-nielsen_error_2011" class="csl-entry" role="listitem">
Nielsen, Rasmus, Joshua S. Paul, Anders Albrechtsen, and Yun S. Song. 2011. <span>“Genotype and <span>SNP</span> Calling from Next-Generation Sequencing Data.”</span> <em>Nature Reviews. Genetics</em> 12 (6): 443–51. <a href="https://doi.org/10.1038/nrg2986">https://doi.org/10.1038/nrg2986</a>.
</div>
<div id="ref-nurk_complete_2022" class="csl-entry" role="listitem">
Nurk, Sergey, Sergey Koren, Arang Rhie, Mikko Rautiainen, Andrey V. Bzikadze, Alla Mikheenko, Mitchell R. Vollger, et al. 2022. <span>“The Complete Sequence of a Human Genome.”</span> <em>Science</em> 376 (6588): 44–53. <a href="https://doi.org/10.1126/science.abj6987">https://doi.org/10.1126/science.abj6987</a>.
</div>
<div id="ref-oconnell_shapeit2_2014" class="csl-entry" role="listitem">
O’Connell, Jared, Deepti Gurdasani, Olivier Delaneau, Nicola Pirastu, Sheila Ulivi, Massimiliano Cocca, Michela Traglia, et al. 2014. <span>“A <span>General</span> <span>Approach</span> for <span>Haplotype</span> <span>Phasing</span> Across the <span>Full</span> <span>Spectrum</span> of <span>Relatedness</span>.”</span> <em>PLOS Genetics</em> 10 (4): e1004234. <a href="https://doi.org/10.1371/journal.pgen.1004234">https://doi.org/10.1371/journal.pgen.1004234</a>.
</div>
<div id="ref-noauthor_pbsv_2025" class="csl-entry" role="listitem">
<span>“<span>PacificBiosciences</span>/Pbsv.”</span> 2025. PacBio. <a href="https://github.com/PacificBiosciences/pbsv">https://github.com/PacificBiosciences/pbsv</a>.
</div>
<div id="ref-poplin_deepvariant_2018" class="csl-entry" role="listitem">
Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. <span>“[<span>DeepVariant</span>] <span>A</span> Universal <span>SNP</span> and Small-Indel Variant Caller Using Deep Neural Networks.”</span> <em>Nature Biotechnology</em> 36 (10): 983–87. <a href="https://doi.org/10.1038/nbt.4235">https://doi.org/10.1038/nbt.4235</a>.
</div>
<div id="ref-noauthor_rtg-core_2025" class="csl-entry" role="listitem">
<span>“<span>RealTimeGenomics</span>/Rtg-Core.”</span> 2025. Real Time Genomics. <a href="https://github.com/RealTimeGenomics/rtg-core">https://github.com/RealTimeGenomics/rtg-core</a>.
</div>
<div id="ref-robinson_hla-db_2020" class="csl-entry" role="listitem">
Robinson, James, Dominic J Barker, Xenia Georgiou, Michael A Cooper, Paul Flicek, and Steven G E Marsh. 2020. <span>“<span>IPD</span>-<span>IMGT</span>/<span>HLA</span> <span>Database</span>.”</span> <em>Nucleic Acids Research</em> 48 (D1): D948–55. <a href="https://doi.org/10.1093/nar/gkz950">https://doi.org/10.1093/nar/gkz950</a>.
</div>
<div id="ref-sakaue_hla_2023" class="csl-entry" role="listitem">
Sakaue, Saori, Saisriram Gurajala, Michelle Curtis, Yang Luo, Wanson Choi, Kazuyoshi Ishigaki, Joyce B. Kang, et al. 2023. <span>“Tutorial: A Statistical Genetics Guide to Identifying <span>HLA</span> Alleles Driving Complex Disease.”</span> <em>Nature Protocols</em> 18 (9): 2625–41. <a href="https://doi.org/10.1038/s41596-023-00853-4">https://doi.org/10.1038/s41596-023-00853-4</a>.
</div>
<div id="ref-shafin_pepper_2021" class="csl-entry" role="listitem">
Shafin, Kishwar, Trevor Pesout, Pi-Chuan Chang, Maria Nattestad, Alexey Kolesnikov, Sidharth Goel, Gunjan Baid, et al. 2021. <span>“Haplotype-Aware Variant Calling with <span>PEPPER</span>-<span>Margin</span>-<span>DeepVariant</span> Enables High Accuracy in Nanopore Long-Reads.”</span> <em>Nature Methods</em> 18 (11): 1322–32. <a href="https://doi.org/10.1038/s41592-021-01299-w">https://doi.org/10.1038/s41592-021-01299-w</a>.
</div>
<div id="ref-smolka_sniffles2_2024" class="csl-entry" role="listitem">
Smolka, Moritz, Luis F. Paulin, Christopher M. Grochowski, Dominic W. Horner, Medhat Mahmoud, Sairam Behera, Ester Kalef-Ezra, et al. 2024. <span>“Detection of Mosaic and Population-Level Structural Variants with <span>Sniffles2</span>.”</span> <em>Nature Biotechnology</em> 42 (10): 1571–80. <a href="https://doi.org/10.1038/s41587-023-02024-y">https://doi.org/10.1038/s41587-023-02024-y</a>.
</div>
<div id="ref-song_t1k_2022" class="csl-entry" role="listitem">
Song, Li, Gali Bai, X. Shirley Liu, Bo Li, and Heng Li. 2022. <span>“<span>T1K</span>: Efficient and Accurate <span>KIR</span> and <span>HLA</span> Genotyping with Next-Generation Sequencing Data.”</span> bioRxiv. <a href="https://doi.org/10.1101/2022.10.26.513955">https://doi.org/10.1101/2022.10.26.513955</a>.
</div>
<div id="ref-van_der_auwera_gatk_best_2018" class="csl-entry" role="listitem">
Van der Auwera, Geraldine A., Mauricio O. Carneiro, Christopher Hartl, Ryan Poplin, Guillermo del Angel, Ami Levy-Moonshine, Tadeusz Jordan, et al. 2018. <span>“From <span>FastQ</span> <span>Data</span> to <span>High</span>-<span>Confidence</span> <span>Variant</span> <span>Calls</span>: <span>The</span> <span>Genome</span> <span>Analysis</span> <span>Toolkit</span> <span>Best</span> <span>Practices</span> <span>Pipeline</span>.”</span> <em>Current Protocols in Bioinformatics</em> 43 (1): 11.10.1–33. <a href="https://doi.org/10.1002/0471250953.bi1110s43">https://doi.org/10.1002/0471250953.bi1110s43</a>.
</div>
<div id="ref-wenger_pacbiohifi_2019" class="csl-entry" role="listitem">
Wenger, Aaron M., Paul Peluso, William J. Rowell, Pi-Chuan Chang, Richard J. Hall, Gregory T. Concepcion, Jana Ebler, et al. 2019. <span>“Accurate Circular Consensus Long-Read Sequencing Improves Variant Detection and Assembly of a Human Genome.”</span> <em>Nature Biotechnology</em> 37 (10): 1155–62. <a href="https://doi.org/10.1038/s41587-019-0217-9">https://doi.org/10.1038/s41587-019-0217-9</a>.
</div>
<div id="ref-yun_accurate_2021" class="csl-entry" role="listitem">
Yun, Taedong, Helen Li, Pi-Chuan Chang, Michael F Lin, Andrew Carroll, and Cory Y McLean. 2021. <span>“Accurate, Scalable Cohort Variant Calls Using <span>DeepVariant</span> and <span>GLnexus</span>.”</span> <em>Bioinformatics</em> 36 (24): 5582–89. <a href="https://doi.org/10.1093/bioinformatics/btaa1081">https://doi.org/10.1093/bioinformatics/btaa1081</a>.
</div>
<div id="ref-zheng_clair3_2022" class="csl-entry" role="listitem">
Zheng, Zhenxian, Shumin Li, Junhao Su, Amy Wing-Sze Leung, Tak-Wah Lam, and Ruibang Luo. 2022. <span>“Symphonizing Pileup and Full-Alignment for Deep Learning-Based Long-Read Variant Calling.”</span> <em>Nature Computational Science</em> 2 (12): 797–803. <a href="https://doi.org/10.1038/s43588-022-00387-x">https://doi.org/10.1038/s43588-022-00387-x</a>.
</div>
<div id="ref-zook_giab_2019" class="csl-entry" role="listitem">
Zook, Justin M., Jennifer McDaniel, Nathan D. Olson, Justin Wagner, Hemang Parikh, Haynes Heaton, Sean A. Irvine, et al. 2019. <span>“An Open Resource for Accurately Benchmarking Small Variant and Reference Calls.”</span> <em>Nature Biotechnology</em> 37 (5): 561–66. <a href="https://doi.org/10.1038/s41587-019-0074-6">https://doi.org/10.1038/s41587-019-0074-6</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p1--foundations.html" class="pagination-link" aria-label="Part I: Foundations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part I: Foundations</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p1-ch02-data.html" class="pagination-link" aria-label="The Genomic Data Landscape">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>