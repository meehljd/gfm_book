<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Sequencing: From Reads to Variants – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p1-ch02-data.html" rel="next">
<link href="./p1--foundations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transformer Architecture for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-foundation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models: Concepts &amp; Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives &amp; Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning &amp; Deployment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">p4–multi-modal_multi-scale.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-challenge-of-ngs-data" id="toc-the-challenge-of-ngs-data" class="nav-link active" data-scroll-target="#the-challenge-of-ngs-data"><span class="header-section-number">1.1</span> The Challenge of NGS Data</a></li>
  <li><a href="#targeting-strategies-panels-exomes-and-genomes" id="toc-targeting-strategies-panels-exomes-and-genomes" class="nav-link" data-scroll-target="#targeting-strategies-panels-exomes-and-genomes"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</a>
  <ul class="collapse">
  <li><a href="#targeted-and-panel-sequencing" id="toc-targeted-and-panel-sequencing" class="nav-link" data-scroll-target="#targeted-and-panel-sequencing"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</a></li>
  <li><a href="#whole-exome-sequencing" id="toc-whole-exome-sequencing" class="nav-link" data-scroll-target="#whole-exome-sequencing"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</a></li>
  <li><a href="#whole-genome-sequencing" id="toc-whole-genome-sequencing" class="nav-link" data-scroll-target="#whole-genome-sequencing"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</a></li>
  <li><a href="#long-read-sequencing-technologies" id="toc-long-read-sequencing-technologies" class="nav-link" data-scroll-target="#long-read-sequencing-technologies"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</a></li>
  </ul></li>
  <li><a href="#classical-variant-calling-pipelines" id="toc-classical-variant-calling-pipelines" class="nav-link" data-scroll-target="#classical-variant-calling-pipelines"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</a>
  <ul class="collapse">
  <li><a href="#sample-level-quality-control-and-cohort-curation" id="toc-sample-level-quality-control-and-cohort-curation" class="nav-link" data-scroll-target="#sample-level-quality-control-and-cohort-curation"><span class="header-section-number">1.3.1</span> Sample-Level Quality Control and Cohort Curation</a></li>
  <li><a href="#probabilistic-framework" id="toc-probabilistic-framework" class="nav-link" data-scroll-target="#probabilistic-framework"><span class="header-section-number">1.3.2</span> Probabilistic Framework</a></li>
  </ul></li>
  <li><a href="#haplotype-phasing" id="toc-haplotype-phasing" class="nav-link" data-scroll-target="#haplotype-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</a>
  <ul class="collapse">
  <li><a href="#why-phasing-matters" id="toc-why-phasing-matters" class="nav-link" data-scroll-target="#why-phasing-matters"><span class="header-section-number">1.4.1</span> Why Phasing Matters</a></li>
  <li><a href="#phasing-methods" id="toc-phasing-methods" class="nav-link" data-scroll-target="#phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</a></li>
  <li><a href="#imputation-and-genotype-refinement" id="toc-imputation-and-genotype-refinement" class="nav-link" data-scroll-target="#imputation-and-genotype-refinement"><span class="header-section-number">1.4.3</span> Imputation and Genotype Refinement</a></li>
  </ul></li>
  <li><a href="#sources-of-error-and-uncertainty" id="toc-sources-of-error-and-uncertainty" class="nav-link" data-scroll-target="#sources-of-error-and-uncertainty"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</a></li>
  <li><a href="#difficult-regions-for-variant-calling" id="toc-difficult-regions-for-variant-calling" class="nav-link" data-scroll-target="#difficult-regions-for-variant-calling"><span class="header-section-number">1.6</span> Difficult Regions for Variant Calling</a>
  <ul class="collapse">
  <li><a href="#segmental-duplications-and-paralogs" id="toc-segmental-duplications-and-paralogs" class="nav-link" data-scroll-target="#segmental-duplications-and-paralogs"><span class="header-section-number">1.6.1</span> Segmental Duplications and Paralogs</a></li>
  <li><a href="#low-complexity-and-repetitive-sequence" id="toc-low-complexity-and-repetitive-sequence" class="nav-link" data-scroll-target="#low-complexity-and-repetitive-sequence"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</a></li>
  <li><a href="#the-hla-region-a-case-study" id="toc-the-hla-region-a-case-study" class="nav-link" data-scroll-target="#the-hla-region-a-case-study"><span class="header-section-number">1.6.3</span> The HLA Region: A Case Study</a></li>
  </ul></li>
  <li><a href="#benchmarking-and-ground-truth" id="toc-benchmarking-and-ground-truth" class="nav-link" data-scroll-target="#benchmarking-and-ground-truth"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</a>
  <ul class="collapse">
  <li><a href="#giab-reference-samples" id="toc-giab-reference-samples" class="nav-link" data-scroll-target="#giab-reference-samples"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</a></li>
  <li><a href="#benchmarking-metrics" id="toc-benchmarking-metrics" class="nav-link" data-scroll-target="#benchmarking-metrics"><span class="header-section-number">1.7.2</span> Benchmarking Metrics</a></li>
  <li><a href="#limitations-of-current-benchmarks" id="toc-limitations-of-current-benchmarks" class="nav-link" data-scroll-target="#limitations-of-current-benchmarks"><span class="header-section-number">1.7.3</span> Limitations of Current Benchmarks</a></li>
  </ul></li>
  <li><a href="#sec-deepvar" id="toc-sec-deepvar" class="nav-link" data-scroll-target="#sec-deepvar"><span class="header-section-number">1.8</span> DeepVariant: CNNs for Variant Calling</a>
  <ul class="collapse">
  <li><a href="#image-like-pileup-representation" id="toc-image-like-pileup-representation" class="nav-link" data-scroll-target="#image-like-pileup-representation"><span class="header-section-number">1.8.1</span> Image-Like Pileup Representation</a></li>
  <li><a href="#inception-style-cnn-classifier" id="toc-inception-style-cnn-classifier" class="nav-link" data-scroll-target="#inception-style-cnn-classifier"><span class="header-section-number">1.8.2</span> Inception-Style CNN Classifier</a></li>
  <li><a href="#cohort-calling-with-deepvariant-and-glnexus" id="toc-cohort-calling-with-deepvariant-and-glnexus" class="nav-link" data-scroll-target="#cohort-calling-with-deepvariant-and-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with DeepVariant and GLnexus</a></li>
  <li><a href="#comparison-classical-pipelines-vs.-deepvariant" id="toc-comparison-classical-pipelines-vs.-deepvariant" class="nav-link" data-scroll-target="#comparison-classical-pipelines-vs.-deepvariant"><span class="header-section-number">1.8.4</span> Comparison: Classical Pipelines vs.&nbsp;DeepVariant</a></li>
  </ul></li>
  <li><a href="#significance-for-genomic-deep-learning" id="toc-significance-for-genomic-deep-learning" class="nav-link" data-scroll-target="#significance-for-genomic-deep-learning"><span class="header-section-number">1.9</span> Significance for Genomic Deep Learning</a>
  <ul class="collapse">
  <li><a href="#defining-the-atoms-we-model" id="toc-defining-the-atoms-we-model" class="nav-link" data-scroll-target="#defining-the-atoms-we-model"><span class="header-section-number">1.9.1</span> Defining the Atoms We Model</a></li>
  <li><a href="#constraining-downstream-models" id="toc-constraining-downstream-models" class="nav-link" data-scroll-target="#constraining-downstream-models"><span class="header-section-number">1.9.2</span> Constraining Downstream Models</a></li>
  <li><a href="#effect-sizes-and-practical-impact" id="toc-effect-sizes-and-practical-impact" class="nav-link" data-scroll-target="#effect-sizes-and-practical-impact"><span class="header-section-number">1.9.3</span> Effect Sizes and Practical Impact</a></li>
  <li><a href="#motivating-end-to-end-learning" id="toc-motivating-end-to-end-learning" class="nav-link" data-scroll-target="#motivating-end-to-end-learning"><span class="header-section-number">1.9.4</span> Motivating End-to-End Learning</a></li>
  <li><a href="#looking-ahead" id="toc-looking-ahead" class="nav-link" data-scroll-target="#looking-ahead"><span class="header-section-number">1.9.5</span> Looking Ahead</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ngs" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-challenge-of-ngs-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-challenge-of-ngs-data"><span class="header-section-number">1.1</span> The Challenge of NGS Data</h2>
<p>Next-generation sequencing (NGS) has transformed genomics by making it routine to generate tens to hundreds of gigabases of DNA sequence from a single individual <span class="citation" data-cites="goodwin_10year_2016">(<a href="references.html#ref-goodwin_10year_2016" role="doc-biblioref">Goodwin, McPherson, and McCombie 2016</a>)</span>. Modern instruments produce short reads, typically 100 to 300 base pairs of paired-end Illumina sequence, at very high throughput but with non-trivial error profiles including substitutions, context-specific errors, and base quality uncertainties. Long-read technologies from Pacific Biosciences and Oxford Nanopore further expand the space of observable variation to include complex structural variants and some segmental duplications <span class="citation" data-cites="wenger_pacbiohifi_2019 dabernig_ont_2024">(<a href="references.html#ref-wenger_pacbiohifi_2019" role="doc-biblioref">Wenger et al. 2019</a>; <a href="references.html#ref-dabernig_ont_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>.</p>
<p>From the perspective of this book, the central problem is: <strong>how do we turn raw reads into a reliable list of genomic variants?</strong> The answer is a multi-stage pipeline involving alignment, local assembly, genotype likelihoods, joint calling, phasing, and imputation. Every downstream model in this book, including polygenic scores, regulatory sequence models, variant effect predictors, and clinical risk models, assumes that this upstream pipeline has already run and that its output represents ground truth.</p>
<p>Turning raw reads into reliable variants is therefore not simply a matter of comparing strings. Variant calling pipelines must disentangle sequencing errors (instrument noise, PCR artifacts), alignment artifacts (mis-mapping in repeats, paralogous regions, pseudogenes), and genuine biological variation (germline variants, somatic mutations, mosaicism). Historically, this was addressed by complex, modular pipelines combining probabilistic models and hand-crafted heuristics <span class="citation" data-cites="nielsen_error_2011">(<a href="references.html#ref-nielsen_error_2011" role="doc-biblioref">Nielsen et al. 2011</a>)</span>. Deep learning now plays an important role in simplifying and improving parts of this stack, but understanding the classical pipeline remains essential.</p>
<p>This chapter focuses on <strong>germline variant calling in human WES and WGS data</strong>. Somatic variant calling in cancer and RNA-seq-specific variant calling share many parallels but require additional considerations that fall largely outside the scope of Part I.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Overview schematic of an NGS variant-calling workflow, from DNA sample → library prep → sequencer (short vs.&nbsp;long read) → FASTQ → alignment → duplicate marking → BQSR → variant calling → filtering → VCF.</p>
</div>
</div>
</section>
<section id="targeting-strategies-panels-exomes-and-genomes" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="targeting-strategies-panels-exomes-and-genomes"><span class="header-section-number">1.2</span> Targeting Strategies: Panels, Exomes, and Genomes</h2>
<p>NGS is not a single technology; it is deployed in different targeting strategies, each with distinct trade-offs in coverage, cost, and bias. We begin with these strategies before examining pipelines and models.</p>
<section id="targeted-and-panel-sequencing" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="targeted-and-panel-sequencing"><span class="header-section-number">1.2.1</span> Targeted and Panel Sequencing</h3>
<p>Targeted gene panels capture tens to hundreds of genes selected for a specific clinical indication, such as cardiomyopathy, hereditary cancer, or epilepsy. By restricting the target to a small number of loci, panels achieve very deep coverage (often exceeding 500×) at modest cost, enabling sensitive detection of rare variants and some mosaicism. Panels are widely used in clinical genetics for focused, high-yield diagnostic tests.</p>
<p>The narrow scope of panels is their main limitation for deep learning and population-scale analysis. Panels miss novel disease genes outside their target, are not easily repurposed for new traits, and often have heterogeneous content across laboratories. For large-scale genomic foundation models, panel data are more useful as richly phenotyped “anchors” than as primary training material: they provide clean labels but sparse genomic coverage.</p>
</section>
<section id="whole-exome-sequencing" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="whole-exome-sequencing"><span class="header-section-number">1.2.2</span> Whole-Exome Sequencing</h3>
<p>Whole-exome sequencing (WES) enriches coding exons and some splice-adjacent regions across the genome. Exome capture uses hybridization probes to pull down targeted regions, followed by short-read sequencing. Typical coverage ranges from 80 to 150× for exonic targets, though capture efficiency varies across GC content and repetitive exons. WES covers approximately 1 to 2 percent of the genome but concentrates on protein-coding sequence, where variant interpretation is currently most mature.</p>
<p>WES has been especially successful for Mendelian disease gene discovery and early biobank-scale efforts, including the exome subsets of gnomAD and many hospital-based cohorts <span class="citation" data-cites="karczewski_gnomad_2020">(<a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. However, capture-based approaches introduce nonuniform coverage, GC- and sequence-content biases, and batch effects tied to reagent lots and panel designs. Certain exons, especially those that are GC-rich, highly repetitive, or very long, may have systematically low coverage, which propagates into missingness and uncertainty for downstream models.</p>
</section>
<section id="whole-genome-sequencing" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="whole-genome-sequencing"><span class="header-section-number">1.2.3</span> Whole-Genome Sequencing</h3>
<p>Whole-genome sequencing (WGS) samples nearly all bases in the genome, including coding and noncoding regions. Typical coverage is 30 to 60× across the genome, with more uniform depth than WES. Because there is no capture step, WGS produces fewer batch-specific artifacts and enables detection of noncoding variants, structural variants, and copy-number changes along with SNVs and indels.</p>
<p>WGS is increasingly favored for new large cohorts and rare disease studies. The data are reusable for many downstream analyses (GWAS, PGS, rare variant burden tests), and the simplified pipeline eliminates the need to track changing capture designs. WGS supports more complete variant catalogs for the models discussed in later chapters and is the primary data type for many of the biobanks and population resources that underpin modern genomic deep learning <span class="citation" data-cites="bycroft_ukbiobank_2018 karczewski_gnomad_2020">(<a href="references.html#ref-bycroft_ukbiobank_2018" role="doc-biblioref">Bycroft et al. 2018</a>; <a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>)</span>. Throughout this text, when we refer to “whole-genome models,” we implicitly assume access to WGS-based variant calls, even when actual training sets combine WES and WGS data.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Comparative table or radar plot for panels, WES, WGS (and possibly long-read WGS) summarizing target size, typical coverage depth, per-sample cost, ability to detect rare variants, and suitability for large-cohort foundation model training.</p>
</div>
</div>
</section>
<section id="long-read-sequencing-technologies" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="long-read-sequencing-technologies"><span class="header-section-number">1.2.4</span> Long-Read Sequencing Technologies</h3>
<p>While short-read Illumina sequencing dominates population-scale studies, long-read technologies are increasingly important for resolving complex genomic regions and structural variation.</p>
<p>Pacific Biosciences (PacBio) HiFi produces reads of 10 to 25 kilobases with per-base accuracy exceeding 99.9% through circular consensus sequencing <span class="citation" data-cites="wenger_pacbiohifi_2019">(<a href="references.html#ref-wenger_pacbiohifi_2019" role="doc-biblioref">Wenger et al. 2019</a>)</span>. Oxford Nanopore Technologies (ONT) instruments generate reads from a few kilobases up to megabases in length, with rapidly improving raw accuracy and unique capabilities such as portable sequencers, field diagnostics, and direct RNA sequencing <span class="citation" data-cites="dabernig_ont_2024">(<a href="references.html#ref-dabernig_ont_2024" role="doc-biblioref">Dabernig-Heinz et al. 2024</a>)</span>. Long reads can span repetitive elements, resolve haplotypes across tens to hundreds of kilobases, and directly characterize structural variants and complex indels. They played a central role in the telomere-to-telomere (T2T) assembly of a complete human genome and in emerging human pangenome references <span class="citation" data-cites="nurk_complete_2022 liao_pangenome_2023">(<a href="references.html#ref-nurk_complete_2022" role="doc-biblioref">Nurk et al. 2022</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Long reads transform variant calling in several ways. They provide improved mappability, traversing low-complexity and repetitive regions that are essentially invisible to short reads. They enable robust structural variant detection, with callers such as PEPPER-Margin-DeepVariant <span class="citation" data-cites="shafin_pepper_2021">(<a href="references.html#ref-shafin_pepper_2021" role="doc-biblioref">Shafin et al. 2021</a>)</span>, Clair3 <span class="citation" data-cites="zheng_clair3_2022">(<a href="references.html#ref-zheng_clair3_2022" role="doc-biblioref">Zheng et al. 2022</a>)</span>, Sniffles2 <span class="citation" data-cites="smolka_sniffles2_2024">(<a href="references.html#ref-smolka_sniffles2_2024" role="doc-biblioref">Smolka et al. 2024</a>)</span>, pbsv <span class="citation" data-cites="noauthor_pbsv_2025">(<a href="references.html#ref-noauthor_pbsv_2025" role="doc-biblioref"><span>“<span>PacificBiosciences</span>/Pbsv”</span> 2025</a>)</span>, and cuteSV <span class="citation" data-cites="jiang_cutesv_2020">(<a href="references.html#ref-jiang_cutesv_2020" role="doc-biblioref">Jiang et al. 2020</a>)</span> exploiting read-length and alignment patterns to detect insertions, deletions, inversions, and duplications. Single molecules spanning multiple heterozygous sites provide direct phasing information for haplotype resolution. Long reads also inform graph-based references and pangenomes that better represent population diversity <span class="citation" data-cites="liao_pangenome_2023">(<a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>This chapter focuses on short-read pipelines, which remain the workhorse for large human cohorts. However, the models in later chapters must accommodate variants discovered by either technology and must be evaluated on composite callsets that integrate short- and long-read information.</p>
</section>
</section>
<section id="classical-variant-calling-pipelines" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="classical-variant-calling-pipelines"><span class="header-section-number">1.3</span> Classical Variant Calling Pipelines</h2>
<p>While every institution implements its own details, a classical short-read pipeline has several common stages.</p>
<p>The process begins with <strong>base calling and demultiplexing</strong>, where instrument software converts fluorescent images to base calls and quality scores, and reads are demultiplexed by barcode into sample-specific FASTQ files.</p>
<p>Next comes <strong>read alignment</strong>, in which short reads are aligned to a reference genome (such as GRCh38 or T2T-CHM13) using seed-and-extend mappers such as BWA-MEM or minimap2 <span class="citation" data-cites="li_bwa-mem_2013 li_minimap2_2018">(<a href="references.html#ref-li_bwa-mem_2013" role="doc-biblioref">Li 2013</a>, <a href="references.html#ref-li_minimap2_2018" role="doc-biblioref">2018</a>)</span>. Aligners must cope with mismatches, small indels, and repetitive sequence, often producing multiple candidate alignments with associated scores.</p>
<p><strong>Post-alignment processing</strong> follows, including marking or removing PCR duplicates, base quality score recalibration (BQSR) to model systematic quality score errors, and local realignment around indels in older pipelines <span class="citation" data-cites="depristo_gatk_2011 van_der_auwera_gatk_best_2018">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="references.html#ref-van_der_auwera_gatk_best_2018" role="doc-biblioref">Van der Auwera et al. 2018</a>)</span>. These steps aim to correct systematic errors in base qualities and improve alignment around small insertion-deletion events.</p>
<p><strong>Per-sample variant calling</strong> then takes place, where tools like GATK HaplotypeCaller assemble local haplotypes, compute genotype likelihoods at candidate sites, and output per-sample gVCFs that encode both variant calls and “reference blocks” with estimated confidence <span class="citation" data-cites="depristo_gatk_2011">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>)</span>.</p>
<p>Finally, for <strong>cohort variant calling</strong>, joint genotyping and cohort-level filtering combine gVCFs across many samples to produce a multi-sample VCF. Joint genotyping ensures that all samples are evaluated at the same sites, and filtering strategies (hard filters, VQSR, or ML-based filters) select high-confidence variants based on multiple quality axes rather than independent thresholds.</p>
<p>These steps are encoded in pipelines like GATK Best Practices and similar frameworks implemented by large sequencing centers <span class="citation" data-cites="van_der_auwera_gatk_best_2018">(<a href="references.html#ref-van_der_auwera_gatk_best_2018" role="doc-biblioref">Van der Auwera et al. 2018</a>)</span>. The key point is that each step uses hand-designed summary features and mechanistic models chosen by experts, not learned end-to-end.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Block diagram of a short-read variant calling pipeline, with each step (alignment, duplicate marking, BQSR, per-sample calling, joint genotyping, filtering) shown as a box and data formats (FASTQ, BAM/CRAM, gVCF, VCF) annotated along the arrows.</p>
</div>
</div>
<section id="sample-level-quality-control-and-cohort-curation" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="sample-level-quality-control-and-cohort-curation"><span class="header-section-number">1.3.1</span> Sample-Level Quality Control and Cohort Curation</h3>
<p>Before any downstream analysis or training of deep models, variant callsets must pass through sample-level quality control (QC). Sex checks compare reported sex to X/Y coverage and heterozygosity to detect sex mismatches or sex chromosome aneuploidy. Contamination and mixture analysis estimates contamination levels from allelic balance or dedicated tools and excludes heavily contaminated samples. Relatedness and duplicate detection identifies unexpected relatives or duplicate sequencing of the same individual. Ancestry inference estimates genetic ancestry using PCA or clustering, which is crucial both for scientific questions and for controlling confounding in later analyses.</p>
<p>These QC steps determine which samples enter training sets, how models are stratified by ancestry, and which samples may be excluded due to technical artifacts. Throughout the book, when we refer to “a callset,” we implicitly assume that a careful QC process like this has already been applied.</p>
</section>
<section id="probabilistic-framework" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="probabilistic-framework"><span class="header-section-number">1.3.2</span> Probabilistic Framework</h3>
<p>At the core of GATK’s HaplotypeCaller and similar tools is a Bayesian genotype likelihood model. At a given site, the posterior probability of a genotype <span class="math inline">\(G\)</span> (for example, 0/0, 0/1, or 1/1) given the read data <span class="math inline">\(D\)</span> is:</p>
<p><span class="math display">\[
P(G \mid D) \propto P(G) \prod_{r \in \text{reads}} P(r \mid G),
\]</span></p>
<p>where <span class="math inline">\(P(G)\)</span> is a prior over genotypes (often assuming Hardy-Weinberg equilibrium with a specified allele frequency) and <span class="math inline">\(P(r \mid G)\)</span> is the likelihood of observing read <span class="math inline">\(r\)</span> given genotype <span class="math inline">\(G\)</span>. Computing this likelihood is non-trivial: GATK uses a pair hidden Markov model (pair-HMM) to marginalize over possible alignments between the read and candidate haplotypes, incorporating base quality scores to weight the contribution of each base <span class="citation" data-cites="depristo_gatk_2011 li_mapping_2014">(<a href="references.html#ref-depristo_gatk_2011" role="doc-biblioref">DePristo et al. 2011</a>; <a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>.</p>
<p>This formulation assumes conditional independence of reads given the genotype, an assumption known to be violated in practice. Systematic sequencing errors, read pair correlations, and library-level artifacts create dependencies among reads. Classical pipelines try to correct for these effects through BQSR and ad hoc filters, whereas deep learning-based callers can learn these dependencies implicitly. DeepVariant’s CNN, by contrast, sees all reads in a pileup simultaneously and can learn to model these dependencies directly.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Small schematic showing reads aligned at a single site, illustrating how each read contributes to the likelihood term in the Bayesian genotype model (e.g., three reads supporting the alternate allele with different base qualities).</p>
</div>
</div>
<p>The per-read likelihoods are aggregated into genotype likelihoods, which are then combined with priors to yield genotype posterior probabilities. These posteriors become the genotype quality (GQ) scores that downstream analyses often treat as truth.</p>
</section>
</section>
<section id="haplotype-phasing" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="haplotype-phasing"><span class="header-section-number">1.4</span> Haplotype Phasing</h2>
<p>Diploid organisms carry two copies of each autosomal chromosome, one inherited from each parent. A standard VCF encodes genotypes at each site but does not specify which alleles reside together on the same physical chromosome. <strong>Haplotype phasing</strong> resolves this ambiguity by assigning each allele to a specific haplotype, transforming unphased genotypes such as <code>0/1</code> into phased genotypes like <code>0|1</code> or <code>1|0</code>.</p>
<section id="why-phasing-matters" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="why-phasing-matters"><span class="header-section-number">1.4.1</span> Why Phasing Matters</h3>
<p>Phased haplotypes are essential for multiple applications. For interpreting compound heterozygosity, determining whether two rare variants in a gene are on the same or different chromosomes can distinguish benign from pathogenic combinations. In recessive disease, two deleterious variants in the same gene cause disease only if they are on different haplotypes (in <em>trans</em>); unphased calls cannot distinguish <em>cis</em> from <em>trans</em> configurations. For cis-trans regulatory effects, assigning regulatory variants and target gene variants to the same haplotype enables haplotype-specific expression and methylation analyses. For population genetics and LD structure, most statistical genetics methods assume a haplotype model of linkage disequilibrium, which requires well-phased data to estimate recombination and selection. Reference panels used for genotype imputation are stored as phased haplotypes, and accurate phasing improves imputation quality.</p>
<p>In the context of deep learning, phasing determines whether we feed models unordered genotypes or more structured, haplotype-resolved representations, which can change both model design and performance.</p>
</section>
<section id="phasing-methods" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="phasing-methods"><span class="header-section-number">1.4.2</span> Phasing Methods</h3>
<p>Phasing can be achieved through several approaches. <strong>Read-backed phasing</strong> uses sequencing reads that span multiple heterozygous sites to assign alleles to haplotypes. Short reads phase over tens to hundreds of base pairs, while long reads extend this to tens of kilobases or more.</p>
<p><strong>Statistical or population-based phasing</strong> tools such as SHAPEIT, Eagle, and Beagle use haplotype reference panels and linkage disequilibrium to infer phase over much longer distances <span class="citation" data-cites="oconnell_shapeit2_2014 loh_eagle_2016 browning_beagle_2021">(<a href="references.html#ref-oconnell_shapeit2_2014" role="doc-biblioref">O’Connell et al. 2014</a>; <a href="references.html#ref-loh_eagle_2016" role="doc-biblioref">Loh et al. 2016</a>; <a href="references.html#ref-browning_beagle_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>. These methods excel in common variation but struggle with rare variants that lack informative LD.</p>
<p><strong>Pedigree-based phasing</strong> becomes possible when parent-offspring trios or larger pedigrees are available. Mendelian inheritance rules can resolve phase with high confidence, especially when combined with population-based methods.</p>
<p><strong>Long-read and linked-read technologies</strong> provide direct observations of long-range haplotypes by sequencing long molecules or barcoded fragments spanning many heterozygous sites <span class="citation" data-cites="wenger_pacbiohifi_2019 shafin_pepper_2021">(<a href="references.html#ref-wenger_pacbiohifi_2019" role="doc-biblioref">Wenger et al. 2019</a>; <a href="references.html#ref-shafin_pepper_2021" role="doc-biblioref">Shafin et al. 2021</a>)</span>.</p>
<p>Modern pipelines often combine these approaches: statistical phasing anchored by a large reference panel, augmented by read-backed evidence where available, and refined by trio data when present. The result is a phased VCF where each heterozygous genotype is annotated with haplotype structure that downstream analyses can exploit.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Table or multi-panel cartoon comparing phasing strategies: axes for input data (short reads, long reads, trios, population reference), typical genomic span per phased block, and typical use cases (imputation, rare disease, population genetics).</p>
</div>
</div>
</section>
<section id="imputation-and-genotype-refinement" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="imputation-and-genotype-refinement"><span class="header-section-number">1.4.3</span> Imputation and Genotype Refinement</h3>
<p>Phasing is closely tied to <strong>genotype imputation</strong> and <strong>genotype refinement</strong>, which use phased reference panels to improve and extend variant calls.</p>
<p>In genotype imputation, a cohort with incomplete or noisy genotype data (for example, genotyped on an array or sequenced at low coverage) is matched against a reference panel of densely phased haplotypes. Statistical models infer missing genotypes and refine uncertain calls by leveraging LD patterns and shared haplotype segments <span class="citation" data-cites="browning_beagle_2021">(<a href="references.html#ref-browning_beagle_2021" role="doc-biblioref">Browning et al. 2021</a>)</span>. Two related processes are often distinguished. <strong>Within-panel boosting</strong> improves genotype quality at already-typed sites, especially in low-coverage WGS or WES, by pooling information across haplotypes and samples. <strong>Imputation of untyped variants</strong> infers genotypes at variants not directly observed in the study cohort but present in the reference panel, dramatically increasing the density of the callset.</p>
<p>For downstream deep learning, imputation has several important consequences. It increases the number of variants available as input “tokens” for genotype-based models. It changes the distribution of genotype uncertainty, often producing well-calibrated genotype probabilities that can be exploited by probabilistic models. It ties model performance to the composition and ancestry of the reference panel: imputation errors are larger when target individuals are underrepresented in the panel, reinforcing the themes of bias and confounding addressed in <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Cartoon showing how genotype imputation and boosting fill in missing genotypes and refine uncertain calls using a reference panel of phased haplotypes, with before/after views of a sparse vs.&nbsp;dense genotype matrix.</p>
</div>
</div>
</section>
</section>
<section id="sources-of-error-and-uncertainty" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sources-of-error-and-uncertainty"><span class="header-section-number">1.5</span> Sources of Error and Uncertainty</h2>
<p>Even with modern pipelines, variant calls are imperfect. Understanding the main sources of error is essential for interpreting downstream analyses and for designing robust deep models <span class="citation" data-cites="li_mapping_2014">(<a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>.</p>
<p><strong>Mapping ambiguity</strong> arises when reads align almost equally well to multiple locations, such as segmental duplications, paralogous gene families, or repetitive elements. Reads may be arbitrarily assigned, down-weighted, or discarded, leading to false positives in one region and false negatives in another. Reference bias can favor the reference allele in ambiguous regions, causing systematic undercalling of alternate alleles.</p>
<p><strong>Systematic sequencing artifacts</strong> include context-specific errors (for example, homopolymer-associated indels), machine- and chemistry-specific error modes, and index hopping. These artifacts can create correlated false positives that cluster by batch or lane, making them difficult to distinguish from real rare variants.</p>
<p><strong>Low-coverage regions</strong> present another challenge. Stochastic sampling means that some alleles may be missed entirely, and allelic balance can deviate from the expected 50:50 ratio in heterozygotes. Somatic mosaic variants at low allele fraction can be mistaken for noise, while true germline variants may be undercalled.</p>
<p><strong>Complex variants and representation choices</strong> are also problematic. Small indels near homopolymers, multi-nucleotide variants, and overlapping indels can be represented as a single complex variant or decomposed into multiple SNVs, depending on the caller and normalization conventions. Discrepancies in representation complicate comparison across pipelines and benchmarks.</p>
<p>The deep learning models in later chapters inherit these errors and uncertainties. If a variant never enters the VCF, no model trained on VCFs can learn its effect. If genotype qualities are miscalibrated, models trained on hard calls may be overconfident in regions where the input is fundamentally noisy.</p>
</section>
<section id="difficult-regions-for-variant-calling" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="difficult-regions-for-variant-calling"><span class="header-section-number">1.6</span> Difficult Regions for Variant Calling</h2>
<p>Certain regions of the genome are inherently difficult to call with short reads, regardless of algorithmic sophistication. These regions are disproportionately responsible for discordant calls between pipelines and technologies <span class="citation" data-cites="li_mapping_2014">(<a href="references.html#ref-li_mapping_2014" role="doc-biblioref">Li 2014</a>)</span>.</p>
<section id="segmental-duplications-and-paralogs" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="segmental-duplications-and-paralogs"><span class="header-section-number">1.6.1</span> Segmental Duplications and Paralogs</h3>
<p>Regions with high sequence identity to other parts of the genome confound short-read aligners. Paralogous genes, such as <em>SMN1</em> and <em>SMN2</em>, or <em>CYP2D6</em> and its pseudogenes, are particularly challenging. Reads from one copy may map equally well to another, leading to ambiguous alignments and inflated mapping qualities if the ambiguity is not recognized. Variant callers may undercall true variation (to avoid false positives) or call spurious variants in the wrong paralog.</p>
</section>
<section id="low-complexity-and-repetitive-sequence" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="low-complexity-and-repetitive-sequence"><span class="header-section-number">1.6.2</span> Low-Complexity and Repetitive Sequence</h3>
<p>Homopolymers, short tandem repeats, and other low-complexity regions challenge both sequencing chemistry and base calling. Indel error rates are especially high, and many pipelines mask or flag these regions as low confidence. Yet variation in repeats can be biologically important, for example in triplet repeat expansion disorders, so models trained on callsets that ignore these regions will inherit blind spots.</p>
</section>
<section id="the-hla-region-a-case-study" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="the-hla-region-a-case-study"><span class="header-section-number">1.6.3</span> The HLA Region: A Case Study</h3>
<p>The human leukocyte antigen (HLA) locus on chromosome 6p21 is among the most polymorphic regions in the human genome and among the most clinically important. HLA genes (<em>HLA-A</em>, <em>HLA-B</em>, <em>HLA-C</em>, <em>HLA-DRB1</em>, and others) harbor extensive allelic diversity, structural variation, and copy-number changes. Local sequence similarity, gene conversions, and pseudogenes create a dense thicket of near-identical sequences.</p>
<p>HLA is difficult to call for several reasons. The extreme polymorphism means that many alleles differ by only a few bases, while others involve larger structural differences. Different HLA alleles may differ by only a few nucleotides, making accurate allele-level typing difficult with short reads alone. High homology among closely related genes and pseudogenes confuses alignment and local assembly. Standard reference-based alignment struggles because reads may match the reference poorly even when they represent common, well-characterized alleles. Structural variation and copy number differences, especially in class II regions, violate assumptions of simple diploid models. Reads carrying non-reference HLA alleles may fail to align or align with low mapping quality, causing systematic undercalling of alternate alleles.</p>
<p>Despite these challenges, accurate HLA typing is essential for several clinical applications. In transplantation, HLA matching between donor and recipient is critical for solid organ and hematopoietic stem cell transplant outcomes. HLA alleles are the strongest genetic risk factors for many autoimmune conditions, including type 1 diabetes, rheumatoid arthritis, and multiple sclerosis; fine-mapping causal alleles and amino acid positions requires accurate genotyping <span class="citation" data-cites="sakaue_hla_2023">(<a href="references.html#ref-sakaue_hla_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>. Specific HLA alleles, such as <em>HLA-B*57:01</em> for abacavir and <em>HLA-B*15:02</em> for carbamazepine, are pharmacogenomic markers for severe adverse drug reactions <span class="citation" data-cites="mallal_abacavir_2008 chung_carbamazepine_2004">(<a href="references.html#ref-mallal_abacavir_2008" role="doc-biblioref">Mallal et al. 2008</a>; <a href="references.html#ref-chung_carbamazepine_2004" role="doc-biblioref">Chung et al. 2004</a>)</span>. HLA diversity also shapes immune responses to pathogens, including HIV, hepatitis viruses, and SARS-CoV-2 <span class="citation" data-cites="robinson_hla-db_2020 sakaue_hla_2023">(<a href="references.html#ref-robinson_hla-db_2020" role="doc-biblioref">Robinson et al. 2020</a>; <a href="references.html#ref-sakaue_hla_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>.</p>
<p>Because standard variant callers perform poorly in HLA, specialized tools have been developed. HLA imputation methods use dense reference panels to impute HLA alleles from array genotypes, enabling large-scale association studies <span class="citation" data-cites="sakaue_hla_2023">(<a href="references.html#ref-sakaue_hla_2023" role="doc-biblioref">Sakaue et al. 2023</a>)</span>. Sequence-based typing tools such as T1K perform HLA and KIR (killer immunoglobulin-like receptor) genotyping directly from WES, WGS, or RNA-seq data by aligning reads against allele databases (such as IPD-IMGT/HLA) rather than the linear reference genome <span class="citation" data-cites="song_t1k_2022">(<a href="references.html#ref-song_t1k_2022" role="doc-biblioref">Song et al. 2022</a>)</span>. Graph-based approaches that incorporate known HLA alleles as alternate paths can improve alignment and variant calling in this region <span class="citation" data-cites="garrison_vgtool_2018 liao_pangenome_2023">(<a href="references.html#ref-garrison_vgtool_2018" role="doc-biblioref">Garrison et al. 2018</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>For the purposes of this book, HLA exemplifies a broader lesson: <strong>regions that are biologically rich are often technically difficult.</strong> Deep models trained on callsets that downweight or exclude these regions inherit their absence, and careful evaluation must either explicitly include or explicitly acknowledge them.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Zoomed-in view of the HLA region comparing a linear reference vs.&nbsp;graph/pangenome representation, with multiple alternative haplotypes and structural variants, highlighting why linear alignment fails and how graph alignment improves recall.</p>
</div>
</div>
</section>
</section>
<section id="benchmarking-and-ground-truth" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="benchmarking-and-ground-truth"><span class="header-section-number">1.7</span> Benchmarking and Ground Truth</h2>
<p>Evaluating variant callers requires high-confidence truth sets and standardized benchmarking tools. Without careful benchmarking, it is easy to overfit to specific datasets, underestimate errors in difficult regions, or misinterpret the consequences of small improvements.</p>
<section id="giab-reference-samples" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="giab-reference-samples"><span class="header-section-number">1.7.1</span> GIAB Reference Samples</h3>
<p>The Genome in a Bottle (GIAB) Consortium, coordinated by NIST, provides extensively characterized reference samples with validated variant calls across most of the genome <span class="citation" data-cites="zook_giab_2019">(<a href="references.html#ref-zook_giab_2019" role="doc-biblioref">Zook et al. 2019</a>)</span>. The primary GIAB samples include NA12878 (also known as HG001), a well-studied female of European ancestry from the CEPH/Utah pedigree with the longest history of characterization. The collection also includes HG002 through HG007: an Ashkenazi Jewish trio (HG002 to HG004) and a Han Chinese trio (HG005 to HG007), providing diversity and enabling trio-based validation.</p>
<p>For each sample, GIAB provides high-confidence variant calls, representing consensus calls derived from multiple sequencing technologies and variant callers that constitute the best current estimate of true genotypes. They also define high-confidence regions, genomic intervals where the truth set is believed to be reliable, as well as BED files defining difficult regions and stratifications by genomic context. Benchmarking tools such as hap.py and RTG Tools enable standardized comparison of callsets against truth, implementing reproducible reporting of precision, recall, and F1 by variant type <span class="citation" data-cites="krusche_happy_2019 noauthor_rtg-core_2025">(<a href="references.html#ref-krusche_happy_2019" role="doc-biblioref">Krusche et al. 2019</a>; <a href="references.html#ref-noauthor_rtg-core_2025" role="doc-biblioref"><span>“<span>RealTimeGenomics</span>/Rtg-Core”</span> 2025</a>)</span>.</p>
</section>
<section id="benchmarking-metrics" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="benchmarking-metrics"><span class="header-section-number">1.7.2</span> Benchmarking Metrics</h3>
<p>Standard metrics for variant calling include recall (sensitivity), defined as the fraction of true variants in the benchmark that are recovered by the caller; precision (positive predictive value), defined as the fraction of called variants that are present in the benchmark truth set; and F1 score, the harmonic mean of precision and recall providing a single summary statistic. These are typically reported separately for SNVs and indels and may be stratified by genomic context, such as performance inside versus outside difficult regions.</p>
<p>Metrics can be defined per-variant, per-genotype, or per-site, and can also be aggregated at the sample level. For downstream models, genotype-level accuracy (getting the zygosity right) and sample-level completeness (fraction of callable genotypes per sample) are often more relevant than simply counting variant matches.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Example precision-recall or ROC curves for two variant callers evaluated on a GIAB-like benchmark, plus a small confusion-matrix-style illustration showing how false positives and false negatives map to the metrics.</p>
</div>
</div>
</section>
<section id="limitations-of-current-benchmarks" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="limitations-of-current-benchmarks"><span class="header-section-number">1.7.3</span> Limitations of Current Benchmarks</h3>
<p>GIAB truth sets have known limitations. They are derived primarily from a small number of deeply sequenced samples, often of European ancestry, and initially focused on “easy” regions with high confidence. High-confidence regions cover only approximately 85 to 90 percent of the genome, so performance in excluded regions is unknown. Performance in underrepresented ancestries, in complex regions, and for structural variants may differ substantially from GIAB metrics <span class="citation" data-cites="zook_giab_2019 liao_pangenome_2023">(<a href="references.html#ref-zook_giab_2019" role="doc-biblioref">Zook et al. 2019</a>; <a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
<p>Moreover, when benchmarks are reused for method development, there is a risk of <strong>overfitting to the benchmark</strong>: pipelines may be tuned to maximize F1 on GIAB-like datasets without improving performance in real-world cohorts. For deep learning-based callers, which have large capacity to absorb quirks in training data, this risk is especially salient. Later chapters revisit similar issues for benchmarking and evaluating deep models (<a href="p5-ch18-benchmarks.html" class="quarto-xref"><span>Chapter 18</span></a>, <a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
<p>Ongoing efforts, including the T2T Consortium’s complete genome assemblies and the Human Pangenome Reference Consortium’s diverse haplotype collection, are expanding the scope of benchmarking resources <span class="citation" data-cites="liao_pangenome_2023">(<a href="references.html#ref-liao_pangenome_2023" role="doc-biblioref">Liao et al. 2023</a>)</span>.</p>
</section>
</section>
<section id="sec-deepvar" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="sec-deepvar"><span class="header-section-number">1.8</span> DeepVariant: CNNs for Variant Calling</h2>
<p>DeepVariant replaces much of the hand-engineered logic in classical pipelines with a deep convolutional neural network that predicts genotypes directly from read pileups <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>. It is a canonical example of using deep learning to improve an existing workflow without fully rethinking the problem formulation.</p>
<section id="image-like-pileup-representation" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="image-like-pileup-representation"><span class="header-section-number">1.8.1</span> Image-Like Pileup Representation</h3>
<p>Around each candidate variant site, DeepVariant constructs a multi-channel tensor resembling an image. Each row corresponds to a read overlapping the site, with one dimension indexing positions relative to the candidate site. Channels encode information such as reference match/mismatch status, Phred-scaled base quality scores, mapping quality, strand orientation, allele support (reference versus alternate), and additional alignment features. The reference sequence and candidate alleles are overlaid.</p>
<p>This representation turns the variant calling problem into an image classification task: given a small, fixed-size “picture” of the local alignment context, predict the probability of each genotype. The pileup tensor captures not just which bases are present, but how they are arranged across reads, enabling the model to detect patterns like strand-biased support or mismatches clustered at read ends.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Example DeepVariant-style pileup image with color channels labeled (reference, base identity, base quality, strand, mapping quality), showing how reads stack around a potential variant site.</p>
</div>
</div>
</section>
<section id="inception-style-cnn-classifier" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="inception-style-cnn-classifier"><span class="header-section-number">1.8.2</span> Inception-Style CNN Classifier</h3>
<p>DeepVariant uses an Inception-style CNN architecture originally developed for natural image classification. Trained on high-confidence truth sets such as GIAB genomes, the CNN processes the pileup tensor through multiple convolutional layers, pooling operations, and non-linearities, finally outputting genotype probabilities for each candidate site <span class="citation" data-cites="poplin_deepvariant_2018">(<a href="references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">Poplin et al. 2018</a>)</span>. It learns to recognize true variant patterns, including balanced allele support across strands, consistent base qualities, and clean alignments, while rejecting artifacts such as strand-biased support, mapping pileups in repeats, and inconsistent quality profiles.</p>
<p>Crucially, DeepVariant learns to weigh quality signals jointly and end-to-end, rather than relying on manually defined summary statistics or post-hoc recalibration. During training, the model sees many examples of true variants and non-variants, along with their associated pileups, and learns complex decision boundaries that combine base quality, mapping quality, local context, and read-level patterns. Where VQSR fits a separate model on hand-selected annotations after calling, DeepVariant integrates the raw evidence directly into its classification.</p>
<p>Because the model is trained end-to-end on labeled examples, its genotype likelihoods tend to be well calibrated across a range of sequencing chemistries, instruments, and read lengths, especially when fine-tuned for specific settings <span class="citation" data-cites="yun_accurate_2021">(<a href="references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. Once trained, the same architecture generalizes across whole-genome versus whole-exome data, PCR-free versus PCR-amplified libraries, and different instrument models and read lengths. This contrasts with classical pipelines where calibration is often a separate, post hoc step.</p>
</section>
<section id="cohort-calling-with-deepvariant-and-glnexus" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="cohort-calling-with-deepvariant-and-glnexus"><span class="header-section-number">1.8.3</span> Cohort Calling with DeepVariant and GLnexus</h3>
<p>DeepVariant operates primarily at the per-sample level: for each sample, it produces a gVCF of genotype likelihoods and candidate variant calls. To generate a multi-sample VCF, these gVCFs are combined by a joint genotyper and cohort-level variant filter.</p>
<p>GLnexus is a widely used system for joint calling DeepVariant gVCFs at cohort scale <span class="citation" data-cites="yun_accurate_2021">(<a href="references.html#ref-yun_accurate_2021" role="doc-biblioref">Yun et al. 2021</a>)</span>. GLnexus merges per-sample likelihoods, applies cohort-level priors, and performs multi-sample genotype refinement and filtering. Together, DeepVariant and GLnexus form a modular pipeline: DeepVariant replaces HaplotypeCaller as the per-sample likelihood engine, while the overall structure (per-sample calls → cohort-level joint calling → filtering) remains similar.</p>
<p>Joint calling matters for several reasons. It improves sensitivity for rare variants: a variant observed in only one or two individuals may have weak per-sample evidence, but by combining likelihoods across carriers, joint calling can recover true rare variants that would be filtered in single-sample analysis. Joint calling ensures consistent representation, so that the same variants are genotyped across all samples, avoiding the problem of comparing different candidate variant sites. Cohort-level quality filters can identify and remove systematic artifacts that affect subsets of samples, reducing batch effects and improving allele frequency estimates for downstream GWAS and PRS accuracy.</p>
<p>This combination has become a de facto standard for large WES and WGS projects, including recent releases of gnomAD and UK Biobank <span class="citation" data-cites="karczewski_gnomad_2020 bycroft_ukbiobank_2018">(<a href="references.html#ref-karczewski_gnomad_2020" role="doc-biblioref">Karczewski et al. 2020</a>; <a href="references.html#ref-bycroft_ukbiobank_2018" role="doc-biblioref">Bycroft et al. 2018</a>)</span>.</p>
</section>
<section id="comparison-classical-pipelines-vs.-deepvariant" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="comparison-classical-pipelines-vs.-deepvariant"><span class="header-section-number">1.8.4</span> Comparison: Classical Pipelines vs.&nbsp;DeepVariant</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 36%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>GATK HaplotypeCaller</th>
<th>DeepVariant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Core approach</strong></td>
<td>Pair-HMM + hand-crafted heuristics</td>
<td>CNN on pileup tensors</td>
</tr>
<tr class="even">
<td><strong>Feature engineering</strong></td>
<td>Expert-designed (MQ, DP, FS, etc.)</td>
<td>Learned end-to-end from data</td>
</tr>
<tr class="odd">
<td><strong>Read independence</strong></td>
<td>Assumed (violated in practice)</td>
<td>Implicitly models dependencies across reads</td>
</tr>
<tr class="even">
<td><strong>Calibration</strong></td>
<td>VQSR post-hoc recalibration</td>
<td>Well-calibrated likelihoods after training</td>
</tr>
<tr class="odd">
<td><strong>Generalization</strong></td>
<td>Requires species/platform tuning</td>
<td>Transfers across species and platforms</td>
</tr>
<tr class="even">
<td><strong>Structural variants</strong></td>
<td>Limited (SNVs/indels only)</td>
<td>Limited (SNVs/indels only)</td>
</tr>
<tr class="odd">
<td><strong>Implementation burden</strong></td>
<td>Many interacting modules and thresholds</td>
<td>One large model + simpler pre/post-processing</td>
</tr>
</tbody>
</table>
<p>Both approaches achieve comparable accuracy on high-quality Illumina data, but DeepVariant often shows advantages in difficult contexts, in calibration, and in cross-platform generalization. At the same time, DeepVariant still lives inside a broader classical pipeline: alignment, duplicate marking, BQSR, and joint genotyping remain largely unchanged.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Side-by-side schematic of a classical GATK-style pipeline vs.&nbsp;a DeepVariant-enhanced pipeline, emphasizing which components are hand-crafted vs.&nbsp;learned, and where DL models plug into the overall workflow.</p>
</div>
</div>
<p>Beyond DeepVariant, many long-read and graph-based variant callers adopt the same core idea: <strong>learn a mapping from read pileups or local assemblies to genotype probabilities</strong>. DeepVariant is thus a useful conceptual bridge between classical pipelines and the more ambitious, end-to-end models discussed later.</p>
</section>
</section>
<section id="significance-for-genomic-deep-learning" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="significance-for-genomic-deep-learning"><span class="header-section-number">1.9</span> Significance for Genomic Deep Learning</h2>
<p>NGS and variant calling set the stage for everything else in this book. They determine what data we model, where we have coverage, and where we have systematic blind spots.</p>
<section id="defining-the-atoms-we-model" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="defining-the-atoms-we-model"><span class="header-section-number">1.9.1</span> Defining the Atoms We Model</h3>
<p>The output of WES and WGS pipelines, a VCF of SNVs, indels, and inferred genotypes, defines the <strong>atoms</strong> that many downstream models operate on. Polygenic risk scores (PGS), GWAS summary statistics, genotype-based foundation models, and many variant annotation tools treat variants (or genomic positions) as discrete tokens.</p>
<p>If a variant is never called, it never appears in the training data, and no model can learn its effect. False positives introduce noise into labels and features; false negatives create blind spots where models must extrapolate from incomplete information. Choices about phasing, imputation, and representation (for example, multi-allelic versus biallelic decomposition) also determine whether models see haplotypes, genotypes, or scalar summary statistics. The quality of variant calls directly limits the quality of downstream models.</p>
</section>
<section id="constraining-downstream-models" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="constraining-downstream-models"><span class="header-section-number">1.9.2</span> Constraining Downstream Models</h3>
<p>Upstream decisions constrain what downstream sequence and variant effect models can learn. If an assay rarely observes indels or structural variants in certain repeat classes, deep models trained on those callsets will effectively learn a world where such variants do not exist. If certain ancestries are underrepresented in reference panels or truth sets, models trained on those data may perform poorly for those groups while appearing well-calibrated in benchmarks. If variant quality metrics (MQ, GQ, depth, strand bias) are heavily used in filtering, the resulting callset may be cleaner but less representative of challenging contexts. Difficult regions such as HLA and segmental duplications may be systematically excluded from training data, and models inherit their biases and gaps.</p>
<p>For regulatory sequence models and variant effect predictors in coding and noncoding regions (<a href="p3-ch11-dna.html" class="quarto-xref"><span>Chapter 11</span></a>, <a href="p3-ch10-cnn.html#sec-reg" class="quarto-xref"><span>Section 10.1</span></a>, <a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a>, <a href="p1-ch04-cadd.html" class="quarto-xref"><span>Chapter 4</span></a>), upstream variant calling determines which sites appear as candidates and how often certain patterns (for example, homopolymer indels, splice acceptor disruptions) are observed.</p>
</section>
<section id="effect-sizes-and-practical-impact" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="effect-sizes-and-practical-impact"><span class="header-section-number">1.9.3</span> Effect Sizes and Practical Impact</h3>
<p>Variant calling decisions matter because they modulate the <strong>effective effect sizes</strong> that downstream models can detect and learn from. Several regimes are worth distinguishing.</p>
<p><strong>Common variants with small effects.</strong> For highly polygenic traits, individual variant effect sizes are tiny. A modest amount of genotype error or imputation noise mostly acts as additional measurement error, attenuating estimated effect sizes and reducing GWAS power but rarely creating spurious large effects. In this regime, improving variant calling in already “easy” regions yields diminishing returns compared to increasing sample size or improving phenotype quality.</p>
<p><strong>Rare variants with large effects.</strong> Loss-of-function variants, damaging missense mutations, and certain splice-altering variants can have large effects on disease risk and molecular phenotypes. Here, <strong>false negatives dominate</strong>: if the variant is never called or is assigned low-quality genotypes, its effect is invisible to association tests and to deep models trained on called genotypes. Small improvements in recall in these regions can have outsized impact on gene discovery and clinical interpretation.</p>
<p><strong>Mis-calibrated genotype probabilities.</strong> Many downstream models implicitly assume that genotype calls and quality scores are well calibrated. Overconfident but wrong calls effectively “inflate” effect size estimates for artifacts, while underconfident correct calls dilute true effects. DeepVariant-like calibration tends to preserve effect size estimates better, especially when models explicitly use genotype probabilities rather than hard calls.</p>
<p><strong>Imputation quality and LD structure.</strong> For imputed variants, the squared correlation <span class="math inline">\(r^2\)</span> between true and imputed genotypes acts as an attenuation factor on effect sizes: an association with true effect <span class="math inline">\(\beta\)</span> behaves as if its effect were approximately <span class="math inline">\(r^2 \beta\)</span> in downstream analyses. Improvements in imputation quality, especially in underrepresented ancestries or for low-frequency variants, therefore directly scale the effective effect sizes that models can learn.</p>
<p><strong>Clinically critical loci and difficult regions.</strong> Many pharmacogenomic and immune-related effect sizes reside in technically challenging regions such as HLA, CYP gene families, and other paralog-rich loci. Global metrics (for example, genome-wide F1) may change only slightly when these regions improve, but the <strong>clinical effect size</strong> of such improvements, measured in terms of adverse drug reactions avoided or transplant matches correctly identified, can be enormous.</p>
<p>When designing and evaluating deep models, it is therefore not enough to ask whether an upstream pipeline has “high accuracy” overall. We care about <strong>where</strong> improvements occur and <strong>which effect sizes</strong> they amplify or attenuate. Later chapters return to these themes when we discuss polygenic scores, variant interpretation, and clinical deployment (<a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a>, <a href="p1-ch04-cadd.html" class="quarto-xref"><span>Chapter 4</span></a>, <a href="p6-ch23-clinical.html" class="quarto-xref"><span>Chapter 23</span></a>).</p>
</section>
<section id="motivating-end-to-end-learning" class="level3" data-number="1.9.4">
<h3 data-number="1.9.4" class="anchored" data-anchor-id="motivating-end-to-end-learning"><span class="header-section-number">1.9.4</span> Motivating End-to-End Learning</h3>
<p>DeepVariant is an early example of replacing a hand-designed component of the pipeline with a learned model. This paradigm, replacing feature engineering with learned representations, recurs throughout the book. DeepSEA and Basenji (<a href="p3-ch10-cnn.html#sec-reg" class="quarto-xref"><span>Section 10.1</span></a>) learn regulatory grammars from sequence. SpliceAI (<a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a>) predicts splicing from local sequence context. DNA language models (<a href="p3-ch11-dna.html" class="quarto-xref"><span>Chapter 11</span></a>) learn general-purpose representations from unlabeled genomes. In each case, the question is whether learned representations outperform hand-crafted features, and under what conditions.</p>
<p>DeepVariant raises broader questions that echo throughout this book. Which parts of genomic analysis pipelines are amenable to end-to-end learning? When do learned representations and decision rules outperform hand-crafted features? How do we ensure that learned models remain interpretable and robust?</p>
<p>Some recent work pushes further upstream, modeling raw sequencing signal (for example, nanopore current traces) or minimally processed reads directly, with the goal of learning both alignment and variant calling jointly. Others propose downstream models that reason directly over reads and phenotypes, bypassing intermediate variant calls. These directions blur the line between “variant calling” and “downstream modeling,” and foreshadow the joint, multi-scale foundation models discussed in later parts of this book.</p>
</section>
<section id="looking-ahead" class="level3" data-number="1.9.5">
<h3 data-number="1.9.5" class="anchored" data-anchor-id="looking-ahead"><span class="header-section-number">1.9.5</span> Looking Ahead</h3>
<p>The remaining chapters in Part I describe how variant calls are linked to phenotypes, used to construct polygenic scores (<a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a>), and integrated with sequence-based models of regulatory function and splicing (<a href="p3-ch11-dna.html" class="quarto-xref"><span>Chapter 11</span></a>, <a href="p3-ch10-cnn.html#sec-reg" class="quarto-xref"><span>Section 10.1</span></a>, <a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a>, <a href="p1-ch04-cadd.html" class="quarto-xref"><span>Chapter 4</span></a>). We also return to upstream choices when discussing confounders, dataset artifacts, and evaluation strategies (<a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>, <a href="p5-ch18-benchmarks.html" class="quarto-xref"><span>Chapter 18</span></a>, <a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
<p>For now, the key takeaways are:</p>
<ol type="1">
<li>Variant calling is a complex, multi-stage pipeline whose outputs are treated as ground truth by most downstream models.</li>
<li>Errors, biases, and design choices in this pipeline propagate into every subsequent analysis.</li>
<li>Deep learning has already improved important components of the pipeline and will likely play an increasing role in future “end-to-end” genomic systems.</li>
</ol>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visual TODO: Conceptual “stack” figure showing raw sequence/signal → variant calling → variant-level representations (VCF, annotations) → genomic foundation models → downstream tasks (PGS, regulatory prediction, variant interpretation), with arrows indicating how errors/choices propagate upward.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-browning_beagle_2021" class="csl-entry" role="listitem">
Browning, Brian L., Xiaowen Tian, Ying Zhou, and Sharon R. Browning. 2021. <span>“Fast Two-Stage Phasing of Large-Scale Sequence Data.”</span> <em>American Journal of Human Genetics</em> 108 (10): 1880–90. <a href="https://doi.org/10.1016/j.ajhg.2021.08.005">https://doi.org/10.1016/j.ajhg.2021.08.005</a>.
</div>
<div id="ref-bycroft_ukbiobank_2018" class="csl-entry" role="listitem">
Bycroft, Clare, Colin Freeman, Desislava Petkova, Gavin Band, Lloyd T. Elliott, Kevin Sharp, Allan Motyer, et al. 2018. <span>“The <span>UK</span> <span>Biobank</span> Resource with Deep Phenotyping and Genomic Data.”</span> <em>Nature</em> 562 (7726): 203–9. <a href="https://doi.org/10.1038/s41586-018-0579-z">https://doi.org/10.1038/s41586-018-0579-z</a>.
</div>
<div id="ref-chung_carbamazepine_2004" class="csl-entry" role="listitem">
Chung, Wen-Hung, Shuen-Iu Hung, Hong-Shang Hong, Mo-Song Hsih, Li-Cheng Yang, Hsin-Chun Ho, Jer-Yuarn Wu, and Yuan-Tsong Chen. 2004. <span>“A Marker for <span>Stevens</span>–<span>Johnson</span> Syndrome.”</span> <em>Nature</em> 428 (6982): 486–86. <a href="https://doi.org/10.1038/428486a">https://doi.org/10.1038/428486a</a>.
</div>
<div id="ref-dabernig_ont_2024" class="csl-entry" role="listitem">
Dabernig-Heinz, Johanna, Mara Lohde, Martin Hölzer, Adriana Cabal, Rick Conzemius, Christian Brandt, Matthias Kohl, et al. 2024. <span>“A Multicenter Study on Accuracy and Reproducibility of Nanopore Sequencing-Based Genotyping of Bacterial Pathogens.”</span> <em>Journal of Clinical Microbiology</em> 62 (9): e00628–24. <a href="https://doi.org/10.1128/jcm.00628-24">https://doi.org/10.1128/jcm.00628-24</a>.
</div>
<div id="ref-depristo_gatk_2011" class="csl-entry" role="listitem">
DePristo, Mark A., Eric Banks, Ryan Poplin, Kiran V. Garimella, Jared R. Maguire, Christopher Hartl, Anthony A. Philippakis, et al. 2011. <span>“A Framework for Variation Discovery and Genotyping Using Next-Generation <span>DNA</span> Sequencing Data.”</span> <em>Nature Genetics</em> 43 (5): 491–98. <a href="https://doi.org/10.1038/ng.806">https://doi.org/10.1038/ng.806</a>.
</div>
<div id="ref-garrison_vgtool_2018" class="csl-entry" role="listitem">
Garrison, Erik, Jouni Sirén, Adam M. Novak, Glenn Hickey, Jordan M. Eizenga, Eric T. Dawson, William Jones, et al. 2018. <span>“Variation Graph Toolkit Improves Read Mapping by Representing Genetic Variation in the Reference.”</span> <em>Nature Biotechnology</em> 36 (9): 875–79. <a href="https://doi.org/10.1038/nbt.4227">https://doi.org/10.1038/nbt.4227</a>.
</div>
<div id="ref-goodwin_10year_2016" class="csl-entry" role="listitem">
Goodwin, Sara, John D. McPherson, and W. Richard McCombie. 2016. <span>“Coming of Age: Ten Years of Next-Generation Sequencing Technologies.”</span> <em>Nature Reviews Genetics</em> 17 (6): 333–51. <a href="https://doi.org/10.1038/nrg.2016.49">https://doi.org/10.1038/nrg.2016.49</a>.
</div>
<div id="ref-jiang_cutesv_2020" class="csl-entry" role="listitem">
Jiang, Tao, Yongzhuang Liu, Yue Jiang, Junyi Li, Yan Gao, Zhe Cui, Yadong Liu, Bo Liu, and Yadong Wang. 2020. <span>“Long-Read-Based Human Genomic Structural Variation Detection with <span class="nocase">cuteSV</span>.”</span> <em>Genome Biology</em> 21 (1): 189. <a href="https://doi.org/10.1186/s13059-020-02107-y">https://doi.org/10.1186/s13059-020-02107-y</a>.
</div>
<div id="ref-karczewski_gnomad_2020" class="csl-entry" role="listitem">
Karczewski, Konrad J., Laurent C. Francioli, Grace Tiao, Beryl B. Cummings, Jessica Alföldi, Qingbo Wang, Ryan L. Collins, et al. 2020. <span>“The Mutational Constraint Spectrum Quantified from Variation in 141,456 Humans.”</span> <em>Nature</em> 581 (7809): 434–43. <a href="https://doi.org/10.1038/s41586-020-2308-7">https://doi.org/10.1038/s41586-020-2308-7</a>.
</div>
<div id="ref-krusche_happy_2019" class="csl-entry" role="listitem">
Krusche, Peter, Len Trigg, Paul C. Boutros, Christopher E. Mason, Francisco M. De La Vega, Benjamin L. Moore, Mar Gonzalez-Porta, et al. 2019. <span>“Best <span>Practices</span> for <span>Benchmarking</span> <span>Germline</span> <span>Small</span> <span>Variant</span> <span>Calls</span> in <span>Human</span> <span>Genomes</span>.”</span> <em>Nature Biotechnology</em> 37 (5): 555–60. <a href="https://doi.org/10.1038/s41587-019-0054-x">https://doi.org/10.1038/s41587-019-0054-x</a>.
</div>
<div id="ref-li_bwa-mem_2013" class="csl-entry" role="listitem">
Li, Heng. 2013. <span>“Aligning Sequence Reads, Clone Sequences and Assembly Contigs with <span>BWA</span>-<span>MEM</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1303.3997">https://doi.org/10.48550/arXiv.1303.3997</a>.
</div>
<div id="ref-li_mapping_2014" class="csl-entry" role="listitem">
———. 2014. <span>“Towards <span>Better</span> <span>Understanding</span> of <span>Artifacts</span> in <span>Variant</span> <span>Calling</span> from <span>High</span>-<span>Coverage</span> <span>Samples</span>.”</span> <em>Bioinformatics</em> 30 (20): 2843–51. <a href="https://doi.org/10.1093/bioinformatics/btu356">https://doi.org/10.1093/bioinformatics/btu356</a>.
</div>
<div id="ref-li_minimap2_2018" class="csl-entry" role="listitem">
———. 2018. <span>“Minimap2: Pairwise Alignment for Nucleotide Sequences.”</span> <em>Bioinformatics</em> 34 (18): 3094–3100. <a href="https://doi.org/10.1093/bioinformatics/bty191">https://doi.org/10.1093/bioinformatics/bty191</a>.
</div>
<div id="ref-liao_pangenome_2023" class="csl-entry" role="listitem">
Liao, Wen-Wei, Mobin Asri, Jana Ebler, Daniel Doerr, Marina Haukness, Glenn Hickey, Shuangjia Lu, et al. 2023. <span>“A Draft Human Pangenome Reference.”</span> <em>Nature</em> 617 (7960): 312–24. <a href="https://doi.org/10.1038/s41586-023-05896-x">https://doi.org/10.1038/s41586-023-05896-x</a>.
</div>
<div id="ref-loh_eagle_2016" class="csl-entry" role="listitem">
Loh, Po-Ru, Petr Danecek, Pier Francesco Palamara, Christian Fuchsberger, Yakir A Reshef, Hilary K Finucane, Sebastian Schoenherr, et al. 2016. <span>“Reference-Based Phasing Using the <span>Haplotype</span> <span>Reference</span> <span>Consortium</span> Panel.”</span> <em>Nature Genetics</em> 48 (11): 1443–48. <a href="https://doi.org/10.1038/ng.3679">https://doi.org/10.1038/ng.3679</a>.
</div>
<div id="ref-mallal_abacavir_2008" class="csl-entry" role="listitem">
Mallal, Simon, Elizabeth Phillips, Giampiero Carosi, Jean-Michel Molina, Cassy Workman, Janez Tomažič, Eva Jägel-Guedes, et al. 2008. <span>“<span>HLA</span>-<span>B</span>*5701 <span>Screening</span> for <span>Hypersensitivity</span> to <span>Abacavir</span>.”</span> <em>New England Journal of Medicine</em> 358 (6): 568–79. <a href="https://doi.org/10.1056/NEJMoa0706135">https://doi.org/10.1056/NEJMoa0706135</a>.
</div>
<div id="ref-nielsen_error_2011" class="csl-entry" role="listitem">
Nielsen, Rasmus, Joshua S. Paul, Anders Albrechtsen, and Yun S. Song. 2011. <span>“Genotype and <span>SNP</span> Calling from Next-Generation Sequencing Data.”</span> <em>Nature Reviews. Genetics</em> 12 (6): 443–51. <a href="https://doi.org/10.1038/nrg2986">https://doi.org/10.1038/nrg2986</a>.
</div>
<div id="ref-nurk_complete_2022" class="csl-entry" role="listitem">
Nurk, Sergey, Sergey Koren, Arang Rhie, Mikko Rautiainen, Andrey V. Bzikadze, Alla Mikheenko, Mitchell R. Vollger, et al. 2022. <span>“The Complete Sequence of a Human Genome.”</span> <em>Science</em> 376 (6588): 44–53. <a href="https://doi.org/10.1126/science.abj6987">https://doi.org/10.1126/science.abj6987</a>.
</div>
<div id="ref-oconnell_shapeit2_2014" class="csl-entry" role="listitem">
O’Connell, Jared, Deepti Gurdasani, Olivier Delaneau, Nicola Pirastu, Sheila Ulivi, Massimiliano Cocca, Michela Traglia, et al. 2014. <span>“A <span>General</span> <span>Approach</span> for <span>Haplotype</span> <span>Phasing</span> Across the <span>Full</span> <span>Spectrum</span> of <span>Relatedness</span>.”</span> <em>PLOS Genetics</em> 10 (4): e1004234. <a href="https://doi.org/10.1371/journal.pgen.1004234">https://doi.org/10.1371/journal.pgen.1004234</a>.
</div>
<div id="ref-noauthor_pbsv_2025" class="csl-entry" role="listitem">
<span>“<span>PacificBiosciences</span>/Pbsv.”</span> 2025. PacBio. <a href="https://github.com/PacificBiosciences/pbsv">https://github.com/PacificBiosciences/pbsv</a>.
</div>
<div id="ref-poplin_deepvariant_2018" class="csl-entry" role="listitem">
Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. <span>“[<span>DeepVariant</span>] <span>A</span> Universal <span>SNP</span> and Small-Indel Variant Caller Using Deep Neural Networks.”</span> <em>Nature Biotechnology</em> 36 (10): 983–87. <a href="https://doi.org/10.1038/nbt.4235">https://doi.org/10.1038/nbt.4235</a>.
</div>
<div id="ref-noauthor_rtg-core_2025" class="csl-entry" role="listitem">
<span>“<span>RealTimeGenomics</span>/Rtg-Core.”</span> 2025. Real Time Genomics. <a href="https://github.com/RealTimeGenomics/rtg-core">https://github.com/RealTimeGenomics/rtg-core</a>.
</div>
<div id="ref-robinson_hla-db_2020" class="csl-entry" role="listitem">
Robinson, James, Dominic J Barker, Xenia Georgiou, Michael A Cooper, Paul Flicek, and Steven G E Marsh. 2020. <span>“<span>IPD</span>-<span>IMGT</span>/<span>HLA</span> <span>Database</span>.”</span> <em>Nucleic Acids Research</em> 48 (D1): D948–55. <a href="https://doi.org/10.1093/nar/gkz950">https://doi.org/10.1093/nar/gkz950</a>.
</div>
<div id="ref-sakaue_hla_2023" class="csl-entry" role="listitem">
Sakaue, Saori, Saisriram Gurajala, Michelle Curtis, Yang Luo, Wanson Choi, Kazuyoshi Ishigaki, Joyce B. Kang, et al. 2023. <span>“Tutorial: A Statistical Genetics Guide to Identifying <span>HLA</span> Alleles Driving Complex Disease.”</span> <em>Nature Protocols</em> 18 (9): 2625–41. <a href="https://doi.org/10.1038/s41596-023-00853-4">https://doi.org/10.1038/s41596-023-00853-4</a>.
</div>
<div id="ref-shafin_pepper_2021" class="csl-entry" role="listitem">
Shafin, Kishwar, Trevor Pesout, Pi-Chuan Chang, Maria Nattestad, Alexey Kolesnikov, Sidharth Goel, Gunjan Baid, et al. 2021. <span>“Haplotype-Aware Variant Calling with <span>PEPPER</span>-<span>Margin</span>-<span>DeepVariant</span> Enables High Accuracy in Nanopore Long-Reads.”</span> <em>Nature Methods</em> 18 (11): 1322–32. <a href="https://doi.org/10.1038/s41592-021-01299-w">https://doi.org/10.1038/s41592-021-01299-w</a>.
</div>
<div id="ref-smolka_sniffles2_2024" class="csl-entry" role="listitem">
Smolka, Moritz, Luis F. Paulin, Christopher M. Grochowski, Dominic W. Horner, Medhat Mahmoud, Sairam Behera, Ester Kalef-Ezra, et al. 2024. <span>“Detection of Mosaic and Population-Level Structural Variants with <span>Sniffles2</span>.”</span> <em>Nature Biotechnology</em> 42 (10): 1571–80. <a href="https://doi.org/10.1038/s41587-023-02024-y">https://doi.org/10.1038/s41587-023-02024-y</a>.
</div>
<div id="ref-song_t1k_2022" class="csl-entry" role="listitem">
Song, Li, Gali Bai, X. Shirley Liu, Bo Li, and Heng Li. 2022. <span>“<span>T1K</span>: Efficient and Accurate <span>KIR</span> and <span>HLA</span> Genotyping with Next-Generation Sequencing Data.”</span> bioRxiv. <a href="https://doi.org/10.1101/2022.10.26.513955">https://doi.org/10.1101/2022.10.26.513955</a>.
</div>
<div id="ref-van_der_auwera_gatk_best_2018" class="csl-entry" role="listitem">
Van der Auwera, Geraldine A., Mauricio O. Carneiro, Christopher Hartl, Ryan Poplin, Guillermo del Angel, Ami Levy-Moonshine, Tadeusz Jordan, et al. 2018. <span>“From <span>FastQ</span> <span>Data</span> to <span>High</span>-<span>Confidence</span> <span>Variant</span> <span>Calls</span>: <span>The</span> <span>Genome</span> <span>Analysis</span> <span>Toolkit</span> <span>Best</span> <span>Practices</span> <span>Pipeline</span>.”</span> <em>Current Protocols in Bioinformatics</em> 43 (1): 11.10.1–33. <a href="https://doi.org/10.1002/0471250953.bi1110s43">https://doi.org/10.1002/0471250953.bi1110s43</a>.
</div>
<div id="ref-wenger_pacbiohifi_2019" class="csl-entry" role="listitem">
Wenger, Aaron M., Paul Peluso, William J. Rowell, Pi-Chuan Chang, Richard J. Hall, Gregory T. Concepcion, Jana Ebler, et al. 2019. <span>“Accurate Circular Consensus Long-Read Sequencing Improves Variant Detection and Assembly of a Human Genome.”</span> <em>Nature Biotechnology</em> 37 (10): 1155–62. <a href="https://doi.org/10.1038/s41587-019-0217-9">https://doi.org/10.1038/s41587-019-0217-9</a>.
</div>
<div id="ref-yun_accurate_2021" class="csl-entry" role="listitem">
Yun, Taedong, Helen Li, Pi-Chuan Chang, Michael F Lin, Andrew Carroll, and Cory Y McLean. 2021. <span>“Accurate, Scalable Cohort Variant Calls Using <span>DeepVariant</span> and <span>GLnexus</span>.”</span> <em>Bioinformatics</em> 36 (24): 5582–89. <a href="https://doi.org/10.1093/bioinformatics/btaa1081">https://doi.org/10.1093/bioinformatics/btaa1081</a>.
</div>
<div id="ref-zheng_clair3_2022" class="csl-entry" role="listitem">
Zheng, Zhenxian, Shumin Li, Junhao Su, Amy Wing-Sze Leung, Tak-Wah Lam, and Ruibang Luo. 2022. <span>“Symphonizing Pileup and Full-Alignment for Deep Learning-Based Long-Read Variant Calling.”</span> <em>Nature Computational Science</em> 2 (12): 797–803. <a href="https://doi.org/10.1038/s43588-022-00387-x">https://doi.org/10.1038/s43588-022-00387-x</a>.
</div>
<div id="ref-zook_giab_2019" class="csl-entry" role="listitem">
Zook, Justin M., Jennifer McDaniel, Nathan D. Olson, Justin Wagner, Hemang Parikh, Haynes Heaton, Sean A. Irvine, et al. 2019. <span>“An Open Resource for Accurately Benchmarking Small Variant and Reference Calls.”</span> <em>Nature Biotechnology</em> 37 (5): 561–66. <a href="https://doi.org/10.1038/s41587-019-0074-6">https://doi.org/10.1038/s41587-019-0074-6</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p1--foundations.html" class="pagination-link" aria-label="Part I: Foundations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part I: Foundations</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p1-ch02-data.html" class="pagination-link" aria-label="The Genomic Data Landscape">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>