<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; GWAS &amp; Polygenic Scores – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p1-ch04-cadd.html" rel="next">
<link href="./p1-ch02-data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch03-pgs.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transformer Architecture for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-foundation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models: Concepts &amp; Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives &amp; Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning &amp; Deployment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">p4–multi-modal_multi-scale.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-gwas-paradigm" id="toc-the-gwas-paradigm" class="nav-link active" data-scroll-target="#the-gwas-paradigm"><span class="header-section-number">3.1</span> The GWAS Paradigm</a>
  <ul class="collapse">
  <li><a href="#continuous-phenotypes" id="toc-continuous-phenotypes" class="nav-link" data-scroll-target="#continuous-phenotypes"><span class="header-section-number">3.1.1</span> Continuous Phenotypes</a></li>
  <li><a href="#binary-phenotypes" id="toc-binary-phenotypes" class="nav-link" data-scroll-target="#binary-phenotypes"><span class="header-section-number">3.1.2</span> Binary Phenotypes</a></li>
  </ul></li>
  <li><a href="#linkage-disequilibrium-and-association-signals" id="toc-linkage-disequilibrium-and-association-signals" class="nav-link" data-scroll-target="#linkage-disequilibrium-and-association-signals"><span class="header-section-number">3.2</span> Linkage Disequilibrium and Association Signals</a>
  <ul class="collapse">
  <li><a href="#haplotype-structure-and-recombination" id="toc-haplotype-structure-and-recombination" class="nav-link" data-scroll-target="#haplotype-structure-and-recombination"><span class="header-section-number">3.2.1</span> Haplotype Structure and Recombination</a></li>
  <li><a href="#measuring-correlation-the-r2-statistic" id="toc-measuring-correlation-the-r2-statistic" class="nav-link" data-scroll-target="#measuring-correlation-the-r2-statistic"><span class="header-section-number">3.2.2</span> Measuring Correlation: The (r^2) Statistic</a></li>
  <li><a href="#causal-versus-tag-variants" id="toc-causal-versus-tag-variants" class="nav-link" data-scroll-target="#causal-versus-tag-variants"><span class="header-section-number">3.2.3</span> Causal Versus Tag Variants</a></li>
  </ul></li>
  <li><a href="#from-association-signals-to-fine-mapping" id="toc-from-association-signals-to-fine-mapping" class="nav-link" data-scroll-target="#from-association-signals-to-fine-mapping"><span class="header-section-number">3.3</span> From Association Signals to Fine-Mapping</a>
  <ul class="collapse">
  <li><a href="#bayesian-fine-mapping-framework" id="toc-bayesian-fine-mapping-framework" class="nav-link" data-scroll-target="#bayesian-fine-mapping-framework"><span class="header-section-number">3.3.1</span> Bayesian Fine-Mapping Framework</a></li>
  <li><a href="#applications-and-multi-ancestry-leverage" id="toc-applications-and-multi-ancestry-leverage" class="nav-link" data-scroll-target="#applications-and-multi-ancestry-leverage"><span class="header-section-number">3.3.2</span> Applications and Multi-Ancestry Leverage</a></li>
  </ul></li>
  <li><a href="#constructing-polygenic-scores" id="toc-constructing-polygenic-scores" class="nav-link" data-scroll-target="#constructing-polygenic-scores"><span class="header-section-number">3.4</span> Constructing Polygenic Scores</a>
  <ul class="collapse">
  <li><a href="#terminology-pgs-vs-prs" id="toc-terminology-pgs-vs-prs" class="nav-link" data-scroll-target="#terminology-pgs-vs-prs"><span class="header-section-number">3.4.1</span> Terminology: PGS vs PRS</a></li>
  <li><a href="#clumping-and-thresholding" id="toc-clumping-and-thresholding" class="nav-link" data-scroll-target="#clumping-and-thresholding"><span class="header-section-number">3.4.2</span> Clumping and Thresholding</a></li>
  <li><a href="#ld-aware-bayesian-methods" id="toc-ld-aware-bayesian-methods" class="nav-link" data-scroll-target="#ld-aware-bayesian-methods"><span class="header-section-number">3.4.3</span> LD-Aware Bayesian Methods</a></li>
  <li><a href="#fine-mapping-informed-polygenic-scores" id="toc-fine-mapping-informed-polygenic-scores" class="nav-link" data-scroll-target="#fine-mapping-informed-polygenic-scores"><span class="header-section-number">3.4.4</span> Fine-Mapping-Informed Polygenic Scores</a></li>
  </ul></li>
  <li><a href="#interpreting-polygenic-scores" id="toc-interpreting-polygenic-scores" class="nav-link" data-scroll-target="#interpreting-polygenic-scores"><span class="header-section-number">3.5</span> Interpreting Polygenic Scores</a>
  <ul class="collapse">
  <li><a href="#relative-versus-absolute-risk" id="toc-relative-versus-absolute-risk" class="nav-link" data-scroll-target="#relative-versus-absolute-risk"><span class="header-section-number">3.5.1</span> Relative versus Absolute Risk</a></li>
  <li><a href="#ancestry-linkage-disequilibrium-and-transferability" id="toc-ancestry-linkage-disequilibrium-and-transferability" class="nav-link" data-scroll-target="#ancestry-linkage-disequilibrium-and-transferability"><span class="header-section-number">3.5.2</span> Ancestry, Linkage Disequilibrium, and Transferability</a></li>
  </ul></li>
  <li><a href="#limitations-of-gwas-and-pgs-and-the-case-for-mechanistic-models" id="toc-limitations-of-gwas-and-pgs-and-the-case-for-mechanistic-models" class="nav-link" data-scroll-target="#limitations-of-gwas-and-pgs-and-the-case-for-mechanistic-models"><span class="header-section-number">3.6</span> Limitations of GWAS and PGS, and the Case for Mechanistic Models</a>
  <ul class="collapse">
  <li><a href="#achievements-and-the-clinical-adoption-gap" id="toc-achievements-and-the-clinical-adoption-gap" class="nav-link" data-scroll-target="#achievements-and-the-clinical-adoption-gap"><span class="header-section-number">3.6.1</span> Achievements and the Clinical Adoption Gap</a></li>
  <li><a href="#association-without-mechanism" id="toc-association-without-mechanism" class="nav-link" data-scroll-target="#association-without-mechanism"><span class="header-section-number">3.6.2</span> Association Without Mechanism</a></li>
  <li><a href="#population-transferability" id="toc-population-transferability" class="nav-link" data-scroll-target="#population-transferability"><span class="header-section-number">3.6.3</span> Population Transferability</a></li>
  <li><a href="#the-noncoding-variant-challenge" id="toc-the-noncoding-variant-challenge" class="nav-link" data-scroll-target="#the-noncoding-variant-challenge"><span class="header-section-number">3.6.4</span> The Noncoding Variant Challenge</a></li>
  <li><a href="#static-scores-in-a-dynamic-context" id="toc-static-scores-in-a-dynamic-context" class="nav-link" data-scroll-target="#static-scores-in-a-dynamic-context"><span class="header-section-number">3.6.5</span> Static Scores in a Dynamic Context</a></li>
  <li><a href="#missing-heritability" id="toc-missing-heritability" class="nav-link" data-scroll-target="#missing-heritability"><span class="header-section-number">3.6.6</span> Missing Heritability</a></li>
  <li><a href="#toward-mechanistic-models" id="toc-toward-mechanistic-models" class="nav-link" data-scroll-target="#toward-mechanistic-models"><span class="header-section-number">3.6.7</span> Toward Mechanistic Models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1--foundations.html">Part I: Foundations</a></li><li class="breadcrumb-item"><a href="./p1-ch03-pgs.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-pgs" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO</strong> - Get scientific and methodological review from Dr.&nbsp;Schaid’s group. - Double-check all equation notation for consistency with later chapters.</p>
</div>
</div>
<p>Genome-wide association studies (GWAS) and polygenic scores (PGS) form the statistical backbone of modern human genetics. GWAS connect variation in DNA to variation in traits. Polygenic scores then aggregate many small genetic effects across the genome into a single number per individual. Together, they have delivered striking insights into complex traits, but they also expose fundamental limitations that motivate the mechanistic models developed in later parts of this book.</p>
<p>In this chapter we:</p>
<ul>
<li>Introduce the GWAS framework and its standard statistical models.</li>
<li>Explain how linkage disequilibrium (LD) shapes association signals.</li>
<li>Describe fine-mapping and its role in identifying putative causal variants.</li>
<li>Show how GWAS results are converted into polygenic scores.</li>
<li>Discuss how to interpret PGS and why they often fail to transfer across ancestries.</li>
<li>Highlight the limitations of GWAS and PGS, motivating the need for genomic foundation models.</li>
</ul>
<p>Throughout, we will connect to data resources introduced in Chapter <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> and to confounding and fairness issues discussed in Chapter <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: High-level pipeline figure showing: 1. Cohort with genotypes + phenotypes. 2. GWAS producing a Manhattan plot. 3. Fine-mapping yielding credible sets and PIPs. 4. Polygenic score construction and downstream risk stratification.</p>
</div>
</div>
<section id="the-gwas-paradigm" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-gwas-paradigm"><span class="header-section-number">3.1</span> The GWAS Paradigm</h2>
<p>A GWAS requires three ingredients:</p>
<ol type="1">
<li><strong>Genotypes</strong> – typically dense SNP arrays or imputed variants across the genome, often augmented with structural variants or exome data.</li>
<li><strong>Phenotypes</strong> – quantitative traits (e.g., height, LDL cholesterol) or binary outcomes (e.g., disease vs control), plus relevant covariates (age, sex, etc.).</li>
<li><strong>A statistical model</strong> – usually a regression model that tests one variant at a time for association with the phenotype.</li>
</ol>
<p>The basic GWAS workflow is:</p>
<ol type="1">
<li>Perform quality control on individuals and variants.</li>
<li>For each variant, fit a regression model of the phenotype on genotype and covariates.</li>
<li>Record the estimated effect size and an association statistic (e.g., p-value).</li>
<li>Correct for multiple testing to control false positives.</li>
<li>Summarize results across the genome (Manhattan and QQ plots) and follow up notable loci.</li>
</ol>
<p>Practically oriented guides provide detailed recommendations on QC, covariate selection, and interpretation <span class="citation" data-cites="marees_gwas_2018">(<a href="references.html#ref-marees_gwas_2018" role="doc-biblioref">Marees et al. 2018</a>)</span>. Biobanks and consortia described in <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> provide the sample sizes that make modern GWAS possible.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: Flow diagram of the GWAS pipeline with annotations: - Inputs: genotype matrix, phenotype vector, covariates. - “For each variant” loop with regression model. - Outputs: table of effect sizes and p-values, Manhattan and QQ plots.</p>
</div>
</div>
<section id="continuous-phenotypes" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="continuous-phenotypes"><span class="header-section-number">3.1.1</span> Continuous Phenotypes</h3>
<p>For quantitative traits, the standard association model is linear regression. Consider a single bi-allelic variant (j). Let (g_{ij}) denote the genotype dosage for individual (i), encoded as 0, 1, or 2 copies of the alternative allele (or as an imputed fractional dosage). Let (c_i) be a vector of covariates (e.g., age, sex, ancestry principal components). The model is</p>
<p><span class="math display">\[
y_i = \alpha + \beta_j g_{ij} + \gamma^\top c_i + \varepsilon_i,
\]</span></p>
<p>where:</p>
<ul>
<li>(y_i) is the phenotype for individual (i).</li>
<li>() is the intercept (baseline phenotype when genotype and covariates are zero).</li>
<li>(_j) is the per-allele effect size for variant (j).</li>
<li>() is a vector of covariate coefficients.</li>
<li>(_i) is a residual error term, typically assumed to be Gaussian with mean 0 and constant variance.</li>
</ul>
<section id="effect-size" class="level4" data-number="3.1.1.1">
<h4 data-number="3.1.1.1" class="anchored" data-anchor-id="effect-size"><span class="header-section-number">3.1.1.1</span> Effect Size</h4>
<p>The coefficient (_j) has a direct interpretation: it is the expected change in the phenotype associated with one additional copy of the alternative allele, holding covariates fixed. If phenotype units are meaningful (e.g., cm of height), (_j) is interpretable on that scale. Often we standardize phenotypes to zero mean and unit variance, so (_j) is in units of standard deviations per allele.</p>
<p>Because GWAS typically considers millions of variants, most individual (|_j|) are small. Nonetheless, in aggregate, many such effects can explain a substantial fraction of trait heritability, as we will see when we discuss polygenic scores and “missing heritability” <span class="citation" data-cites="yang_common_2010">(<a href="references.html#ref-yang_common_2010" role="doc-biblioref">Yang et al. 2010</a>)</span>.</p>
</section>
<section id="significance-testing-and-multiple-comparisons" class="level4" data-number="3.1.1.2">
<h4 data-number="3.1.1.2" class="anchored" data-anchor-id="significance-testing-and-multiple-comparisons"><span class="header-section-number">3.1.1.2</span> Significance Testing and Multiple Comparisons</h4>
<p>To test association, we compute a test statistic for the null hypothesis (H_0: _j = 0). Under standard assumptions, the usual (t)-statistic for (_j) approximately follows a normal distribution in large samples. This yields a p-value for each variant.</p>
<p>With (M) variants tested (often (M <sup>6)–(10</sup>7)), we must correct for multiple comparisons. A widely used heuristic is the <strong>genome-wide significance threshold</strong> of (5 ^{-8}). This value reflects a Bonferroni correction for roughly one million effectively independent tests, accounting for LD among common SNPs <span class="citation" data-cites="peer_estimation_2008">(<a href="references.html#ref-peer_estimation_2008" role="doc-biblioref">Pe’er et al. 2008</a>)</span>.</p>
<p>Variants with p-values below this threshold are reported as genome-wide significant hits. Variants with less extreme p-values may still contribute to polygenic scores, particularly in LD-aware methods.</p>
</section>
<section id="covariates" class="level4" data-number="3.1.1.3">
<h4 data-number="3.1.1.3" class="anchored" data-anchor-id="covariates"><span class="header-section-number">3.1.1.3</span> Covariates</h4>
<p>Covariates play two roles:</p>
<ul>
<li><strong>Precision</strong>: adjusting for variables like age and sex can reduce residual variance and increase power.</li>
<li><strong>Control of confounding</strong>: failing to adjust for variables related to both genotype and phenotype can produce spurious associations (e.g., if cases and controls differ systematically in age or sex).</li>
</ul>
<p>In practice, GWAS covariate sets often include age, sex, study-specific technical covariates (batch, array type), and ancestry principal components (see below) <span class="citation" data-cites="marees_gwas_2018">(<a href="references.html#ref-marees_gwas_2018" role="doc-biblioref">Marees et al. 2018</a>)</span>.</p>
</section>
<section id="ancestry-pcs" class="level4" data-number="3.1.1.4">
<h4 data-number="3.1.1.4" class="anchored" data-anchor-id="ancestry-pcs"><span class="header-section-number">3.1.1.4</span> Ancestry PCs</h4>
<p>Population structure can induce confounding: if allele frequencies differ across subgroups and the phenotype also differs across groups for non-genetic reasons, naive GWAS may detect associations that reflect group differences rather than causal effects.</p>
<p>Principal component analysis (PCA) on genotype data captures major axes of genetic variation <span class="citation" data-cites="price_pca_2006 patterson_population_2006">(<a href="references.html#ref-price_pca_2006" role="doc-biblioref">Price et al. 2006</a>; <a href="references.html#ref-patterson_population_2006" role="doc-biblioref">Patterson, Price, and Reich 2006</a>)</span>. The top principal components often correspond to broad ancestry gradients (e.g., continental-level differences). Including these PCs as covariates attenuates spurious associations due to ancestry, though it does not solve all forms of confounding; broader issues of population structure and fairness are discussed in Chapter <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>.</p>
</section>
<section id="intercept-and-residuals" class="level4" data-number="3.1.1.5">
<h4 data-number="3.1.1.5" class="anchored" data-anchor-id="intercept-and-residuals"><span class="header-section-number">3.1.1.5</span> Intercept and Residuals</h4>
<p>The intercept () and residuals (_i) are often overlooked. Systematic inflation in test statistics (e.g., due to cryptic relatedness or subtle structure) can manifest as a departure from the expected p-value distribution, even after including PCs. Genomic control, LD score regression, and more recent methods quantify and sometimes correct for this inflation, though we do not detail them here.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: QQ plot and Manhattan plot for a sample GWAS: - Show expected vs observed (-_{10}(p)) to illustrate inflation/deflation. - Show genome-wide Manhattan plot with annotated genome-wide significant loci.</p>
</div>
</div>
</section>
</section>
<section id="binary-phenotypes" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="binary-phenotypes"><span class="header-section-number">3.1.2</span> Binary Phenotypes</h3>
<p>For case–control traits (e.g., disease status), GWAS typically uses logistic regression. Let (y_i {0,1}) denote case (1) or control (0). The model is</p>
<p><span class="math display">\[
\log \frac{P(y_i = 1)}{P(y_i = 0)} = \alpha + \beta_j g_{ij} + \gamma^\top c_i.
\]</span></p>
<p>The left-hand side is the log-odds of being a case. Here:</p>
<ul>
<li>(_j) represents the log-odds ratio (log-OR) per additional copy of the alternative allele.</li>
<li>((_j)) is the odds ratio (OR).</li>
</ul>
<p>For rare diseases, odds ratios are often interpreted as approximating relative risks, but strictly speaking they differ: the OR compares odds, not probabilities. Converting ORs into absolute risk requires baseline disease prevalence, which we discuss later when interpreting polygenic scores.</p>
<p>Case–control sampling can distort absolute risk but preserves the ordering of risk: a variant that increases odds in the sampled data also increases risk in the source population. This is why GWAS conducted in case–control designs still provide useful effect sizes for polygenic scores, provided downstream models account for baseline incidence.</p>
<p>Logistic regression shares the same covariate structure as linear regression, and the same challenges with confounding, population structure, and technical artifacts apply.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: - Simple 2×2 table (allele count vs case/control) leading into logistic regression. - Plot of probability of disease vs genotype dosage for a variant with OR &gt; 1, illustrating the logistic curve.</p>
</div>
</div>
</section>
</section>
<section id="linkage-disequilibrium-and-association-signals" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="linkage-disequilibrium-and-association-signals"><span class="header-section-number">3.2</span> Linkage Disequilibrium and Association Signals</h2>
<p>GWAS tests variants one at a time, but the genome is inherited in blocks. Nearby variants tend to be correlated because they are co-inherited on haplotypes. This <strong>linkage disequilibrium (LD)</strong> is central to interpreting GWAS results.</p>
<p>A GWAS association signal at variant (j) may arise because:</p>
<ul>
<li>Variant (j) is itself causal for the phenotype.</li>
<li>Variant (j) tags a causal variant (k) that is correlated with it in the population.</li>
<li>Multiple causal variants in a region jointly influence the phenotype, producing a complex local pattern of association.</li>
</ul>
<p>Understanding LD is essential before moving to fine-mapping and polygenic scoring.</p>
<section id="haplotype-structure-and-recombination" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="haplotype-structure-and-recombination"><span class="header-section-number">3.2.1</span> Haplotype Structure and Recombination</h3>
<p>Meiosis recombines parental chromosomes through crossover events. Over many generations, recombination breaks down long-range correlations but preserves short-range structure. The result is:</p>
<ul>
<li>Regions of high LD (haplotype blocks) where many variants are strongly correlated.</li>
<li>Recombination hotspots where LD decays rapidly.</li>
</ul>
<p>Patterns of LD vary across populations due to demographic history (bottlenecks, expansions, admixture). These differences play a major role in how GWAS signals and polygenic scores transfer across ancestries.</p>
</section>
<section id="measuring-correlation-the-r2-statistic" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="measuring-correlation-the-r2-statistic"><span class="header-section-number">3.2.2</span> Measuring Correlation: The (r^2) Statistic</h3>
<p>The most commonly used measure of LD between two bi-allelic variants is the squared correlation (r^2) between their allele counts:</p>
<ul>
<li>(r^2 ) indicates nearly perfect correlation (variants are almost always observed together).</li>
<li>(r^2 ) indicates independence.</li>
</ul>
<p>From a GWAS perspective:</p>
<ul>
<li>If variant (j) is causal and variant (k) is in high LD with (j), both may show similar p-values.</li>
<li>If multiple variants are causal, LD patterns can cause their signals to blend into a single “peak” in the Manhattan plot.</li>
</ul>
<p>This correlation structure complicates efforts to pinpoint which variants are truly causal.</p>
</section>
<section id="causal-versus-tag-variants" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="causal-versus-tag-variants"><span class="header-section-number">3.2.3</span> Causal Versus Tag Variants</h3>
<p>A <strong>causal variant</strong> directly influences the phenotype (e.g., by altering a protein, transcription factor binding, or splicing). A <strong>tag variant</strong> is merely correlated with a causal variant due to LD. Tag variants are often easier to genotype, especially on array platforms, and can stand in for causal variants in association analyses.</p>
<p>GWAS catalogs are therefore catalogs of <strong>associated loci</strong>, not necessarily of causal variants. Distinguishing causal from tag variants requires additional information (fine-mapping, functional assays, or mechanistic models), which we discuss below and in later chapters.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: Local locus illustration: - Top: Manhattan “zoom-in” showing a cluster of strongly associated variants. - Middle: LD heatmap (r²) across the locus. - Bottom: Track indicating “causal” variant(s) vs tag variants, possibly overlaying gene annotations.</p>
</div>
</div>
</section>
</section>
<section id="from-association-signals-to-fine-mapping" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="from-association-signals-to-fine-mapping"><span class="header-section-number">3.3</span> From Association Signals to Fine-Mapping</h2>
<p>Fine-mapping aims to move from “this region is associated” to “these are the most likely causal variants in this region.” Given a set of summary association statistics and an LD matrix, Bayesian fine-mapping methods estimate the probability that each variant is causal.</p>
<p>At a high level:</p>
<ol type="1">
<li>Define a region around an index SNP (e.g., all variants within 1 Mb).</li>
<li>Specify a prior over which variants are causal (e.g., at most (K) causal variants per region).</li>
<li>Use the observed association statistics and LD to compute the posterior probability of each configuration of causal variants.</li>
<li>Derive <strong>posterior inclusion probabilities (PIPs)</strong> for each variant and <strong>credible sets</strong> that contain the true causal variant(s) with a specified probability (e.g., 95%).</li>
</ol>
<p>Comprehensive reviews describe how summary statistics and LD matrices from reference panels can be combined to perform fine-mapping at scale <span class="citation" data-cites="pasaniuc_dissecting_2016">(<a href="references.html#ref-pasaniuc_dissecting_2016" role="doc-biblioref">Pasaniuc and Price 2016</a>)</span>.</p>
<section id="bayesian-fine-mapping-framework" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="bayesian-fine-mapping-framework"><span class="header-section-number">3.3.1</span> Bayesian Fine-Mapping Framework</h3>
<p>Bayesian fine-mapping methods differ in their priors and computational approximations, but they share common ingredients:</p>
<ul>
<li>A prior on the number of causal variants and their effect sizes.</li>
<li>A likelihood model linking effect sizes to observed marginal associations given LD.</li>
<li>Posterior inference to compute PIPs and credible sets.</li>
</ul>
<p>Variants with high PIPs are strong candidates for causal involvement. Credible sets reflect the uncertainty due to LD and limited sample size. Narrow credible sets (few variants) are more actionable for functional follow-up.</p>
</section>
<section id="applications-and-multi-ancestry-leverage" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="applications-and-multi-ancestry-leverage"><span class="header-section-number">3.3.2</span> Applications and Multi-Ancestry Leverage</h3>
<p>Fine-mapping serves several downstream purposes:</p>
<ul>
<li><strong>Variant prioritization</strong>: variants with high PIPs are prime targets for mechanistic follow-up (e.g., regulatory assays).</li>
<li><strong>Gene prioritization</strong>: mapping credible-set variants to genes (via proximity, eQTLs, or chromatin interactions) helps identify likely effector genes.</li>
<li><strong>Polygenic score construction</strong>: PIPs can be used to weight variants or to select variants with high posterior probability of causality.</li>
</ul>
<p>Multi-ancestry data often sharpen fine-mapping. Because LD patterns differ across populations, a variant that is highly correlated with many others in one population may have fewer strong proxies in another. Joint fine-mapping across ancestries can therefore reduce credible set sizes and refine causal inferences <span class="citation" data-cites="pasaniuc_dissecting_2016">(<a href="references.html#ref-pasaniuc_dissecting_2016" role="doc-biblioref">Pasaniuc and Price 2016</a>)</span>.</p>
<p>Integration of fine-mapping with functional annotations and multi-omics data at scale—such as in large open resources linking GWAS, fine-mapping, and functional genomics—further improves prioritization of likely causal variants <span class="citation" data-cites="mountjoy_open_2021">(<a href="references.html#ref-mountjoy_open_2021" role="doc-biblioref">Mountjoy et al. 2021</a>)</span>.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: Fine-mapping cartoon: - Panel A: Manhattan peak highlighting a broad associated region. - Panel B: Bar plot of PIPs for variants in the region. - Panel C: Example of a 95% credible set, indicating how many variants remain plausible. - Optional overlay: effect of adding a second ancestry on credible set narrowing.</p>
</div>
</div>
</section>
</section>
<section id="constructing-polygenic-scores" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="constructing-polygenic-scores"><span class="header-section-number">3.4</span> Constructing Polygenic Scores</h2>
<p>Polygenic scores (PGS) aggregate estimated variant effects across the genome into a single scalar per individual:</p>
<p><span class="math display">\[
\text{PGS}_i = \sum_{j} w_j g_{ij},
\]</span></p>
<p>where (w_j) is a weight assigned to variant (j) based on GWAS or fine-mapping, and (g_{ij}) is the genotype dosage for individual (i).</p>
<p>There are many design choices:</p>
<ul>
<li>Which variants to include.</li>
<li>How to set the weights (w_j).</li>
<li>How to account for LD.</li>
<li>How to validate and calibrate the resulting score.</li>
</ul>
<section id="terminology-pgs-vs-prs" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="terminology-pgs-vs-prs"><span class="header-section-number">3.4.1</span> Terminology: PGS vs PRS</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Terminology: PGS vs PRS
</div>
</div>
<div class="callout-body-container callout-body">
<p>The literature uses overlapping terminology:</p>
<ul>
<li><strong>Polygenic risk score (PRS)</strong> – historically common, especially for disease endpoints.</li>
<li><strong>Polygenic score (PGS)</strong> – more general, used for both diseases and quantitative traits.</li>
<li><strong>Genomic risk score</strong> and related terms also appear, often interchangeably.</li>
</ul>
<p>In this book we use <strong>polygenic score (PGS)</strong> as the default, with “risk” added when we specifically discuss disease risks. Methodological overviews of PGS construction and evaluation are available in <span class="citation" data-cites="choi_prs_2020">(<a href="references.html#ref-choi_prs_2020" role="doc-biblioref">Choi, Mak, and O’Reilly 2020</a>)</span>.</p>
</div>
</div>
<p>We now describe three families of approaches: clumping &amp; thresholding, LD-aware Bayesian methods, and fine-mapping-informed scores.</p>
</section>
<section id="clumping-and-thresholding" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="clumping-and-thresholding"><span class="header-section-number">3.4.2</span> Clumping and Thresholding</h3>
<p>The simplest and still widely used approach is <strong>clumping and thresholding</strong> (“C+T”):</p>
<ol type="1">
<li><strong>Clumping</strong>:
<ul>
<li>Rank variants by their GWAS significance (e.g., p-value).</li>
<li>Starting from the most significant variant, remove nearby variants within a specified window that are in high LD (e.g., (r^2 &gt; 0.1)–0.2).</li>
<li>This yields a set of approximately independent variants.</li>
</ul></li>
<li><strong>Thresholding</strong>:
<ul>
<li>Apply a p-value threshold (e.g., (5 ^{-8}), (10^{-5}), or even 1).</li>
<li>Retain only variants with p-values below this threshold.</li>
</ul></li>
<li><strong>Weighting</strong>:
<ul>
<li>Set weights (w_j) equal to the GWAS effect size estimates (e.g., (_j)) for the retained variants, and zero otherwise.</li>
</ul></li>
</ol>
<p>Hyperparameters (LD window, (r^2) threshold, p-value threshold) are often chosen by grid search to maximize predictive performance in a validation set. This tuning can introduce overfitting, especially in small samples or when the validation set is not representative of future deployment populations.</p>
<p>C+T scores are easy to compute and interpret, but they ignore much of the information in GWAS summary statistics:</p>
<ul>
<li>Most variants are discarded.</li>
<li>LD is only handled via coarse pruning.</li>
<li>Variants with modest p-values that collectively explain substantial variance may be underweight or excluded.</li>
</ul>
</section>
<section id="ld-aware-bayesian-methods" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="ld-aware-bayesian-methods"><span class="header-section-number">3.4.3</span> LD-Aware Bayesian Methods</h3>
<p>A more principled approach is to model the joint distribution of effect sizes explicitly, accounting for LD among variants. In these methods, we treat the true effect sizes (= (_1, , _M)) as random variables drawn from a prior distribution, and use the GWAS summary statistics and LD matrix to infer posterior mean effect sizes ([_j ]). The posterior means (or related shrinkage estimates) become the PGS weights (w_j).</p>
<p>LDpred, for example, assumes that a fraction (p) of variants have nonzero effects drawn from a Gaussian distribution, while the rest have zero effect <span class="citation" data-cites="vilhjalmsson_modeling_2015">(<a href="references.html#ref-vilhjalmsson_modeling_2015" role="doc-biblioref">Vilhjálmsson et al. 2015</a>)</span>. Given GWAS summary statistics and an LD reference panel, LDpred computes approximate posterior effect sizes that:</p>
<ul>
<li>Shrink noisy estimates toward zero.</li>
<li>Borrow strength across correlated variants.</li>
<li>Reduce overfitting compared with C+T.</li>
</ul>
<p>Related methods (e.g., lassosum and others) use different priors or optimization strategies but share the general idea: jointly model effect sizes under LD rather than pruning it away. These methods generally yield better predictive performance than C+T when properly tuned, especially as sample sizes increase.</p>
<p>However, they still face challenges:</p>
<ul>
<li>They typically rely on an LD reference panel that may not match the target population.</li>
<li>They are sensitive to model misspecification (e.g., wrong prior on effect sizes).</li>
<li>They often assume a single ancestry or treat ancestries separately.</li>
</ul>
</section>
<section id="fine-mapping-informed-polygenic-scores" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="fine-mapping-informed-polygenic-scores"><span class="header-section-number">3.4.4</span> Fine-Mapping-Informed Polygenic Scores</h3>
<p>Fine-mapping outputs—particularly PIPs—provide an appealing basis for polygenic scores:</p>
<ul>
<li>Variants with high PIPs are more likely to be causal.</li>
<li>Fine-mapping can incorporate functional annotations and multi-ancestry information.</li>
<li>PIPs can be used to select variants or to reweight effect sizes.</li>
</ul>
<p>Two broad strategies are common:</p>
<ol type="1">
<li><strong>Selection</strong>: include only variants with PIP above a threshold (e.g., 0.1 or 0.5) and set (w_j) proportional to their estimated effect sizes.</li>
<li><strong>Weighting</strong>: use PIPs directly as weights (or as multiplicative factors), so that variants with higher PIPs contribute more to the score even if effect size estimates are similar.</li>
</ol>
<p>Fine-mapping-informed PGS aim to concentrate weight on variants that are more likely to be biologically meaningful and robust across ancestries. Large-scale resources that jointly analyze GWAS, fine-mapping, and functional genomics provide datasets from which such scores can be derived <span class="citation" data-cites="mountjoy_open_2021">(<a href="references.html#ref-mountjoy_open_2021" role="doc-biblioref">Mountjoy et al. 2021</a>)</span>.</p>
<p>These approaches sit conceptually between purely statistical shrinkage (e.g., LDpred) and mechanistic models. They still rely on GWAS summary statistics but use additional structure—LD, functional annotations, and multi-ancestry patterns—to enrich the score.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: Three-panel PGS construction schematic: - Panel A: C+T pipeline (Manhattan plot → pruning → few variants with raw betas). - Panel B: LD-aware Bayesian pipeline (summary stats + LD matrix → posterior effect sizes). - Panel C: Fine-mapping-informed pipeline (credible sets + PIPs → weighted score).</p>
</div>
</div>
</section>
</section>
<section id="interpreting-polygenic-scores" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="interpreting-polygenic-scores"><span class="header-section-number">3.5</span> Interpreting Polygenic Scores</h2>
<p>Once a polygenic score has been computed for an individual, how should it be interpreted?</p>
<p>At a minimum, a PGS can be used to:</p>
<ul>
<li>Rank individuals by genetic susceptibility (relative risk).</li>
<li>Stratify populations into risk quantiles (e.g., top 1% vs average).</li>
<li>Estimate the proportion of phenotypic variance explained by common variants (on the liability scale for diseases).</li>
</ul>
<section id="relative-versus-absolute-risk" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="relative-versus-absolute-risk"><span class="header-section-number">3.5.1</span> Relative versus Absolute Risk</h3>
<p>Polygenic scores are most naturally interpreted in <strong>relative</strong> terms. For a disease outcome, we might fit a logistic regression model in a target cohort:</p>
<p><span class="math display">\[
\log \frac{P(y_i = 1)}{P(y_i = 0)} = \alpha + \theta \, \text{PGS}_i + \eta^\top z_i,
\]</span></p>
<p>where (z_i) collects covariates (age, sex, etc.) and () is the effect of a one-unit increase in the PGS. We can rescale the PGS (e.g., to have unit standard deviation) so that (()) is the <strong>odds ratio per SD of PGS</strong>.</p>
<p>Relative risk communication often focuses on percentiles:</p>
<ul>
<li>Individuals in the top 1% of the PGS distribution may have several-fold higher disease odds than those near the median.</li>
<li>Risk gradients can be displayed as odds ratios or hazard ratios by PGS decile or percentile.</li>
</ul>
<p>Absolute risk requires combining the PGS with baseline incidence rates (e.g., age-specific disease rates in the population). Clinical guidelines increasingly emphasize absolute risk (e.g., 10-year risk of coronary artery disease) for decision-making, and using PGS in this context requires careful calibration and validation in representative populations (see Chapter <a href="p6-ch23-clinical.html" class="quarto-xref"><span>Chapter 23</span></a>).</p>
</section>
<section id="ancestry-linkage-disequilibrium-and-transferability" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="ancestry-linkage-disequilibrium-and-transferability"><span class="header-section-number">3.5.2</span> Ancestry, Linkage Disequilibrium, and Transferability</h3>
<p>A major challenge for PGS is <strong>transferability</strong> across populations:</p>
<ul>
<li>GWAS in large European-ancestry cohorts identify many variants and yield precise effect size estimates.</li>
<li>The same PGS often explains substantially less variance and exhibits poorer risk discrimination in non-European ancestries.</li>
</ul>
<p>Several factors contribute:</p>
<ul>
<li><strong>LD differences</strong>: variants tagging causal alleles in one ancestry may not be in LD with them in another.</li>
<li><strong>Allele frequency differences</strong>: rare variants in one population may be common in another, affecting power and effect size estimates.</li>
<li><strong>Gene–environment interactions</strong> and environment-specific exposures.</li>
<li><strong>Statistical artifacts</strong> due to mismatched LD reference panels and QC pipelines.</li>
</ul>
<p>Empirical studies document pronounced drops in PGS performance when applied across ancestries and emphasize the importance of diverse training data and careful evaluation <span class="citation" data-cites="verma_diversity_2024">(<a href="references.html#ref-verma_diversity_2024" role="doc-biblioref">Verma et al. 2024</a>)</span>. Equity concerns are central: deploying PGS trained primarily in one ancestry can exacerbate health disparities if scores are systematically less accurate for underrepresented groups (see also Chapter <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>).</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: - Panel A: Overlaid histograms of PGS for cases vs controls in a single ancestry, with risk-by-percentile curve. - Panel B: Bar plot or line plot comparing variance explained (R² or liability-scale (R^2)) for the same PGS across multiple ancestry groups, highlighting decreased performance.</p>
</div>
</div>
</section>
</section>
<section id="limitations-of-gwas-and-pgs-and-the-case-for-mechanistic-models" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="limitations-of-gwas-and-pgs-and-the-case-for-mechanistic-models"><span class="header-section-number">3.6</span> Limitations of GWAS and PGS, and the Case for Mechanistic Models</h2>
<p>GWAS and PGS have transformed human genetics, but they have also revealed persistent gaps between statistical association and biological understanding.</p>
<section id="achievements-and-the-clinical-adoption-gap" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="achievements-and-the-clinical-adoption-gap"><span class="header-section-number">3.6.1</span> Achievements and the Clinical Adoption Gap</h3>
<p>GWAS have:</p>
<ul>
<li>Identified thousands of loci associated with hundreds of traits.</li>
<li>Demonstrated that common variants contribute meaningfully to disease risk.</li>
<li>Enabled construction of PGS that rival or exceed traditional risk factors for some diseases in specific settings.</li>
</ul>
<p>Yet clinical adoption remains limited:</p>
<ul>
<li>Many PGS offer modest incremental predictive power over standard risk factors.</li>
<li>Performance often varies sharply across ancestries.</li>
<li>Mechanistic interpretation is often shallow: we know <em>where</em> in the genome association lies but not exactly <em>how</em> it influences disease.</li>
</ul>
</section>
<section id="association-without-mechanism" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="association-without-mechanism"><span class="header-section-number">3.6.2</span> Association Without Mechanism</h3>
<p>Most GWAS hits lie in noncoding regions. They often reside in enhancers, promoters, or other regulatory elements, but the causal chain from variant to molecular effect to disease is typically unknown. Even when credible sets are small, they frequently contain multiple plausible regulatory variants.</p>
<p>This “association without mechanism” problem limits:</p>
<ul>
<li>Our ability to identify drug targets.</li>
<li>Translation into therapeutic interventions.</li>
<li>Interpretability and trust in genetic risk predictions.</li>
</ul>
</section>
<section id="population-transferability" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="population-transferability"><span class="header-section-number">3.6.3</span> Population Transferability</h3>
<p>As discussed above, PGS constructed from predominantly European-ancestry GWAS often perform poorly in other ancestries <span class="citation" data-cites="verma_diversity_2024">(<a href="references.html#ref-verma_diversity_2024" role="doc-biblioref">Verma et al. 2024</a>)</span>. This is not just a technical nuisance; it raises fundamental questions about what PGS capture:</p>
<ul>
<li>Are they measuring biology that is genuinely universal but poorly estimated in underrepresented groups?</li>
<li>Or are they partly capturing ancestry-specific LD patterns, environmental context, and even subtle confounders?</li>
</ul>
<p>These issues complicate the use of PGS in diverse clinical populations and underscore the importance of diverse cohorts and careful causal reasoning (Chapters <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a> and <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>).</p>
</section>
<section id="the-noncoding-variant-challenge" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="the-noncoding-variant-challenge"><span class="header-section-number">3.6.4</span> The Noncoding Variant Challenge</h3>
<p>Many trait-associated variants are noncoding and likely act through gene regulation, chromatin structure, or RNA processing rather than protein sequence. Without a mechanistic model of how sequence specifies regulatory activity, GWAS can tell us <em>where</em> something is happening but not <em>what</em> or <em>why</em>.</p>
<p>Deep learning models trained on regulatory genomics data, such as those that predict chromatin accessibility, transcription factor binding, and gene expression from sequence <span class="citation" data-cites="zhou_deepsea_2015 zhou_expecto_2018">(<a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>; <a href="references.html#ref-zhou_expecto_2018" role="doc-biblioref">Zhou et al. 2018</a>)</span>, begin to address this gap. They map sequence changes directly to predicted molecular consequences, providing hypotheses about regulatory mechanisms that underlie GWAS signals.</p>
</section>
<section id="static-scores-in-a-dynamic-context" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="static-scores-in-a-dynamic-context"><span class="header-section-number">3.6.5</span> Static Scores in a Dynamic Context</h3>
<p>PGS are typically static:</p>
<ul>
<li>Computed once from inherited genetic variants.</li>
<li>Interpreted as a lifetime, context-independent risk modifier.</li>
</ul>
<p>In reality, disease risk unfolds over time in a dynamic environment:</p>
<ul>
<li>Exposures (diet, smoking, pollution) change across the life course.</li>
<li>Physiological states (e.g., inflammation, hormone levels) fluctuate.</li>
<li>Gene regulation and cellular states respond to these changing conditions.</li>
</ul>
<p>Static PGS cannot capture temporal trajectories or gene–environment interactions. They are a coarse summary of inherited liability, not a full model of disease dynamics.</p>
</section>
<section id="missing-heritability" class="level3" data-number="3.6.6">
<h3 data-number="3.6.6" class="anchored" data-anchor-id="missing-heritability"><span class="header-section-number">3.6.6</span> Missing Heritability</h3>
<p>Classical quantitative genetics connects family resemblance to <strong>narrow-sense heritability</strong> (h^2): the proportion of phenotypic variance attributable to additive genetic effects. Early GWAS explained only a small fraction of this heritability, leading to the “missing heritability” puzzle <span class="citation" data-cites="manolio_finding_2009">(<a href="references.html#ref-manolio_finding_2009" role="doc-biblioref">Manolio et al. 2009</a>)</span>.</p>
<p>Subsequent work showed that much of the “missing” component could be accounted for by many common variants of small effect, even if individually nonsignificant, when modeled jointly <span class="citation" data-cites="yang_common_2010">(<a href="references.html#ref-yang_common_2010" role="doc-biblioref">Yang et al. 2010</a>)</span>. Nonetheless, there remain gaps:</p>
<ul>
<li>Rare variants with large effects.</li>
<li>Structural variants, copy-number variation, and other classes not well captured by standard GWAS.</li>
<li>Epistasis and gene–environment interactions.</li>
</ul>
<p>Pooled across traits, GWAS and PGS suggest that complex traits are highly polygenic, but they do not fully close the gap between observed heritability, biological mechanism, and actionable clinical information.</p>
</section>
<section id="toward-mechanistic-models" class="level3" data-number="3.6.7">
<h3 data-number="3.6.7" class="anchored" data-anchor-id="toward-mechanistic-models"><span class="header-section-number">3.6.7</span> Toward Mechanistic Models</h3>
<p>These limitations collectively motivate the mechanistic approaches that form the core of this book. We would like models that:</p>
<ul>
<li>Connect sequence variation directly to molecular phenotypes (e.g., regulatory activity, splicing, chromatin structure).</li>
<li>Integrate multi-omics data across scales (Chapters <a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a> and <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>).</li>
<li>Provide causal hypotheses about how variants influence cellular and organismal phenotypes.</li>
<li>Generalize across populations and contexts by modeling underlying biology rather than solely statistical association patterns.</li>
</ul>
<p>Deep learning models trained on large regulatory and transcriptomic datasets, such as those predicting chromatin accessibility, transcription factor binding, and expression from DNA sequence, are one step in this direction <span class="citation" data-cites="zhou_deepsea_2015 zhou_expecto_2018">(<a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>; <a href="references.html#ref-zhou_expecto_2018" role="doc-biblioref">Zhou et al. 2018</a>)</span>. When combined with GWAS and fine-mapping results, these models can prioritize variants that are both statistically associated and predicted to be functionally impactful <span class="citation" data-cites="mountjoy_open_2021">(<a href="references.html#ref-mountjoy_open_2021" role="doc-biblioref">Mountjoy et al. 2021</a>)</span>.</p>
<p>Downstream chapters will show how:</p>
<ul>
<li>Multi-omics integration (Chapter <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>) connects molecular and clinical data.</li>
<li>Variant effect prediction methods (Chapter <a href="p3-ch10-cnn.html#sec-splice" class="quarto-xref"><span>Section 10.3</span></a> and Chapter <a href="p5-ch20-vep.html" class="quarto-xref"><span>Chapter 20</span></a>) refine our understanding of GWAS loci.</li>
<li>Genomic foundation models move beyond association to provide mechanistic insight and improved, equitable clinical translation (Part VI).</li>
</ul>
<p>The goal is not to discard GWAS and PGS, but to build on them—replacing “association without mechanism” with models that make testable, mechanistic claims and support robust, fair deployment in real-world settings.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Suggested visual</em>: Conceptual “bridge” figure: - Left: GWAS &amp; PGS (Manhattan plot, PGS distribution) with labels “statistical association.” - Right: Mechanistic models (sequence → regulatory predictions → cellular phenotypes) with labels “biological mechanism.” - Middle: Fine-mapping and integration steps (PIPs, functional annotations, multi-omics). This figure should foreshadow Parts III–VI of the book.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-choi_prs_2020" class="csl-entry" role="listitem">
Choi, Shing Wan, Timothy Shin-Heng Mak, and Paul F. O’Reilly. 2020. <span>“[<span>PRS</span>] <span>Tutorial</span>: A Guide to Performing Polygenic Risk Score Analyses.”</span> <em>Nature Protocols</em> 15 (9): 2759–72. <a href="https://doi.org/10.1038/s41596-020-0353-1">https://doi.org/10.1038/s41596-020-0353-1</a>.
</div>
<div id="ref-manolio_finding_2009" class="csl-entry" role="listitem">
Manolio, Teri A., Francis S. Collins, Nancy J. Cox, David B. Goldstein, Lucia A. Hindorff, David J. Hunter, Mark I. McCarthy, et al. 2009. <span>“Finding the Missing Heritability of Complex Diseases.”</span> <em>Nature</em> 461 (7265): 747–53. <a href="https://doi.org/10.1038/nature08494">https://doi.org/10.1038/nature08494</a>.
</div>
<div id="ref-marees_gwas_2018" class="csl-entry" role="listitem">
Marees, Andries T., Hilde de Kluiver, Sven Stringer, Florence Vorspan, Emmanuel Curis, Cynthia Marie-Claire, and Eske M. Derks. 2018. <span>“[<span>GWAS</span>] <span>A</span> Tutorial on Conducting Genome-Wide Association Studies: <span>Quality</span> Control and Statistical Analysis.”</span> <em>International Journal of Methods in Psychiatric Research</em> 27 (2): e1608. <a href="https://doi.org/10.1002/mpr.1608">https://doi.org/10.1002/mpr.1608</a>.
</div>
<div id="ref-mountjoy_open_2021" class="csl-entry" role="listitem">
Mountjoy, Edward, Ellen M. Schmidt, Miguel Carmona, Jeremy Schwartzentruber, Gareth Peat, Alfredo Miranda, Luca Fumis, et al. 2021. <span>“An Open Approach to Systematically Prioritize Causal Variants and Genes at All Published Human <span>GWAS</span> Trait-Associated Loci.”</span> <em>Nature Genetics</em> 53 (11): 1527–33. <a href="https://doi.org/10.1038/s41588-021-00945-5">https://doi.org/10.1038/s41588-021-00945-5</a>.
</div>
<div id="ref-pasaniuc_dissecting_2016" class="csl-entry" role="listitem">
Pasaniuc, Bogdan, and Alkes L. Price. 2016. <span>“Dissecting the Genetics of Complex Traits Using Summary Association Statistics.”</span> <em>Nature Reviews Genetics</em> 18 (2): 117–27. <a href="https://doi.org/10.1038/nrg.2016.142">https://doi.org/10.1038/nrg.2016.142</a>.
</div>
<div id="ref-patterson_population_2006" class="csl-entry" role="listitem">
Patterson, Nick, Alkes L. Price, and David Reich. 2006. <span>“Population <span>Structure</span> and <span>Eigenanalysis</span>.”</span> <em>PLOS Genetics</em> 2 (12): e190. <a href="https://doi.org/10.1371/journal.pgen.0020190">https://doi.org/10.1371/journal.pgen.0020190</a>.
</div>
<div id="ref-peer_estimation_2008" class="csl-entry" role="listitem">
Pe’er, Itsik, Roman Yelensky, David Altshuler, and Mark J. Daly. 2008. <span>“Estimation of the Multiple Testing Burden for Genomewide Association Studies of Nearly All Common Variants.”</span> <em>Genetic Epidemiology</em> 32 (4): 381–85. <a href="https://doi.org/10.1002/gepi.20303">https://doi.org/10.1002/gepi.20303</a>.
</div>
<div id="ref-price_pca_2006" class="csl-entry" role="listitem">
Price, Alkes L., Nick J. Patterson, Robert M. Plenge, Michael E. Weinblatt, Nancy A. Shadick, and David Reich. 2006. <span>“Principal Components Analysis Corrects for Stratification in Genome-Wide Association Studies.”</span> <em>Nature Genetics</em> 38 (8): 904–9. <a href="https://doi.org/10.1038/ng1847">https://doi.org/10.1038/ng1847</a>.
</div>
<div id="ref-verma_diversity_2024" class="csl-entry" role="listitem">
Verma, Anurag, Jennifer E. Huffman, Alex Rodriguez, Mitchell Conery, Molei Liu, Yuk-Lam Ho, Youngdae Kim, et al. 2024. <span>“Diversity and Scale: <span>Genetic</span> Architecture of 2068 Traits in the <span>VA</span> <span>Million</span> <span>Veteran</span> <span>Program</span>.”</span> <em>Science</em> 385 (6706): eadj1182. <a href="https://doi.org/10.1126/science.adj1182">https://doi.org/10.1126/science.adj1182</a>.
</div>
<div id="ref-vilhjalmsson_modeling_2015" class="csl-entry" role="listitem">
Vilhjálmsson, Bjarni J., Jian Yang, Hilary K. Finucane, Alexander Gusev, Sara Lindström, Stephan Ripke, Giulio Genovese, et al. 2015. <span>“Modeling <span>Linkage</span> <span>Disequilibrium</span> <span>Increases</span> <span>Accuracy</span> of <span>Polygenic</span> <span>Risk</span> <span>Scores</span>.”</span> <em>American Journal of Human Genetics</em> 97 (4): 576–92. <a href="https://doi.org/10.1016/j.ajhg.2015.09.001">https://doi.org/10.1016/j.ajhg.2015.09.001</a>.
</div>
<div id="ref-yang_common_2010" class="csl-entry" role="listitem">
Yang, Jian, Beben Benyamin, Brian P. McEvoy, Scott Gordon, Anjali K. Henders, Dale R. Nyholt, Pamela A. Madden, et al. 2010. <span>“Common <span>SNPs</span> Explain a Large Proportion of the Heritability for Human Height.”</span> <em>Nature Genetics</em> 42 (7): 565–69. <a href="https://doi.org/10.1038/ng.608">https://doi.org/10.1038/ng.608</a>.
</div>
<div id="ref-zhou_expecto_2018" class="csl-entry" role="listitem">
Zhou, Jian, Chandra L. Theesfeld, Kevin Yao, Kathleen M. Chen, Aaron K. Wong, and Olga G. Troyanskaya. 2018. <span>“[<span>Expecto</span>] <span>Deep</span> Learning Sequence-Based Ab Initio Prediction of Variant Effects on Expression and Disease Risk.”</span> <em>Nature Genetics</em> 50 (8): 1171–79. <a href="https://doi.org/10.1038/s41588-018-0160-6">https://doi.org/10.1038/s41588-018-0160-6</a>.
</div>
<div id="ref-zhou_deepsea_2015" class="csl-entry" role="listitem">
Zhou, Jian, and Olga G. Troyanskaya. 2015. <span>“[<span>DeepSEA</span>] <span>Predicting</span> Effects of Noncoding Variants with Deep Learning–Based Sequence Model.”</span> <em>Nature Methods</em> 12 (10): 931–34. <a href="https://doi.org/10.1038/nmeth.3547">https://doi.org/10.1038/nmeth.3547</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p1-ch02-data.html" class="pagination-link" aria-label="The Genomic Data Landscape">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p1-ch04-cadd.html" class="pagination-link" aria-label="Deleteriousness Scores">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>