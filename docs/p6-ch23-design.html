<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>23&nbsp; Sequence Design – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p6-ch24-future.html" rel="next">
<link href="./p6-ch22-drugs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p6--translation.html">Part VI — Translation and Application</a></li><li class="breadcrumb-item"><a href="./p6-ch23-design.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sequence Design</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p4--multi-scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Multi-Scale Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch13-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch14-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch16-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch17-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch20-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch21-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch22-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-design.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#from-prediction-to-design" id="toc-from-prediction-to-design" class="nav-link active" data-scroll-target="#from-prediction-to-design"><span class="header-section-number">23.1</span> From prediction to design</a></li>
  <li><a href="#protein-design-with-foundation-models" id="toc-protein-design-with-foundation-models" class="nav-link" data-scroll-target="#protein-design-with-foundation-models"><span class="header-section-number">23.2</span> Protein design with foundation models</a>
  <ul class="collapse">
  <li><a href="#sequence-only-generative-models" id="toc-sequence-only-generative-models" class="nav-link" data-scroll-target="#sequence-only-generative-models"><span class="header-section-number">23.2.1</span> Sequence-only generative models</a></li>
  <li><a href="#structure-aware-and-diffusion-based-design" id="toc-structure-aware-and-diffusion-based-design" class="nav-link" data-scroll-target="#structure-aware-and-diffusion-based-design"><span class="header-section-number">23.2.2</span> Structure-aware and diffusion-based design</a></li>
  <li><a href="#functional-conditioning-and-multi-objective-design" id="toc-functional-conditioning-and-multi-objective-design" class="nav-link" data-scroll-target="#functional-conditioning-and-multi-objective-design"><span class="header-section-number">23.2.3</span> Functional conditioning and multi-objective design</a></li>
  </ul></li>
  <li><a href="#regulatory-and-noncoding-sequence-design" id="toc-regulatory-and-noncoding-sequence-design" class="nav-link" data-scroll-target="#regulatory-and-noncoding-sequence-design"><span class="header-section-number">23.3</span> Regulatory and noncoding sequence design</a>
  <ul class="collapse">
  <li><a href="#promoter-and-enhancer-design" id="toc-promoter-and-enhancer-design" class="nav-link" data-scroll-target="#promoter-and-enhancer-design"><span class="header-section-number">23.3.1</span> Promoter and enhancer design</a></li>
  <li><a href="#splicing-and-rna-processing" id="toc-splicing-and-rna-processing" class="nav-link" data-scroll-target="#splicing-and-rna-processing"><span class="header-section-number">23.3.2</span> Splicing and RNA processing</a></li>
  <li><a href="#rna-structure-and-functional-rna-design" id="toc-rna-structure-and-functional-rna-design" class="nav-link" data-scroll-target="#rna-structure-and-functional-rna-design"><span class="header-section-number">23.3.3</span> RNA structure and functional RNA design</a></li>
  </ul></li>
  <li><a href="#designbuildtestlearn-loops" id="toc-designbuildtestlearn-loops" class="nav-link" data-scroll-target="#designbuildtestlearn-loops"><span class="header-section-number">23.4</span> Design–build–test–learn loops</a>
  <ul class="collapse">
  <li><a href="#active-learning-and-adaptive-experiments" id="toc-active-learning-and-adaptive-experiments" class="nav-link" data-scroll-target="#active-learning-and-adaptive-experiments"><span class="header-section-number">23.4.1</span> Active learning and adaptive experiments</a></li>
  <li><a href="#high-throughput-assays-as-feedback" id="toc-high-throughput-assays-as-feedback" class="nav-link" data-scroll-target="#high-throughput-assays-as-feedback"><span class="header-section-number">23.4.2</span> High-throughput assays as feedback</a></li>
  </ul></li>
  <li><a href="#practical-considerations-and-pitfalls" id="toc-practical-considerations-and-pitfalls" class="nav-link" data-scroll-target="#practical-considerations-and-pitfalls"><span class="header-section-number">23.5</span> Practical considerations and pitfalls</a>
  <ul class="collapse">
  <li><a href="#constraints-safety-and-manufacturability" id="toc-constraints-safety-and-manufacturability" class="nav-link" data-scroll-target="#constraints-safety-and-manufacturability"><span class="header-section-number">23.5.1</span> Constraints, safety, and manufacturability</a></li>
  <li><a href="#model-failure-modes-in-the-design-regime" id="toc-model-failure-modes-in-the-design-regime" class="nav-link" data-scroll-target="#model-failure-modes-in-the-design-regime"><span class="header-section-number">23.5.2</span> Model failure modes in the design regime</a></li>
  </ul></li>
  <li><a href="#design-paradigms-and-algorithmic-toolkits" id="toc-design-paradigms-and-algorithmic-toolkits" class="nav-link" data-scroll-target="#design-paradigms-and-algorithmic-toolkits"><span class="header-section-number">23.6</span> Design paradigms and algorithmic toolkits</a></li>
  <li><a href="#case-studies-and-applications" id="toc-case-studies-and-applications" class="nav-link" data-scroll-target="#case-studies-and-applications"><span class="header-section-number">23.7</span> Case studies and applications</a>
  <ul class="collapse">
  <li><a href="#therapeutic-protein-and-antibody-design" id="toc-therapeutic-protein-and-antibody-design" class="nav-link" data-scroll-target="#therapeutic-protein-and-antibody-design"><span class="header-section-number">23.7.1</span> Therapeutic protein and antibody design</a></li>
  <li><a href="#synthetic-regulatory-circuits-and-cell-engineering" id="toc-synthetic-regulatory-circuits-and-cell-engineering" class="nav-link" data-scroll-target="#synthetic-regulatory-circuits-and-cell-engineering"><span class="header-section-number">23.7.2</span> Synthetic regulatory circuits and cell engineering</a></li>
  <li><a href="#genome-scale-perturbation-libraries" id="toc-genome-scale-perturbation-libraries" class="nav-link" data-scroll-target="#genome-scale-perturbation-libraries"><span class="header-section-number">23.7.3</span> Genome-scale perturbation libraries</a></li>
  </ul></li>
  <li><a href="#outlook" id="toc-outlook" class="nav-link" data-scroll-target="#outlook"><span class="header-section-number">23.8</span> Outlook</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p6--translation.html">Part VI — Translation and Application</a></li><li class="breadcrumb-item"><a href="./p6-ch23-design.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sequence Design</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-design" class="quarto-section-identifier"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Foundation models have transformed our ability to <strong>predict</strong> the consequences of genetic and protein variation. In this chapter, we flip the direction of inference: instead of asking what a sequence does, we ask <strong>what sequence should we build</strong> to achieve a desired function.</p>
<p>We focus on three complementary views:</p>
<ol type="1">
<li><strong>Protein design</strong> using protein language models and structure-aware models for generating and optimizing amino acid sequences.</li>
<li><strong>Regulatory and noncoding sequence design</strong> for creating promoters, enhancers, splice sites, and RNAs with genomic foundation models as oracles.</li>
<li><strong>Closed-loop design–build–test–learn (DBTL)</strong> approaches that integrate models with experimental platforms, optimization strategies, and safety constraints.</li>
</ol>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Conceptual figure contrasting <em>prediction</em> (sequence → function) vs <em>design</em> (desired function → sequence) with a loop showing design–build–test–learn. This could reuse iconography from earlier chapters for “model”, “experiment”, and “sequence”.</p>
</div>
</div>
<hr>
<section id="from-prediction-to-design" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="from-prediction-to-design"><span class="header-section-number">23.1</span> From prediction to design</h2>
<p>Most chapters in this book assume a <strong>forward mapping</strong>: given a DNA, RNA, or protein sequence, a model predicts structure, activity, or phenotype. Design inverts this relationship. We specify a <strong>target</strong> (a structure, expression level, binding affinity, or multi-objective profile), then search over the astronomical space of sequences to find candidates predicted to satisfy that target. We experimentally test and iteratively refine both the sequences and the model.</p>
<p>Formally, if <span class="math inline">\(f_\theta(x)\)</span> is a foundation model that predicts properties of a sequence <span class="math inline">\(x\)</span>, design problems can be posed as:</p>
<ul>
<li><strong>Optimization:</strong> find <span class="math inline">\(x^\star = \arg\max_x f_\theta(x)\)</span> for some scalar objective (e.g., predicted activity).</li>
<li><strong>Conditional generation:</strong> sample <span class="math inline">\(x \sim p_\theta(x \mid y)\)</span> given a desired property or condition <span class="math inline">\(y\)</span> (e.g., a structure, binding partner, or cell type).</li>
<li><strong>Constrained design:</strong> optimize subject to constraints <span class="math inline">\(c(x) \leq 0\)</span> (e.g., GC content, off-target scores, immunogenicity).</li>
</ul>
<p>The central challenge is <strong>searching enormous combinatorial spaces</strong> (e.g., <span class="math inline">\(20^{200}\)</span> for a 200-residue protein) while staying within the regime where model predictions are reliable.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Cartoon of a high-dimensional fitness landscape. Show a foundation model approximating the landscape and different design strategies (gradient ascent, MCMC, evolutionary search) climbing toward high-fitness regions.</p>
</div>
</div>
<hr>
</section>
<section id="protein-design-with-foundation-models" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="protein-design-with-foundation-models"><span class="header-section-number">23.2</span> Protein design with foundation models</h2>
<p>Protein design pre-dates foundation models, but large-scale <strong>protein language models (PLMs)</strong> and structure-aware models have made it possible to generate and optimize sequences with minimal or no task-specific data.</p>
<section id="sequence-only-generative-models" class="level3" data-number="23.2.1">
<h3 data-number="23.2.1" class="anchored" data-anchor-id="sequence-only-generative-models"><span class="header-section-number">23.2.1</span> Sequence-only generative models</h3>
<p>Protein language models trained with masked-token or autoregressive objectives (e.g., ESM, ProGen, ProtGPT-like models) learn rich priors over amino acid sequences <span class="citation" data-cites="rao_tape_2019 madani_progen_2023 ferruz_protgpt2_2022">(<a href="references.html#ref-rao_tape_2019" role="doc-biblioref">Rao et al. 2019</a>; <a href="references.html#ref-madani_progen_2023" role="doc-biblioref">Madani et al. 2023</a>; <a href="references.html#ref-ferruz_protgpt2_2022" role="doc-biblioref">Ferruz, Schmidt, and Höcker 2022</a>)</span>. These priors can be used for design in multiple ways. <strong>Unconditional sampling</strong> generates novel, foldable proteins by sampling from the model. <strong>Latent-space optimization</strong> encodes sequences into embeddings, then optimizes in latent space for desired downstream scores. <strong>Conditional prompting or steering</strong> biases generation with prompts, control tokens, or guidance signals (e.g., family, subcellular localization).</p>
<p>Key advantages include <strong>data efficiency</strong> (models can exploit vast unlabeled sequence corpora), <strong>diversity</strong> (generative sampling naturally explores multiple modes of sequence space), and <strong>transferability</strong> (the same PLM can support many downstream tasks including prediction, design, and annotation).</p>
<p>Limitations remain. These models provide weak or indirect control over <strong>structure and function</strong>. They may regenerate or minimally modify training data, raising data leakage concerns. Additionally, the correspondence between “knobs” in latent space and functional properties remains poorly understood, limiting interpretability.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Diagram of a protein language model used for design. Left: training on large sequence corpus. Right: using the trained model to sample new sequences, optionally conditioned on family or simple attributes.</p>
</div>
</div>
<hr>
</section>
<section id="structure-aware-and-diffusion-based-design" class="level3" data-number="23.2.2">
<h3 data-number="23.2.2" class="anchored" data-anchor-id="structure-aware-and-diffusion-based-design"><span class="header-section-number">23.2.2</span> Structure-aware and diffusion-based design</h3>
<p>Structure-aware models like AlphaFold2 <span class="citation" data-cites="jumper_alphafold2_2021">(<a href="references.html#ref-jumper_alphafold2_2021" role="doc-biblioref">Jumper et al. 2021</a>)</span> and related architectures provide accurate mappings from sequence to structure. Building on these, <strong>diffusion models</strong> and <strong>structure-conditioned generative models</strong> now enable direct design of sequences that fold into desired 3D structures <span class="citation" data-cites="watson_rfdiffusion_2023 dauparas_proteinmpnn_2022">(<a href="references.html#ref-watson_rfdiffusion_2023" role="doc-biblioref">Watson et al. 2023</a>; <a href="references.html#ref-dauparas_proteinmpnn_2022" role="doc-biblioref">Dauparas et al. 2022</a>)</span>.</p>
<p>Design strategies include <strong>backbone-conditioned sequence design</strong>, where a fixed backbone (natural or imagined) guides generation of sequences predicted to fold onto that backbone (e.g., ProteinMPNN). <strong>Hallucination of novel folds</strong> diffuses in the space of structures or sequence–structure pairs to generate entirely new topologies (e.g., RFdiffusion). <strong>Interface and binder design</strong> conditions generation on a target protein to create binding partners with specific affinity or epitope geometry.</p>
<p>These models often operate in a <strong>joint space of sequence and structure</strong>, coupling three components: (1) a model for structural consistency (e.g., diffusion in backbone coordinates), (2) a sequence-conditional model for structural plausibility and stability, and (3) a downstream oracle (binding, stability, catalytic activity) used during scoring or optimization.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Multi-panel schematic of structure-aware design. Panel A: target backbone or target protein. Panel B: diffusion trajectory producing a new binder. Panel C: predicted structure overlay of designed vs.&nbsp;target complex.</p>
</div>
</div>
<hr>
</section>
<section id="functional-conditioning-and-multi-objective-design" class="level3" data-number="23.2.3">
<h3 data-number="23.2.3" class="anchored" data-anchor-id="functional-conditioning-and-multi-objective-design"><span class="header-section-number">23.2.3</span> Functional conditioning and multi-objective design</h3>
<p>In real applications, we rarely want “anything that folds”. We want proteins that are stable, expressible, and soluble; functional (enzymatic activity, binding, signaling); and safe and manufacturable (low aggregation, low immunogenicity, good developability).</p>
<p>To capture this, design pipelines combine foundation models with <strong>multi-objective optimization</strong>. A <strong>generative prior</strong> (PLM or diffusion model) proposes candidates. These candidates are then evaluated with <strong>oracles</strong>, which may be in silico (structure predictors, stability models, developability scores) or experimental (deep mutational scanning, binding assays, functional screens). Strategies like <strong>Bayesian optimization</strong>, <strong>evolutionary algorithms</strong>, or <strong>gradient-based editing</strong> iteratively improve proposals.</p>
<p>Multi-objective design often produces a <strong>Pareto frontier</strong> of solutions trading off properties (e.g., activity vs.&nbsp;stability). Genomic foundation models contribute by providing <strong>cheap, differentiable oracles</strong> for properties linked to sequence (e.g., localization motifs, PTM sites) and encoding <strong>evolutionary constraints</strong> that discourage unrealistic sequences.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: 2D scatter plot mock-up of designed proteins along two axes (e.g., predicted stability vs.&nbsp;binding score), highlighting a Pareto frontier. Overlay different design strategies as colored point sets.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="regulatory-and-noncoding-sequence-design" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="regulatory-and-noncoding-sequence-design"><span class="header-section-number">23.3</span> Regulatory and noncoding sequence design</h2>
<p>Most genomic foundation models in this book learn mappings from <strong>noncoding DNA or RNA</strong> to regulatory activities: expression, chromatin state, splicing patterns, or transcription factor binding. These models can be inverted to design regulatory sequences with desired behaviors.</p>
<section id="promoter-and-enhancer-design" class="level3" data-number="23.3.1">
<h3 data-number="23.3.1" class="anchored" data-anchor-id="promoter-and-enhancer-design"><span class="header-section-number">23.3.1</span> Promoter and enhancer design</h3>
<p>Models trained on massive datasets (e.g., MPRA, ChIP–seq, ATAC–seq, CAGE) can predict regulatory activity from local sequence context <span class="citation" data-cites="deboer_deciphering_2020">(<a href="references.html#ref-deboer_deciphering_2020" role="doc-biblioref">Boer et al. 2020</a>)</span>. Design tasks include <strong>promoter optimization</strong> (maximize expression of a gene in a specific cell type or condition), <strong>cell-type-specific enhancers</strong> (high activity in a target cell/tissue and low activity elsewhere), and <strong>minimal regulatory elements</strong> (short synthetic enhancers with robust and tunable activity).</p>
<p>Two broad approaches exist for regulatory sequence design. <strong>Gradient-based sequence editing</strong> treats a sequence-to-function model as differentiable with respect to input embeddings. We compute gradients of the desired objective with respect to nucleotides, apply projected gradient steps or “soft token” optimization, then project back to discrete bases. This leverages the same models used for interpretation (saliency maps, in silico mutagenesis) but runs gradients “in reverse” for design.</p>
<p><strong>Generative regulatory models</strong> take an alternative approach. These models train autoregressive or diffusion models directly on genomic regulatory regions, condition on metadata (cell type, histone marks, accessibility), and sample synthetic enhancers/promoters with targeted activity profiles before filtering using oracles.</p>
</section>
<section id="splicing-and-rna-processing" class="level3" data-number="23.3.2">
<h3 data-number="23.3.2" class="anchored" data-anchor-id="splicing-and-rna-processing"><span class="header-section-number">23.3.2</span> Splicing and RNA processing</h3>
<p>Models like SpliceAI and RNA-focused FMs (<a href="p2-ch08-rna.html" class="quarto-xref"><span>Chapter 8</span></a>) can predict splicing outcomes from local sequence context. Design applications include <strong>therapeutic splice modulation</strong> (design antisense oligos or CRISPR base edits that restore normal splicing), <strong>alternative isoform tuning</strong> (adjust splicing of specific exons to modulate protein isoforms), and <strong>RNA processing elements</strong> (design polyadenylation signals, UTRs, and RNA stability motifs).</p>
<p>Design strategies mirror the promoter/enhancer setting: gradient-based editing, enumerative search guided by saliency maps, and generative sequence models trained on splicing-competent regions.</p>
</section>
<section id="rna-structure-and-functional-rna-design" class="level3" data-number="23.3.3">
<h3 data-number="23.3.3" class="anchored" data-anchor-id="rna-structure-and-functional-rna-design"><span class="header-section-number">23.3.3</span> RNA structure and functional RNA design</h3>
<p>RNA foundation models that jointly capture sequence and secondary/tertiary structure enable design of riboswitches and aptamers, guide RNAs with precise on-/off-target profiles, and synthetic RNAs for sensing and actuation (e.g., toehold switches). Here, the design objective blends <strong>structure</strong>, <strong>thermodynamics</strong>, and <strong>interaction propensity</strong> with genomic-context constraints (e.g., avoiding cryptic splice sites or immune-stimulatory motifs).</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Schematic of regulatory sequence design. Panel A: model predicts expression from promoter/enhancer sequence. Panel B: gradients or an optimization loop propose sequence edits. Panel C: synthetic sequences tested in an MPRA assay.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="designbuildtestlearn-loops" class="level2" data-number="23.4">
<h2 data-number="23.4" class="anchored" data-anchor-id="designbuildtestlearn-loops"><span class="header-section-number">23.4</span> Design–build–test–learn loops</h2>
<p>Foundation models realize their full potential in <strong>closed-loop DBTL workflows</strong>. In the <strong>design</strong> phase, we use generative or optimization algorithms to propose sequences. During <strong>build</strong>, we synthesize DNA/RNA or construct libraries (pooled or array-based). The <strong>test</strong> phase assays function using high-throughput methods (e.g., MPRA, DMS, functional genomics screens). Finally, we <strong>learn</strong> by updating model parameters or retraining with new data, focusing on regimes where model uncertainty was high.</p>
<section id="active-learning-and-adaptive-experiments" class="level3" data-number="23.4.1">
<h3 data-number="23.4.1" class="anchored" data-anchor-id="active-learning-and-adaptive-experiments"><span class="header-section-number">23.4.1</span> Active learning and adaptive experiments</h3>
<p>Active learning aims to select the <strong>most informative experiments</strong> given limited budget. <strong>Uncertainty sampling</strong> chooses sequences where the model is uncertain (e.g., high entropy over outputs). <strong>Bayesian optimization</strong> balances exploration (uncertainty) and exploitation (predicted high fitness). <strong>Diversity-aware selection</strong> enforces coverage over sequence and function space to avoid local optima.</p>
<p>Genomic foundation models are especially well-suited for active learning. They provide <strong>calibrated uncertainty estimates</strong> (e.g., via ensembles, MC dropout, or explicit probabilistic outputs). They can be <strong>fine-tuned</strong> on task-specific data from each DBTL cycle, gradually shifting from a generic prior to a task-adapted model.</p>
</section>
<section id="high-throughput-assays-as-feedback" class="level3" data-number="23.4.2">
<h3 data-number="23.4.2" class="anchored" data-anchor-id="high-throughput-assays-as-feedback"><span class="header-section-number">23.4.2</span> High-throughput assays as feedback</h3>
<p>Several assay modalities naturally pair with foundation models. <strong>MPRA / STARR-seq</strong> provides parallel readouts of regulatory element activity for hundreds of thousands of sequences. <strong>Deep mutational scanning</strong> enables systematic exploration of mutational neighborhoods around proteins or regulatory elements. <strong>CRISPR screens</strong> introduce perturbations to regulatory regions or coding genes, with phenotypic readouts (e.g., proliferation, expression).</p>
<p>These assays generate <strong>dense local maps</strong> of function within specific sequence neighborhoods. Foundation models can interpolate across unmeasured variants, extrapolate to new regions by combining assay data with global priors, and suggest where to expand measurements next.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Flowchart of a DBTL cycle specific to regulatory sequence design: model → library design → DNA synthesis → cellular assay → sequencing → model update. Use consistent design language with Chapter 20 (clinical) and Chapter 22 (drugs).</p>
</div>
</div>
<hr>
</section>
</section>
<section id="practical-considerations-and-pitfalls" class="level2" data-number="23.5">
<h2 data-number="23.5" class="anchored" data-anchor-id="practical-considerations-and-pitfalls"><span class="header-section-number">23.5</span> Practical considerations and pitfalls</h2>
<p>Design with genomic foundation models introduces a distinct set of <strong>practical challenges</strong> compared to prediction-only use.</p>
<section id="constraints-safety-and-manufacturability" class="level3" data-number="23.5.1">
<h3 data-number="23.5.1" class="anchored" data-anchor-id="constraints-safety-and-manufacturability"><span class="header-section-number">23.5.1</span> Constraints, safety, and manufacturability</h3>
<p>Real-world designs must satisfy numerous constraints beyond the primary objective. <strong>Sequence-level constraints</strong> include GC content, repeats, restriction sites, and synthesis compatibility, as well as coding vs.&nbsp;noncoding frame integrity and avoiding unwanted ORFs. <strong>Contextual constraints</strong> encompass the chromatin environment, genomic integration site, neighboring regulatory elements, and species- and tissue-specific sequence biases. <strong>Safety and biosecurity</strong> considerations require avoiding sequences with known pathogenic motifs or virulence determinants and controlling dual-use risks (see <a href="p6-ch24-future.html" class="quarto-xref"><span>Chapter 24</span></a> for broader discussion).</p>
<p>Design algorithms must either <strong>hard-encode constraints</strong> (e.g., only sample from constrained spaces) or use <strong>penalty terms</strong> in objective functions, ideally with interpretable trade-offs.</p>
</section>
<section id="model-failure-modes-in-the-design-regime" class="level3" data-number="23.5.2">
<h3 data-number="23.5.2" class="anchored" data-anchor-id="model-failure-modes-in-the-design-regime"><span class="header-section-number">23.5.2</span> Model failure modes in the design regime</h3>
<p>Many pitfalls from <a href="p5-ch18-confound.html" class="quarto-xref"><span>Chapter 18</span></a> become amplified in design. <strong>Mode collapse toward training data</strong> occurs when generative models reproduce or minimally modify sequences seen during training, undermining novelty. <strong>Off-manifold proposals</strong> arise when aggressive optimization (e.g., many gradient steps) pushes sequences into regions where model predictions are unreliable. <strong>Reward hacking</strong> happens when optimization objectives only reflect surrogate scores (e.g., model-predicted activity), allowing the system to exploit quirks of the model rather than true biology.</p>
<p>Mitigation strategies include regularizing designs toward realistic priors (e.g., KL penalties against the PLM prior), enforcing <strong>novelty thresholds</strong> relative to training sequences, and using <strong>ensembles or multi-model agreement</strong> to guard against idiosyncratic failures.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Small panel illustrating “reward hacking” in sequence design: sequences optimized to extreme model scores that are actually biologically implausible (e.g., bizarre motifs, impossible structures).</p>
</div>
</div>
<hr>
</section>
</section>
<section id="design-paradigms-and-algorithmic-toolkits" class="level2" data-number="23.6">
<h2 data-number="23.6" class="anchored" data-anchor-id="design-paradigms-and-algorithmic-toolkits"><span class="header-section-number">23.6</span> Design paradigms and algorithmic toolkits</h2>
<p>Although implementation details vary, design workflows tend to fall into a few algorithmic patterns.</p>
<p><strong>Gradient-based design</strong> uses differentiable models and surrogate continuous relaxations of discrete sequences. We apply gradient ascent with regularization and projection. This approach is efficient in high-dimensional spaces but can produce off-manifold, adversarial sequences.</p>
<p><strong>Evolutionary and genetic algorithms</strong> maintain populations of sequences, applying mutation, crossover, and selection based on model or assay scores. This approach provides a natural fit for multi-objective optimization and discrete constraints.</p>
<p><strong>Bayesian optimization and bandits</strong> treat the sequence-to-fitness mapping as an unknown function, using a surrogate (e.g., Gaussian process, neural surrogate) to guide sampling. This strategy is particularly powerful when experimental budgets are small and assays are expensive.</p>
<p><strong>Reinforcement learning (RL)</strong> formulates design as a sequential decision problem (e.g., build sequence token-by-token), using rewards based on foundation model predictions or assay outcomes. RL can leverage <strong>policy constraints</strong> to maintain similarity to natural sequences.</p>
<p><strong>Diffusion and flow-based generative models</strong> learn to map noise to sequences (or sequence–structure pairs), optionally conditioned on design targets. These models support sampling diverse sets of candidates with controllable properties.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Table summarizing design algorithm families (gradient-based, evolutionary, Bayesian optimization, RL, diffusion) with columns for “pros”, “cons”, “typical use cases”, and “interaction with foundation models”.</p>
</div>
</div>
<hr>
</section>
<section id="case-studies-and-applications" class="level2" data-number="23.7">
<h2 data-number="23.7" class="anchored" data-anchor-id="case-studies-and-applications"><span class="header-section-number">23.7</span> Case studies and applications</h2>
<p>Below are representative application areas where genomic foundation model-enabled design is already making impact.</p>
<section id="therapeutic-protein-and-antibody-design" class="level3" data-number="23.7.1">
<h3 data-number="23.7.1" class="anchored" data-anchor-id="therapeutic-protein-and-antibody-design"><span class="header-section-number">23.7.1</span> Therapeutic protein and antibody design</h3>
<p><strong>De novo enzymes</strong> represent designed catalysts for specific chemical transformations, guided by structural and stability models. <strong>Antibodies and binders</strong> include synthetic binders targeting viral proteins, oncogenic receptors, or immune checkpoints, where FMs help optimize binding affinity and developability. <strong>Cytokines and signaling proteins</strong> comprise designed variants with tuned half-lives, receptor specificities, and signaling strength.</p>
<p>Foundation models serve multiple roles in these applications. They provide priors over plausible sequences and interfaces. They act as oracles for properties such as stability, aggregation, and PTM patterns. They function as feature extractors for downstream models that predict pharmacokinetics or immunogenicity.</p>
</section>
<section id="synthetic-regulatory-circuits-and-cell-engineering" class="level3" data-number="23.7.2">
<h3 data-number="23.7.2" class="anchored" data-anchor-id="synthetic-regulatory-circuits-and-cell-engineering"><span class="header-section-number">23.7.2</span> Synthetic regulatory circuits and cell engineering</h3>
<p><strong>Synthetic promoters and enhancers</strong> drive precise expression programs in CAR-T cells, stem cells, or engineered tissues. <strong>Logic-gated regulatory elements</strong> integrate multiple transcription factor inputs. <strong>Safety switches</strong> (kill switches, inducible expression) are embedded in therapeutic constructs.</p>
<p>Genomic FMs are crucial for predicting how designed elements behave <strong>within real genomic and epigenomic contexts</strong>, not just in isolated plasmid systems.</p>
</section>
<section id="genome-scale-perturbation-libraries" class="level3" data-number="23.7.3">
<h3 data-number="23.7.3" class="anchored" data-anchor-id="genome-scale-perturbation-libraries"><span class="header-section-number">23.7.3</span> Genome-scale perturbation libraries</h3>
<p>Even when individual sequences are not used as products, design methods power saturation mutagenesis libraries for functional genomics, tiled CRISPR perturbation libraries targeting regulatory landscapes, and Perturb-seq designs that multiplex many regulatory variants across cell types.</p>
<p>Here, the goal is to <strong>maximize information content</strong> of experiments rather than optimize a single construct, but the same models and algorithms apply.</p>
<hr>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>FIGURE SUGGESTION: Multi-panel “applications” figure with small icons or schematic vignettes for (A) therapeutic proteins, (B) regulatory circuits, and (C) functional genomics libraries. Reuse iconography from previous chapters for coherence.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="outlook" class="level2" data-number="23.8">
<h2 data-number="23.8" class="anchored" data-anchor-id="outlook"><span class="header-section-number">23.8</span> Outlook</h2>
<p>Design sits at the intersection of <strong>modeling, optimization, and experimental biology</strong>. Genomic foundation models are rapidly shifting design from artisanal, hand-crafted processes to <strong>principled, data-driven workflows</strong> that can propose novel proteins and regulatory elements beyond natural evolution, exploit massive unlabeled sequence corpora as priors on what biology “allows”, and close loops between <strong>in silico</strong> hypotheses and <strong>in vitro/in vivo</strong> measurements.</p>
<p>However, the same capabilities that enable beneficial applications also raise <strong>epistemic risks</strong> (overconfidence in models, especially out-of-distribution) and <strong>ethical and governance challenges</strong> (dual-use potential, unequal access, and misuse).</p>
<p>These themes connect directly to <a href="p6-ch20-clinical.html" class="quarto-xref"><span>Chapter 20</span></a> and <a href="p6-ch22-drugs.html" class="quarto-xref"><span>Chapter 22</span></a>, and <a href="p6-ch24-future.html" class="quarto-xref"><span>Chapter 24</span></a>. Together, they suggest that the future of genomic design will depend not only on better models, but also on <strong>careful integration with experimental design, rigorous evaluation, and robust norms for safe and equitable use</strong>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-deboer_deciphering_2020" class="csl-entry" role="listitem">
Boer, Carl G. de, Eeshit Dhaval Vaishnav, Ronen Sadeh, Esteban Luis Abeyta, Nir Friedman, and Aviv Regev. 2020. <span>“Deciphering Eukaryotic Gene-Regulatory Logic with 100 Million Random Promoters.”</span> <em>Nature Biotechnology</em> 38 (1): 56–65. <a href="https://doi.org/10.1038/s41587-019-0315-8">https://doi.org/10.1038/s41587-019-0315-8</a>.
</div>
<div id="ref-dauparas_proteinmpnn_2022" class="csl-entry" role="listitem">
Dauparas, J., I. Anishchenko, N. Bennett, H. Bai, R. J. Ragotte, L. F. Milles, B. I. M. Wicky, et al. 2022. <span>“Robust Deep Learning–Based Protein Sequence Design Using <span>ProteinMPNN</span>.”</span> <em>Science</em> 378 (6615): 49–56. <a href="https://doi.org/10.1126/science.add2187">https://doi.org/10.1126/science.add2187</a>.
</div>
<div id="ref-ferruz_protgpt2_2022" class="csl-entry" role="listitem">
Ferruz, Noelia, Steffen Schmidt, and Birte Höcker. 2022. <span>“<span>ProtGPT2</span> Is a Deep Unsupervised Language Model for Protein Design.”</span> <em>Nature Communications</em> 13 (1): 4348. <a href="https://doi.org/10.1038/s41467-022-32007-7">https://doi.org/10.1038/s41467-022-32007-7</a>.
</div>
<div id="ref-jumper_alphafold2_2021" class="csl-entry" role="listitem">
Jumper, John, Richard Evans, Alexander Pritzel, Tim Green, Michael Figurnov, Olaf Ronneberger, Kathryn Tunyasuvunakool, et al. 2021. <span>“[<span>AlphaFold2</span>] <span>Highly</span> Accurate Protein Structure Prediction with <span>AlphaFold</span>.”</span> <em>Nature</em> 596 (7873): 583–89. <a href="https://doi.org/10.1038/s41586-021-03819-2">https://doi.org/10.1038/s41586-021-03819-2</a>.
</div>
<div id="ref-madani_progen_2023" class="csl-entry" role="listitem">
Madani, Ali, Ben Krause, Eric R. Greene, Subu Subramanian, Benjamin P. Mohr, James M. Holton, Jose Luis Olmos, et al. 2023. <span>“Large Language Models Generate Functional Protein Sequences Across Diverse Families.”</span> <em>Nature Biotechnology</em> 41 (8): 1099–1106. <a href="https://doi.org/10.1038/s41587-022-01618-2">https://doi.org/10.1038/s41587-022-01618-2</a>.
</div>
<div id="ref-rao_tape_2019" class="csl-entry" role="listitem">
Rao, Roshan, Nicholas Bhattacharya, Neil Thomas, Yan Duan, Xi Chen, John Canny, Pieter Abbeel, and Yun S. Song. 2019. <span>“Evaluating <span>Protein</span> <span>Transfer</span> <span>Learning</span> with <span>TAPE</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1906.08230">https://doi.org/10.48550/arXiv.1906.08230</a>.
</div>
<div id="ref-watson_rfdiffusion_2023" class="csl-entry" role="listitem">
Watson, Joseph L., David Juergens, Nathaniel R. Bennett, Brian L. Trippe, Jason Yim, Helen E. Eisenach, Woody Ahern, et al. 2023. <span>“De Novo Design of Protein Structure and Function with <span>RFdiffusion</span>.”</span> <em>Nature</em> 620 (7976): 1089–1100. <a href="https://doi.org/10.1038/s41586-023-06415-8">https://doi.org/10.1038/s41586-023-06415-8</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p6-ch22-drugs.html" class="pagination-link" aria-label="Drug Discovery &amp; Biotech">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p6-ch24-future.html" class="pagination-link" aria-label="Future Work &amp; Ethics">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>