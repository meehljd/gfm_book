<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; CNN Sequence-to-Function Models – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p2-ch06-plm.html" rel="next">
<link href="./p2--architectures.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p2--architectures.html">Part II: Deep Learning Architectures</a></li><li class="breadcrumb-item"><a href="./p2-ch05-cnn.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-cnn.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p4--multi-scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Multi-Scale Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch13-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch14-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch16-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch17-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch20-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch21-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch22-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-reg" id="toc-sec-reg" class="nav-link active" data-scroll-target="#sec-reg"><span class="header-section-number">5.1</span> DeepSEA: Regulatory Prediction from Sequence</a>
  <ul class="collapse">
  <li><a href="#the-noncoding-variant-challenge" id="toc-the-noncoding-variant-challenge" class="nav-link" data-scroll-target="#the-noncoding-variant-challenge"><span class="header-section-number">5.1.1</span> The Noncoding Variant Challenge</a></li>
  <li><a href="#learning-regulatory-code-from-sequence" id="toc-learning-regulatory-code-from-sequence" class="nav-link" data-scroll-target="#learning-regulatory-code-from-sequence"><span class="header-section-number">5.1.2</span> Learning Regulatory Code from Sequence</a></li>
  <li><a href="#variant-effect-prediction" id="toc-variant-effect-prediction" class="nav-link" data-scroll-target="#variant-effect-prediction"><span class="header-section-number">5.1.3</span> Variant Effect Prediction</a></li>
  <li><a href="#functional-variant-prioritization" id="toc-functional-variant-prioritization" class="nav-link" data-scroll-target="#functional-variant-prioritization"><span class="header-section-number">5.1.4</span> Functional Variant Prioritization</a></li>
  <li><a href="#evolution-of-the-deepsea-framework" id="toc-evolution-of-the-deepsea-framework" class="nav-link" data-scroll-target="#evolution-of-the-deepsea-framework"><span class="header-section-number">5.1.5</span> Evolution of the DeepSEA Framework</a></li>
  <li><a href="#what-deepsea-learns" id="toc-what-deepsea-learns" class="nav-link" data-scroll-target="#what-deepsea-learns"><span class="header-section-number">5.1.6</span> What DeepSEA Learns</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">5.1.7</span> Limitations</a></li>
  <li><a href="#significance" id="toc-significance" class="nav-link" data-scroll-target="#significance"><span class="header-section-number">5.1.8</span> Significance</a></li>
  </ul></li>
  <li><a href="#sec-trans" id="toc-sec-trans" class="nav-link" data-scroll-target="#sec-trans"><span class="header-section-number">5.2</span> ExPecto: From Chromatin to Expression</a>
  <ul class="collapse">
  <li><a href="#the-expression-prediction-challenge" id="toc-the-expression-prediction-challenge" class="nav-link" data-scroll-target="#the-expression-prediction-challenge"><span class="header-section-number">5.2.1</span> The Expression Prediction Challenge</a></li>
  <li><a href="#the-modular-architecture" id="toc-the-modular-architecture" class="nav-link" data-scroll-target="#the-modular-architecture"><span class="header-section-number">5.2.2</span> The Modular Architecture</a></li>
  <li><a href="#expression-prediction-performance" id="toc-expression-prediction-performance" class="nav-link" data-scroll-target="#expression-prediction-performance"><span class="header-section-number">5.2.3</span> Expression Prediction Performance</a></li>
  <li><a href="#variant-effect-prediction-1" id="toc-variant-effect-prediction-1" class="nav-link" data-scroll-target="#variant-effect-prediction-1"><span class="header-section-number">5.2.4</span> Variant Effect Prediction</a></li>
  <li><a href="#gwas-variant-prioritization" id="toc-gwas-variant-prioritization" class="nav-link" data-scroll-target="#gwas-variant-prioritization"><span class="header-section-number">5.2.5</span> GWAS Variant Prioritization</a></li>
  <li><a href="#in-silico-saturation-mutagenesis-1" id="toc-in-silico-saturation-mutagenesis-1" class="nav-link" data-scroll-target="#in-silico-saturation-mutagenesis-1"><span class="header-section-number">5.2.6</span> In Silico Saturation Mutagenesis</a></li>
  <li><a href="#the-40-kb-regulatory-window" id="toc-the-40-kb-regulatory-window" class="nav-link" data-scroll-target="#the-40-kb-regulatory-window"><span class="header-section-number">5.2.7</span> The 40 kb Regulatory Window</a></li>
  <li><a href="#limitations-1" id="toc-limitations-1" class="nav-link" data-scroll-target="#limitations-1"><span class="header-section-number">5.2.8</span> Limitations</a></li>
  <li><a href="#significance-1" id="toc-significance-1" class="nav-link" data-scroll-target="#significance-1"><span class="header-section-number">5.2.9</span> Significance</a></li>
  </ul></li>
  <li><a href="#sec-splice" id="toc-sec-splice" class="nav-link" data-scroll-target="#sec-splice"><span class="header-section-number">5.3</span> SpliceAI: Splicing Prediction</a>
  <ul class="collapse">
  <li><a href="#the-splicing-challenge" id="toc-the-splicing-challenge" class="nav-link" data-scroll-target="#the-splicing-challenge"><span class="header-section-number">5.3.1</span> The Splicing Challenge</a></li>
  <li><a href="#prior-approaches-and-limitations" id="toc-prior-approaches-and-limitations" class="nav-link" data-scroll-target="#prior-approaches-and-limitations"><span class="header-section-number">5.3.2</span> Prior Approaches and Limitations</a></li>
  <li><a href="#the-spliceai-architecture" id="toc-the-spliceai-architecture" class="nav-link" data-scroll-target="#the-spliceai-architecture"><span class="header-section-number">5.3.3</span> The SpliceAI Architecture</a></li>
  <li><a href="#training-and-performance" id="toc-training-and-performance" class="nav-link" data-scroll-target="#training-and-performance"><span class="header-section-number">5.3.4</span> Training and Performance</a></li>
  <li><a href="#the-delta-score" id="toc-the-delta-score" class="nav-link" data-scroll-target="#the-delta-score"><span class="header-section-number">5.3.5</span> The Delta Score</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation"><span class="header-section-number">5.3.6</span> Validation</a></li>
  <li><a href="#clinical-impact-de-novo-mutations-in-rare-disease" id="toc-clinical-impact-de-novo-mutations-in-rare-disease" class="nav-link" data-scroll-target="#clinical-impact-de-novo-mutations-in-rare-disease"><span class="header-section-number">5.3.7</span> Clinical Impact: De Novo Mutations in Rare Disease</a></li>
  <li><a href="#what-spliceai-learned" id="toc-what-spliceai-learned" class="nav-link" data-scroll-target="#what-spliceai-learned"><span class="header-section-number">5.3.8</span> What SpliceAI Learned</a></li>
  <li><a href="#limitations-2" id="toc-limitations-2" class="nav-link" data-scroll-target="#limitations-2"><span class="header-section-number">5.3.9</span> Limitations</a></li>
  </ul></li>
  <li><a href="#sec-cnn-summary" id="toc-sec-cnn-summary" class="nav-link" data-scroll-target="#sec-cnn-summary"><span class="header-section-number">5.4</span> Architectural Progression and Common Themes</a>
  <ul class="collapse">
  <li><a href="#task-specificity-vs.-foundation-models" id="toc-task-specificity-vs.-foundation-models" class="nav-link" data-scroll-target="#task-specificity-vs.-foundation-models"><span class="header-section-number">5.4.1</span> Task Specificity vs.&nbsp;Foundation Models</a></li>
  <li><a href="#tissue-specific-model-specialization" id="toc-tissue-specific-model-specialization" class="nav-link" data-scroll-target="#tissue-specific-model-specialization"><span class="header-section-number">5.4.2</span> Tissue-Specific Model Specialization</a></li>
  <li><a href="#integration-with-variant-interpretation" id="toc-integration-with-variant-interpretation" class="nav-link" data-scroll-target="#integration-with-variant-interpretation"><span class="header-section-number">5.4.3</span> Integration with Variant Interpretation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p2--architectures.html">Part II: Deep Learning Architectures</a></li><li class="breadcrumb-item"><a href="./p2-ch05-cnn.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-cnn" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>Citations: verify all citations are in bibliography</li>
<li>Add figure showing DeepSEA architecture</li>
<li>Add figure showing ExPecto modular architecture</li>
<li>Add figure showing SpliceAI residual block design</li>
<li>Consider adding comparative architecture diagram across all three models</li>
</ul>
</div>
</div>
<p>The deep learning revolution in genomics began with convolutional neural networks (CNNs) that learned to predict molecular function directly from DNA sequence. Between 2015 and 2019, a series of models established paradigms that would shape the field. DeepVariant demonstrated that CNNs could outperform hand-crafted pipelines for variant calling by treating read pileups as images (<a href="p1-ch01-ngs.html#sec-deepvar" class="quarto-xref"><span>Section 1.8</span></a>; <span class="citation" data-cites="poplin_deepvariant_2018">Poplin et al. (<a href="references.html#ref-poplin_deepvariant_2018" role="doc-biblioref">2018</a>)</span>). DeepSEA showed that 1D convolutions over raw sequence could predict chromatin state without manual feature engineering <span class="citation" data-cites="zhou_deepsea_2015">(<a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>)</span>. ExPecto extended this approach to gene expression prediction <span class="citation" data-cites="zhou_expecto_2018">(<a href="references.html#ref-zhou_expecto_2018" role="doc-biblioref">Zhou et al. 2018</a>)</span>, and SpliceAI achieved remarkable accuracy in splice site recognition <span class="citation" data-cites="jaganathan_spliceai_2019">(<a href="references.html#ref-jaganathan_spliceai_2019" role="doc-biblioref">Jaganathan et al. 2019</a>)</span>.</p>
<p>Though DeepVariant and the sequence-to-function models solve fundamentally different problems (variant calling asks “is this a true variant?” while effect prediction asks “what does this variant do?”), they share a common lesson: learned representations can replace the hand-crafted features and heuristics that dominated earlier computational genomics. Where DeepVariant learns to recognize true variant patterns from pileup tensors, DeepSEA and its successors learn to recognize regulatory grammar from nucleotide sequences.</p>
<p>This chapter focuses on the sequence-to-function lineage. DeepSEA, ExPecto, and SpliceAI each addressed a distinct biological question, yet they shared a common architectural foundation: treat DNA as a signal to be processed by learnable filters, and let the network discover relevant sequence patterns from data. Together they demonstrate how increasing architectural depth and context length enable capture of progressively longer-range biological dependencies, from the kilobase-scale regulatory elements recognized by DeepSEA, through the tens of kilobases of promoter-proximal sequence integrated by ExPecto, to the 10 kb windows required for accurate splice prediction by SpliceAI. Understanding these models provides essential context for the transformer-based foundation models in Part III, which extend and generalize many of the principles established here.</p>
<section id="sec-reg" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-reg"><span class="header-section-number">5.1</span> DeepSEA: Regulatory Prediction from Sequence</h2>
<section id="the-noncoding-variant-challenge" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="the-noncoding-variant-challenge"><span class="header-section-number">5.1.1</span> The Noncoding Variant Challenge</h3>
<p>The vast majority of disease-associated variants identified by GWAS lie in noncoding regions of the genome. Across thousands of loci mapped to complex traits, only a small minority directly alter protein-coding sequences; the remainder fall in introns, intergenic regions, and putative regulatory elements where their functional consequences are far less obvious. This presents both an interpretive challenge and an opportunity. If we could predict how noncoding variants affect gene regulation, we would have a powerful tool for moving from statistical association to biological mechanism.</p>
<p>Yet in 2015, the field lacked systematic methods to predict how noncoding variants affect regulatory activity. Existing approaches relied on overlap with known annotations: if a variant fell within a ChIP-seq peak or DNase hypersensitive site, it might be flagged as potentially functional. This strategy had obvious appeal, since it grounded predictions in experimental observations, but it suffered from fundamental limitations. Overlap-based annotation offered no mechanism for predicting the direction or magnitude of a variant’s effect on regulatory activity. A variant might fall within an enhancer, but would it strengthen or weaken the enhancer? By how much? These questions could not be answered by checking whether genomic coordinates intersected. Furthermore, overlap-based methods could not score variants in regions lacking experimental coverage, which was problematic given that functional genomics experiments, despite their scale, still covered only a fraction of cell types and conditions.</p>
<p>DeepSEA, introduced by Zhou and Troyanskaya in 2015, fundamentally changed this paradigm by learning to predict chromatin features directly from DNA sequence <span class="citation" data-cites="zhou_deepsea_2015">(<a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>)</span>. Rather than asking “does this variant overlap a known regulatory element?”, DeepSEA asks “what regulatory activities does this sequence encode, and how would a mutation change them?” This shift from annotation lookup to sequence-based prediction opened a new chapter in computational genomics, one where deep neural networks could learn the relationship between DNA sequence and molecular function without requiring hand-crafted features or explicit motif definitions.</p>
</section>
<section id="learning-regulatory-code-from-sequence" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="learning-regulatory-code-from-sequence"><span class="header-section-number">5.1.2</span> Learning Regulatory Code from Sequence</h3>
<p>DeepSEA’s central insight was that deep convolutional networks could learn the sequence patterns underlying regulatory activity without explicit feature engineering. This represented a departure from earlier computational approaches to regulatory genomics, which typically required defining sequence features a priori. Methods like gapped k-mer SVMs (gkm-SVM) required specifying which k-mers to count and how to weight them. Position weight matrices for transcription factor binding sites required curating motif databases like JASPAR or TRANSFAC. These approaches worked, but they encoded human assumptions about what sequence features mattered and could not easily discover novel patterns or complex dependencies.</p>
<p>DeepSEA instead learned relevant sequence features automatically from data. The convolutional layers of the network function analogously to motif scanners, detecting local sequence patterns that correlate with regulatory activity. But unlike predefined motif scanners, these filters are learned during training, allowing the network to discover whatever patterns best predict the training labels. Deeper layers in the network can then learn combinations of these patterns, capturing regulatory “grammar” such as motif spacing, orientation preferences, and cooperative binding arrangements. The network does not know in advance which patterns matter; it learns them by optimizing predictions on hundreds of thousands of genomic sequences with experimentally measured chromatin profiles.</p>
<section id="architecture" class="level4" data-number="5.1.2.1">
<h4 data-number="5.1.2.1" class="anchored" data-anchor-id="architecture"><span class="header-section-number">5.1.2.1</span> Architecture</h4>
<p>The original DeepSEA architecture was deliberately simple by modern standards, comprising a stack of convolutional layers followed by fully connected layers that integrate information across the sequence.</p>
<p>The input to the network is a 1000 bp DNA sequence, one-hot encoded into a binary matrix with four channels (one per nucleotide) and 1000 positions. This representation treats sequence as a signal to be processed by convolution, analogous to how image recognition networks process pixel values. Each position in the sequence is represented by exactly one active channel, encoding which nucleotide (A, C, G, or T) is present.</p>
<p>The network processes this input through three convolutional layers, each followed by ReLU activation and max pooling. The first convolutional layer uses 320 filters of width 8, scanning the sequence for local patterns roughly the size of transcription factor binding sites. Max pooling after each convolution reduces the spatial dimension, progressively compressing the 1000-position input into a more compact representation. The second and third convolutional layers use 480 and 960 filters respectively, with narrower widths (8 and 8) applied to the already-pooled representation. These deeper layers can learn combinations of the patterns detected by earlier layers, building increasingly abstract representations of sequence features.</p>
<p>After the convolutional stack, a fully connected layer with 925 units integrates information across all positions in the compressed representation. This layer allows the network to learn relationships between sequence features at different positions, capturing spatial dependencies that pure convolution cannot represent. Finally, an output layer with 919 sigmoid units produces independent probability predictions for each chromatin profile.</p>
<p>The total number of parameters is modest by contemporary standards (approximately 60 million) but was substantial for genomics applications at the time. Training used stochastic gradient descent with momentum on sequences sampled from the human genome, with chromosome 8 held out for testing.</p>
</section>
<section id="training-data" class="level4" data-number="5.1.2.2">
<h4 data-number="5.1.2.2" class="anchored" data-anchor-id="training-data"><span class="header-section-number">5.1.2.2</span> Training Data</h4>
<p>DeepSEA was trained on 919 chromatin profiles compiled from ENCODE and Roadmap Epigenomics, two consortium efforts that had systematically mapped the epigenomic landscape across diverse human cell types and tissues <span class="citation" data-cites="kagda_encode_2025 kundaje_roadmap_2015">(<a href="references.html#ref-kagda_encode_2025" role="doc-biblioref">Kagda et al. 2025</a>; <a href="references.html#ref-kundaje_roadmap_2015" role="doc-biblioref">Kundaje et al. 2015</a>)</span>. These profiles represented three major categories of regulatory annotation.</p>
<p>Transcription factor binding profiles, numbering 690 in total, captured the genomic locations where specific proteins bind DNA. These were derived from ChIP-seq experiments targeting factors like CTCF (a ubiquitous insulator protein), p53 (a tumor suppressor), and GATA1 (a hematopoietic transcription factor). Each profile represents a binary classification problem: for a given sequence, is the central region bound by this factor in this cell type?</p>
<p>Histone modification profiles, numbering 104, captured the locations of specific chemical modifications to histone proteins. Marks like H3K4me3 (trimethylation of lysine 4 on histone H3) are associated with active promoters, while H3K27ac (acetylation of lysine 27) marks active enhancers. H3K27me3 marks repressed regions through Polycomb-mediated silencing. These modifications do not directly encode regulatory logic but reflect the functional state of chromatin and correlate with gene expression.</p>
<p>DNase I hypersensitivity profiles, numbering 125, captured regions of open chromatin across cell types. DNase hypersensitive sites mark regions where DNA is accessible to regulatory proteins, identifying potential regulatory elements regardless of which specific factors bind there. Unlike transcription factor ChIP-seq, DNase-seq provides a relatively unbiased view of regulatory potential.</p>
<p>For each 1000 bp input sequence, the model predicts the probability that the central 200 bp region exhibits each of these 919 chromatin features. The narrower prediction window relative to the input window allows the network to use flanking sequence as context for predicting the central region’s activity. Training used sequences sampled from the human genome, excluding chromosome 8 which was reserved for evaluation. This chromosome-level holdout prevents overfitting to sequence homology or LD patterns that might leak between training and test sets.</p>
</section>
<section id="multi-task-learning" class="level4" data-number="5.1.2.3">
<h4 data-number="5.1.2.3" class="anchored" data-anchor-id="multi-task-learning"><span class="header-section-number">5.1.2.3</span> Multi-Task Learning</h4>
<p>A key architectural decision was predicting all 919 features simultaneously rather than training separate models for each. This multi-task learning approach offers several advantages that compound as the number of tasks increases.</p>
<p>Shared representations in early layers benefit all tasks. The first convolutional layer learns general sequence features such as GC content, dinucleotide frequencies, and common motifs that are useful across many prediction problems. By sharing these representations, the network amortizes the cost of learning basic sequence features across all tasks rather than relearning them independently.</p>
<p>Joint prediction provides regularization. Predicting many correlated features simultaneously prevents overfitting to any single task. If a convolutional filter becomes overly specific to one transcription factor, it will harm predictions for other related factors, providing a pressure toward learning generalizable representations. This implicit regularization is particularly valuable when some tasks have limited training data.</p>
<p>Efficiency gains are substantial. One model serving all 919 prediction tasks requires far less computation than training and maintaining 919 separate models. This matters not only for initial training but for deployment, where a single forward pass produces all predictions.</p>
<p>The multi-task framework also reveals relationships between chromatin features. Weights connecting shared representations to different output tasks can be analyzed to understand which features rely on similar sequence patterns. This provides a form of interpretability that separate models would not offer.</p>
</section>
</section>
<section id="variant-effect-prediction" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="variant-effect-prediction"><span class="header-section-number">5.1.3</span> Variant Effect Prediction</h3>
<p>With a trained model that maps sequence to chromatin profiles, variant effect prediction becomes straightforward in principle: predict chromatin profiles for both reference and alternative allele sequences, then compute the difference. This produces a 919-dimensional vector describing how the variant is predicted to alter regulatory activity across all profiled features. A variant might be predicted to increase CTCF binding while decreasing DNase accessibility, or to have no effect on any chromatin feature, depending on where it falls and what sequence context it disrupts or creates.</p>
<p>This approach has a crucial property: it requires no training on variant data. The model learns to predict chromatin profiles from sequence during training, using only reference genome sequences and their experimentally measured chromatin states. Variant effect prediction is then a form of transfer: the model applies what it learned about sequence-function relationships to score mutations it has never seen. This ab initio capability distinguishes sequence-based models from approaches that learn directly from observed variant effects, which are inevitably biased toward common variants where statistical power exists.</p>
<section id="single-nucleotide-sensitivity" class="level4" data-number="5.1.3.1">
<h4 data-number="5.1.3.1" class="anchored" data-anchor-id="single-nucleotide-sensitivity"><span class="header-section-number">5.1.3.1</span> Single-Nucleotide Sensitivity</h4>
<p>For the approach to work, the model must achieve single-nucleotide sensitivity: changing one base must be capable of substantially altering predictions. This is not guaranteed. A model could achieve good performance on chromatin prediction by learning only coarse sequence features (GC content, repeat density) that are insensitive to point mutations. Such a model would be useless for variant interpretation.</p>
<p>DeepSEA achieves genuine single-nucleotide sensitivity, and the authors validated this using allelic imbalance data from digital genomic footprinting. For 57,407 variants showing allele-specific DNase I sensitivity across 35 cell types, DeepSEA predictions correlated strongly with the experimentally observed allelic bias. Variants predicted to increase chromatin accessibility tended to show higher accessibility on the corresponding allele, and vice versa. This correlation would not exist if the model were insensitive to point mutations.</p>
<p>The validation is particularly compelling because allelic imbalance represents an independent experimental readout. The model was not trained to predict allelic imbalance; it was trained to predict chromatin profiles from reference sequences. That it correctly predicts the direction of allelic effects demonstrates that the learned sequence-function relationships capture genuine biology rather than spurious correlations.</p>
</section>
<section id="in-silico-saturation-mutagenesis" class="level4" data-number="5.1.3.2">
<h4 data-number="5.1.3.2" class="anchored" data-anchor-id="in-silico-saturation-mutagenesis"><span class="header-section-number">5.1.3.2</span> In Silico Saturation Mutagenesis</h4>
<p>Beyond scoring individual variants, DeepSEA enables a powerful computational experiment: in silico saturation mutagenesis (ISM). By systematically predicting effects of all possible single-nucleotide substitutions within a sequence, one can identify which positions are most critical for regulatory function. At each position, three alternative nucleotides can be substituted, and the predicted change in chromatin profiles can be computed for each. Positions where substitutions produce large predicted effects are presumably functionally constrained, while positions tolerant of substitution are less critical.</p>
<p>ISM analysis of regulatory elements reveals sequence positions where mutations would most strongly perturb function. These critical positions often correspond to transcription factor binding motifs learned by the model. When the predicted effects are visualized along a regulatory sequence, clear patterns emerge: core motif positions show strong predicted effects, while flanking positions are more tolerant. This provides a form of motif discovery that emerges from the model’s learned representations rather than from explicit motif searching.</p>
</section>
</section>
<section id="functional-variant-prioritization" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="functional-variant-prioritization"><span class="header-section-number">5.1.4</span> Functional Variant Prioritization</h3>
<p>Beyond predicting chromatin effects for individual variants, DeepSEA introduced a framework for prioritizing likely functional variants among large sets of candidates. This addresses a practical problem in human genetics: GWAS and sequencing studies identify many variants in a region, most of which are not causal. Which variants should be prioritized for follow-up?</p>
<p>Expression quantitative trait loci (eQTLs) represent variants statistically associated with gene expression changes. However, most eQTL signals reflect linkage disequilibrium rather than direct causation. A lead eQTL variant may simply be correlated with the true causal variant, which could be any of dozens of SNPs in the same LD block. DeepSEA demonstrated improved ability to distinguish likely causal eQTL variants from nearby non-causal variants compared to overlap-based methods. The intuition is straightforward: if a variant is truly causal, it should disrupt a sequence feature that matters for gene regulation.</p>
<p>DeepSEA’s performance advantage over gkm-SVM was particularly notable for transcription factor binding prediction. The deep CNN achieved higher AUC for nearly all transcription factors tested. More revealing was the pattern with respect to sequence context: gkm-SVM showed no improvement when given longer input sequences (extending context from 200 bp to 500 bp to 1000 bp), while DeepSEA performance improved substantially with additional context. This difference reflects the fundamental limitation of gapped k-mer methods, which count k-mers without learning relationships between motifs at different positions.</p>
</section>
<section id="evolution-of-the-deepsea-framework" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="evolution-of-the-deepsea-framework"><span class="header-section-number">5.1.5</span> Evolution of the DeepSEA Framework</h3>
<p>The original DeepSEA established the sequence-to-chromatin prediction paradigm. Subsequent work from the same research group expanded and refined this approach, building a lineage of models with progressively greater scope and sophistication.</p>
<p>ExPecto, published in 2018, included an updated chromatin prediction model nicknamed “Beluga” that served as the foundation for tissue-specific expression prediction <span class="citation" data-cites="zhou_expecto_2018">(<a href="references.html#ref-zhou_expecto_2018" role="doc-biblioref">Zhou et al. 2018</a>)</span>. Beluga incorporated several architectural improvements over the original DeepSEA. The number of predicted chromatin profiles expanded from 919 to 2,002, covering additional transcription factors and histone modifications across more cell types. The architecture deepened, adding additional convolutional layers with residual connections that facilitated training and improved gradient flow. The input context expanded from 1000 bp to 2000 bp, allowing the model to capture longer-range sequence dependencies.</p>
<p>Sei represents the current state of the DeepSEA lineage, predicting 21,907 chromatin profiles, a 24-fold expansion over the original <span class="citation" data-cites="chen_deepsea_2022">(<a href="references.html#ref-chen_deepsea_2022" role="doc-biblioref">Chen et al. 2022</a>)</span>. The Sei architecture introduces dual linear and nonlinear paths, dilated convolutions to expand the receptive field, and spatial basis functions for memory-efficient integration across positions. Beyond raw prediction performance, Sei introduced sequence class annotations that cluster the 21,907 chromatin predictions into interpretable regulatory categories.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>Year</th>
<th>Chromatin Targets</th>
<th>Input Length</th>
<th>Architecture</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DeepSEA</td>
<td>2015</td>
<td>919</td>
<td>1000 bp</td>
<td>3 conv + FC</td>
</tr>
<tr class="even">
<td>Beluga</td>
<td>2018</td>
<td>2,002</td>
<td>2000 bp</td>
<td>Deep residual CNN</td>
</tr>
<tr class="odd">
<td>Sei</td>
<td>2022</td>
<td>21,907</td>
<td>4000 bp</td>
<td>Dual-path + dilated conv</td>
</tr>
</tbody>
</table>
</section>
<section id="what-deepsea-learns" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="what-deepsea-learns"><span class="header-section-number">5.1.6</span> What DeepSEA Learns</h3>
<p>Analysis of DeepSEA’s first-layer filters reveals learned sequence patterns corresponding to known transcription factor binding motifs. Many filters match canonical motifs from databases like JASPAR, indicating that the network has independently discovered the sequence preferences of well-characterized transcription factors. Beyond individual motifs, DeepSEA implicitly learns aspects of regulatory “grammar,” including motif spacing requirements, orientation preferences, and combinatorial logic.</p>
<p>However, the original DeepSEA architecture’s limited receptive field constrained its ability to learn long-range dependencies. Max pooling after each convolutional layer progressively reduces spatial resolution, and the fully connected layer can only integrate information from the resulting compressed representation. Dependencies spanning hundreds or thousands of base pairs, such as enhancer-promoter communication, are difficult to capture in this framework. This limitation motivated later architectures with expanded context windows, culminating in models like Enformer (<a href="p2-ch09-hybrid.html" class="quarto-xref"><span>Chapter 9</span></a>) with effective receptive fields spanning hundreds of kilobases.</p>
</section>
<section id="limitations" class="level3" data-number="5.1.7">
<h3 data-number="5.1.7" class="anchored" data-anchor-id="limitations"><span class="header-section-number">5.1.7</span> Limitations</h3>
<p>DeepSEA represents a major advance, but understanding its limitations is essential for appropriate application. The model predicts chromatin profiles for specific cell types included in training, but the same sequence may have different regulatory activity in cell types not represented. The model treats each input sequence independently, without considering three-dimensional chromatin structure, the current transcriptional state of the cell, or other variants in the same individual. While DeepSEA accurately predicts the binary presence or absence of chromatin features, its quantitative predictions of signal strength are less reliable.</p>
</section>
<section id="significance" class="level3" data-number="5.1.8">
<h3 data-number="5.1.8" class="anchored" data-anchor-id="significance"><span class="header-section-number">5.1.8</span> Significance</h3>
<p>DeepSEA established several paradigms that shaped subsequent genomic deep learning. The “sequence-in, function-out” paradigm treats DNA sequence as the sole input and molecular function as the output, learning the mapping without hand-engineered features. Multi-task chromatin prediction, jointly modeling many related tasks, proved both more efficient and more effective than training separate models. Variant effect prediction via sequence comparison provided a general framework for interpreting genetic variation. The approach demonstrated that deep learning could extract biologically meaningful patterns from raw sequence data at scale.</p>
</section>
</section>
<section id="sec-trans" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-trans"><span class="header-section-number">5.2</span> ExPecto: From Chromatin to Expression</h2>
<section id="the-expression-prediction-challenge" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="the-expression-prediction-challenge"><span class="header-section-number">5.2.1</span> The Expression Prediction Challenge</h3>
<p>DeepSEA demonstrated that deep learning could predict chromatin features from DNA sequence alone. Yet chromatin accessibility and transcription factor binding are intermediate phenotypes. The ultimate functional readout for most regulatory variants is their effect on gene expression. A variant might disrupt a transcription factor binding site, but does that binding site actually regulate a nearby gene? In which tissues? By how much?</p>
<p>ExPecto, introduced by Zhou et al.&nbsp;in 2018, addressed these questions by extending the sequence-to-chromatin paradigm to predict tissue-specific gene expression levels <span class="citation" data-cites="zhou_expecto_2018">(<a href="references.html#ref-zhou_expecto_2018" role="doc-biblioref">Zhou et al. 2018</a>)</span>. The framework’s name reflects its core capability: expression prediction. Rather than stopping at chromatin predictions, ExPecto integrates predicted regulatory signals across a 40 kb promoter-proximal region to predict absolute expression levels in 218 tissues and cell types.</p>
<p>Critically, ExPecto predicts expression effects ab initio from sequence, without training on any variant data. This enables scoring of rare variants, de novo mutations, and even hypothetical mutations never observed in any population.</p>
</section>
<section id="the-modular-architecture" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="the-modular-architecture"><span class="header-section-number">5.2.2</span> The Modular Architecture</h3>
<p>ExPecto comprises three sequential components, each addressing a distinct computational challenge.</p>
<section id="component-1-epigenomic-effects-model-beluga-cnn" class="level4" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="component-1-epigenomic-effects-model-beluga-cnn"><span class="header-section-number">5.2.2.1</span> Component 1: Epigenomic Effects Model (Beluga CNN)</h4>
<p>The first component is an enhanced version of DeepSEA, predicting 2,002 chromatin profiles across more than 200 cell types. Key architectural improvements over the original DeepSEA include expanded chromatin targets (from 919 to 2,002), a wider input window (from 1,000 bp to 2,000 bp), deeper architecture (six convolutional layers with residual connections rather than three), and broader cell type coverage.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>DeepSEA (2015)</th>
<th>ExPecto/Beluga (2018)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Chromatin targets</td>
<td>919</td>
<td>2,002</td>
</tr>
<tr class="even">
<td>Input window</td>
<td>1,000 bp</td>
<td>2,000 bp</td>
</tr>
<tr class="odd">
<td>Convolution layers</td>
<td>3</td>
<td>6 (with residual connections)</td>
</tr>
<tr class="even">
<td>Cell types</td>
<td>~125</td>
<td>&gt;200</td>
</tr>
</tbody>
</table>
<p>The CNN scans the 40 kb region surrounding each transcription start site (TSS) with a moving window (200 bp step size), generating chromatin predictions at 200 spatial positions. For each gene, this produces 2,002 × 200 = 400,400 features representing the predicted spatial chromatin organization around the TSS.</p>
</section>
<section id="component-2-spatial-feature-transformation" class="level4" data-number="5.2.2.2">
<h4 data-number="5.2.2.2" class="anchored" data-anchor-id="component-2-spatial-feature-transformation"><span class="header-section-number">5.2.2.2</span> Component 2: Spatial Feature Transformation</h4>
<p>The 400,400-dimensional feature space poses optimization challenges for downstream expression prediction. ExPecto addresses this through spatial transformation, a biologically motivated dimensionality reduction that captures the known distance-dependent relationship between regulatory elements and their target promoters.</p>
<p>The transformation applies ten exponential decay functions separately to upstream and downstream regions:</p>
<p><span class="math display">\[
\text{expression} = \sum_{i,k} \left( \beta_{ik}^{\text{up}} \cdot \mathbf{1}(t_d &lt; 0) + \beta_{ik}^{\text{down}} \cdot \mathbf{1}(t_d &gt; 0) \right) \cdot \sum_{d \in D} p_{id} \cdot e^{-a_k \cdot |t_d|}
\]</span></p>
<p>where <span class="math inline">\(p_{id}\)</span> is the predicted probability for chromatin feature <span class="math inline">\(i\)</span> at spatial bin <span class="math inline">\(d\)</span>, <span class="math inline">\(t_d\)</span> is the mean distance to TSS for bin <span class="math inline">\(d\)</span>, and <span class="math inline">\(a_k\)</span> represents decay constants (0.01, 0.02, 0.05, 0.1, 0.2). This transformation reduces dimensionality 20-fold (to 20,020 features) while preserving spatial information.</p>
</section>
<section id="component-3-tissue-specific-linear-models" class="level4" data-number="5.2.2.3">
<h4 data-number="5.2.2.3" class="anchored" data-anchor-id="component-3-tissue-specific-linear-models"><span class="header-section-number">5.2.2.3</span> Component 3: Tissue-Specific Linear Models</h4>
<p>The final component comprises 218 L2-regularized linear regression models (one per tissue), each predicting log RPKM expression from spatially-transformed features. Linear models were chosen deliberately: they provide interpretability, prevent overfitting given the high-dimensional feature space, and enable straightforward coefficient analysis to identify which chromatin features drive expression in each tissue.</p>
</section>
</section>
<section id="expression-prediction-performance" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="expression-prediction-performance"><span class="header-section-number">5.2.3</span> Expression Prediction Performance</h3>
<p>ExPecto achieved 0.819 median Spearman correlation between predicted and observed expression (log RPKM) across 218 tissues and cell types, a substantial improvement over prior sequence-based expression models, which were typically limited to narrower regulatory regions (&lt;2 kb) and fewer cell types.</p>
<p>Beyond predicting absolute expression levels, ExPecto captures tissue-specific expression patterns. Analysis of model coefficients reveals automatic learning of cell-type-relevant features without explicit tissue labels. The liver expression model assigns top weights to transcription factors profiled in HepG2 (liver-derived) cells. The breast tissue model weights estrogen receptor and glucocorticoid receptor features from breast cancer cell lines most heavily among its positive coefficients. These patterns emerge purely from learning to predict expression, without any tissue identity information provided to the chromatin features.</p>
<p>Model coefficients also reveal the relative contributions of different chromatin feature types. Transcription factors and histone marks receive consistently higher weights, reflecting their direct mechanistic roles in transcriptional regulation. DNase I features receive significantly lower weights despite indicating regulatory activity. This discrepancy likely reflects that DNase hypersensitivity marks the presence of regulatory activity without specifying its type or causal relationship to expression.</p>
</section>
<section id="variant-effect-prediction-1" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="variant-effect-prediction-1"><span class="header-section-number">5.2.4</span> Variant Effect Prediction</h3>
<p>ExPecto’s expression predictions enable scoring variant effects through in silico mutagenesis: predict expression with reference allele, predict with alternative allele, and compute the difference:</p>
<p><span class="math display">\[
\Delta \text{expression} = f(\text{sequence}_{\text{alt}}) - f(\text{sequence}_{\text{ref}})
\]</span></p>
<p>Because the model never trains on variant data, predictions are unconfounded by linkage disequilibrium, a fundamental advantage over statistical eQTL approaches.</p>
<p>ExPecto correctly predicted the direction of expression change for 92% of the top 500 strongest-effect GTEx eQTL variants. Prediction accuracy increases with predicted effect magnitude: variants with stronger predicted effects show higher eQTL direction concordance, consistent with the expectation that true causal variants should have larger predicted effects.</p>
<p>Traditional eQTL studies face fundamental limitations. Linkage disequilibrium confounds causal inference: only 3.5 to 11.7% of GTEx lead variants are estimated to be truly causal. ExPecto’s sequence-based predictions sidestep this limitation: the model scores variants based on predicted functional impact rather than population associations, works identically for any allele frequency, and leverages expression training data from many tissues even when eQTL data is unavailable.</p>
</section>
<section id="gwas-variant-prioritization" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="gwas-variant-prioritization"><span class="header-section-number">5.2.5</span> GWAS Variant Prioritization</h3>
<p>Zhou et al.&nbsp;applied ExPecto to prioritize variants from approximately 3,000 GWAS studies. GWAS loci with stronger predicted effect variants were significantly more likely to replicate in independent studies (p = 6.3×10⁻¹⁸⁹). The framework can identify causal variants that statistical association alone cannot distinguish.</p>
<p>The authors experimentally validated three top-ranked ExPecto predictions for immune-related diseases using luciferase reporter assays. In all cases, the ExPecto-prioritized variants showed significant allele-specific regulatory activity, while the original GWAS lead variants showed no differential activity.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 36%">
<col style="width: 9%">
<col style="width: 26%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Disease</th>
<th>ExPecto-Prioritized SNP</th>
<th>Gene</th>
<th>Reporter Effect</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Crohn’s disease / IBD</td>
<td>rs1174815</td>
<td>IRGM</td>
<td>Decreased expression</td>
<td>3×10⁻⁶</td>
</tr>
<tr class="even">
<td>Behçet’s disease</td>
<td>rs147398495</td>
<td>CCR1</td>
<td>Changed activity</td>
<td>7×10⁻¹⁰</td>
</tr>
<tr class="odd">
<td>Chronic HBV infection</td>
<td>rs381218</td>
<td>HLA-DOA</td>
<td>4-fold change</td>
<td>1×10⁻⁹</td>
</tr>
</tbody>
</table>
</section>
<section id="in-silico-saturation-mutagenesis-1" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="in-silico-saturation-mutagenesis-1"><span class="header-section-number">5.2.6</span> In Silico Saturation Mutagenesis</h3>
<p>The computational efficiency of ExPecto enables exhaustive characterization of the regulatory mutation space. The authors computed predicted effects for all possible single nucleotide substitutions within ±1 kb of each TSS, covering over 140 million mutations across 23,779 human genes. This identified more than 1.1 million mutations with strong predicted expression effects.</p>
<p>For each gene, the comprehensive mutagenesis profile defines its “variation potential” (VP), the collective effects of all possible mutations on that gene’s expression. VP correlates with known biological properties: tissue-specific genes show lower VP than broadly expressed genes, and genes under stronger evolutionary constraint tend to have higher VP.</p>
</section>
<section id="the-40-kb-regulatory-window" class="level3" data-number="5.2.7">
<h3 data-number="5.2.7" class="anchored" data-anchor-id="the-40-kb-regulatory-window"><span class="header-section-number">5.2.7</span> The 40 kb Regulatory Window</h3>
<p>ExPecto’s ±20 kb window around each TSS represents an empirically optimized trade-off. Smaller windows decreased prediction performance, while larger windows (50 to 200 kb) showed negligible improvement. This suggests that most regulatory information for promoter-proximal expression lies within 40 kb of the TSS, at least within the linear modeling framework employed by ExPecto. Distal enhancers beyond this window, while biologically important, likely require more sophisticated integration approaches. Enformer (<a href="p2-ch09-hybrid.html" class="quarto-xref"><span>Chapter 9</span></a>), with its 200 kb effective receptive field, addresses this limitation.</p>
</section>
<section id="limitations-1" class="level3" data-number="5.2.8">
<h3 data-number="5.2.8" class="anchored" data-anchor-id="limitations-1"><span class="header-section-number">5.2.8</span> Limitations</h3>
<p>While the chromatin CNN captures nonlinear sequence patterns, the final expression model is linear. This prevents modeling of complex regulatory logic such as synergistic interactions between elements, competitive binding, or threshold effects. The 40 kb window misses distal enhancers operating over hundreds of kilobases and three-dimensional chromatin interactions. The TSS-centric framework may limit predictions for genes with multiple alternative promoters or tissue-specific promoter usage. Expression models trained on GTEx, Roadmap, and ENCODE data inherit their biases in ancestry composition, tissue representation, and cell line artifacts.</p>
</section>
<section id="significance-1" class="level3" data-number="5.2.9">
<h3 data-number="5.2.9" class="anchored" data-anchor-id="significance-1"><span class="header-section-number">5.2.9</span> Significance</h3>
<p>ExPecto established several paradigms that influenced subsequent genomic deep learning. The modular sequence-to-expression prediction architecture demonstrated the value of decomposing the problem into chromatin prediction, spatial integration, and expression modeling. Ab initio variant effect prediction, achieved by training without variant data, avoids LD confounding and enables causal inference rather than mere association. The framework demonstrated that deep learning could move beyond predicting intermediate molecular phenotypes to predict cellular phenotypes directly from sequence.</p>
</section>
</section>
<section id="sec-splice" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-splice"><span class="header-section-number">5.3</span> SpliceAI: Splicing Prediction</h2>
<section id="the-splicing-challenge" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="the-splicing-challenge"><span class="header-section-number">5.3.1</span> The Splicing Challenge</h3>
<p>While DeepSEA and ExPecto addressed chromatin state and gene expression, a distinct class of functional variants operates through a different mechanism: disruption of pre-mRNA splicing. The spliceosome achieves remarkable precision, recognizing the correct splice sites among millions of potential candidates in the human transcriptome. Yet the sequence determinants underlying this specificity remained incompletely understood, limiting interpretation of variants that might alter splicing.</p>
<p>The clinical stakes are substantial. As discussed in <a href="p1-ch01-ngs.html" class="quarto-xref"><span>Chapter 1</span></a>, variant calling pipelines identify thousands of variants per exome and millions per genome, but annotation frameworks traditionally focus on coding consequences. Variants affecting splicing outside the canonical GT/AG dinucleotides are systematically underascertained, even though splice-disrupting mutations are a major mechanism of Mendelian disease. The ACMG/AMP guidelines (<a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a>) recognize splicing evidence as supporting pathogenicity, but until recently, computational tools lacked the accuracy to identify cryptic splice variants reliably.</p>
<p>SpliceAI, introduced by Jaganathan et al.&nbsp;in 2019, demonstrated that deep neural networks could learn the sequence rules governing splicing with near-spliceosomal precision <span class="citation" data-cites="jaganathan_spliceai_2019">(<a href="references.html#ref-jaganathan_spliceai_2019" role="doc-biblioref">Jaganathan et al. 2019</a>)</span>. The model predicts splice site locations directly from pre-mRNA sequence, enabling identification of “cryptic splice” variants that create novel splice sites or disrupt existing ones in ways that evade traditional annotation-based detection.</p>
</section>
<section id="prior-approaches-and-limitations" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="prior-approaches-and-limitations"><span class="header-section-number">5.3.2</span> Prior Approaches and Limitations</h3>
<p>Before SpliceAI, splice site prediction relied on methods with limited sequence context. MaxEntScan models core splice motifs using maximum entropy, limited to approximately 9 bp context around donor/acceptor sites <span class="citation" data-cites="yeo_maxentscan_2004">(<a href="references.html#ref-yeo_maxentscan_2004" role="doc-biblioref"><strong>yeo_maxentscan_2004?</strong></a>)</span>. GeneSplicer combines Markov models with decision trees. NNSplice represents an early neural network approach with narrow receptive fields. These methods captured the essential GT (donor) and AG (acceptor) dinucleotides and surrounding consensus sequences, but could not model the long-range determinants that contribute to splicing specificity.</p>
<p>The limitations parallel those of pre-deep-learning variant effect predictors like CADD (<a href="p1-ch04-cadd.html" class="quarto-xref"><span>Chapter 4</span></a>), which aggregate many annotation features but lack the capacity to learn complex sequence dependencies. Prior methods produced many false positive predictions and missed variants acting through distal mechanisms.</p>
</section>
<section id="the-spliceai-architecture" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="the-spliceai-architecture"><span class="header-section-number">5.3.3</span> The SpliceAI Architecture</h3>
<p>SpliceAI employs an ultra-deep residual convolutional network that integrates information across 10,000 nucleotides of sequence context. This represents an order of magnitude expansion beyond prior methods and reflects the same architectural intuition that motivated ExPecto’s 40 kb regulatory window: functional genomic predictions often require long-range context that shallow models cannot capture.</p>
<section id="input-representation" class="level4" data-number="5.3.3.1">
<h4 data-number="5.3.3.1" class="anchored" data-anchor-id="input-representation"><span class="header-section-number">5.3.3.1</span> Input Representation</h4>
<p>Like DeepSEA and ExPecto, SpliceAI uses one-hot encoded nucleotide sequences as input. The four nucleotides are encoded as binary vectors, with no hand-crafted features or annotations. This end-to-end learning approach forces the network to discover relevant sequence patterns from training data. The input window spans 10,000 nucleotides (5,000 on each side of the position of interest), providing context for recognizing distant determinants like branch points, exonic splicing enhancers, and intron/exon length constraints.</p>
</section>
<section id="residual-block-design" class="level4" data-number="5.3.3.2">
<h4 data-number="5.3.3.2" class="anchored" data-anchor-id="residual-block-design"><span class="header-section-number">5.3.3.2</span> Residual Block Design</h4>
<p>The architecture’s fundamental unit is the residual block, comprising batch normalization, ReLU activation, and dilated convolutions. Residual connections address the vanishing gradient problem that had limited earlier deep networks:</p>
<p><span class="math display">\[
\text{output} = \text{input} + F(\text{input})
\]</span></p>
<p>This design enables training of networks with 32 layers, far deeper than the 3-layer DeepSEA or 6-layer ExPecto/Beluga architectures. Skip connections from every fourth residual block feed directly to the penultimate layer, accelerating training convergence and enabling gradient flow through the full network depth.</p>
</section>
<section id="dilated-convolutions" class="level4" data-number="5.3.3.3">
<h4 data-number="5.3.3.3" class="anchored" data-anchor-id="dilated-convolutions"><span class="header-section-number">5.3.3.3</span> Dilated Convolutions</h4>
<p>Standard convolutions with small kernels would require many layers to achieve a 10,000 bp receptive field. SpliceAI uses dilated convolutions that exponentially expand the receptive field while maintaining computational efficiency. A dilated convolution with dilation rate <span class="math inline">\(d\)</span> samples input positions at intervals of <span class="math inline">\(d\)</span> rather than consecutively. By stacking convolutions with increasing dilation rates, the network can efficiently integrate information across the full 10 kb window while maintaining sensitivity to local motif patterns.</p>
</section>
<section id="output-predictions" class="level4" data-number="5.3.3.4">
<h4 data-number="5.3.3.4" class="anchored" data-anchor-id="output-predictions"><span class="header-section-number">5.3.3.4</span> Output Predictions</h4>
<p>For each position in the pre-mRNA sequence, SpliceAI outputs three probabilities summing to one: the probability of being a splice acceptor, splice donor, or neither. This per-position classification enables fine-grained predictions across entire transcripts.</p>
</section>
</section>
<section id="training-and-performance" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="training-and-performance"><span class="header-section-number">5.3.4</span> Training and Performance</h3>
<p>SpliceAI was trained on GENCODE V24 annotations, using 20,287 protein-coding genes with principal transcripts selected when multiple isoforms existed. The training/test split used odd versus even chromosomes, with genes having paralogs on training chromosomes excluded from the test set to prevent information leakage.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Set</th>
<th>Chromosomes</th>
<th>Genes</th>
<th>Donor-Acceptor Pairs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Training</td>
<td>2, 4, 6, 8, 10-22, X, Y</td>
<td>13,384</td>
<td>130,796</td>
</tr>
<tr class="even">
<td>Testing</td>
<td>1, 3, 5, 7, 9</td>
<td>1,652</td>
<td>14,289</td>
</tr>
</tbody>
</table>
<p>SpliceAI-10k achieved remarkable accuracy, with 95% top-k accuracy (compared to 57% for MaxEntScan) and 0.98 PR-AUC. Even complex genes exceeding 100 kb, such as CFTR, are often reconstructed perfectly to nucleotide precision.</p>
<p>Performance improved substantially with context length:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>Context (each side)</th>
<th>PR-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SpliceAI-80nt</td>
<td>40 bp</td>
<td>0.87</td>
</tr>
<tr class="even">
<td>SpliceAI-400nt</td>
<td>200 bp</td>
<td>0.93</td>
</tr>
<tr class="odd">
<td>SpliceAI-2k</td>
<td>1,000 bp</td>
<td>0.96</td>
</tr>
<tr class="even">
<td>SpliceAI-10k</td>
<td>5,000 bp</td>
<td>0.98</td>
</tr>
</tbody>
</table>
<p>This progression confirms that distal sequence features thousands of nucleotides from splice sites contribute meaningfully to splicing decisions.</p>
</section>
<section id="the-delta-score" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="the-delta-score"><span class="header-section-number">5.3.5</span> The Delta Score</h3>
<p>SpliceAI predicts variant effects by comparing splice site predictions for reference and alternative sequences:</p>
<p><span class="math display">\[
\Delta\text{score} = \max_{|p - v| \leq 50} \left| P_{\text{alt}}(p) - P_{\text{ref}}(p) \right|
\]</span></p>
<p>where <span class="math inline">\(v\)</span> is the variant position and <span class="math inline">\(p\)</span> ranges over positions within 50 bp of the variant. The maximum change across all positions captures variants that strengthen existing sites, weaken existing sites, or create entirely new splice sites.</p>
<p>Critically, the model was trained only on reference transcript sequences and splice junction annotations. It never saw variant data during training. Variant effect prediction is thus a challenging test of whether the network learned genuine sequence determinants of splicing.</p>
<p>SpliceAI detects several classes of splice-altering variants: donor/acceptor loss (disruption of annotated sites), donor/acceptor gain (creation of novel sites), exon skipping, intron retention, and cryptic exon activation (deep intronic variants activating pseudoexons).</p>
</section>
<section id="validation" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="validation"><span class="header-section-number">5.3.6</span> Validation</h3>
<section id="rna-seq-validation" class="level4" data-number="5.3.6.1">
<h4 data-number="5.3.6.1" class="anchored" data-anchor-id="rna-seq-validation"><span class="header-section-number">5.3.6.1</span> RNA-seq Validation</h4>
<p>The authors validated predictions using GTEx RNA-seq data from 149 individuals with matched whole-genome sequencing. Focusing on rare, private mutations, they found that mutations predicted to have functional consequences were strongly enriched at novel splice junctions. Validation rates tracked closely with Δ scores:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Δ Score Threshold</th>
<th>Validation Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>≥ 0.2</td>
<td>~50%</td>
</tr>
<tr class="even">
<td>≥ 0.5</td>
<td>~75%</td>
</tr>
<tr class="odd">
<td>≥ 0.8</td>
<td>~85%</td>
</tr>
</tbody>
</table>
</section>
<section id="population-genetics-evidence" class="level4" data-number="5.3.6.2">
<h4 data-number="5.3.6.2" class="anchored" data-anchor-id="population-genetics-evidence"><span class="header-section-number">5.3.6.2</span> Population Genetics Evidence</h4>
<p>Predicted cryptic splice variants (Δ score ≥ 0.8) showed 78% depletion at common allele frequencies compared to singletons, nearly matching the 82% depletion of frameshift, stop-gain, and essential splice disruptions. This population genetics signature provides orthogonal evidence that predictions identify genuinely functional variants.</p>
<p>The average human genome carries approximately 11 rare protein-truncating variants and 5 rare functional cryptic splice variants. Cryptic splice variants outnumber essential GT/AG splice-disrupting variants roughly 2:1.</p>
</section>
</section>
<section id="clinical-impact-de-novo-mutations-in-rare-disease" class="level3" data-number="5.3.7">
<h3 data-number="5.3.7" class="anchored" data-anchor-id="clinical-impact-de-novo-mutations-in-rare-disease"><span class="header-section-number">5.3.7</span> Clinical Impact: De Novo Mutations in Rare Disease</h3>
<p>The central clinical finding of SpliceAI is that cryptic splice mutations constitute a major, previously underappreciated cause of rare genetic disorders.</p>
<p>The authors analyzed de novo mutations in 4,293 individuals with intellectual disability and 3,953 individuals with autism spectrum disorders, compared to 2,073 unaffected sibling controls. De novo mutations predicted to disrupt splicing (Δ ≥ 0.1) were significantly enriched in affected individuals:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Cohort</th>
<th>Enrichment vs.&nbsp;Controls</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intellectual disability</td>
<td>1.51-fold</td>
<td>4.2×10⁻⁴</td>
</tr>
<tr class="even">
<td>Autism spectrum disorder</td>
<td>1.30-fold</td>
<td>0.020</td>
</tr>
</tbody>
</table>
<p>Based on the excess of de novo mutations in cases versus controls, approximately 9% of pathogenic de novo mutations in intellectual disability and 11% in autism act through cryptic splicing. In absolute terms, approximately 250 cases across the cohorts could be explained by de novo cryptic splice mutations.</p>
<p>Including cryptic splice mutations in gene discovery analyses identified 5 additional candidate genes for intellectual disability and 2 additional genes for autism that would have fallen below discovery thresholds when considering only protein-coding mutations.</p>
</section>
<section id="what-spliceai-learned" class="level3" data-number="5.3.8">
<h3 data-number="5.3.8" class="anchored" data-anchor-id="what-spliceai-learned"><span class="header-section-number">5.3.8</span> What SpliceAI Learned</h3>
<p>Beyond prediction accuracy, SpliceAI provides mechanistic insights. Comparison of models trained on different context lengths revealed that apparent “degeneracy” in splice motifs is explained by long-range determinants. In silico mutagenesis experiments confirmed that SpliceAI learned canonical splicing elements: introducing the optimal branch point sequence at various distances from splice acceptors increased predicted splice strength specifically when placed 20-45 nucleotides upstream, matching the known functional range. The SR-protein binding motif GAAGAA enhanced splice site strength when placed in expected exonic locations.</p>
<p>Novel exon-creation events were significantly associated with existing nucleosome positioning, supporting a causal role for nucleosome occupancy in exon definition and demonstrating that SpliceAI implicitly captures chromatin-related effects despite not being trained on chromatin data.</p>
</section>
<section id="limitations-2" class="level3" data-number="5.3.9">
<h3 data-number="5.3.9" class="anchored" data-anchor-id="limitations-2"><span class="header-section-number">5.3.9</span> Limitations</h3>
<p>SpliceAI predicts splice sites based on sequence alone, without modeling tissue-specific alternative splicing. Many cryptic splice variants produce partial shifts rather than complete disruption, and the Δ score correlates with penetrance but does not precisely quantify isoform ratios. While substantially better than prior methods, sensitivity for deep intronic variants (41% at Δ ≥ 0.5) remains lower than for variants near exons.</p>
</section>
</section>
<section id="sec-cnn-summary" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-cnn-summary"><span class="header-section-number">5.4</span> Architectural Progression and Common Themes</h2>
<p>The three models examined in this chapter share a common foundation while addressing increasingly complex biological questions. All use one-hot encoded DNA sequence as input and convolutional neural networks to learn relevant patterns. All achieve variant effect prediction through comparison of reference and alternative allele predictions, without requiring variant-level training data. All demonstrate that deep learning can discover biologically meaningful patterns from sequence alone.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>DeepSEA</th>
<th>ExPecto</th>
<th>SpliceAI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Primary task</td>
<td>Chromatin state</td>
<td>Gene expression</td>
<td>Splice sites</td>
</tr>
<tr class="even">
<td>Context window</td>
<td>1 kb</td>
<td>40 kb</td>
<td>10 kb</td>
</tr>
<tr class="odd">
<td>Architecture depth</td>
<td>3 layers</td>
<td>6 layers</td>
<td>32 layers</td>
</tr>
<tr class="even">
<td>Output type</td>
<td>Multi-label classification</td>
<td>Regression</td>
<td>Per-position classification</td>
</tr>
<tr class="odd">
<td>Training data</td>
<td>ENCODE/Roadmap</td>
<td>GTEx expression</td>
<td>GENCODE annotations</td>
</tr>
<tr class="even">
<td>Variant interpretation</td>
<td>Allelic imbalance</td>
<td>Expression effect</td>
<td>Δ score</td>
</tr>
</tbody>
</table>
<p>The progression from DeepSEA to SpliceAI illustrates several themes. First, context length matters: 1 kb suffices for local regulatory element recognition, but expression and splicing require integration over tens of kilobases. Second, architectural depth enables capture of longer-range dependencies: the 32-layer SpliceAI could not have been trained with 2015-era techniques. Third, task-specific architectures can achieve remarkable accuracy: SpliceAI’s focus on splice sites yields near-spliceosomal precision.</p>
<p>Yet these models also share limitations. All assume reference genome context, scoring variants in isolation without considering other variants in the same individual. All are trained on human data and may not transfer well to other species. All require experimental validation for clinical applications.</p>
<section id="task-specificity-vs.-foundation-models" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="task-specificity-vs.-foundation-models"><span class="header-section-number">5.4.1</span> Task Specificity vs.&nbsp;Foundation Models</h3>
<p>These CNN models represent a different design philosophy from the foundation model approach explored in Parts III and IV. Rather than learning general sequence representations that transfer across tasks, each model focuses computational capacity on a single problem. SpliceAI’s representations do not obviously transfer to chromatin prediction; ExPecto’s chromatin model was purpose-built for expression prediction.</p>
<p>This specialization has both advantages and limitations. Task-specific models achieve remarkable accuracy on their target problems, but require separate training for each new application. Later chapters will explore whether self-supervised foundation models can match task-specific performance while providing broader utility (<a href="p2-ch07-dna.html" class="quarto-xref"><span>Chapter 7</span></a>; <a href="p3-ch11-principles.html" class="quarto-xref"><span>Chapter 11</span></a>).</p>
<p>The tension between specialized and general-purpose models remains unresolved. For clinical applications requiring high accuracy on specific tasks, specialized models like SpliceAI may remain preferred. For discovery applications requiring broad coverage of molecular mechanisms, foundation models may prove more valuable.</p>
</section>
<section id="tissue-specific-model-specialization" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="tissue-specific-model-specialization"><span class="header-section-number">5.4.2</span> Tissue-Specific Model Specialization</h3>
<p>The CNN models discussed in this chapter primarily aim for broad coverage across cell types and assays, training on diverse ENCODE and Roadmap Epigenomics data to learn generalizable regulatory patterns. An alternative strategy focuses computational capacity on a single tissue or disease context, trading breadth for depth in biologically targeted applications.</p>
<p>TREDNet exemplifies this tissue-specific approach <span class="citation" data-cites="hudaiberdiev_trednet_2023">(<a href="references.html#ref-hudaiberdiev_trednet_2023" role="doc-biblioref">Hudaiberdiev et al. 2023</a>)</span>. Rather than predicting chromatin features across hundreds of cell types, TREDNet trains specifically on pancreatic islet enhancer data to identify candidate causal variants at type 2 diabetes and glycemic trait GWAS loci. This narrow focus allows the model to learn regulatory patterns specific to islet biology that might be diluted in pan-tissue training, while sacrificing applicability to other tissues. The tradeoff between specialized depth and general breadth recurs throughout this book: foundation models in Parts III and IV generally favor breadth, but disease-specific fine-tuning remains valuable when the clinical question is well-defined and training data for the relevant tissue are available.</p>
</section>
<section id="integration-with-variant-interpretation" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="integration-with-variant-interpretation"><span class="header-section-number">5.4.3</span> Integration with Variant Interpretation</h3>
<p>All three models contribute to modern variant interpretation pipelines. DeepSEA and Sei scores indicate regulatory potential. ExPecto predictions prioritize expression-altering variants. SpliceAI Δ scores support splicing evidence in ACMG/AMP classification. These predictions complement protein-effect predictors and provide independent evidence types for clinical interpretation (<a href="p3-ch12-vep.html" class="quarto-xref"><span>Chapter 12</span></a>).</p>
<p>The models also established expectations for the field: public web servers, downloadable code and weights, rigorous validation against orthogonal data sources, and clear articulation of limitations. These norms have persisted as genomic deep learning has grown in scope and ambition.</p>
<p>Part III turns to transformer-based architectures and self-supervised learning, approaches that aim to learn general-purpose sequence representations applicable across many tasks rather than optimizing for single prediction targets. The CNN models examined here provide essential context for understanding what transformers must improve upon and what accuracy standards they must meet.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-chen_deepsea_2022" class="csl-entry" role="listitem">
Chen, Kathleen M., Aaron K. Wong, Olga G. Troyanskaya, and Jian Zhou. 2022. <span>“[<span>DeepSEA</span> <span>Sei</span>] <span>A</span> Sequence-Based Global Map of Regulatory Activity for Deciphering Human Genetics.”</span> <em>Nature Genetics</em> 54 (7): 940–49. <a href="https://doi.org/10.1038/s41588-022-01102-2">https://doi.org/10.1038/s41588-022-01102-2</a>.
</div>
<div id="ref-hudaiberdiev_trednet_2023" class="csl-entry" role="listitem">
Hudaiberdiev, Sanjarbek, D. Leland Taylor, Wei Song, Narisu Narisu, Redwan M. Bhuiyan, Henry J. Taylor, Xuming Tang, et al. 2023. <span>“[<span>TREDNet</span>] <span>Modeling</span> Islet Enhancers Using Deep Learning Identifies Candidate Causal Variants at Loci Associated with <span>T2D</span> and Glycemic Traits.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (35): e2206612120. <a href="https://doi.org/10.1073/pnas.2206612120">https://doi.org/10.1073/pnas.2206612120</a>.
</div>
<div id="ref-jaganathan_spliceai_2019" class="csl-entry" role="listitem">
Jaganathan, Kishore, Sofia Kyriazopoulou Panagiotopoulou, Jeremy F. McRae, Siavash Fazel Darbandi, David Knowles, Yang I. Li, Jack A. Kosmicki, et al. 2019. <span>“[<span>SpliceAI</span>] <span>Predicting</span> <span>Splicing</span> from <span>Primary</span> <span>Sequence</span> with <span>Deep</span> <span>Learning</span>.”</span> <em>Cell</em> 176 (3): 535–548.e24. <a href="https://doi.org/10.1016/j.cell.2018.12.015">https://doi.org/10.1016/j.cell.2018.12.015</a>.
</div>
<div id="ref-kagda_encode_2025" class="csl-entry" role="listitem">
Kagda, Meenakshi S., Bonita Lam, Casey Litton, Corinn Small, Cricket A. Sloan, Emma Spragins, Forrest Tanaka, et al. 2025. <span>“Data Navigation on the <span>ENCODE</span> Portal.”</span> <em>Nature Communications</em> 16 (1): 9592. <a href="https://doi.org/10.1038/s41467-025-64343-9">https://doi.org/10.1038/s41467-025-64343-9</a>.
</div>
<div id="ref-kundaje_roadmap_2015" class="csl-entry" role="listitem">
Kundaje, Anshul, Wouter Meuleman, Jason Ernst, Misha Bilenky, Angela Yen, Alireza Heravi-Moussavi, Pouya Kheradpour, et al. 2015. <span>“Integrative Analysis of 111 Reference Human Epigenomes.”</span> <em>Nature</em> 518 (7539): 317–30. <a href="https://doi.org/10.1038/nature14248">https://doi.org/10.1038/nature14248</a>.
</div>
<div id="ref-poplin_deepvariant_2018" class="csl-entry" role="listitem">
Poplin, Ryan, Pi-Chuan Chang, David Alexander, Scott Schwartz, Thomas Colthurst, Alexander Ku, Dan Newburger, et al. 2018. <span>“[<span>DeepVariant</span>] <span>A</span> Universal <span>SNP</span> and Small-Indel Variant Caller Using Deep Neural Networks.”</span> <em>Nature Biotechnology</em> 36 (10): 983–87. <a href="https://doi.org/10.1038/nbt.4235">https://doi.org/10.1038/nbt.4235</a>.
</div>
<div id="ref-zhou_expecto_2018" class="csl-entry" role="listitem">
Zhou, Jian, Chandra L. Theesfeld, Kevin Yao, Kathleen M. Chen, Aaron K. Wong, and Olga G. Troyanskaya. 2018. <span>“[<span>Expecto</span>] <span>Deep</span> Learning Sequence-Based Ab Initio Prediction of Variant Effects on Expression and Disease Risk.”</span> <em>Nature Genetics</em> 50 (8): 1171–79. <a href="https://doi.org/10.1038/s41588-018-0160-6">https://doi.org/10.1038/s41588-018-0160-6</a>.
</div>
<div id="ref-zhou_deepsea_2015" class="csl-entry" role="listitem">
Zhou, Jian, and Olga G. Troyanskaya. 2015. <span>“[<span>DeepSEA</span>] <span>Predicting</span> Effects of Noncoding Variants with Deep Learning–Based Sequence Model.”</span> <em>Nature Methods</em> 12 (10): 931–34. <a href="https://doi.org/10.1038/nmeth.3547">https://doi.org/10.1038/nmeth.3547</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p2--architectures.html" class="pagination-link" aria-label="Part II: Deep Learning Architectures">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part II: Deep Learning Architectures</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p2-ch06-plm.html" class="pagination-link" aria-label="Protein Language Models">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>