<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Multi-omics &amp; Systems Context – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p5-ch15-eval.html" rel="next">
<link href="./p4-ch13-vep.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4-ch12-principles.html">Part IV: GFMs &amp; Multi-omics</a></li><li class="breadcrumb-item"><a href="./p4-ch14-omics.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics &amp; Systems Context</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Data &amp; Pre-DL Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NGS &amp; Variant Calling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Foundational Genomics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: CNN Seq-to-Function Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regulatory Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transcriptional Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-splice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Splicing Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Transformers Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch08-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch09-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">DNA Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Long-range Hybrid Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: GFMs &amp; Multi-omics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch12-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch13-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch14-omics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics &amp; Systems Context</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Reliability &amp; Interpretation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch15-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Model Evaluation &amp; Benchmarks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch16-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch17-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI: Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch18-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch19-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch20-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-single-omics-models-are-not-enough" id="toc-why-single-omics-models-are-not-enough" class="nav-link active" data-scroll-target="#why-single-omics-models-are-not-enough"><span class="header-section-number">14.1</span> Why Single-omics Models Are Not Enough</a></li>
  <li><a href="#foundations-of-multi-omics-integration" id="toc-foundations-of-multi-omics-integration" class="nav-link" data-scroll-target="#foundations-of-multi-omics-integration"><span class="header-section-number">14.2</span> Foundations of Multi-omics Integration</a></li>
  <li><a href="#cpgpt-a-foundation-model-for-dna-methylation" id="toc-cpgpt-a-foundation-model-for-dna-methylation" class="nav-link" data-scroll-target="#cpgpt-a-foundation-model-for-dna-methylation"><span class="header-section-number">14.3</span> CpGPT: A Foundation Model for DNA Methylation</a>
  <ul class="collapse">
  <li><a href="#motivation-methylation-as-a-systems-hub" id="toc-motivation-methylation-as-a-systems-hub" class="nav-link" data-scroll-target="#motivation-methylation-as-a-systems-hub"><span class="header-section-number">14.3.1</span> Motivation: Methylation as a Systems Hub</a></li>
  <li><a href="#architecture-and-pretraining" id="toc-architecture-and-pretraining" class="nav-link" data-scroll-target="#architecture-and-pretraining"><span class="header-section-number">14.3.2</span> Architecture and Pretraining</a></li>
  <li><a href="#zero-shot-and-fine-tuned-tasks" id="toc-zero-shot-and-fine-tuned-tasks" class="nav-link" data-scroll-target="#zero-shot-and-fine-tuned-tasks"><span class="header-section-number">14.3.3</span> Zero-shot and Fine-tuned Tasks</a></li>
  </ul></li>
  <li><a href="#glue-graph-linked-unified-embedding-for-single-cell-multi-omics" id="toc-glue-graph-linked-unified-embedding-for-single-cell-multi-omics" class="nav-link" data-scroll-target="#glue-graph-linked-unified-embedding-for-single-cell-multi-omics"><span class="header-section-number">14.4</span> GLUE: Graph-linked Unified Embedding for Single-cell Multi-omics</a>
  <ul class="collapse">
  <li><a href="#the-unpaired-single-cell-integration-problem" id="toc-the-unpaired-single-cell-integration-problem" class="nav-link" data-scroll-target="#the-unpaired-single-cell-integration-problem"><span class="header-section-number">14.4.1</span> The Unpaired Single-cell Integration Problem</a></li>
  <li><a href="#architecture" id="toc-architecture" class="nav-link" data-scroll-target="#architecture"><span class="header-section-number">14.4.2</span> Architecture</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="header-section-number">14.4.3</span> Applications</a></li>
  </ul></li>
  <li><a href="#gnn-based-multi-omics-cancer-subtyping-mogcn-cgmega-and-beyond" id="toc-gnn-based-multi-omics-cancer-subtyping-mogcn-cgmega-and-beyond" class="nav-link" data-scroll-target="#gnn-based-multi-omics-cancer-subtyping-mogcn-cgmega-and-beyond"><span class="header-section-number">14.5</span> GNN-based Multi-omics Cancer Subtyping: MoGCN, CGMega, and Beyond</a>
  <ul class="collapse">
  <li><a href="#mogcn-patient-graphs-from-multi-omics" id="toc-mogcn-patient-graphs-from-multi-omics" class="nav-link" data-scroll-target="#mogcn-patient-graphs-from-multi-omics"><span class="header-section-number">14.5.1</span> MoGCN: Patient Graphs from Multi-omics</a></li>
  <li><a href="#cgmega-multi-omics-cancer-gene-modules" id="toc-cgmega-multi-omics-cancer-gene-modules" class="nav-link" data-scroll-target="#cgmega-multi-omics-cancer-gene-modules"><span class="header-section-number">14.5.2</span> CGMega: Multi-omics Cancer Gene Modules</a></li>
  <li><a href="#design-patterns-and-alternatives" id="toc-design-patterns-and-alternatives" class="nav-link" data-scroll-target="#design-patterns-and-alternatives"><span class="header-section-number">14.5.3</span> Design Patterns and Alternatives</a></li>
  </ul></li>
  <li><a href="#rare-variants-and-epistasis-in-systems-context" id="toc-rare-variants-and-epistasis-in-systems-context" class="nav-link" data-scroll-target="#rare-variants-and-epistasis-in-systems-context"><span class="header-section-number">14.6</span> Rare Variants and Epistasis in Systems Context</a>
  <ul class="collapse">
  <li><a href="#deeprvat-set-based-rare-variant-burden-modeling" id="toc-deeprvat-set-based-rare-variant-burden-modeling" class="nav-link" data-scroll-target="#deeprvat-set-based-rare-variant-burden-modeling"><span class="header-section-number">14.6.1</span> DeepRVAT: Set-based Rare Variant Burden Modeling</a></li>
  <li><a href="#needl-network-based-epistasis-detection" id="toc-needl-network-based-epistasis-detection" class="nav-link" data-scroll-target="#needl-network-based-epistasis-detection"><span class="header-section-number">14.6.2</span> NeEDL: Network-based Epistasis Detection</a></li>
  <li><a href="#g2pt-hierarchical-genotype-to-phenotype-transformers" id="toc-g2pt-hierarchical-genotype-to-phenotype-transformers" class="nav-link" data-scroll-target="#g2pt-hierarchical-genotype-to-phenotype-transformers"><span class="header-section-number">14.6.3</span> G2PT: Hierarchical Genotype-to-Phenotype Transformers</a></li>
  </ul></li>
  <li><a href="#deep-learning-enhanced-polygenic-risk-and-fine-mapping" id="toc-deep-learning-enhanced-polygenic-risk-and-fine-mapping" class="nav-link" data-scroll-target="#deep-learning-enhanced-polygenic-risk-and-fine-mapping"><span class="header-section-number">14.7</span> Deep Learning-enhanced Polygenic Risk and Fine-mapping</a>
  <ul class="collapse">
  <li><a href="#deep-learning-pgs-e.g.-delphi-like-frameworks" id="toc-deep-learning-pgs-e.g.-delphi-like-frameworks" class="nav-link" data-scroll-target="#deep-learning-pgs-e.g.-delphi-like-frameworks"><span class="header-section-number">14.7.1</span> Deep-learning PGS (e.g., Delphi-like frameworks)</a></li>
  <li><a href="#mifm-and-multi-ancestry-fine-mapping" id="toc-mifm-and-multi-ancestry-fine-mapping" class="nav-link" data-scroll-target="#mifm-and-multi-ancestry-fine-mapping"><span class="header-section-number">14.7.2</span> MIFM and Multi-ancestry Fine-mapping</a></li>
  </ul></li>
  <li><a href="#design-patterns-for-multi-omics-and-systems-gfms" id="toc-design-patterns-for-multi-omics-and-systems-gfms" class="nav-link" data-scroll-target="#design-patterns-for-multi-omics-and-systems-gfms"><span class="header-section-number">14.8</span> Design Patterns for Multi-omics and Systems GFMs</a></li>
  <li><a href="#practical-pitfalls-and-considerations" id="toc-practical-pitfalls-and-considerations" class="nav-link" data-scroll-target="#practical-pitfalls-and-considerations"><span class="header-section-number">14.9</span> Practical Pitfalls and Considerations</a></li>
  <li><a href="#outlook-toward-whole-patient-foundation-models" id="toc-outlook-toward-whole-patient-foundation-models" class="nav-link" data-scroll-target="#outlook-toward-whole-patient-foundation-models"><span class="header-section-number">14.10</span> Outlook: Toward Whole-patient Foundation Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4-ch12-principles.html">Part IV: GFMs &amp; Multi-omics</a></li><li class="breadcrumb-item"><a href="./p4-ch14-omics.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics &amp; Systems Context</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-multi" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics &amp; Systems Context</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>…</li>
<li>…</li>
</ul>
</div>
</div>
<p>Modern genomic foundation models (GFMs) excel at learning from sequences, structures, or single-omic profiles in isolation. Yet most complex traits arise from <em>systems-level</em> interactions: genetic variants perturb molecular networks; networks span multiple omics layers; and these layers interact with environment, development, and clinical context. A model that sees only one layer rarely captures the full story.</p>
<p>This chapter surveys how deep learning extends beyond single-omics to integrate methylation, chromatin, expression, protein, and clinical data into unified representations. Within the book structure defined by the Quarto project, this is the final chapter of Part IV and serves as a bridge from model-centric architecture design to systems-level, clinically grounded applications.</p>
<p>We focus on several archetypal systems:</p>
<ul>
<li><strong>CpGPT</strong>: a foundation model for DNA methylation<br>
</li>
<li><strong>GLUE</strong>: a graph-linked framework for single-cell multi-omics integration (e.g., SCGLUE)<br>
</li>
<li><strong>GNN-based cancer subtyping</strong> with models such as MoGCN and CGMega<br>
</li>
<li><strong>Rare variants and epistasis</strong> with DeepRVAT, NeEDL, and the Genotype-to-Phenotype Transformer (G2PT)<br>
</li>
<li><strong>DL-enhanced polygenic risk and fine-mapping</strong>, including Delphi and MIFM</li>
</ul>
<p>Together, these approaches illustrate emerging design patterns for <em>systems-aware</em> GFMs that move from single sequences to whole-patient representations.</p>
<hr>
<section id="why-single-omics-models-are-not-enough" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="why-single-omics-models-are-not-enough"><span class="header-section-number">14.1</span> Why Single-omics Models Are Not Enough</h2>
<p>Earlier chapters emphasized how sequence-based models can predict variant effects from local DNA or protein context. These models already improve causal variant prioritization and polygenic risk scoring. However, they typically assume a narrow view of biology:</p>
<ul>
<li><strong>Single layer</strong>: A CNN or transformer may see only DNA sequence or only expression.<br>
</li>
<li><strong>Additive effects</strong>: Many downstream uses still treat variant effects as additively summing across loci.<br>
</li>
<li><strong>Static context</strong>: Models rarely account for dynamic state (cell type, developmental stage, environment).</li>
</ul>
<p>Real diseases violate all three assumptions:</p>
<ul>
<li><em>Regulation is multi-layered</em>: genetic variants alter chromatin accessibility and DNA methylation, which modulate transcription, splicing, translation, and protein modification.<br>
</li>
<li><em>Effects are context-dependent</em>: the same variant can be benign in one tissue and pathogenic in another.<br>
</li>
<li><em>Risk is combinatorial</em>: epistasis and pathway-level perturbations play a significant role in many complex traits.</li>
</ul>
<p><a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> highlighted the “missing heritability” and limited portability of traditional GWAS and linear PGS, motivating sequence-based deep learning. Here we take the next step: combining sequence-derived features with <strong>multi-omics</strong> and <strong>systems-level models</strong> that better reflect biological organization.</p>
<hr>
</section>
<section id="foundations-of-multi-omics-integration" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="foundations-of-multi-omics-integration"><span class="header-section-number">14.2</span> Foundations of Multi-omics Integration</h2>
<p>Multi-omics data come in several flavors:</p>
<ul>
<li><strong>Bulk-level</strong> profiles (e.g., GWAS variants, bulk RNA-seq, bulk proteomics)<br>
</li>
<li><strong>Single-cell</strong> modalities (scRNA-seq, scATAC-seq, multiome, spatial omics)<br>
</li>
<li><strong>Epigenetic</strong> readouts (DNA methylation, histone marks, chromatin conformation)<br>
</li>
<li><strong>Clinical and environmental</strong> covariates (EHR, labs, lifestyle)</li>
</ul>
<p>Integration strategies typically fall into three categories:</p>
<ol type="1">
<li><strong>Early fusion (feature-level)</strong>
<ul>
<li>Concatenate normalized features from multiple omics and feed them into a single model.<br>
</li>
<li>Straightforward but sensitive to scaling, missing data, and modality imbalance.</li>
</ul></li>
<li><strong>Intermediate fusion (shared latent space)</strong>
<ul>
<li>Learn modality-specific encoders that map each omic into a common latent space.<br>
</li>
<li>Align latent spaces via reconstruction losses, contrastive terms, or graph constraints.<br>
</li>
<li>This is the dominant design in modern multi-omics deep learning.</li>
</ul></li>
<li><strong>Late fusion (prediction-level)</strong>
<ul>
<li>Train separate models per modality; combine outputs via ensemble or meta-model.<br>
</li>
<li>Robust to missing modalities but may underutilize cross-omic structure.</li>
</ul></li>
</ol>
<p>Modern frameworks like GLUE and multi-omics GNNs adopt <strong>intermediate fusion</strong>, often with <strong>graphs</strong> encoding known or inferred relationships (e.g., gene–peak, gene–TF, protein–protein, or sample similarity networks). The rest of this chapter traces how these design choices implement systems-level reasoning in practice.</p>
<hr>
</section>
<section id="cpgpt-a-foundation-model-for-dna-methylation" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="cpgpt-a-foundation-model-for-dna-methylation"><span class="header-section-number">14.3</span> CpGPT: A Foundation Model for DNA Methylation</h2>
<section id="motivation-methylation-as-a-systems-hub" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="motivation-methylation-as-a-systems-hub"><span class="header-section-number">14.3.1</span> Motivation: Methylation as a Systems Hub</h3>
<p>DNA methylation sits at a crucial junction between genotype, environment, and phenotype:</p>
<ul>
<li>It integrates genetic, developmental, and environmental influences.<br>
</li>
<li>It encodes <em>cell type</em> and <em>cell state</em> information.<br>
</li>
<li>It is predictive of aging, mortality, and disease risk.</li>
</ul>
<p>Traditional methylation models are task-specific (e.g., age clocks, mortality predictors). CpGPT reframes methylation as a <strong>foundation modeling problem</strong>, using large-scale pretraining to unlock downstream tasks.</p>
</section>
<section id="architecture-and-pretraining" class="level3" data-number="14.3.2">
<h3 data-number="14.3.2" class="anchored" data-anchor-id="architecture-and-pretraining"><span class="header-section-number">14.3.2</span> Architecture and Pretraining</h3>
<p>CpGPT (Cytosine-phosphate-Guanine Pretrained Transformer) is trained on large-scale collections of whole-genome and array-based methylation profiles. Conceptually, CpGPT treats methylomes as sequences or sets of CpG sites, and uses transformer-style self-attention to model:</p>
<ul>
<li>Local CpG correlations (e.g., CpG islands)<br>
</li>
<li>Long-range coordination across genomic regions<br>
</li>
<li>Global sample-level variation (e.g., age, disease status)</li>
</ul>
<p>Key aspects:</p>
<ul>
<li><strong>Masked modeling objectives</strong>: Learn to reconstruct held-out CpG values from context.<br>
</li>
<li><strong>Multi-task pretraining</strong>: Auxiliary tasks like array conversion or reference mapping encourage robust representations.<br>
</li>
<li><strong>Sample embeddings</strong>: The [CLS]-like embedding for each sample acts as a compact, task-agnostic representation of its methylome.</li>
</ul>
</section>
<section id="zero-shot-and-fine-tuned-tasks" class="level3" data-number="14.3.3">
<h3 data-number="14.3.3" class="anchored" data-anchor-id="zero-shot-and-fine-tuned-tasks"><span class="header-section-number">14.3.3</span> Zero-shot and Fine-tuned Tasks</h3>
<p>Because CpGPT is trained on diverse cohorts, it exhibits <em>zero-shot</em> or few-shot generalization to new tasks:</p>
<ul>
<li><strong>Imputation and array conversion</strong>: Fill in missing CpGs or harmonize different methylation platforms.<br>
</li>
<li><strong>Chronological age and mortality prediction</strong>: Yield clocks that match or exceed specialized models.<br>
</li>
<li><strong>Sample classification</strong>: Distinguish tissues, disease states, or exposure profiles.</li>
</ul>
<p>In a multi-omics context, CpGPT-derived embeddings can serve as:</p>
<ul>
<li>Inputs to <em>downstream</em> predictors (e.g., risk scores, prognosis models).<br>
</li>
<li>One modality in a shared latent space (with expression, proteomics, etc.).<br>
</li>
<li>A way to inject epigenetic state into otherwise sequence-centric GFMs.</li>
</ul>
<p>Conceptually, CpGPT is an example of a <strong>single-omic foundation model</strong> that is <em>designed</em> to plug into multi-omics architectures.</p>
<hr>
</section>
</section>
<section id="glue-graph-linked-unified-embedding-for-single-cell-multi-omics" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="glue-graph-linked-unified-embedding-for-single-cell-multi-omics"><span class="header-section-number">14.4</span> GLUE: Graph-linked Unified Embedding for Single-cell Multi-omics</h2>
<section id="the-unpaired-single-cell-integration-problem" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="the-unpaired-single-cell-integration-problem"><span class="header-section-number">14.4.1</span> The Unpaired Single-cell Integration Problem</h3>
<p>Single-cell experiments often profile different modalities in different cells—for instance:</p>
<ul>
<li>Some cells with <strong>scRNA-seq</strong> only<br>
</li>
<li>Other cells with <strong>scATAC-seq</strong> only<br>
</li>
<li>Sometimes a small subset with both (multiome) or additional modalities (e.g., protein, methylation)</li>
</ul>
<p>The central challenge: build a unified atlas that aligns these cells in a common space, recovers cell types and trajectories, and infers regulatory networks.</p>
<p>GLUE (Graph-Linked Unified Embedding) addresses this by combining modality-specific encoders with a <strong>graph of biological prior knowledge</strong> linking features across omics.</p>
</section>
<section id="architecture" class="level3" data-number="14.4.2">
<h3 data-number="14.4.2" class="anchored" data-anchor-id="architecture"><span class="header-section-number">14.4.2</span> Architecture</h3>
<p>GLUE consists of three key components:</p>
<ol type="1">
<li><strong>Modality-specific variational autoencoders (VAEs)</strong>
<ul>
<li>Each omic (e.g., RNA, ATAC) has its own encoder–decoder pair.<br>
</li>
<li>Encoders map cells to a low-dimensional latent embedding; decoders reconstruct modality-specific features.</li>
</ul></li>
<li><strong>Feature graph and SCGLUE</strong>
<ul>
<li>Features (genes, peaks, motifs) form a graph whose edges capture biological relationships: e.g., a peak linked to a gene’s promoter or enhancer, or TF binding motifs affecting genes.<br>
</li>
<li>A graph neural network (GNN) learns feature embeddings consistent with this graph.</li>
</ul></li>
<li><strong>Alignment objectives</strong>
<ul>
<li>Loss terms encourage the <em>cell</em> latent spaces to align (so RNA-only and ATAC-only cells with similar biology end up near each other).<br>
</li>
<li>The feature embeddings are tied to the cell latents via generative decoders, enforcing consistency between data and prior graph.</li>
</ul></li>
</ol>
<p>The result is a <strong>unified embedding</strong> in which cells from multiple modalities can be jointly clustered, visualized, and used for downstream tasks.</p>
</section>
<section id="applications" class="level3" data-number="14.4.3">
<h3 data-number="14.4.3" class="anchored" data-anchor-id="applications"><span class="header-section-number">14.4.3</span> Applications</h3>
<p>The GLUE framework has demonstrated:</p>
<ul>
<li><strong>Multi-omics integration</strong> (RNA, ATAC, methylation or protein) at single-cell resolution.<br>
</li>
<li><strong>Regulatory network inference</strong> by linking chromatin features to gene expression through the feature graph.<br>
</li>
<li><strong>Atlas construction</strong> over large cohorts, correcting earlier annotation errors and unifying datasets across labs.</li>
</ul>
<p>From the perspective of GFMs, GLUE exemplifies <strong>graph-guided multi-modal pretraining</strong>: modality-specific encoders learn a shared latent space regularized by biological networks, enabling reuse across tasks and tissues.</p>
<hr>
</section>
</section>
<section id="gnn-based-multi-omics-cancer-subtyping-mogcn-cgmega-and-beyond" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="gnn-based-multi-omics-cancer-subtyping-mogcn-cgmega-and-beyond"><span class="header-section-number">14.5</span> GNN-based Multi-omics Cancer Subtyping: MoGCN, CGMega, and Beyond</h2>
<p>Cancer is inherently multi-omic: driver mutations, copy number changes, epigenetic reprogramming, and transcriptional rewiring jointly define tumor subtypes. Multi-omics cancer subtyping models increasingly rely on <strong>graph neural networks</strong> to capture this complexity.</p>
<section id="mogcn-patient-graphs-from-multi-omics" class="level3" data-number="14.5.1">
<h3 data-number="14.5.1" class="anchored" data-anchor-id="mogcn-patient-graphs-from-multi-omics"><span class="header-section-number">14.5.1</span> MoGCN: Patient Graphs from Multi-omics</h3>
<p>MoGCN is a graph-convolutional framework for cancer subtype classification that integrates genomics, transcriptomics, and proteomics.</p>
<p>Design:</p>
<ul>
<li>Each <strong>patient</strong> is a node in a graph; edges encode similarity (e.g., based on expression or multi-omics features).<br>
</li>
<li>For each omic, a GCN learns modality-specific latent representations.<br>
</li>
<li>These representations are <strong>concatenated</strong> into a joint embedding per patient.<br>
</li>
<li>A classifier operating on node embeddings predicts cancer subtypes (e.g., BRCA subtypes).</li>
</ul>
<p>Benefits:</p>
<ul>
<li>Captures non-linear relationships between patients in a data-driven graph.<br>
</li>
<li>Naturally integrates multiple omics via multi-view GCNs.<br>
</li>
<li>Enables subtype discovery and interpretation via graph structure and learned embeddings.</li>
</ul>
</section>
<section id="cgmega-multi-omics-cancer-gene-modules" class="level3" data-number="14.5.2">
<h3 data-number="14.5.2" class="anchored" data-anchor-id="cgmega-multi-omics-cancer-gene-modules"><span class="header-section-number">14.5.2</span> CGMega: Multi-omics Cancer Gene Modules</h3>
<p>Where MoGCN focuses on <em>patient-level</em> graphs, CGMega operates on <strong>gene-level</strong> graphs:</p>
<ul>
<li>Nodes represent genes; edges capture multi-omics relationships (expression, copy number, methylation, 3D genome contacts, etc.).<br>
</li>
<li>A graph attention network learns <strong>cancer gene modules</strong>—subsets of genes that co-vary across omics and are associated with phenotypes.</li>
</ul>
<p>This module-centric view aligns with systems biology: instead of single-gene markers, CGMega identifies network-level signatures that better reflect pathway dysregulation.</p>
</section>
<section id="design-patterns-and-alternatives" class="level3" data-number="14.5.3">
<h3 data-number="14.5.3" class="anchored" data-anchor-id="design-patterns-and-alternatives"><span class="header-section-number">14.5.3</span> Design Patterns and Alternatives</h3>
<p>A growing ecosystem of multi-omics subtyping methods uses related patterns:</p>
<ul>
<li><strong>Contrastive learning</strong> for multi-omics sample embeddings.<br>
</li>
<li><strong>Generative models</strong> (e.g., GAN-based subtyping) that jointly model multiple omics for unsupervised clustering.<br>
</li>
<li><strong>Transformer-based hybrids</strong> that blend MLPs and transformer blocks for high-dimensional omics.</li>
</ul>
<p>Common themes:</p>
<ul>
<li>Modality-specific encoders with shared latent spaces<br>
</li>
<li>Graphs capturing patient–patient or gene–gene relationships<br>
</li>
<li>Emphasis on <em>interpretability</em> via clusters, modules, or attention over features</li>
</ul>
<p>These cancer models illustrate how multi-omics integration naturally leads to <strong>graph-structured GFMs</strong>, where sequences, epigenetics, and expression are all nodes in a learned biological network.</p>
<hr>
</section>
</section>
<section id="rare-variants-and-epistasis-in-systems-context" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="rare-variants-and-epistasis-in-systems-context"><span class="header-section-number">14.6</span> Rare Variants and Epistasis in Systems Context</h2>
<p><a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> discussed how standard PGS methods often ignore <strong>rare variants</strong> and <strong>epistasis</strong>, despite their importance for individual-level risk and disease mechanism. Multi-omics and systems models offer a framework to incorporate these effects more effectively.</p>
<section id="deeprvat-set-based-rare-variant-burden-modeling" class="level3" data-number="14.6.1">
<h3 data-number="14.6.1" class="anchored" data-anchor-id="deeprvat-set-based-rare-variant-burden-modeling"><span class="header-section-number">14.6.1</span> DeepRVAT: Set-based Rare Variant Burden Modeling</h3>
<p>DeepRVAT (Deep Rare Variant Association Testing) learns gene-level impairment scores from rare variant annotations and genotypes using <strong>set neural networks</strong>.</p>
<p>Key properties:</p>
<ul>
<li>Treats each gene’s rare variants as an unordered set.<br>
</li>
<li>Learns a <em>trait-agnostic</em> gene impairment score that generalizes across traits.<br>
</li>
<li>Improves both gene discovery and detection of high-risk individuals across many complex traits.</li>
</ul>
<p>Conceptually, DeepRVAT bridges the gap between variant-level annotations (e.g., VEP, conservation, structure-based predictions) and gene-level burden, making it naturally compatible with sequence-based variant effect models introduced earlier in the book.</p>
</section>
<section id="needl-network-based-epistasis-detection" class="level3" data-number="14.6.2">
<h3 data-number="14.6.2" class="anchored" data-anchor-id="needl-network-based-epistasis-detection"><span class="header-section-number">14.6.2</span> NeEDL: Network-based Epistasis Detection</h3>
<p>NeEDL (Network-based Epistasis Detection via Local search) uses <strong>network medicine and quantum-inspired optimization</strong> to identify epistatic interactions among SNPs.</p>
<p>Core ideas:</p>
<ul>
<li>Build a network of SNPs and genes based on biological priors and GWAS signals.<br>
</li>
<li>Use local search strategies to explore combinations of variants that jointly influence disease.<br>
</li>
<li>Prioritize <em>interpretable</em> epistatic modules that map onto pathways and cellular processes.</li>
</ul>
<p>NeEDL does not yet operate as a full GFM, but it points toward <strong>systems-level combinatorial reasoning</strong> that future GFMs will need to support.</p>
</section>
<section id="g2pt-hierarchical-genotype-to-phenotype-transformers" class="level3" data-number="14.6.3">
<h3 data-number="14.6.3" class="anchored" data-anchor-id="g2pt-hierarchical-genotype-to-phenotype-transformers"><span class="header-section-number">14.6.3</span> G2PT: Hierarchical Genotype-to-Phenotype Transformers</h3>
<p>G2PT (Genotype-to-Phenotype Transformer) explicitly models hierarchical structure:</p>
<ul>
<li>Variant-level signals aggregate into <strong>genes</strong>.<br>
</li>
<li>Genes aggregate into <strong>systems</strong> (e.g., pathways, tissues).<br>
</li>
<li>Systems collectively determine phenotypes and polygenic risk.</li>
</ul>
<p>Architecturally:</p>
<ul>
<li>Uses transformer blocks to model interactions at each level.<br>
</li>
<li>Incorporates prior knowledge (e.g., gene–pathway membership) to structure attention patterns.<br>
</li>
<li>Provides explanations by attributing risk to specific variants, genes, and systems.</li>
</ul>
<p>G2PT can be viewed as an early example of a <strong>systems-aware GFM</strong> for genotype data, unifying additive and interaction effects within a single deep model.</p>
<hr>
</section>
</section>
<section id="deep-learning-enhanced-polygenic-risk-and-fine-mapping" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="deep-learning-enhanced-polygenic-risk-and-fine-mapping"><span class="header-section-number">14.7</span> Deep Learning-enhanced Polygenic Risk and Fine-mapping</h2>
<p><a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a> framed PGS as linear weighted sums of SNP effects. Deep learning extends this paradigm by:</p>
<ul>
<li>Modeling non-linear interactions and context dependence<br>
</li>
<li>Integrating multi-omics features as priors or inputs<br>
</li>
<li>Sharing information across ancestries and cohorts</li>
</ul>
<section id="deep-learning-pgs-e.g.-delphi-like-frameworks" class="level3" data-number="14.7.1">
<h3 data-number="14.7.1" class="anchored" data-anchor-id="deep-learning-pgs-e.g.-delphi-like-frameworks"><span class="header-section-number">14.7.1</span> Deep-learning PGS (e.g., Delphi-like frameworks)</h3>
<p>Deep-learning PGS frameworks learn complex functions of genotype and covariates, rather than relying on additive SNP weights.</p>
<p>Key contributions:</p>
<ul>
<li>Incorporate <strong>non-genetic risk factors</strong> alongside genome-wide variants.<br>
</li>
<li>Learn non-linear functions that can capture dominance, epistasis, and interactions with covariates.<br>
</li>
<li>Demonstrate improved discrimination over traditional PGS across several traits.</li>
</ul>
<p>From a systems perspective, these models represent a move toward <strong>whole-patient risk modeling</strong>, albeit still primarily from genotype + covariates, without explicit multi-omics integration.</p>
</section>
<section id="mifm-and-multi-ancestry-fine-mapping" class="level3" data-number="14.7.2">
<h3 data-number="14.7.2" class="anchored" data-anchor-id="mifm-and-multi-ancestry-fine-mapping"><span class="header-section-number">14.7.2</span> MIFM and Multi-ancestry Fine-mapping</h3>
<p>Multiple-instance fine-mapping frameworks (MIFM-like methods) address a key bottleneck: lack of per-variant labels. Instead, we often know only that <em>some</em> variant(s) in a locus are causal. This is formulated as a <strong>multiple-instance learning</strong> problem:</p>
<ul>
<li>Each locus is a “bag” of variants.<br>
</li>
<li>Loci with significant GWAS signals form positive bags; others form negative bags.<br>
</li>
<li>A deep model learns to assign high scores to causal variants within positive bags.</li>
</ul>
<p>Related methods in multi-ancestry contexts combine signals across cohorts and ancestries, leveraging divergent LD patterns to refine causal inference.</p>
<p>Connections to earlier chapters:</p>
<ul>
<li>Variant effect predictors (Chapters 5–7, 13) can supply per-variant features.<br>
</li>
<li>Multi-omics models (this chapter) provide functional priors (e.g., regulatory activity, methylation, chromatin accessibility).<br>
</li>
<li>MIFM-type frameworks integrate these priors with GWAS evidence to produce more accurate, ancestry-aware fine-mapping.</li>
</ul>
<hr>
</section>
</section>
<section id="design-patterns-for-multi-omics-and-systems-gfms" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="design-patterns-for-multi-omics-and-systems-gfms"><span class="header-section-number">14.8</span> Design Patterns for Multi-omics and Systems GFMs</h2>
<p>Pulling these examples together, several design patterns emerge for systems-level GFMs:</p>
<ol type="1">
<li><strong>Modality-specific encoders + shared latent space</strong>
<ul>
<li>CpGPT, GLUE, and many multi-omics subtyping models use separate encoders for each omic, aligned in a common embedding space.<br>
</li>
<li>This design supports flexible inference with missing modalities and incremental addition of new data types.</li>
</ul></li>
<li><strong>Graph-guided integration</strong>
<ul>
<li>GLUE’s feature graph, CGMega’s gene modules, and NeEDL’s epistasis networks all use prior or learned graphs to structure learning.<br>
</li>
<li>GNNs, graph transformers, and attention over graph edges are natural tools for encoding biological networks.</li>
</ul></li>
<li><strong>Hierarchical modeling</strong>
<ul>
<li>G2PT formalizes the hierarchy from variants → genes → systems → phenotypes.<br>
</li>
<li>Similar hierarchies can be defined for omics layers: sequence → chromatin → methylation → expression → protein → clinical traits.</li>
</ul></li>
<li><strong>Set- and bag-based learning</strong>
<ul>
<li>DeepRVAT and MIFM treat variants or loci as sets/bags with permutation-invariant architectures.<br>
</li>
<li>This is crucial when sample sizes are large, labels are sparse, and order is biologically meaningless.</li>
</ul></li>
<li><strong>Foundation pretraining + task-specific adaptation</strong>
<ul>
<li>CpGPT is pretrained on massive methylation datasets and then adapted to tasks like aging clocks, mortality prediction, or disease classification.<br>
</li>
<li>Future models may pretrain jointly on sequence, chromatin, methylation, expression, and clinical data, then specialize for specific traits.</li>
</ul></li>
</ol>
<p>These patterns collectively point toward <strong>general-purpose systems GFMs</strong> that can ingest heterogeneous biological data and output risk predictions, mechanistic hypotheses, or treatment recommendations.</p>
<hr>
</section>
<section id="practical-pitfalls-and-considerations" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="practical-pitfalls-and-considerations"><span class="header-section-number">14.9</span> Practical Pitfalls and Considerations</h2>
<p>Despite impressive progress, multi-omics and systems GFMs are especially vulnerable to confounding and overinterpretation—issues examined in depth in <a href="p5-ch16-confound.html" class="quarto-xref"><span>Chapter 16</span></a>. Key challenges include:</p>
<ul>
<li><strong>Batch effects and platform heterogeneity</strong>
<ul>
<li>Different omics layers often come from different assays, labs, or time points.<br>
</li>
<li>Integration methods can inadvertently encode batch structure rather than biology if not properly corrected.</li>
</ul></li>
<li><strong>Sample size and missingness</strong>
<ul>
<li>Multi-omics datasets are typically smaller than single-omic datasets.<br>
</li>
<li>Many samples lack certain modalities, requiring robust handling of missing data.</li>
</ul></li>
<li><strong>Population diversity and fairness</strong>
<ul>
<li>As highlighted for PGS, representation of diverse ancestries is essential.<br>
</li>
<li>Multi-omics GFMs risk amplifying disparities if trained primarily on European-ancestry or high-resource cohorts.</li>
</ul></li>
<li><strong>Evaluation complexity</strong>
<ul>
<li>Multi-omics models can be evaluated at many levels: predictive performance, biological consistency, network plausibility, and clinical utility.<br>
</li>
<li>Overfitting to proxy metrics (e.g., clustering quality) may not translate to actionable biology.</li>
</ul></li>
<li><strong>Interpretability and causal inference</strong>
<ul>
<li>Attention or feature importance scores are not guarantees of causal mechanism.<br>
</li>
<li>Integrating deep models with perturbation data (e.g., CRISPR screens) and robust causal frameworks remains an open frontier.</li>
</ul></li>
</ul>
<p>Careful experimental design, thoughtful validation, and transparent reporting are therefore especially crucial for multi-omics GFMs.</p>
<hr>
</section>
<section id="outlook-toward-whole-patient-foundation-models" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="outlook-toward-whole-patient-foundation-models"><span class="header-section-number">14.10</span> Outlook: Toward Whole-patient Foundation Models</h2>
<p>The methods in this chapter sketch an endgame for genomic deep learning:</p>
<ul>
<li><strong>Genome-wide variant and sequence representation</strong> via hybrid CNN/transformer/SSM architectures (Chapters 10–13).<br>
</li>
<li><strong>Multi-omics integration</strong> through graph-guided latent spaces (CpGPT, GLUE, MoGCN, CGMega).<br>
</li>
<li><strong>Systems-level reasoning</strong> about rare variants and epistasis (DeepRVAT, NeEDL, G2PT).<br>
</li>
<li><strong>Clinically oriented risk modeling</strong> with deep PGS and fine-mapping (Delphi-like and MIFM-like frameworks).</li>
</ul>
<p>A future <strong>whole-patient foundation model</strong> might:</p>
<ul>
<li>Jointly encode genotype, methylome, chromatin state, expression, proteomics, imaging, and EHR data.<br>
</li>
<li>Provide unified representations across tissues, cell types, and time points.<br>
</li>
<li>Offer calibrated, equitable predictions of disease risk and treatment response.<br>
</li>
<li>Support mechanistic queries like “which pathways mediate this variant’s effect in this tissue?” or “which interventions counteract this rare variant burden in this patient?”</li>
</ul>
<p>Realizing this vision will require advances in data sharing, privacy-preserving learning, scalable architecture design, and causal validation. But the methods surveyed here show that moving beyond single-omics is not just incremental—it fundamentally changes what kinds of questions genomic models can answer, bringing us closer to truly systems-level, clinically actionable genomics.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p4-ch13-vep.html" class="pagination-link" aria-label="Variant Effect Prediction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p5-ch15-eval.html" class="pagination-link" aria-label="Model Evaluation &amp; Benchmarks">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Model Evaluation &amp; Benchmarks</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>