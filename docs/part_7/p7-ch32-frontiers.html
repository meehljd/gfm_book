<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>32&nbsp; Frontiers and Synthesis – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../bib/references.html" rel="next">
<link href="../part_7/p7-ch31-design.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_7/p7--applications.html">Part VII: Applications &amp; Frontiers</a></li><li class="breadcrumb-item"><a href="../part_7/p7-ch32-frontiers.html"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch32-technical" id="toc-sec-ch32-technical" class="nav-link active" data-scroll-target="#sec-ch32-technical"><span class="header-section-number">32.1</span> Open Technical Problems</a>
  <ul class="collapse">
  <li><a href="#sec-ch32-scaling" id="toc-sec-ch32-scaling" class="nav-link" data-scroll-target="#sec-ch32-scaling"><span class="header-section-number">32.1.1</span> Scaling and Efficiency</a></li>
  <li><a href="#sec-ch32-multiscale" id="toc-sec-ch32-multiscale" class="nav-link" data-scroll-target="#sec-ch32-multiscale"><span class="header-section-number">32.1.2</span> Context and Multi-Scale Integration</a></li>
  <li><a href="#sec-ch32-causality" id="toc-sec-ch32-causality" class="nav-link" data-scroll-target="#sec-ch32-causality"><span class="header-section-number">32.1.3</span> Causality and Mechanism</a></li>
  </ul></li>
  <li><a href="#sec-ch32-emerging" id="toc-sec-ch32-emerging" class="nav-link" data-scroll-target="#sec-ch32-emerging"><span class="header-section-number">32.2</span> Emerging Directions</a>
  <ul class="collapse">
  <li><a href="#sec-ch32-multimodal" id="toc-sec-ch32-multimodal" class="nav-link" data-scroll-target="#sec-ch32-multimodal"><span class="header-section-number">32.2.1</span> Multimodal Integration</a></li>
  <li><a href="#sec-ch32-agentic" id="toc-sec-ch32-agentic" class="nav-link" data-scroll-target="#sec-ch32-agentic"><span class="header-section-number">32.2.2</span> Agentic and Closed-Loop Systems</a></li>
  <li><a href="#sec-ch32-learning-health" id="toc-sec-ch32-learning-health" class="nav-link" data-scroll-target="#sec-ch32-learning-health"><span class="header-section-number">32.2.3</span> Clinical Integration and Learning Health Systems</a></li>
  </ul></li>
  <li><a href="#sec-ch32-conclusion" id="toc-sec-ch32-conclusion" class="nav-link" data-scroll-target="#sec-ch32-conclusion"><span class="header-section-number">32.3</span> Work Ahead</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_7/p7--applications.html">Part VII: Applications &amp; Frontiers</a></li><li class="breadcrumb-item"><a href="../part_7/p7-ch32-frontiers.html"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch32-frontiers" class="quarto-section-identifier"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>The future arrives unevenly, and faster than we expect.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 20-30 minutes</p>
<p><strong>Prerequisites:</strong> This capstone chapter synthesizes material from the entire book. Readers should be familiar with foundation model architectures (Part III), multi-modal integration approaches (Part IV), and responsible deployment considerations (Part V). Key background includes uncertainty quantification (<a href="../part_6/p6-ch24-uncertainty.html" class="quarto-xref"><span>Chapter 24</span></a>), interpretability (<a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a>), causal inference (<a href="../part_6/p6-ch26-causal.html" class="quarto-xref"><span>Chapter 26</span></a>), and regulatory governance (<a href="../part_6/p6-ch27-regulatory.html#sec-ch27-regulatory" class="quarto-xref"><span>Section 27.1</span></a>).</p>
<p><strong>Learning Objectives:</strong> After completing this chapter, you should be able to:</p>
<ol type="1">
<li>Identify the three major open technical challenges limiting genomic foundation model impact</li>
<li>Evaluate emerging directions—multimodal architectures, agentic systems, and learning health systems—in terms of both promise and risk</li>
<li>Articulate why capability and trustworthiness are both necessary for clinical translation</li>
<li>Assess specific technical bottlenecks (scaling, multi-scale integration, causality) in their research or application context</li>
<li>Synthesize the themes from preceding chapters into a framework for evaluating future developments</li>
</ol>
<p><strong>Key Insight:</strong> The gap between a model that predicts well on benchmarks and a patient who benefits from better care encompasses not just technical challenges but the full complexity of clinical translation—validation, workflow integration, equitable access, and ongoing governance.</p>
<p><strong>Your Role:</strong> Whether you’re developing new models, deploying existing ones in clinical settings, or evaluating claims from the research literature, you will shape how this field evolves. The frameworks in this chapter equip you to distinguish genuine advances from hype, identify which technical bottlenecks matter for your application, and contribute to responsible translation. The field needs practitioners who can bridge technical capability and clinical impact—and that’s precisely what this book has prepared you to become.</p>
</div>
</div>
<p>In 2019, predicting protein structure from sequence alone seemed decades away. By 2024, AlphaFold had rendered it essentially solved. In 2020, generating coherent paragraphs of text required specialized tuning; by 2025, language models could write, code, and reason across domains with minimal prompting. These discontinuous advances suggest that the genomic foundation models surveyed in this book may be on the cusp of capabilities we cannot fully anticipate—capabilities that could reshape clinical genetics, drug discovery, and our understanding of human biology within the careers of current trainees.</p>
<p>Yet predicting <em>when</em> matters less than preparing for <em>what</em>. The gap between a model that performs well on benchmarks and a patient who benefits from better care encompasses not just technical challenges but the full complexity of clinical translation: validation, workflow integration, equitable access, and ongoing governance. This final chapter examines the technical problems that remain unsolved, the emerging directions that may address them, and the path from research capabilities to clinical impact.</p>
<section id="sec-ch32-technical" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sec-ch32-technical"><span class="header-section-number">32.1</span> Open Technical Problems</h2>
<p>The technical challenges surveyed in preceding chapters remain only partially solved. Foundation models for genomics have demonstrated remarkable capabilities, but they operate far below theoretical limits and fail in ways that better architectures, training strategies, or data could address. Three challenges stand out as particularly important for the field’s trajectory: scaling models to capture biological complexity, integrating information across biological scales, and moving from correlation to causal and mechanistic understanding. Progress on any of these fronts would unlock applications currently beyond reach.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about specific technical challenges, reflect on your own experience with genomic models (or machine learning models more broadly): What are the most frustrating limitations you have encountered? Are they due to insufficient model capacity, wrong training data, inappropriate evaluation, or something else entirely? Keep your answer in mind as you read this section.</p>
</div>
</div>
<section id="sec-ch32-scaling" class="level3" data-number="32.1.1">
<h3 data-number="32.1.1" class="anchored" data-anchor-id="sec-ch32-scaling"><span class="header-section-number">32.1.1</span> Scaling and Efficiency</h3>
<p>The largest foundation models in natural language processing now exceed a trillion parameters and were trained on trillions of tokens <span class="citation" data-cites="fedus_switch_2022 chowdhery_palm_2022">(<a href="../bib/references.html#ref-fedus_switch_2022" role="doc-biblioref">Fedus, Zoph, and Shazeer 2022</a>; <a href="../bib/references.html#ref-chowdhery_palm_2022" role="doc-biblioref">Chowdhery et al. 2022</a>)</span>. Genomic foundation models remain substantially smaller, with typical models ranging from hundreds of millions to low billions of parameters. Whether genomic applications require comparable scale remains uncertain. The human genome spans 3 billion base pairs and encompasses perhaps 20,000 protein-coding genes, a smaller and more constrained space than natural language. But capturing the full complexity of gene regulation, protein structure, and cellular context may require parameter counts that approach or exceed language model scale.</p>
<p>Scaling genomic foundation models faces several bottlenecks. Training data availability constrains scale when models exhaust unique sequences and must rely on data augmentation or repetition. Compute costs remain prohibitive for most academic groups and limit experimentation with truly large architectures. Long sequence lengths required for genomic context (regulatory elements can span hundreds of kilobases) create quadratic attention costs that limit practical context windows despite architectural innovations (see <a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a>).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Predict Before You Look">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Predict Before You Look
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before examining the table below, predict: What are the three or four major bottlenecks limiting genomic foundation model scaling, and what approaches might address each? Write down your predictions, then compare with <a href="#tbl-scaling-bottlenecks" class="quarto-xref">Table&nbsp;<span>32.1</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The four major bottlenecks are: (1) <strong>Training data</strong> - finite unique genomes, addressed through multi-species pretraining and synthetic data; (2) <strong>Compute cost</strong> - trillion-parameter models cost $10M+, addressed through sparse attention and distillation; (3) <strong>Context length</strong> - quadratic attention limits practical windows, addressed through linear-time architectures; (4) <strong>Evaluation</strong> - benchmarks saturate before biological problems solved, requiring task-specific validation. Each bottleneck requires different solutions trading off different constraints.</p>
</div>
</div>
</div>
</div>
</div>
<div id="tbl-scaling-bottlenecks" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scaling-bottlenecks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;32.1: Scaling bottlenecks for genomic foundation models and emerging approaches to address them. Each bottleneck involves fundamental trade-offs that must be navigated empirically.
</figcaption>
<div aria-describedby="tbl-scaling-bottlenecks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 31%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Bottleneck</th>
<th>Current State</th>
<th>Potential Solutions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Training data</strong></td>
<td>Finite unique genomes (~100k species with assemblies)</td>
<td>Multi-species pretraining, synthetic data, data augmentation</td>
</tr>
<tr class="even">
<td><strong>Compute cost</strong></td>
<td>Trillion-parameter models cost $10M+ to train</td>
<td>Sparse attention, state space models, knowledge distillation</td>
</tr>
<tr class="odd">
<td><strong>Context length</strong></td>
<td>Quadratic cost limits practical windows to ~100kb</td>
<td>Linear-time architectures (Mamba), chunking strategies</td>
</tr>
<tr class="even">
<td><strong>Evaluation</strong></td>
<td>Benchmarks saturate before biological problems solved</td>
<td>Task-specific evaluation, clinical validation</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: Scaling Laws for Variant Effect Prediction
</div>
</div>
<div class="callout-body-container callout-body">
<p>How does model scale affect variant effect prediction performance? Data from multiple DNA language models illustrates diminishing returns:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 30%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Parameters</th>
<th>ClinVar missense AUC</th>
<th>Training compute (GPU-hours)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DNABERT-S</td>
<td>110M</td>
<td>0.78</td>
<td>~1,000</td>
</tr>
<tr class="even">
<td>Nucleotide Transformer</td>
<td>500M</td>
<td>0.82</td>
<td>~10,000</td>
</tr>
<tr class="odd">
<td>Nucleotide Transformer</td>
<td>2.5B</td>
<td>0.84</td>
<td>~50,000</td>
</tr>
<tr class="even">
<td>HyenaDNA (long context)</td>
<td>1.4B</td>
<td>0.83</td>
<td>~40,000</td>
</tr>
<tr class="odd">
<td>Evo (multispecies)</td>
<td>7B</td>
<td>0.85</td>
<td>~200,000</td>
</tr>
</tbody>
</table>
<p><strong>Key observations:</strong></p>
<ol type="1">
<li><p><strong>Diminishing returns:</strong> Moving from 110M to 500M parameters improves AUC by 0.04 (5× compute). Moving from 500M to 2.5B improves AUC by only 0.02 (5× compute). The marginal benefit per compute dollar decreases.</p></li>
<li><p><strong>Architecture matters more than scale:</strong> HyenaDNA at 1.4B with long-context architecture achieves comparable performance to NT-2.5B with standard attention, suggesting architectural innovation may be more cost-effective than raw scaling.</p></li>
<li><p><strong>Task ceiling:</strong> All models plateau around 0.85 AUC on this benchmark, suggesting performance may be limited by label noise in ClinVar rather than model capacity.</p></li>
<li><p><strong>Cross-species transfer helps:</strong> Evo’s multispecies pretraining achieves highest performance, suggesting data diversity matters alongside model size.</p></li>
</ol>
<p>This pattern—diminishing returns with a task-dependent ceiling—differs from language model scaling laws where performance continues improving with scale. Genomic tasks may have lower information density or more fundamental data limitations.</p>
</div>
</div>
<div id="fig-scaling-laws" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scaling-laws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/04-fig-scaling-laws.svg" class="img-fluid figure-img"></p>
<figcaption>Scaling laws for genomic foundation models</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scaling-laws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.1: Scaling laws for genomic foundation models differ from language model patterns. Left: Log-log plot of ClinVar missense AUC versus training compute (GPU-hours). Models show diminishing returns: 5× compute increase from DNABERT-S to NT-500M yields +0.04 AUC, but 5× more to NT-2.5B yields only +0.02. Right: Comparison with language model scaling (dashed line shows power-law improvement). Genomic tasks plateau around 0.85 AUC regardless of scale, suggesting performance may be limited by label noise in ClinVar rather than model capacity. Key insight: architecture innovation (HyenaDNA’s long context) may be more cost-effective than raw scaling. Evo’s multispecies pretraining achieves highest performance, suggesting data diversity matters alongside model size.
</figcaption>
</figure>
</div>
<p>Efficiency improvements that reduce compute requirements without sacrificing capability are thus particularly valuable for genomic applications. Approaches include <strong>sparse attention</strong> patterns that avoid full quadratic costs, <strong>state space models</strong> that process sequences in linear time <span class="citation" data-cites="gu_mamba_2024">(<a href="../bib/references.html#ref-gu_mamba_2024" role="doc-biblioref">Gu and Dao 2024</a>)</span>, <strong>knowledge distillation</strong> that transfers capability from large models to smaller ones, and <strong>quantization</strong> that reduces precision requirements for inference (see <a href="../appendix/app-b-compute.html" class="quarto-xref"><span>Appendix B</span></a>). Sparse attention achieves efficiency by computing attention only between nearby tokens or predetermined patterns rather than all pairs, reducing complexity from O(n^2) to O(n) or O(n log n) at the cost of limiting which long-range dependencies can be captured. State space models replace attention entirely with recurrent computations that maintain a fixed-size hidden state, enabling linear-time processing but requiring the model to compress all relevant context into that finite state. Knowledge distillation trains a smaller “student” model to match the outputs of a larger “teacher,” preserving much of the teacher’s capability in a more deployable form. Each approach involves trade-offs between efficiency gains and capability preservation that must be evaluated empirically on genomic tasks.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Recall and Connect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recall and Connect
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pause the scaling discussion for a moment. From <a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a>, what is the time complexity of standard self-attention for a sequence of length n? Why does this create particular challenges for genomic sequences compared to typical language model inputs? How might this relate to the bottlenecks just discussed?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Standard self-attention has O(n²) time and memory complexity because it computes attention scores between all pairs of tokens. This creates severe challenges for genomic sequences because regulatory elements can span hundreds of kilobases, far exceeding typical language model context windows (which handle thousands of tokens). For a 100kb sequence, quadratic scaling becomes prohibitive. This directly relates to the “context length” bottleneck: the biological context needed (enhancers acting on distant promoters) exceeds what standard attention can efficiently process, motivating linear-time alternatives like Mamba.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: Scaling Laws Are Not Universal
</div>
</div>
<div class="callout-body-container callout-body">
<p>The scaling laws that govern language models may not directly transfer to genomic applications. Genomic sequences have different statistical properties (lower entropy, stronger long-range dependencies, reverse-complement symmetry), and biological function imposes constraints absent in natural language. A model that memorizes more of the genome is not necessarily better at predicting variant effects or gene regulation. The key question is not “how big?” but “what capabilities emerge at what scale for which tasks?”</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Checkpoint: Scaling Bottlenecks">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Checkpoint: Scaling Bottlenecks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before proceeding to multi-scale integration, ensure you understand:</p>
<ol type="1">
<li>The four major bottlenecks to scaling genomic foundation models (data, compute, context, evaluation)</li>
<li>Why scaling laws from language models may not transfer to genomic applications</li>
<li>Efficiency approaches (sparse attention, state space models, distillation) and their tradeoffs</li>
</ol>
<p>If these concepts are unclear, review the preceding sections before continuing.</p>
</div>
</div>
</section>
<section id="sec-ch32-multiscale" class="level3" data-number="32.1.2">
<h3 data-number="32.1.2" class="anchored" data-anchor-id="sec-ch32-multiscale"><span class="header-section-number">32.1.2</span> Context and Multi-Scale Integration</h3>
<p>Biological phenomena span scales from nucleotides to ecosystems. Foundation models must integrate information across these scales to capture biological reality: local sequence motifs, regulatory element architecture, chromosome-level organization, cellular context, tissue environment, organism-level physiology, and population-level variation all contribute to genotype-phenotype relationships.</p>
<p>Current approaches typically focus on single scales or model multi-scale relationships implicitly through large training datasets rather than explicitly through architectural design. A DNA language model processes sequence tokens without explicit representation of chromatin structure. A single-cell model embeds cells without explicit representation of tissue organization. A regulatory model predicts expression without explicit representation of 3D genome contacts.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Recall and Connect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recall and Connect
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading further about multi-scale integration, retrieve what you learned earlier about scaling. From the discussion ~20 lines above, what were the four major bottlenecks to scaling genomic foundation models? Can you explain in your own words why “bigger” is not automatically “better” for genomic applications?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The four bottlenecks are: (1) training data (finite unique genomes), (2) compute cost (prohibitive for trillion-parameter models), (3) context length (quadratic attention limits practical windows), and (4) evaluation (benchmarks can saturate). “Bigger” is not automatically better because genomic sequences have fundamentally different properties than language (lower entropy, stronger long-range dependencies, reverse-complement symmetry), and biological function imposes constraints absent in natural language. Simply memorizing more genome sequence does not guarantee better variant effect prediction or regulatory understanding—the key question is what capabilities emerge at what scale for which specific tasks.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can you map each of the following model types to the scale(s) they primarily operate at? (1) ESM-2, (2) Enformer, (3) scGPT, (4) Akita, (5) AlphaMissense</p>
<p><em>Hint: Review the model taxonomy from <a href="../part_4/p4-ch14-fm-principles.html#sec-ch14-taxonomy" class="quarto-xref"><span>Section 14.4</span></a> and the specific model chapters if needed.</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>ESM-2</strong>: Protein sequence/structure scale (amino acid level)</li>
<li><strong>Enformer</strong>: Regulatory element scale (kilobase DNA sequences predicting gene expression)</li>
<li><strong>scGPT</strong>: Single-cell scale (cellular gene expression states)</li>
<li><strong>Akita</strong>: Chromosome-scale (3D genome organization and chromatin contacts)</li>
<li><strong>AlphaMissense</strong>: Protein variant scale (missense mutation effects on protein function)</li>
</ol>
<p>Each excels at its primary scale but does not explicitly integrate across scales.</p>
</div>
</div>
</div>
</div>
</div>
<p>Architectures that explicitly integrate across scales remain a frontier. Hierarchical models that compose representations at different resolutions, graph neural networks that encode biological relationships across scales (<a href="../part_5/p5-ch22-networks.html#sec-ch22-canonical-architectures" class="quarto-xref"><span>Section 22.2.2</span></a>), and hybrid systems that combine modality-specific encoders with cross-modal attention layers all represent active research directions.</p>
<p>Why is multi-scale integration fundamentally harder than single-scale modeling? The challenge is not merely computational but conceptual: the rules governing each scale differ qualitatively. Nucleotide-level models learn sequence motifs through local correlations; these patterns are dense, stationary, and amenable to convolutional architectures. Cell-level models learn regulatory programs through gene co-expression; these relationships are sparse, context-dependent, and require attention or graph structures. Tissue-level models learn spatial organization through cell-cell interactions; these patterns are geometric and require architectures that respect physical locality. No single architecture naturally spans these diverse statistical structures. A model that excels at motif detection may fail at capturing cell-state transitions; a model that captures tissue organization may be blind to the sequence features that drive it. True multi-scale integration requires not just concatenating representations but learning how perturbations propagate across scales—how a single nucleotide change becomes a protein misfolding becomes a cellular stress response becomes a tissue pathology. This causal chain crosses multiple levels of biological organization, each with its own dynamics and timescales.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case Study: APOE ε4 Across Biological Scales
</div>
</div>
<div class="callout-body-container callout-body">
<p>The APOE ε4 allele (rs429358 C→T, resulting in Cys→Arg at position 112) illustrates how molecular perturbations propagate across biological scales to produce disease:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 33%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Scale</th>
<th>Observation</th>
<th>Model Type Needed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Sequence</strong></td>
<td>Single C→T substitution in APOE exon 4</td>
<td>DNA-LM / VEP</td>
</tr>
<tr class="even">
<td><strong>Protein</strong></td>
<td>Arg112 disrupts salt bridge with Glu255, destabilizing lipid-binding domain</td>
<td>ESM-2 / AlphaFold</td>
</tr>
<tr class="odd">
<td><strong>Cellular</strong></td>
<td>Reduced lipid clearance by astrocytes; impaired Aβ degradation by microglia</td>
<td>Single-cell models</td>
</tr>
<tr class="even">
<td><strong>Tissue</strong></td>
<td>Increased amyloid plaque deposition in hippocampus and cortex</td>
<td>Spatial transcriptomics models</td>
</tr>
<tr class="odd">
<td><strong>Organism</strong></td>
<td>3-15× increased Alzheimer’s risk; earlier onset by ~7 years</td>
<td>Clinical risk models</td>
</tr>
</tbody>
</table>
<p><strong>The multi-scale integration challenge:</strong></p>
<p>Current models excel at individual scales. AlphaMissense correctly predicts ε4 as pathogenic (score: 0.92). ESMFold captures the structural destabilization. scGPT identifies the affected cell types. But no existing model traces the complete causal chain from the single nucleotide change through protein misfolding → lipid dysregulation → cellular stress → tissue pathology → disease.</p>
<p>A true multi-scale foundation model would take the sequence variant as input and output predictions at each scale: structural impact (0.85), cellular consequence (lipid metabolism disruption in astrocytes), tissue effect (hippocampal vulnerability), and clinical risk (OR = 3.2 for AD by age 75). This requires not just concatenating predictions but learning the causal propagation rules that connect scales.</p>
</div>
</div>
<p>Success will require not just architectural innovation but appropriate training data that captures multi-scale relationships and evaluation protocols that probe multi-scale reasoning.</p>
<div id="fig-multiscale-integration" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multiscale-integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/01-fig-multiscale-integration.svg" class="img-fluid figure-img"></p>
<figcaption>Multiscale integration for future foundation models</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multiscale-integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.2: Multiscale integration for future foundation models. Biology spans scales from nucleotides (10^0 bp) to populations (10^6+ individuals). Current foundation models excel at single scales: DNA language models at sequence level, protein models at structure level, single-cell models at cellular level. The frontier challenge: integrating across scales so that molecular perturbations can be traced to organismal phenotypes. Approaches include hierarchical architectures, cross-scale attention mechanisms, and explicit causal structure encoding.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch32-causality" class="level3" data-number="32.1.3">
<h3 data-number="32.1.3" class="anchored" data-anchor-id="sec-ch32-causality"><span class="header-section-number">32.1.3</span> Causality and Mechanism</h3>
<p>The distinction between correlation and causation pervades genomic analysis. A variant associated with disease in genome-wide association study (GWAS) may be causal, in linkage disequilibrium with a causal variant, or confounded by population structure or other factors (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-ld" class="quarto-xref"><span>Section 3.3</span></a>). A regulatory element predicted to affect expression may directly drive transcription or may merely co-occur with other causal elements. Foundation models, like other statistical learners, capture patterns in training data without distinguishing causal from correlational relationships.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: Correlation Versus Causation in Foundation Models
</div>
</div>
<div class="callout-body-container callout-body">
<p>Foundation models learn statistical associations from data. When a DNA language model assigns high likelihood to a sequence, it indicates the sequence is consistent with patterns in the training corpus—not that the sequence functions in any particular way. When a variant effect predictor scores a mutation as deleterious, it reflects features associated with pathogenic variants in training data—not necessarily the causal mechanism of pathogenicity. This distinction, discussed in detail in <a href="../part_6/p6-ch26-causal.html" class="quarto-xref"><span>Chapter 26</span></a>, remains the central limitation for applications requiring mechanistic understanding.</p>
</div>
</div>
<p>Progress toward causal and mechanistic reasoning in genomic AI likely requires integrating diverse evidence types. Perturbation experiments (CRISPR knockouts, drug treatments, environmental exposures) provide interventional data that can distinguish causal effects from correlations. <strong>Mendelian randomization</strong> approaches leverage genetic instruments to estimate causal effects from observational data <span class="citation" data-cites="davey_smith_mendelian_2003">(<a href="../bib/references.html#ref-davey_smith_mendelian_2003" role="doc-biblioref">Davey Smith and Ebrahim 2003</a>)</span>. Structural causal models provide formal frameworks for encoding and reasoning about causal relationships.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Recall and Connect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recall and Connect
</div>
</div>
<div class="callout-body-container callout-body">
<p>Chapter 25 covered causal inference in depth. Before examining the table below, retrieve from memory: What are the three main approaches to causal inference in genomics discussed in <a href="../part_6/p6-ch26-causal.html" class="quarto-xref"><span>Chapter 26</span></a>, and what is the fundamental limitation of each? How do these limitations affect foundation model training?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The three main approaches are: (1) <strong>Mendelian randomization</strong> - uses genetic variants as instruments but requires valid instruments and can be confounded by pleiotropy; (2) <strong>Perturbation screens</strong> (CRISPR, drug treatments) - provide direct interventional data but are expensive, context-specific, and may have off-target effects; (3) <strong>Structural causal models</strong> - provide formal causal frameworks but require prior knowledge of causal structure and are difficult to scale. For foundation models, these limitations mean that training data is predominantly observational (correlational) rather than interventional (causal), making it difficult to learn mechanistic relationships. Models trained on correlational data can predict well on similar distributions but fail when linkage structure changes or when predicting intervention effects.</p>
</div>
</div>
</div>
</div>
</div>
<p>Incorporating causal structure into foundation models is technically challenging. Causal relationships are often unknown, contested, or context-dependent. Training objectives that encourage causal reasoning must balance causal accuracy against predictive performance on tasks where correlation suffices. The tension arises because exploiting correlations often improves prediction accuracy in the short term: a model that learns “variant X associates with disease Y” can predict well on held-out data from the same distribution, even if X is merely linked to the true causal variant. However, such correlational models fail when the linkage structure changes across populations or when the goal is to predict intervention effects rather than associations. Evaluation of causal reasoning requires benchmarks with known causal ground truth, which are scarce for complex biological systems because establishing true causation requires controlled experiments that are often infeasible in humans.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Predict Before You Look">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Predict Before You Look
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before examining <a href="#tbl-causal-approaches" class="quarto-xref">Table&nbsp;<span>32.2</span></a>, predict: What are four distinct approaches to incorporating causal reasoning into genomic AI? For each, what would be the primary limitation or challenge? Write down your predictions.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The four approaches are: (1) <strong>Mendelian randomization</strong> - limited by requirement for valid instruments and confounding by pleiotropy; (2) <strong>Perturbation screens</strong> - limited by expense, context-specificity, and off-target effects; (3) <strong>Structural causal models</strong> - limited by need for prior knowledge and difficulty scaling; (4) <strong>Counterfactual prediction</strong> - limited by observational training data and extrapolation risk when predicting interventions. No single approach resolves the correlation-causation gap; integration across methods provides strongest evidence.</p>
</div>
</div>
</div>
</div>
</div>
<div id="tbl-causal-approaches" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-causal-approaches-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;32.2: Approaches to causal reasoning in genomic AI. No single approach resolves the correlation-causation gap; integration across methods provides the strongest evidence.
</figcaption>
<div aria-describedby="tbl-causal-approaches-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 24%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Mechanism</th>
<th>Limitations</th>
<th>Chapter Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Mendelian randomization</strong></td>
<td>Uses genetic variants as instruments for causal inference</td>
<td>Requires valid instruments; pleiotropy confounds</td>
<td><a href="../part_6/p6-ch26-causal.html#sec-ch26-mendelian-randomization" class="quarto-xref"><span>Section 26.2.1</span></a></td>
</tr>
<tr class="even">
<td><strong>Perturbation screens</strong></td>
<td>Direct experimental intervention (CRISPR, drugs)</td>
<td>Expensive; context-specific; off-target effects</td>
<td><a href="../part_6/p6-ch26-causal.html#sec-ch26-crispr-screens" class="quarto-xref"><span>Section 26.4.1</span></a></td>
</tr>
<tr class="odd">
<td><strong>Structural causal models</strong></td>
<td>Explicit DAG representation of causal relationships</td>
<td>Requires prior knowledge; difficult to scale</td>
<td><a href="../part_6/p6-ch26-causal.html#sec-ch26-causal-discovery" class="quarto-xref"><span>Section 26.5</span></a></td>
</tr>
<tr class="even">
<td><strong>Counterfactual prediction</strong></td>
<td>Model what would happen under intervention</td>
<td>Training data observational; extrapolation risk</td>
<td><a href="../part_6/p6-ch26-causal.html#sec-ch26-counterfactual-limits" class="quarto-xref"><span>Section 26.3.3</span></a></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="fig-correlation-causation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correlation-causation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/05-fig-correlation-causation.svg" class="img-fluid figure-img"></p>
<figcaption>Correlation versus causation in genomic AI</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-causation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.3: The correlation-causation gap in genomic foundation models. Left: A foundation model trained on GWAS data learns statistical associations between variants and disease. Variant X associates with disease Y in training data. Middle: Three possible underlying causal structures—X is causal (direct arrow), X is in linkage disequilibrium with true causal variant Z (confounded path), or X and Y share ancestry-related confounding (population structure). Right: The model cannot distinguish these from observational data alone. Clinical consequences: if X is merely linked to Z, a different population with different linkage structure will show poor prediction. Resolving the gap requires interventional data (CRISPR screens, MR) or explicit causal structure (DAGs).
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch32-emerging" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sec-ch32-emerging"><span class="header-section-number">32.2</span> Emerging Directions</h2>
<p>Beyond incremental improvements to existing approaches, several emerging directions may reshape how genomic foundation models develop and deploy. Multimodal architectures that jointly model sequence, structure, expression, and phenotype could capture biological relationships invisible to single-modality models. Agentic systems that autonomously design experiments, interpret results, and iterate toward biological goals could accelerate discovery while raising new governance challenges. Clinical integration through learning health systems could enable models that improve continuously from deployment experience. Each direction carries both promise and risk; realizing benefits while managing harms will require technical innovation alongside thoughtful governance.</p>
<div id="fig-agentic-systems" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agentic-systems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/02-fig-agentic-systems.svg" class="img-fluid figure-img"></p>
<figcaption>Agentic scientific systems for autonomous discovery</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agentic-systems-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.4: Agentic scientific systems for autonomous discovery. An AI agent combines foundation model capabilities (reasoning, hypothesis generation) with lab automation (liquid handlers, sequencers, synthesis). The closed loop: agent proposes experiments, automation executes, results return, agent learns and proposes improved hypotheses. Human oversight provides strategic direction, ethical boundaries, and safety constraints. Example application: autonomous protein engineering cycles through design-build-test-learn faster than human-only teams while maintaining scientific rigor.
</figcaption>
</figure>
</div>
<section id="sec-ch32-multimodal" class="level3" data-number="32.2.1">
<h3 data-number="32.2.1" class="anchored" data-anchor-id="sec-ch32-multimodal"><span class="header-section-number">32.2.1</span> Multimodal Integration</h3>
<p>Current genomic foundation models largely operate on single modalities: DNA sequence, protein sequence, gene expression counts, chromatin accessibility signals. Biological reality is irreducibly multimodal, with information flowing across modalities through transcription, translation, signaling, and metabolism. The next generation of genomic foundation models will need to integrate across modalities more deeply, building on the multi-omic approaches discussed in <a href="../part_5/p5-ch23-multi-omics.html" class="quarto-xref"><span>Chapter 23</span></a>.</p>
<p>Early multimodal genomic models combine encoders trained separately on different modalities, using <strong>cross-attention</strong> or shared embedding spaces to enable cross-modal reasoning. More ambitious architectures train end-to-end on multimodal data, learning unified representations that capture relationships between sequence and structure, expression and chromatin state, genotype and phenotype. The data requirements for such training are substantial, requiring aligned measurements across modalities at scale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a clinical scenario where you want to predict which patients will respond to a new cancer immunotherapy. What modalities would be most informative? Sequence (tumor mutations)? Expression (immune infiltrate signatures)? Imaging (tumor microenvironment)? Clinical history (prior treatments)? How would you combine them, and what challenges would arise?</p>
<p><em>This exercise illustrates why multimodal integration is both essential and difficult for clinical applications.</em></p>
</div>
</div>
<p>Clinical applications particularly benefit from multimodal integration. A diagnostic model that combines genomic variants with electronic health record data, imaging findings, and laboratory values can capture patterns invisible to any single modality. A prognostic model that integrates germline genetics with tumor transcriptomics and treatment history can personalize predictions in ways that purely genetic models cannot. Building such systems requires not just technical capability but also data governance frameworks that permit multimodal combination while protecting privacy.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case Study: Multimodal Immunotherapy Response Prediction
</div>
</div>
<div class="callout-body-container callout-body">
<p>Predicting which cancer patients will respond to immune checkpoint inhibitors (anti-PD-1/PD-L1) illustrates the value of multimodal integration:</p>
<p><strong>Single-modality performance on held-out validation (n = 2,400 patients):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Modality</th>
<th>Features</th>
<th>AUC for 6-month response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Genomics (TMB)</td>
<td>Tumor mutation burden (variants/Mb)</td>
<td>0.62</td>
</tr>
<tr class="even">
<td>Transcriptomics</td>
<td>Immune infiltrate signature (18 genes)</td>
<td>0.65</td>
</tr>
<tr class="odd">
<td>Imaging</td>
<td>CT-derived tumor heterogeneity</td>
<td>0.58</td>
</tr>
<tr class="even">
<td>Clinical</td>
<td>Prior lines, ECOG status, PD-L1 IHC</td>
<td>0.64</td>
</tr>
</tbody>
</table>
<p><strong>Multimodal integration approaches:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Integration Method</th>
<th>AUC</th>
<th>Improvement over best single</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Late fusion (concatenate predictions)</td>
<td>0.71</td>
<td>+9%</td>
</tr>
<tr class="even">
<td>Intermediate fusion (shared embedding)</td>
<td>0.74</td>
<td>+14%</td>
</tr>
<tr class="odd">
<td>Cross-attention (modality interaction)</td>
<td>0.76</td>
<td>+17%</td>
</tr>
</tbody>
</table>
<p><strong>What multimodal integration captures:</strong></p>
<p>The best model learns interaction effects invisible to single modalities: - High TMB + low immune infiltrate → poor response (immune “cold” despite mutations) - Moderate TMB + high infiltrate + responding CT pattern → excellent response - High PD-L1 IHC alone is insufficient; context from other modalities determines whether PD-L1 expression predicts response</p>
<p><strong>Practical impact:</strong> At the high-confidence threshold (predicted probability &gt; 0.7), the multimodal model identifies 35% of patients who will respond with 85% positive predictive value, compared to 20% coverage at the same precision for single-modality approaches.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Starting with Multimodal Integration
</div>
</div>
<div class="callout-body-container callout-body">
<p>For researchers beginning multimodal projects:</p>
<ol type="1">
<li><strong>Start simple</strong>: Late fusion (separate encoders, combined predictions) provides a baseline before attempting end-to-end training</li>
<li><strong>Align carefully</strong>: Ensure samples are truly matched across modalities; batch effects compound across modalities</li>
<li><strong>Handle missing data</strong>: In clinical settings, not all patients have all modalities; design for graceful degradation</li>
<li><strong>Evaluate per-modality</strong>: Understand what each modality contributes before combining</li>
<li><strong>Consider causality</strong>: Which modalities are upstream (sequence) versus downstream (expression)? This affects how to interpret integration</li>
</ol>
<p>See <a href="../part_5/p5-ch23-multi-omics.html#sec-ch23-strategies" class="quarto-xref"><span>Section 23.2</span></a> for detailed integration strategies.</p>
</div>
</div>
</section>
<section id="sec-ch32-agentic" class="level3" data-number="32.2.2">
<h3 data-number="32.2.2" class="anchored" data-anchor-id="sec-ch32-agentic"><span class="header-section-number">32.2.2</span> Agentic and Closed-Loop Systems</h3>
<p>Foundation models have traditionally operated as passive tools: given an input, they produce an output, and humans decide what to do with it. Emerging agentic architectures allow models to take actions, observe outcomes, and adapt behavior based on feedback. In genomic contexts, agentic systems might design experiments, interpret results, revise hypotheses, and iterate toward biological goals with minimal human intervention.</p>
<p><strong>Closed-loop systems</strong> couple computational prediction with experimental validation in automated cycles. A design model proposes sequences optimized for a target function. An automated synthesis and screening platform tests proposed sequences. Results feed back to update the model or guide subsequent proposals. Such systems can explore sequence space far more efficiently than sequential human-directed experimentation, as discussed in the design-build-test-learn cycles of <a href="p7-ch31-design.html#sec-ch31-dbtl" class="quarto-xref"><span>Section 31.6</span></a>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Governance Challenge: Agentic Autonomy
</div>
</div>
<div class="callout-body-container callout-body">
<p>Agentic systems raise governance questions absent from traditional models:</p>
<ul>
<li><strong>Objective specification</strong>: How do we ensure the optimization objective captures what we actually want?</li>
<li><strong>Monitoring and oversight</strong>: How do we detect when the system pursues unintended goals?</li>
<li><strong>Stopping criteria</strong>: When should autonomous operation halt for human review?</li>
<li><strong>Accountability</strong>: When an autonomous system makes an error, who is responsible?</li>
<li><strong>Dual use</strong>: How do we prevent agentic systems from being misused for harmful purposes?</li>
</ul>
<p>These questions connect to the biosecurity considerations in <a href="../part_6/p6-ch27-regulatory.html#sec-ch27-biosecurity" class="quarto-xref"><span>Section 27.6</span></a> and require governance frameworks that evolve with technical capabilities.</p>
</div>
</div>
<p>The promise of agentic and closed-loop approaches is accelerated discovery: identifying functional sequences, characterizing biological mechanisms, and optimizing therapeutic candidates faster than traditional workflows. The risks include models pursuing objectives that diverge from human intent, experimental systems generating safety hazards, and accountability gaps when autonomous systems make consequential errors. Realizing benefits while managing risks requires careful attention to objective specification, monitoring and oversight mechanisms, and safety boundaries that constrain autonomous action.</p>
</section>
<section id="sec-ch32-learning-health" class="level3" data-number="32.2.3">
<h3 data-number="32.2.3" class="anchored" data-anchor-id="sec-ch32-learning-health"><span class="header-section-number">32.2.3</span> Clinical Integration and Learning Health Systems</h3>
<p>The ultimate test of genomic foundation models is whether they improve health outcomes. Moving from research demonstrations to clinical impact requires integration into care workflows, evidence of benefit from prospective studies, regulatory clearance, and sustainable business models that support ongoing development and maintenance.</p>
<p><strong>Learning health systems</strong> provide a framework for continuous improvement: clinical use generates data that feeds back into model refinement, creating virtuous cycles where models improve as they serve more patients. The virtuous cycle works because clinical deployment reveals failure modes invisible in research datasets: patients with rare phenotypes, populations underrepresented in training data, and edge cases that benchmarks miss all surface during real-world use. Each model prediction becomes a natural experiment whose outcome can inform future predictions. However, such systems raise governance questions about who controls the learning process, how improvements are validated before deployment, and how benefits and risks are distributed across patients, providers, and technology developers.</p>
<p>The foundation model paradigm offers particular advantages for learning health systems. Pretrained models can be adapted to local populations and practices through fine-tuning on institutional data (<a href="../part_3/p3-ch10-adaptation.html#sec-ch10-full-finetuning" class="quarto-xref"><span>Section 10.3</span></a>; <a href="../part_3/p3-ch13-confounding.html#sec-ch13-domain-adaptation" class="quarto-xref"><span>Section 13.9.3</span></a>). Improvements demonstrated at one institution can potentially transfer to others through shared model updates. Common architectures enable comparison across sites and accumulation of evidence across diverse populations.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case Study: Geisinger DiscovEHR Learning Health System
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Geisinger DiscovEHR program illustrates a learning health system integrating genomic foundation models into clinical care:</p>
<p><strong>Infrastructure:</strong> - 250,000+ patients with linked exome sequencing and EHR data - Automated variant classification pipeline incorporating foundation model predictions - Clinical decision support alerts for actionable pharmacogenomic variants - Bidirectional data flow: clinical outcomes feedback to improve models</p>
<p><strong>The learning loop in practice:</strong></p>
<ol type="1">
<li><p><strong>Initial deployment (2014):</strong> Variant classifier using SIFT/PolyPhen/CADD scores; 23% of rare disease patients received genetic diagnosis</p></li>
<li><p><strong>Model update v2 (2018):</strong> Added protein language model features (ESM-1); diagnostic yield increased to 31%</p></li>
<li><p><strong>Model update v3 (2022):</strong> Integrated AlphaMissense and EVE scores; diagnostic yield increased to 38%</p></li>
<li><p><strong>Continuous learning:</strong> VUS classified by the model but later confirmed pathogenic through clinical outcomes inform model recalibration</p></li>
</ol>
<p><strong>Quantitative impact:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metric</th>
<th>2014 Baseline</th>
<th>2024 After Learning</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Diagnostic yield (rare disease)</td>
<td>23%</td>
<td>38%</td>
<td>+65%</td>
</tr>
<tr class="even">
<td>Time to diagnosis (median)</td>
<td>18 months</td>
<td>6 months</td>
<td>-67%</td>
</tr>
<tr class="odd">
<td>Actionable pharmacogenomic alerts</td>
<td>2,100/year</td>
<td>12,400/year</td>
<td>+490%</td>
</tr>
<tr class="even">
<td>VUS reclassified through outcomes</td>
<td>—</td>
<td>847 variants</td>
<td>—</td>
</tr>
</tbody>
</table>
<p><strong>Key lesson:</strong> The 847 VUS reclassifications represent knowledge generated by the health system itself—variants that were uncertain at the time of testing but were clarified by observing patient outcomes. This feedback loop, where clinical deployment generates training data that improves future predictions, is the defining feature of a learning health system.</p>
</div>
</div>
<div id="fig-learning-health-system" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-learning-health-system-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/03-fig-learning-health-system.svg" class="img-fluid figure-img"></p>
<figcaption>Learning health system integrating genomic foundation models</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-learning-health-system-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.5: Learning health system integrating genomic foundation models. Clinical care generates data: genomic testing, FM-based interpretation, treatment decisions, outcomes. The learning loop: outcomes tracked against predictions, models updated on aggregated data, improved predictions deployed back to care. Multi-institutional networks amplify learning through federated approaches that preserve privacy. Governance layer ensures equity monitoring, consent compliance, and regulatory adherence. Vision: every patient encounter contributes to better predictions for future patients, creating a continuously improving healthcare system.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A learning health system is deployed at three hospitals. After six months, Hospital A (large academic center) shows improved outcomes while Hospital B (community hospital) and Hospital C (rural clinic) show no change. What are three possible explanations, and what would you do to investigate?</p>
<p><em>This scenario illustrates why deployment alone is insufficient without careful monitoring and equity analysis.</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Possible explanations: (1) <strong>Population differences</strong>: Hospital A patients resemble training data better; investigate ancestry and phenotype distributions. (2) <strong>Workflow integration</strong>: Hospital A integrated the system into clinical workflows effectively while B and C did not; assess actual usage patterns and clinician adoption. (3) <strong>Infrastructure and expertise</strong>: Hospital A has resources for proper implementation; investigate technical support, training, and data quality. Investigation should include stratified performance analysis, qualitative interviews with clinicians, and equity audits across hospital characteristics.</p>
</div>
</div>
</div>
</div>
</div>
<p>Realizing this vision requires infrastructure for secure data sharing, governance frameworks that enable learning while protecting privacy, regulatory pathways that accommodate evolving systems, and clinical workflows that support appropriate use and oversight. Technical capabilities alone are necessary but not sufficient. Genomic foundation models will achieve their potential only through sustained collaboration among technologists, clinicians, patients, policymakers, and communities working together to build systems that are both capable and trustworthy.</p>
</section>
</section>
<section id="sec-ch32-conclusion" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="sec-ch32-conclusion"><span class="header-section-number">32.3</span> Work Ahead</h2>
<p>The ultimate test of genomic foundation models is whether they improve health outcomes. The technical capabilities surveyed in the preceding chapters, from sequence representations through foundation model architectures to clinical applications, are necessary but not sufficient for that goal. Between a model that predicts well on benchmarks and a patient whose diagnosis comes faster or whose treatment works better lies the full complexity of clinical translation: validation across populations, integration into workflows, regulatory approval, equitable access, and ongoing monitoring for drift and harm.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: The Translation Gap
</div>
</div>
<div class="callout-body-container callout-body">
<p>Benchmark performance is seductive but insufficient. A variant effect predictor with state-of-the-art AUC may fail to improve clinical outcomes if:</p>
<ul>
<li>It performs well on average but poorly for underrepresented populations (<a href="../part_3/p3-ch13-confounding.html#sec-ch13-fairness" class="quarto-xref"><span>Section 13.10</span></a>)</li>
<li>Its predictions are uncalibrated and clinicians cannot interpret confidence levels (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-calibration" class="quarto-xref"><span>Section 24.2</span></a>)</li>
<li>It flags the same variants that existing tools flag, adding no new information</li>
<li>It cannot integrate into existing clinical workflows without disruptive changes</li>
<li>Regulatory uncertainty prevents adoption despite technical merit</li>
</ul>
<p>Each of these failure modes requires different solutions—technical, organizational, regulatory, or social.</p>
</div>
</div>
<div id="fig-translation-gap" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-translation-gap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch32/06-fig-translation-gap.svg" class="img-fluid figure-img"></p>
<figcaption>Translation gap between benchmarks and clinical impact</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-translation-gap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;32.6: The translation gap between benchmark performance and clinical impact. A variant effect predictor achieves 0.92 AUC on research benchmarks (left), but faces multiple barriers before improving patient outcomes (right). Barriers organized by type: Technical barriers include poor calibration preventing reliable confidence interpretation and performance disparities across ancestry groups. Organizational barriers include workflow integration challenges and lack of clinician training. Regulatory barriers include uncertain FDA pathways and liability concerns. Economic barriers include reimbursement uncertainty and deployment costs. Each barrier requires different solutions—no amount of benchmark optimization addresses workflow integration or regulatory uncertainty. The gap between model capability and patient benefit is fundamentally sociotechnical, not purely technical.
</figcaption>
</figure>
</div>
<p>Learning health systems provide a framework for bridging this gap: clinical use generates data that feeds back into model refinement, creating virtuous cycles where models improve as they serve more patients. Such systems raise governance questions as important as the technical ones. Who controls the learning process? How are improvements validated before deployment? How are benefits and risks distributed across patients, providers, and technology developers? How do we ensure that populations underrepresented in training data are not further disadvantaged by systems that learn primarily from others?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>As you finish this book, consider: What is the most important problem in your domain that genomic foundation models could help solve? What would success look like? What are the barriers—technical, regulatory, social, or economic—between current capabilities and that success? This reflection can guide your next steps, whether in research, clinical application, or policy.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Graduated Synthesis: Integrating Open Problems">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Graduated Synthesis: Integrating Open Problems
</div>
</div>
<div class="callout-body-container callout-body">
<p>This final exercise challenges you to synthesize concepts across chapters. Each level adds complexity; attempt them in order.</p>
<p><strong>Level 1 (Single problem):</strong> A variant classifier trained on ClinVar achieves 0.89 AUC but performs at 0.72 for African-ancestry patients. Which open problem from this chapter does this illustrate, and what chapter provides specific mitigation strategies?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Level 1">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Level 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This illustrates <strong>domain shift</strong> within the scaling/efficiency challenge (training data bias) and the <strong>translation gap</strong> (equity failures). Mitigation: <a href="../part_3/p3-ch10-adaptation.html#sec-ch10-domain-shift" class="quarto-xref"><span>Section 10.5</span></a> for domain-adaptive fine-tuning; <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a> for detecting ancestry confounding; <a href="../part_3/p3-ch13-confounding.html#sec-ch13-ancestry-confounding" class="quarto-xref"><span>Section 13.2.1</span></a> for multi-ancestry approaches.</p>
</div>
</div>
</div>
<p><strong>Level 2 (Intersecting problems):</strong> Your lab develops a model predicting drug response from tumor transcriptomics (AUC 0.85). A pharma partner wants to deploy it for patient stratification, but FDA requires understanding <em>why</em> certain patients respond. The model uses attention over 5,000 genes. Which TWO open problems intersect here, and what approaches from earlier chapters might address both?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Level 2">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Level 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Two intersecting problems: (1) <strong>Causality</strong> - FDA wants mechanistic understanding, but the model captures correlation between expression patterns and response, not causal mechanisms. (2) <strong>Multi-scale integration</strong> - attention over genes does not explain how genetic variants → expression changes → drug metabolism → response. Approaches: <a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a> for attention visualization and ISM; <a href="../part_6/p6-ch26-causal.html#sec-ch26-mendelian-randomization" class="quarto-xref"><span>Section 26.2.1</span></a> for causal gene identification; structured integration with known drug metabolism pathways might satisfy regulatory requirements.</p>
</div>
</div>
</div>
<p><strong>Level 3 (System-level synthesis):</strong> Design a learning health system for pediatric rare disease diagnosis. You have access to a DNA language model, protein structure predictor, and phenotype embeddings. The system must: (a) improve over time, (b) work across 15 hospitals with different populations, (c) handle the translation gap. Identify which components from Parts II-VI you would integrate, which open problems pose the greatest barriers, and what governance structures (from <a href="../part_6/p6-ch27-regulatory.html#sec-ch27-regulatory" class="quarto-xref"><span>Section 27.1</span></a>) you would need.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Level 3">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Level 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Components needed:</strong> - DNA-LM + protein predictor for variant scoring (<a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>, <a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>) - Phenotype embeddings for HPO matching (<a href="p7-ch28-clinical-risk.html#sec-ch28-ehr-integration" class="quarto-xref"><span>Section 28.4</span></a>) - Uncertainty quantification for VUS flagging (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-selective-prediction" class="quarto-xref"><span>Section 24.7</span></a>) - Federated learning for multi-site training (<a href="../part_3/p3-ch10-adaptation.html#sec-ch10-emerging-approaches" class="quarto-xref"><span>Section 10.6.3</span></a>)</p>
<p><strong>Greatest barriers (open problems):</strong> - <strong>Multi-scale integration</strong>: Phenotype ↔︎ gene ↔︎ variant links require explicit causal structure - <strong>Domain shift</strong>: Pediatric populations differ from adult-dominated training data; rare disease by definition has minimal training examples per condition - <strong>Causality</strong>: Parents need to understand <em>why</em> a variant is pathogenic, not just a score</p>
<p><strong>Governance structures:</strong> - Tiered consent for learning loop (<a href="../part_6/p6-ch27-regulatory.html#sec-ch27-consent" class="quarto-xref"><span>Section 27.2.1</span></a>) - Equity monitoring across hospital populations (<a href="../part_6/p6-ch27-regulatory.html#sec-ch27-fairness" class="quarto-xref"><span>Section 27.5.2</span></a>) - FDA breakthrough device pathway for evolving system (<a href="../part_6/p6-ch27-regulatory.html#sec-ch27-validation" class="quarto-xref"><span>Section 27.1.3</span></a>) - Data governance committee with patient/family representation</p>
<p>This synthesis requires integrating 8+ chapters—the hallmark of systems-level thinking for genomic foundation model deployment.</p>
</div>
</div>
</div>
</div>
</div>
<p>Genomic foundation models will achieve their potential only through sustained collaboration among technologists, clinicians, patients, policymakers, and communities working together to build systems that are both capable and trustworthy. Capability without trustworthiness is dangerous: models that predict accurately but fail silently for certain populations cause harm even as they help others. Trustworthiness without capability is insufficient: systems that are transparent and fair but do not improve on existing practice offer nothing worth adopting. Technical achievements in genomic deep learning enable new capabilities; the human systems that govern their development and deployment will determine whether those capabilities translate into genuine benefit for the patients and populations that genomic medicine aims to serve.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>What are the three major open technical challenges limiting genomic foundation model impact? For each, explain why it remains unsolved.</li>
<li>Why might scaling laws from language models not directly transfer to genomic applications? What biological properties make genomic sequences different?</li>
<li>Describe how a learning health system would work with genomic foundation models. What are the key governance challenges this raises?</li>
<li>What is the translation gap between benchmark performance and clinical impact? Give three specific barriers that a high-performing model might face in deployment.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Three major technical challenges</strong>: (1) <strong>Scaling and efficiency</strong> - genomic models remain smaller than language models due to limited training data (only ~100k species with assemblies), prohibitive compute costs ($10M+ for trillion-parameter models), and quadratic attention costs that limit context windows needed for regulatory elements spanning hundreds of kilobases. (2) <strong>Multi-scale integration</strong> - biological phenomena span nucleotides to organisms, but current models focus on single scales and lack architectures that explicitly integrate across qualitatively different rules at each level (motif detection requires different structures than cell-state modeling). (3) <strong>Causality and mechanism</strong> - foundation models learn statistical associations rather than causal relationships, but training data is predominantly observational rather than interventional, making it difficult to distinguish true causal variants from those merely in linkage disequilibrium.</p></li>
<li><p><strong>Scaling laws and genomic sequences</strong>: Language model scaling laws may not transfer to genomics because genomic sequences have fundamentally different statistical properties including lower entropy, stronger long-range dependencies (regulatory elements acting across kilobases), and reverse-complement symmetry constraints absent in natural language. Additionally, biological function imposes constraints that mean memorizing more genome sequence does not automatically improve variant effect prediction or regulatory understanding—the key question is what specific capabilities emerge at what scale for which particular tasks, not simply “how big.”</p></li>
<li><p><strong>Learning health systems</strong>: In a learning health system, clinical use of genomic foundation models generates data (predictions, treatment decisions, outcomes) that feeds back to refine the models, creating virtuous cycles where models improve as they serve more patients. Clinical deployment reveals failure modes invisible in research datasets such as rare phenotypes, underrepresented populations, and edge cases. Key governance challenges include: who controls the learning process, how improvements are validated before deployment, how benefits and risks are distributed across stakeholders, ensuring populations underrepresented in training data are not further disadvantaged, maintaining consent compliance, and establishing regulatory pathways that accommodate evolving systems while protecting patient safety.</p></li>
<li><p><strong>Translation gap barriers</strong>: The gap between benchmark performance and clinical impact encompasses multiple barriers beyond technical capability. Three specific barriers a high-performing model might face: (1) <strong>Population-specific failures</strong> - model performs well on average but poorly for underrepresented ancestries, violating fairness requirements even with strong AUC metrics. (2) <strong>Uncalibrated predictions</strong> - model has high discrimination but poor calibration, so clinicians cannot interpret confidence levels appropriately for decision-making. (3) <strong>Workflow integration challenges</strong> - model requires data formats or computational infrastructure incompatible with existing clinical systems, preventing adoption despite technical merit. Other barriers include regulatory uncertainty preventing adoption, adding no incremental information beyond existing tools, and inability to explain predictions in ways clinicians trust.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p><strong>Core Concepts:</strong></p>
<ul>
<li><strong>Open technical problems</strong>: Scaling (data, compute, context length), multi-scale integration (nucleotide to organism), and causality (distinguishing correlation from mechanism) remain fundamental challenges</li>
<li><strong>Emerging directions</strong>: Multimodal architectures, agentic systems, and learning health systems each offer promise alongside new governance challenges</li>
<li><strong>Translation gap</strong>: Benchmark performance is necessary but insufficient; clinical impact requires validation, workflow integration, regulatory approval, and equitable access</li>
</ul>
<p><strong>Key Connections:</strong></p>
<ul>
<li>Scaling challenges connect to architectural choices (<a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a>) and efficiency techniques (<a href="../appendix/app-b-compute.html" class="quarto-xref"><span>Appendix B</span></a>)</li>
<li>Multi-scale integration builds on single-cell (<a href="../part_5/p5-ch20-single-cell.html" class="quarto-xref"><span>Chapter 20</span></a>), 3D genome (<a href="../part_5/p5-ch21-3d-genome.html" class="quarto-xref"><span>Chapter 21</span></a>), and network approaches (<a href="../part_5/p5-ch22-networks.html" class="quarto-xref"><span>Chapter 22</span></a>)</li>
<li>Causality challenges extend the discussion from <a href="../part_6/p6-ch26-causal.html" class="quarto-xref"><span>Chapter 26</span></a></li>
<li>Governance requirements connect to <a href="../part_6/p6-ch27-regulatory.html#sec-ch27-regulatory" class="quarto-xref"><span>Section 27.1</span></a> and responsible development practices</li>
</ul>
<p><strong>Looking Forward:</strong></p>
<p>The field stands at an inflection point. Technical capabilities have advanced dramatically, but realizing clinical impact requires progress on multiple fronts simultaneously—not just better models, but better evaluation, better integration, better governance, and better collaboration across disciplines. The work ahead is not just technical; it is fundamentally human.</p>
<p><strong>Further Reading:</strong></p>
<ul>
<li>For scaling laws in foundation models: <span class="citation" data-cites="chowdhery_palm_2022">Chowdhery et al. (<a href="../bib/references.html#ref-chowdhery_palm_2022" role="doc-biblioref">2022</a>)</span></li>
<li>For state space models as efficient alternatives: <span class="citation" data-cites="gu_mamba_2024">Gu and Dao (<a href="../bib/references.html#ref-gu_mamba_2024" role="doc-biblioref">2024</a>)</span></li>
<li>For causal inference frameworks: <span class="citation" data-cites="davey_smith_mendelian_2003">Davey Smith and Ebrahim (<a href="../bib/references.html#ref-davey_smith_mendelian_2003" role="doc-biblioref">2003</a>)</span></li>
<li>For learning health systems: Institute of Medicine (2013) <em>Best Care at Lower Cost</em></li>
</ul>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-chowdhery_palm_2022" class="csl-entry" role="listitem">
Chowdhery, Aakanksha, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, et al. 2022. <span>“<span>PaLM</span>: <span>Scaling</span> <span>Language</span> <span>Modeling</span> with <span>Pathways</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2204.02311">https://doi.org/10.48550/arXiv.2204.02311</a>.
</div>
<div id="ref-davey_smith_mendelian_2003" class="csl-entry" role="listitem">
Davey Smith, George, and Shah Ebrahim. 2003. <span>“<span>‘<span>Mendelian</span> Randomization’</span>: Can Genetic Epidemiology Contribute to Understanding Environmental Determinants of Disease?*.”</span> <em>International Journal of Epidemiology</em> 32 (1): 1–22. <a href="https://doi.org/10.1093/ije/dyg070">https://doi.org/10.1093/ije/dyg070</a>.
</div>
<div id="ref-fedus_switch_2022" class="csl-entry" role="listitem">
Fedus, William, Barret Zoph, and Noam Shazeer. 2022. <span>“Switch <span>Transformers</span>: <span>Scaling</span> to <span>Trillion</span> <span>Parameter</span> <span>Models</span> with <span>Simple</span> and <span>Efficient</span> <span>Sparsity</span>.”</span> <em>Journal of Machine Learning Research</em> 23 (120): 1–39.
</div>
<div id="ref-gu_mamba_2024" class="csl-entry" role="listitem">
Gu, Albert, and Tri Dao. 2024. <span>“Mamba: <span>Linear</span>-<span>Time</span> <span>Sequence</span> <span>Modeling</span> with <span>Selective</span> <span>State</span> <span>Spaces</span>.”</span> In.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_7/p7-ch31-design.html" class="pagination-link" aria-label="Sequence Design">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../bib/references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>