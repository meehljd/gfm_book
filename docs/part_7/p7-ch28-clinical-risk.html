<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>28&nbsp; Clinical Risk Prediction – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_7/p7-ch29-rare-disease.html" rel="next">
<link href="../part_7/p7--applications.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_7/p7--applications.html">Part VII: Applications &amp; Frontiers</a></li><li class="breadcrumb-item"><a href="../part_7/p7-ch28-clinical-risk.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch28-pgs-to-fm" id="toc-sec-ch28-pgs-to-fm" class="nav-link active" data-scroll-target="#sec-ch28-pgs-to-fm"><span class="header-section-number">28.1</span> From Polygenic Scores to Foundation Model Features</a>
  <ul class="collapse">
  <li><a href="#sec-ch28-nonlinear-prs" id="toc-sec-ch28-nonlinear-prs" class="nav-link" data-scroll-target="#sec-ch28-nonlinear-prs"><span class="header-section-number">28.1.1</span> Non-Linear and Deep Learning PRS Approaches</a></li>
  </ul></li>
  <li><a href="#sec-ch28-defining-risk" id="toc-sec-ch28-defining-risk" class="nav-link" data-scroll-target="#sec-ch28-defining-risk"><span class="header-section-number">28.2</span> Defining Clinical Risk Prediction</a></li>
  <li><a href="#sec-ch28-feature-integration" id="toc-sec-ch28-feature-integration" class="nav-link" data-scroll-target="#sec-ch28-feature-integration"><span class="header-section-number">28.3</span> Feature Integration Architectures</a></li>
  <li><a href="#sec-ch28-ehr-integration" id="toc-sec-ch28-ehr-integration" class="nav-link" data-scroll-target="#sec-ch28-ehr-integration"><span class="header-section-number">28.4</span> EHR Integration and Phenotype Embeddings</a>
  <ul class="collapse">
  <li><a href="#sec-ch28-eeprs" id="toc-sec-ch28-eeprs" class="nav-link" data-scroll-target="#sec-ch28-eeprs"><span class="header-section-number">28.4.1</span> EEPRS Framework</a></li>
  <li><a href="#sec-ch28-embeddings-help" id="toc-sec-ch28-embeddings-help" class="nav-link" data-scroll-target="#sec-ch28-embeddings-help"><span class="header-section-number">28.4.2</span> Understanding When Embeddings Help</a></li>
  <li><a href="#sec-ch28-prs-phewas" id="toc-sec-ch28-prs-phewas" class="nav-link" data-scroll-target="#sec-ch28-prs-phewas"><span class="header-section-number">28.4.3</span> PRS-PheWAS for Clinical Interpretation</a></li>
  <li><a href="#sec-ch28-eeprs-implementation" id="toc-sec-ch28-eeprs-implementation" class="nav-link" data-scroll-target="#sec-ch28-eeprs-implementation"><span class="header-section-number">28.4.4</span> Implementation Considerations</a></li>
  <li><a href="#sec-ch28-eeprs-fm" id="toc-sec-ch28-eeprs-fm" class="nav-link" data-scroll-target="#sec-ch28-eeprs-fm"><span class="header-section-number">28.4.5</span> Integration with Foundation Model Features</a></li>
  </ul></li>
  <li><a href="#sec-ch28-temporal-modeling" id="toc-sec-ch28-temporal-modeling" class="nav-link" data-scroll-target="#sec-ch28-temporal-modeling"><span class="header-section-number">28.5</span> Temporal Modeling Architectures</a></li>
  <li><a href="#sec-ch28-evaluation" id="toc-sec-ch28-evaluation" class="nav-link" data-scroll-target="#sec-ch28-evaluation"><span class="header-section-number">28.6</span> Evaluation for Clinical Deployment</a>
  <ul class="collapse">
  <li><a href="#sec-ch28-discrimination" id="toc-sec-ch28-discrimination" class="nav-link" data-scroll-target="#sec-ch28-discrimination"><span class="header-section-number">28.6.1</span> Discrimination</a></li>
  <li><a href="#sec-ch28-calibration" id="toc-sec-ch28-calibration" class="nav-link" data-scroll-target="#sec-ch28-calibration"><span class="header-section-number">28.6.2</span> Calibration</a></li>
  <li><a href="#sec-ch28-clinical-utility" id="toc-sec-ch28-clinical-utility" class="nav-link" data-scroll-target="#sec-ch28-clinical-utility"><span class="header-section-number">28.6.3</span> Clinical Utility</a></li>
  <li><a href="#sec-ch28-validation-hierarchy" id="toc-sec-ch28-validation-hierarchy" class="nav-link" data-scroll-target="#sec-ch28-validation-hierarchy"><span class="header-section-number">28.6.4</span> Validation Hierarchy</a></li>
  </ul></li>
  <li><a href="#sec-ch28-uncertainty" id="toc-sec-ch28-uncertainty" class="nav-link" data-scroll-target="#sec-ch28-uncertainty"><span class="header-section-number">28.7</span> Uncertainty Quantification</a></li>
  <li><a href="#sec-ch28-fairness" id="toc-sec-ch28-fairness" class="nav-link" data-scroll-target="#sec-ch28-fairness"><span class="header-section-number">28.8</span> Fairness and Health Equity</a></li>
  <li><a href="#sec-ch28-clinical-integration" id="toc-sec-ch28-clinical-integration" class="nav-link" data-scroll-target="#sec-ch28-clinical-integration"><span class="header-section-number">28.9</span> Clinical Integration</a>
  <ul class="collapse">
  <li><a href="#sec-ch28-workflow-patterns" id="toc-sec-ch28-workflow-patterns" class="nav-link" data-scroll-target="#sec-ch28-workflow-patterns"><span class="header-section-number">28.9.1</span> Workflow Integration Patterns</a></li>
  <li><a href="#sec-ch28-system-architecture" id="toc-sec-ch28-system-architecture" class="nav-link" data-scroll-target="#sec-ch28-system-architecture"><span class="header-section-number">28.9.2</span> System Architecture</a></li>
  <li><a href="#sec-ch28-monitoring" id="toc-sec-ch28-monitoring" class="nav-link" data-scroll-target="#sec-ch28-monitoring"><span class="header-section-number">28.9.3</span> Post-Deployment Monitoring</a></li>
  </ul></li>
  <li><a href="#sec-ch28-regulatory" id="toc-sec-ch28-regulatory" class="nav-link" data-scroll-target="#sec-ch28-regulatory"><span class="header-section-number">28.10</span> Regulatory and Quality Frameworks</a></li>
  <li><a href="#sec-ch28-case-studies" id="toc-sec-ch28-case-studies" class="nav-link" data-scroll-target="#sec-ch28-case-studies"><span class="header-section-number">28.11</span> Case Studies</a>
  <ul class="collapse">
  <li><a href="#sec-ch28-case-cardio" id="toc-sec-ch28-case-cardio" class="nav-link" data-scroll-target="#sec-ch28-case-cardio"><span class="header-section-number">28.11.1</span> Cardiometabolic Risk Stratification</a></li>
  <li><a href="#sec-ch28-case-oncology" id="toc-sec-ch28-case-oncology" class="nav-link" data-scroll-target="#sec-ch28-case-oncology"><span class="header-section-number">28.11.2</span> Oncology Prognosis</a></li>
  <li><a href="#sec-ch28-case-pharmacogenomics" id="toc-sec-ch28-case-pharmacogenomics" class="nav-link" data-scroll-target="#sec-ch28-case-pharmacogenomics"><span class="header-section-number">28.11.3</span> Pharmacogenomic Adverse Event Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch28-translation-test" id="toc-sec-ch28-translation-test" class="nav-link" data-scroll-target="#sec-ch28-translation-test"><span class="header-section-number">28.12</span> Translation as the Test</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_7/p7--applications.html">Part VII: Applications &amp; Frontiers</a></li><li class="breadcrumb-item"><a href="../part_7/p7-ch28-clinical-risk.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch28-clinical-risk" class="quarto-section-identifier"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>A risk prediction has clinical value only if it changes what happens next.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 40-50 minutes</p>
<p><strong>Prerequisites:</strong> This chapter builds on concepts from multiple earlier chapters. You should be familiar with polygenic risk scores (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-pgs-construction" class="quarto-xref"><span>Section 3.5</span></a>), foundation model architectures for DNA and protein sequences (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>, <a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>), transfer learning approaches (<a href="../part_3/p3-ch09-transfer.html" class="quarto-xref"><span>Chapter 9</span></a>), and uncertainty quantification principles (<a href="../part_6/p6-ch24-uncertainty.html" class="quarto-xref"><span>Chapter 24</span></a>). Understanding of evaluation metrics (<a href="../part_3/p3-ch12-evaluation.html#sec-ch12-metrics-genomic-tasks" class="quarto-xref"><span>Section 12.6</span></a>) and interpretability methods (<a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a>) will help you assess clinical deployment requirements.</p>
<p><strong>Learning Objectives:</strong> After completing this chapter, you should be able to:</p>
<ol type="1">
<li>Explain why traditional polygenic scores often fail clinical translation and how foundation model features address these limitations</li>
<li>Compare early, intermediate, and late fusion architectures for integrating genomic and clinical data</li>
<li>Distinguish discrimination, calibration, and clinical utility as distinct but complementary evaluation criteria</li>
<li>Design validation studies appropriate for different levels of the evidence hierarchy</li>
<li>Identify sources of bias in genomic and EHR data and describe mitigation strategies for equitable deployment</li>
<li>Articulate the workflow, monitoring, and governance requirements for clinical integration of foundation model-based risk tools</li>
</ol>
</div>
</div>
<p>Maria is 52, with moderately elevated cholesterol and a family history that keeps her cardiologist alert: her father’s heart attack at 49, her brother’s stent at 54. Her physician orders a polygenic risk score and receives a number: 0.84, placing Maria in the top 5% of genetic risk for coronary artery disease. The cardiologist pauses. What should she <em>do</em> differently because of this score? Prescribe the statin she was already considering? Recommend earlier imaging she would have suggested anyway? Counsel Maria about lifestyle modifications she has heard a hundred times before?</p>
<p>A risk prediction has clinical value only if it changes what happens next. If Maria with her high polygenic risk score receives the same statin prescription, lifestyle counseling, and follow-up schedule as a patient without genetic testing, the score added nothing to her care regardless of its statistical validity. The fundamental challenge is not generating genomic predictions but translating them into actions that improve outcomes. This translation requires more than <strong>discrimination</strong> between who will and will not develop disease; it requires that the prediction reach clinicians in a usable form, at a decision point where alternatives exist, for a patient population where the prediction performs equitably.</p>
<p>Traditional polygenic scores, despite their scientific validity, often fail this translation test. They reduce entire genomes to single numbers that provide little mechanistic insight. They transfer poorly across ancestries because training data overrepresent European populations. They exist outside the electronic health records where clinical decisions actually happen, requiring manual lookup that busy clinicians rarely perform. Most fundamentally, the clinical actions available in response to a polygenic risk score (PRS), such as lifestyle modification, earlier screening, or preventive medication, are often the same actions recommended for patients with conventional risk factors, leaving unclear what the genetic information specifically enables.</p>
<p>Genomic foundation models offer capabilities that may address some of these limitations. Rather than collapsing genetic information into scalar risk scores, foundation models produce <strong>embeddings</strong> that capture sequence context, regulatory grammar, and functional consequences. These representations can integrate with clinical data through fusion architectures (<a href="../part_5/p5-ch23-multi-omics.html" class="quarto-xref"><span>Chapter 23</span></a>), adapt to diverse prediction tasks through <strong>transfer learning</strong> (<a href="../part_3/p3-ch09-transfer.html" class="quarto-xref"><span>Chapter 9</span></a>), and provide feature attributions that connect predictions to biological mechanisms (<a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a>). Whether these capabilities translate into tools that change practice remains the open question. Foundation models improve representation quality, but they do not automatically solve the translation problem. Clinicians must still have time and incentive to interpret richer representations, interventions must exist that respond to the mechanistic insights models provide, and computational evidence must meet evidentiary standards for clinical decision-making. Having better predictions does not guarantee better outcomes if those predictions do not reach clinicians in actionable form, at moments when decisions can change, for populations where the predictions perform equitably. The path from these capabilities to tools that change practice runs through electronic health record integration, evidence standards for clinical deployment, fairness considerations that determine whether genomic AI reduces or amplifies health disparities, and the practical realities of care delivery.</p>
<section id="sec-ch28-pgs-to-fm" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sec-ch28-pgs-to-fm"><span class="header-section-number">28.1</span> From Polygenic Scores to Foundation Model Features</h2>
<p>The limitations of classical polygenic risk scores define the opportunity for foundation model approaches. As discussed in <a href="../part_1/p1-ch03-gwas.html#sec-ch03-pgs-construction" class="quarto-xref"><span>Section 3.5</span></a>, polygenic scores aggregate the effects of common variants into weighted sums, with weights derived from genome-wide association study effect sizes. This framework has demonstrated that common genetic variation contributes substantially to risk for conditions including coronary artery disease, type 2 diabetes, and breast cancer. A patient in the top percentile of polygenic risk for coronary disease faces roughly threefold higher lifetime risk than one in the bottom percentile, a gradient comparable to traditional risk factors like smoking or hyperlipidemia .</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading further, consider the three main limitations of traditional polygenic scores mentioned in the introduction: lack of mechanistic insight, poor cross-ancestry portability, and disconnection from clinical workflows. For each limitation, what kind of technical capability would be needed to address it? How might richer representations from foundation models help with each?</p>
</div>
</div>
<p>Several limitations constrain the clinical impact of this approach. The linear additive model cannot capture <strong>epistatic</strong> interactions where one variant’s effect depends on others, nor can it represent the nonlinear relationships between genetic variation and disease that emerge from regulatory networks and cellular pathways. Polygenic scores derived from European-ancestry genome-wide association studies substantially underperform in other populations, with effect sizes often attenuating by half or more in African or East Asian ancestries due to differences in linkage disequilibrium structure and allele frequencies (<a href="../part_3/p3-ch13-confounding.html#sec-ch13-ancestry-confounding" class="quarto-xref"><span>Section 13.2.1</span></a>; <a href="../part_1/p1-ch03-gwas.html#sec-ch03-portability" class="quarto-xref"><span>Section 3.7</span></a>). Beyond these technical constraints, a single scalar provides no mechanistic insight: a high polygenic score for diabetes does not indicate whether risk stems from impaired insulin secretion, insulin resistance, or altered satiety signaling, information that might guide intervention selection.</p>
<p>Foundation models address these limitations through richer representations. Instead of treating variants as independent weighted features, models like <em>Delphi</em> and <em>G2PT</em> learn genome-wide embeddings that encode sequence context, regulatory annotations, and cross-variant interactions <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="../bib/references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="../bib/references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. These approaches can capture nonlinear structure in genetic risk, leverage functional priors that transfer across ancestries, and provide attention-based attributions that highlight which genomic regions contribute most to predictions. Fine-mapping models like <em>MIFM</em> estimate posterior probabilities for variants most likely driving associations within loci, enabling prioritization based on statistical evidence <span class="citation" data-cites="rakowski_mifm_2025">(<a href="../bib/references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>. Whether these probabilistic rankings identify true causal variants (rather than variants in tight linkage with causal variants) remains a distinct question requiring experimental validation; fine-mapping provides refined association signals, not causal proof.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: From Scalar Scores to Rich Representations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The core advancement of foundation model approaches is not simply “better prediction” but a fundamental shift in what the model produces. A polygenic score yields a single number; a foundation model yields a high-dimensional embedding that preserves information about <em>which</em> genomic regions contribute, <em>how</em> they interact, and <em>why</em> they matter biologically. This richer output enables downstream tasks (pathway attribution, cross-ancestry transfer, mechanistic interpretation) that scalar scores cannot support.</p>
</div>
</div>
<p>The practical architecture of a foundation model-enabled risk system typically involves three components: pretrained encoders that transform genomic data into embeddings, aggregation modules that summarize variant-level or region-level representations into patient-level features, and prediction heads that map these features (combined with clinical covariates) to risk estimates. This modular design separates the computationally expensive foundation model inference from the task-specific prediction layer, enabling updates to either component while maintaining clear interfaces for validation.</p>
<div id="tbl-prs-vs-fm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-prs-vs-fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;28.1: Comparison of polygenic risk approaches: traditional polygenic scores versus foundation model-enhanced methods.
</figcaption>
<div aria-describedby="tbl-prs-vs-fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 22%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Representation</th>
<th>Ancestry Transfer</th>
<th>Mechanistic Insight</th>
<th>Computational Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Traditional PRS</td>
<td>Scalar (single number)</td>
<td>Poor (LD-dependent)</td>
<td>None</td>
<td>Low</td>
</tr>
<tr class="even">
<td>PRS + annotations</td>
<td>Scalar + categorical</td>
<td>Moderate</td>
<td>Limited</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>FM embeddings</td>
<td>High-dimensional vector</td>
<td>Better (sequence-based)</td>
<td>Via attribution</td>
<td>High (precompute)</td>
</tr>
<tr class="even">
<td>FM + fine-mapping</td>
<td>Weighted embeddings</td>
<td>Best (causal priors)</td>
<td>Strong</td>
<td>High</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="sec-ch28-nonlinear-prs" class="level3" data-number="28.1.1">
<h3 data-number="28.1.1" class="anchored" data-anchor-id="sec-ch28-nonlinear-prs"><span class="header-section-number">28.1.1</span> Non-Linear and Deep Learning PRS Approaches</h3>
<p>Recent work has explored whether deep learning can capture genetic interactions missed by linear PRS. <span class="citation" data-cites="dibaeinia_prsformer_2025">Dibaeinia et al. (<a href="../bib/references.html#ref-dibaeinia_prsformer_2025" role="doc-biblioref">2025</a>)</span> introduce <em>PRSformer</em>, a transformer-based architecture designed to model variant interactions directly, potentially capturing epistatic effects that linear methods cannot represent.</p>
<div id="tbl-linear-vs-nonlinear" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-linear-vs-nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;28.2: Comparison of linear versus non-linear approaches to polygenic prediction. The trade-off between modeling complexity and interpretability remains a key consideration for clinical deployment.
</figcaption>
<div aria-describedby="tbl-linear-vs-nonlinear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Method Class</th>
<th>Architecture</th>
<th>Captures Epistasis?</th>
<th>Interpretability</th>
<th>Computational Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear PRS (LDpred2, PRS-CS)</td>
<td>Weighted sum</td>
<td>No</td>
<td>High (weights)</td>
<td>Low</td>
</tr>
<tr class="even">
<td>Non-linear ML (XGBoost)</td>
<td>Decision trees</td>
<td>Limited (pairwise)</td>
<td>Moderate (SHAP)</td>
<td>Moderate</td>
</tr>
<tr class="odd">
<td>Deep learning (PRSformer)</td>
<td>Transformer</td>
<td>Potentially</td>
<td>Low</td>
<td>High</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>However, rigorous comparison with well-tuned linear methods is essential before concluding that deep learning adds value (<a href="../part_3/p3-ch12-evaluation.html#sec-ch12-baseline-selection" class="quarto-xref"><span>Section 12.7</span></a>). <span class="citation" data-cites="elgart_non-linear_2022">Elgart et al. (<a href="../bib/references.html#ref-elgart_non-linear_2022" role="doc-biblioref">2022</a>)</span> systematically compared linear and non-linear PRS approaches across multiple phenotypes, finding that non-linear models can provide modest but consistent improvements (typically 2-5% AUC gain) for phenotypes with complex genetic architectures, while establishing that improvements from deep learning must exceed well-tuned linear baselines to justify increased complexity. As discussed in baseline requirements, apparent advantages of complex models may reflect improper comparison rather than genuine epistatic signal.</p>
</section>
</section>
<section id="sec-ch28-defining-risk" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sec-ch28-defining-risk"><span class="header-section-number">28.2</span> Defining Clinical Risk Prediction</h2>
<p>A risk prediction model is only as useful as the decision it informs. Effective clinical risk prediction requires precise specification of four elements: the outcome being predicted, the time horizon over which prediction applies, the target population for whom the model is intended, and the clinical action the prediction will trigger.</p>
<p>Consider a 55-year-old woman with moderately elevated cholesterol and a family history of early coronary disease. Her cardiologist must decide whether to initiate statin therapy, a decision traditionally guided by 10-year cardiovascular risk estimates from tools like the Pooled Cohort Equations. A genomic foundation model could augment this decision in several ways. It might refine her absolute risk estimate by incorporating polygenic information that the traditional calculator ignores. It might identify whether her genetic risk concentrates in pathways amenable to specific interventions (LDL metabolism favoring statins versus inflammatory pathways suggesting alternative approaches). It might flag pharmacogenomic variants affecting statin metabolism that influence dose selection or drug choice.</p>
<p>Each of these applications represents a different prediction task with distinct requirements. The 10-year risk estimate for major adverse cardiovascular events is an individual-level incident risk problem where discrimination and calibration matter most. The pathway-level attribution is an interpretability challenge requiring mechanistic grounding. The pharmacogenomic prediction is a treatment selection problem where the relevant outcome is adverse drug reaction risk conditional on therapy initiation.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Deep Dive: Clinical Validity vs. Clinical Utility">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deep Dive: Clinical Validity vs.&nbsp;Clinical Utility
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For technical readers:</strong> These distinct concepts determine whether a test should enter clinical practice:</p>
<p><strong>Analytical validity:</strong> Does the test accurately measure what it claims to measure?</p>
<ul>
<li>Example: Does the genotyping array correctly call the variant genotypes?</li>
<li>Metrics: Call rate, concordance with sequencing, reproducibility</li>
</ul>
<p><strong>Clinical validity:</strong> Is the measurement associated with the clinical outcome of interest?</p>
<ul>
<li>Example: Does the polygenic score correlate with disease risk?</li>
<li>Metrics: Discrimination (auROC), calibration, hazard ratios</li>
</ul>
<p><strong>Clinical utility:</strong> Does using the test improve patient outcomes?</p>
<ul>
<li>Example: Does knowing the polygenic score lead to interventions that reduce disease incidence?</li>
<li>Metrics: Net reclassification, decision curve analysis, clinical trial outcomes</li>
</ul>
<p><strong>Why the distinction matters:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 68%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Level</th>
<th>Can Be High While Others Are Low?</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Analytical validity</td>
<td>Yes</td>
<td>Perfectly accurate test for a biomarker that does not predict disease</td>
</tr>
<tr class="even">
<td>Clinical validity</td>
<td>Yes</td>
<td>Highly predictive test that does not change management</td>
</tr>
<tr class="odd">
<td>Clinical utility</td>
<td>Requires others</td>
<td>Test must be valid and actually improve care</td>
</tr>
</tbody>
</table>
<p>A model can achieve excellent discrimination (clinical validity) yet provide no clinical utility if the resulting predictions do not change clinical decisions, if the population tested differs from training, or if interventions triggered by the prediction are ineffective.</p>
</div>
</div>
<p>Clinical risk prediction tasks cluster into several archetypes. Incident risk concerns whether a currently disease-free individual will develop disease within a specified window, such as 10-year diabetes risk for prediabetic patients. Progression risk asks which patients with existing disease will develop complications, for instance nephropathy in diabetes or heart failure after myocardial infarction. Survival and prognosis involve time-from-diagnosis to events like death, recurrence, or transplant, often requiring survival models that handle censoring and competing risks. Treatment response and toxicity concerns whether a patient will benefit from one therapy versus another and their probability of experiencing serious adverse effects.</p>
<div id="tbl-risk-task-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-risk-task-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;28.3: Clinical risk prediction task archetypes and their distinct requirements.
</figcaption>
<div aria-describedby="tbl-risk-task-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 24%">
<col style="width: 19%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Task Type</th>
<th>Example Question</th>
<th>Time Structure</th>
<th>Key Metrics</th>
<th>FM Role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Incident risk</td>
<td>Will this patient develop T2D in 10 years?</td>
<td>Fixed window</td>
<td>Discrimination, calibration</td>
<td>Risk stratification features</td>
</tr>
<tr class="even">
<td>Progression</td>
<td>Will this diabetic develop nephropathy?</td>
<td>Conditional on disease</td>
<td>Time-to-event</td>
<td>Trajectory modeling</td>
</tr>
<tr class="odd">
<td>Survival/prognosis</td>
<td>How long after cancer diagnosis?</td>
<td>Open-ended, censored</td>
<td>C-index, survival curves</td>
<td>Tumor embeddings</td>
</tr>
<tr class="even">
<td>Treatment response</td>
<td>Will this patient respond to drug X?</td>
<td>Conditional on treatment</td>
<td>Relative benefit</td>
<td>Drug-gene interactions</td>
</tr>
<tr class="odd">
<td>Toxicity</td>
<td>Adverse event risk with drug X?</td>
<td>Conditional on treatment</td>
<td>auPRC (rare outcomes)</td>
<td>Pharmacogenomic features</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Foundation models enter these problems as feature generators. They transform raw sequence data into structured representations that downstream prediction models combine with clinical covariates. The architectural choices for this combination, and the evidence required to trust the resulting predictions, constitute the core methodological challenges of clinical translation.</p>
</section>
<section id="sec-ch28-feature-integration" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="sec-ch28-feature-integration"><span class="header-section-number">28.3</span> Feature Integration Architectures</h2>
<p>The features available for clinical risk models draw on multiple foundation model families, each capturing different aspects of genetic and molecular risk.</p>
<p>DNA-level foundation models provide variant effect predictions without requiring trait-specific training. Systems like <em>Nucleotide Transformer</em>, <em>HyenaDNA</em>, and <em>GPN</em> compute sequence-based deleteriousness scores that reflect how mutations disrupt regulatory grammar, splice sites, or protein-coding sequences <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="../bib/references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="../bib/references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="../bib/references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>. These <strong>zero-shot</strong> predictions transfer across traits and ancestries because they derive from sequence properties rather than population-specific association statistics (<a href="../part_4/p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>). Fine-mapping models integrate these functional priors with association evidence to estimate which variants within a locus are likely causal, providing principled weights for aggregation (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-fine-mapping" class="quarto-xref"><span>Section 3.4</span></a>). Fine-mapping models like <em>MIFM</em> integrate such functional priors with association evidence to estimate which variants within a locus are likely causal, providing principled weights for aggregation <span class="citation" data-cites="rakowski_mifm_2025">(<a href="../bib/references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.</p>
<div id="fig-feature-integration" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feature-integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/01-A-fig-feature-integration.svg" class="img-fluid figure-img"></p>
<figcaption>DNA foundation models contribute regulatory variant effects</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/01-B-fig-feature-integration.svg" class="img-fluid figure-img"></p>
<figcaption>Expression foundation models provide cell state embeddings</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/01-C-fig-feature-integration.svg" class="img-fluid figure-img"></p>
<figcaption>Protein foundation models add coding variant pathogenicity</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feature-integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.1: Feature integration for clinical risk prediction. (A) DNA foundation models contribute regulatory variant effects, enhancer predictions, and PRS enhancement. (B) Expression foundation models provide cell state embeddings, pathway activities, and disease signatures. (C) Protein foundation models add coding variant pathogenicity and structural effects. Integration combines features across modalities for unified risk prediction with calibrated uncertainty.
</figcaption>
</figure>
</div>
<p>Protein language models add coding variant interpretation. <em>AlphaMissense</em> and related systems predict pathogenicity for missense mutations based on evolutionary conservation patterns learned from millions of protein sequences, as discussed in <a href="../part_4/p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>. For conditions with strong coding variant contributions (Mendelian cardiomyopathies, cancer predisposition syndromes), these predictions provide important signal beyond what noncoding regulatory models capture.</p>
<p>Multi-omics foundation models extend beyond germline sequence. Cell-type-resolved representations from <em>GLUE</em>, <em>scGLUE</em>, and <em>CpGPT</em> capture regulatory state across chromatin accessibility, methylation, and expression (<a href="../part_5/p5-ch20-single-cell.html" class="quarto-xref"><span>Chapter 20</span></a>) <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="../bib/references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="../bib/references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>. Rare variant burden scores from <em>DeepRVAT</em> aggregate predicted effects across genes into pathway-level impairment measures <span class="citation" data-cites="clarke_deeprvat_2024">(<a href="../bib/references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>. For oncology applications, tumor embedding models like <em>SetQuence</em> and graph neural network-based subtypers encode complex somatic mutation landscapes into patient-level representations <span class="citation" data-cites="jurenaite_setquence_2024 li_mogcn_2022">(<a href="../bib/references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>; <a href="../bib/references.html#ref-li_mogcn_2022" role="doc-biblioref">Li et al. 2022</a>)</span>.</p>
<p>Electronic health record features provide the clinical context without which genomic predictions lack meaning. Demographics, vital signs, laboratory values, medication lists, problem codes, and procedure histories characterize the patient’s current state and trajectory. Time-varying biomarker trajectories (estimated glomerular filtration rate trends, hemoglobin A1c patterns, tumor marker dynamics) capture disease evolution that static snapshots miss.</p>
<p>The architectural question is how to combine these heterogeneous inputs. Three fusion strategies offer different tradeoffs.</p>
<p><strong>Early fusion</strong> concatenates all features into a single input vector and trains a unified model (neural network, gradient boosting, survival regression) on the combined representation. This approach allows the model to learn arbitrary interactions between genomic and clinical features but requires all inputs to be present for every patient, handles scale differences between modalities poorly, and can be dominated by whichever input provides the most features or strongest signal.</p>
<p><strong>Intermediate fusion</strong> trains separate encoders for each modality, producing genomic embeddings, clinical embeddings, and multi-omic embeddings that a fusion module then combines. The fusion module might use attention mechanisms to weight modality contributions dynamically, cross-modal transformers that allow features from one modality to attend to features from another, or simpler concatenation with learned combination weights. This approach offers modularity (foundation model encoders can be swapped as new versions become available) while still enabling learned cross-modal interactions.</p>
<p><strong>Late fusion</strong> trains independent models for each modality and combines their predictions through ensemble methods or meta-learning. A polygenic score model, an electronic health record model, and a multi-omic model each produce risk estimates that a final layer integrates. This approach handles missing modalities gracefully and allows modality-specific architectures but may underutilize cross-modal structure since interactions can only be captured at the final combination stage.</p>
<p>Why does late fusion handle missing data so effectively while intermediate fusion struggles? In late fusion, each modality-specific model is trained independently and produces valid predictions whether or not other modalities are available. The genomic model outputs a valid risk score using only genomic data; the EHR model outputs a valid risk score using only clinical data. The combination layer learns optimal weighting when all modalities are present but can fall back to available inputs without architectural modification: if EHR data is missing, the combination layer simply uses the genomic and multi-omic scores. In contrast, intermediate fusion architectures learn cross-modal interactions during training that assume all data streams are present. When a patient lacks methylation data, for example, the fusion layer’s learned weights encode expectations about relationships between methylation features and other modalities that cannot be satisfied, potentially producing undefined or degraded outputs.</p>
<div id="tbl-fusion-strategies" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fusion-strategies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;28.4: Comparison of fusion architectures for combining genomic and clinical features.
</figcaption>
<div aria-describedby="tbl-fusion-strategies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 29%">
<col style="width: 25%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Fusion Strategy</th>
<th>Cross-Modal Interactions</th>
<th>Missing Data Handling</th>
<th>Modularity</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Early</td>
<td>Full (learned jointly)</td>
<td>Poor (all required)</td>
<td>Low</td>
<td>Dense, complete data</td>
</tr>
<tr class="even">
<td>Intermediate</td>
<td>Moderate (fusion layer)</td>
<td>Moderate (graceful degradation)</td>
<td>High</td>
<td>Evolving FM ecosystems</td>
</tr>
<tr class="odd">
<td>Late</td>
<td>Limited (output only)</td>
<td>Excellent (independent)</td>
<td>Moderate</td>
<td>Heterogeneous availability</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Choosing a Fusion Architecture
</div>
</div>
<div class="callout-body-container callout-body">
<p>For clinical deployment, intermediate fusion often provides the best balance. It enables modular updates as foundation models improve, allows graceful degradation when modalities are missing, and captures cross-modal interactions that late fusion misses. The specific fusion mechanism (attention, concatenation, cross-modal transformer) matters less than ensuring the architecture supports the operational requirements of clinical deployment: batch computation, uncertainty quantification, and interpretable feature attribution.</p>
</div>
</div>
</section>
<section id="sec-ch28-ehr-integration" class="level2" data-number="28.4">
<h2 data-number="28.4" class="anchored" data-anchor-id="sec-ch28-ehr-integration"><span class="header-section-number">28.4</span> EHR Integration and Phenotype Embeddings</h2>
<p>Polygenic risk scores condense genetic information into scalar predictions, but clinical decision-making occurs in the context of rich electronic health records that capture diagnoses, procedures, medications, laboratory values, and clinical narratives. A PRS for coronary artery disease exists as an isolated number until integrated with a patient’s history of hypertension, diabetes, smoking, and lipid measurements. The question is not merely whether to combine genetic and clinical information, but how to do so in ways that improve prediction, maintain interpretability, and avoid introducing new sources of bias.</p>
<p>Traditional approaches treat EHR data as additional covariates in regression models that already include the PRS. Age, sex, smoking status, and existing diagnoses enter as predictors alongside the genetic score, with effect sizes learned from training data. This additive framework has clear interpretation but limited capacity: it assumes that genetic risk and clinical risk contribute independently, missing interactions where genetic predisposition matters more or less depending on clinical context. A patient with elevated LDL cholesterol and high coronary disease PRS may face multiplicative risk that additive models underestimate.</p>
<section id="sec-ch28-eeprs" class="level3" data-number="28.4.1">
<h3 data-number="28.4.1" class="anchored" data-anchor-id="sec-ch28-eeprs"><span class="header-section-number">28.4.1</span> EEPRS Framework</h3>
<p>The EHR-embedding-enhanced PRS (<em>EEPRS</em>) framework addresses these limitations by integrating phenotype embeddings derived from EHR data with GWAS summary statistics to construct improved polygenic scores <span class="citation" data-cites="ruan_improving_2022">(<a href="../bib/references.html#ref-ruan_improving_2022" role="doc-biblioref">Ruan et al. 2022</a>)</span>. Rather than using expert-defined phenotype covariates, <em>EEPRS</em> learns vector representations of clinical phenotypes from their patterns of co-occurrence in patient records. These embeddings capture relationships among diseases, symptoms, and risk factors that expert definitions may miss.</p>
<p>The framework proceeds in stages. Embedding models (Word2Vec trained on ICD-10 code sequences, or GPT-based embeddings of code descriptions) transform each patient’s diagnostic history into a low-dimensional vector representation. GWAS conducted on these embedding dimensions identify genetic variants associated with each dimension of clinical phenotype space. The resulting summary statistics enable construction of embedding-based polygenic scores that capture genetic predisposition to the phenotypic patterns encoded in each dimension. Integration with traditional disease-specific PGS through weighted combination yields final risk predictions.</p>
<p>Validation in UK Biobank demonstrated consistent improvement over single-trait polygenic scores across 41 clinical traits. Cardiovascular conditions showed the largest gains: ischemic stroke improved by 66%, heart failure by 32%, and peripheral artery disease by 25% . These improvements concentrate in traits where related phenotypes share genetic architecture, allowing the embedding-based scores to leverage cross-phenotype genetic correlation. For isolated traits without strong embedding-dimension associations, improvements were modest or absent.</p>
</section>
<section id="sec-ch28-embeddings-help" class="level3" data-number="28.4.2">
<h3 data-number="28.4.2" class="anchored" data-anchor-id="sec-ch28-embeddings-help"><span class="header-section-number">28.4.2</span> Understanding When Embeddings Help</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>The EEPRS framework showed large improvements for cardiovascular conditions but minimal improvement for breast cancer. Before reading the explanation, can you hypothesize why? Consider what phenotype embeddings capture and how genetic architecture might differ between these conditions.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Cardiovascular conditions cluster together in clinical practice and share genetic architecture, allowing embeddings to capture cross-phenotype genetic correlations. Breast cancer has largely distinct genetic architecture from cardiovascular diseases, so embedding-based scores derived from cardiovascular-weighted dimensions provide no additional predictive signal for cancer risk.</p>
</div>
</div>
</div>
</div>
</div>
<p>The pattern of improvement across traits reveals when EHR embeddings add value to polygenic prediction. Conditions that cluster together in clinical space, co-occurring in patients and sharing risk factors, benefit most. The cardiovascular cluster (coronary artery disease, ischemic stroke, peripheral artery disease, heart failure, angina, type 2 diabetes) forms a coherent group in both clinical practice and genetic architecture. Embeddings trained on EHR data capture this clustering, and GWAS on embedding dimensions identify variants associated with the shared liability across the cluster. These variants provide additional prediction signal beyond what single-trait GWAS can detect.</p>
<p>Conversely, conditions with distinct genetic architectures that do not cluster with other phenotypes show minimal improvement. Breast cancer and coronary artery disease, despite both being common conditions well-represented in biobanks, did not benefit from embedding integration in external validation. Their genetic architectures are largely distinct; embedding-based scores derived from cardiovascular-weighted dimensions provide no additional signal for cancer prediction.</p>
<p>This selectivity has important implications for clinical deployment. <em>EEPRS</em> offers greatest value for conditions where conventional polygenic scores remain underpowered despite adequate GWAS sample sizes. Heart failure, peripheral artery disease, and asthma showed substantial improvements precisely because their polygenic scores have historically underperformed relative to heritability estimates. Embedding integration effectively borrows strength across genetically correlated phenotypes, amplifying signal that single-trait analyses struggle to detect.</p>
<p>Beyond diagnostic code embeddings, clinical measurements themselves can be embedded for improved prediction. <span class="citation" data-cites="yun_regle_2023">Yun et al. (<a href="../bib/references.html#ref-yun_regle_2023" role="doc-biblioref">2023</a>)</span> introduce <em>REGLE</em>, which learns embeddings from raw clinical data such as spirograms and electrocardiograms rather than from ICD codes. These physiological embeddings capture aspects of phenotype not reflected in diagnostic labels, potentially enabling transfer learning across related conditions and improving prediction for phenotypes with limited direct training data.</p>
</section>
<section id="sec-ch28-prs-phewas" class="level3" data-number="28.4.3">
<h3 data-number="28.4.3" class="anchored" data-anchor-id="sec-ch28-prs-phewas"><span class="header-section-number">28.4.3</span> PRS-PheWAS for Clinical Interpretation</h3>
<p>Clinical deployment requires interpretability: why does this score predict disease risk, and what biological mechanisms does it capture? PRS-based phenome-wide association studies provide one answer by systematically testing association between the polygenic score and hundreds of clinical phenotypes (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-phewas" class="quarto-xref"><span>Section 3.8</span></a>). For embedding-enhanced scores, PRS-PheWAS reveals which clinical manifestations the genetic risk predicts.</p>
<p>The <em>EEPRS</em> framework’s cardiovascular improvements became interpretable through PRS-PheWAS analysis. Embedding-based scores derived from ICA-transformed dimensions showed strong associations (adjusted <span class="math inline">\(p &lt; 10^{-20}\)</span>) with hypertension, atrial fibrillation, and cardiac dysrhythmias . These associations explain the improvement: the embeddings capture genetic variation that influences multiple cardiovascular endpoints, and aggregating across these endpoints provides stronger risk stratification than targeting any single outcome.</p>
<p>PRS-PheWAS also reveals unexpected associations that warrant clinical attention. Different embedding methods capture different aspects of phenotypic structure, with GPT-based embeddings uniquely identifying associations with infectious diseases and mental disorders that Word2Vec embeddings missed. These method-specific patterns may reflect differences in what the embedding approaches learn from clinical data, or they may indicate opportunities for method combination that leverages complementary signals.</p>
</section>
<section id="sec-ch28-eeprs-implementation" class="level3" data-number="28.4.4">
<h3 data-number="28.4.4" class="anchored" data-anchor-id="sec-ch28-eeprs-implementation"><span class="header-section-number">28.4.4</span> Implementation Considerations</h3>
<p>Translating <em>EEPRS</em> from research demonstration to clinical deployment requires addressing several practical challenges. The embedding models must be trained on EHR data representative of the deployment population; embeddings learned from UK Biobank may not transfer to health systems with different patient populations, coding practices, or documentation patterns. The integration weights that combine embedding-based and single-trait scores require calibration in the target population, not just the discovery cohort.</p>
<p>Computational requirements are modest once embeddings are pretrained. Scoring new patients requires computing their embedding from available ICD codes (a lookup operation), then calculating weighted sums across precomputed variant weights. The workflow integrates with existing PGS calculation pipelines, adding embedding score computation and integration as additional steps. Summary statistics for embedding-based GWAS can be distributed like conventional GWAS results, enabling score construction without sharing individual-level data.</p>
<p>The deeper challenge is population representativeness. EHR-based embeddings inherit the documentation patterns, coding practices, and healthcare access disparities of the health systems where they were trained. An embedding that positions diabetes near cardiovascular disease reflects the co-occurrence pattern in patients who access both cardiology and endocrinology care; patients who lack access to specialty care may show different patterns. Multi-ancestry validation revealed that <em>EEPRS</em> improvements varied across populations, with gains concentrated in conditions where the underlying genetic correlation structure held across ancestries.</p>
</section>
<section id="sec-ch28-eeprs-fm" class="level3" data-number="28.4.5">
<h3 data-number="28.4.5" class="anchored" data-anchor-id="sec-ch28-eeprs-fm"><span class="header-section-number">28.4.5</span> Integration with Foundation Model Features</h3>
<p>The <em>EEPRS</em> framework operates on GWAS summary statistics and phenotype embeddings, both derived from classical statistical approaches. Foundation models offer an alternative integration strategy where learned sequence representations replace or augment summary statistics. Rather than weighting variants by GWAS effect sizes, foundation model approaches can score variants by their predicted functional impact, regulatory consequence, or embedding similarity to known pathogenic variants (<a href="../part_4/p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>).</p>
<p>Attention-based integration, graph neural networks for pathway aggregation (<a href="../part_5/p5-ch22-networks.html" class="quarto-xref"><span>Chapter 22</span></a>), and transformer encoders for sequence context can all incorporate EHR embeddings as additional input features. A patient’s clinical embedding provides context that may modify interpretation of their genetic variants: a <strong>variant of uncertain significance (VUS)</strong> in a cardiovascular gene carries different implications for a patient whose clinical embedding places them in the cardiovascular risk cluster versus one with an unremarkable clinical profile. This contextualization moves beyond additive combination toward models that learn interactions between genetic and clinical risk.</p>
<p>The combination of phenotype embeddings and foundation model features remains largely unexplored. <em>EEPRS</em> demonstrated that phenotype embeddings capture heritable variation beyond single-trait GWAS; foundation models demonstrate that sequence context improves variant effect prediction beyond simple annotations (<a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-fm-gains" class="quarto-xref"><span>Section 18.7</span></a>). Whether these approaches provide complementary signal, and whether their combination improves clinical prediction beyond either alone, represents an open research question with substantial clinical implications.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Checkpoint: PGS Enhancement Approaches">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Checkpoint: PGS Enhancement Approaches
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before proceeding to temporal modeling, ensure you understand:</p>
<ol type="1">
<li>Why embedding-based approaches improve some conditions (cardiovascular cluster) but not others (breast cancer)</li>
<li>How PRS-PheWAS provides interpretability for enhanced polygenic scores</li>
<li>What population representativeness challenges affect EHR-based embedding methods</li>
</ol>
<p>If these concepts are unclear, review the preceding sections before continuing.</p>
</div>
</div>
</section>
</section>
<section id="sec-ch28-temporal-modeling" class="level2" data-number="28.5">
<h2 data-number="28.5" class="anchored" data-anchor-id="sec-ch28-temporal-modeling"><span class="header-section-number">28.5</span> Temporal Modeling Architectures</h2>
<p>Clinical risk prediction spans diverse temporal structures, and the choice of modeling framework must match the prediction task. A screening tool estimating whether a patient will develop diabetes within ten years faces different statistical challenges than a monitoring system tracking whether a patient’s kidney function trajectory signals imminent decline. Foundation model features can integrate into each framework, but the integration patterns differ.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Challenging Material Ahead
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section introduces survival analysis concepts (hazard functions, censoring, proportional hazards assumptions) and longitudinal modeling frameworks (joint models, time-varying coefficients). Readers unfamiliar with these statistical foundations may benefit from reviewing standard biostatistics references before proceeding. The key conceptual distinction is between models that predict <em>whether</em> an event occurs within a fixed window versus models that track <em>how</em> risk evolves over time.</p>
</div>
</div>
<p><strong>Survival models</strong> address time-to-event outcomes where patients are followed until an event occurs or observation ends. The Cox proportional hazards model remains the workhorse of clinical risk prediction, estimating hazard ratios for features while making minimal assumptions about baseline hazard shape. Foundation model embeddings enter as covariates alongside clinical variables, with the proportional hazards assumption requiring that genomic risk effects remain constant over time. When this assumption fails (as when genetic effects on cancer recurrence differ between early and late periods), stratified or time-varying coefficient extensions accommodate the violation.</p>
<div id="fig-temporal-modeling" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-temporal-modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/02-A-fig-temporal-modeling.svg" class="img-fluid figure-img"></p>
<figcaption>Static vs dynamic risk over patient lifetime</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/02-B-fig-temporal-modeling.svg" class="img-fluid figure-img"></p>
<figcaption>Longitudinal trajectory modeling with sequential observations</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/02-C-fig-temporal-modeling.svg" class="img-fluid figure-img"></p>
<figcaption>Bayesian updating as evidence accumulates</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-temporal-modeling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.2: Temporal dynamics in clinical risk prediction. (A) Static versus dynamic risk: genetic risk sets baseline trajectory while environmental factors and interventions modify it over time. (B) Longitudinal trajectory modeling: sequential observations (labs, imaging, symptoms) update risk predictions with widening uncertainty into the future. (C) Prediction updating: Bayesian framework incorporates new evidence, adjusting risk as interventions and events occur.
</figcaption>
</figure>
</div>
<p>Deep survival models extend this framework through neural network architectures that learn nonlinear feature interactions. <em>DeepSurv</em> replaces the linear Cox predictor with a multilayer network while preserving the partial likelihood objective <span class="citation" data-cites="katzman_deepsurv_2018">(<a href="../bib/references.html#ref-katzman_deepsurv_2018" role="doc-biblioref">Katzman et al. 2018</a>)</span>. Deep Survival Machines model the survival distribution as a mixture of parametric components, enabling richer distributional assumptions than the semiparametric Cox approach <span class="citation" data-cites="nagpal_deep_2021">(<a href="../bib/references.html#ref-nagpal_deep_2021" role="doc-biblioref">Nagpal, Li, and Dubrawski 2021</a>)</span>. These architectures naturally accommodate the high-dimensional embeddings that foundation models produce, though the risk of overfitting increases and careful regularization becomes essential.</p>
<p><strong>Longitudinal models</strong> address a different challenge: patients observed repeatedly over time, with measurements that evolve and interact. A patient’s hemoglobin A1c trajectory over five years contains information that a single baseline measurement cannot capture. Whether values are stable, rising, or fluctuating conveys prognostic signal beyond their current level. Joint longitudinal-survival models connect these repeated measurements to event outcomes, modeling how biomarker trajectories associate with hazard while accounting for informative dropout when sicker patients are measured more frequently or die before later observations.</p>
<p>Foundation model features integrate into longitudinal frameworks at multiple levels. Static genomic embeddings (computed once from germline sequence) serve as time-invariant covariates influencing both trajectory shape and event hazard. Time-varying molecular features (expression profiles, methylation states, circulating tumor DNA levels) can be encoded through foundation models at each measurement occasion, producing sequences of embeddings that recurrent or attention-based architectures process into trajectory representations. The computational cost of re-encoding molecular data at each timepoint is substantial, making efficient inference strategies essential for deployment.</p>
<p>Transformer architectures designed for irregularly sampled time series offer a natural framework for clinical trajectories. Models like <em>STraTS</em> and similar clinical transformers handle the variable timing and missing measurements characteristic of real-world healthcare data <span class="citation" data-cites="tipirneni_self-supervised_2022">(<a href="../bib/references.html#ref-tipirneni_self-supervised_2022" role="doc-biblioref">Tipirneni and Reddy 2022</a>)</span>. Position encodings based on actual timestamps rather than sequence position accommodate irregular sampling. Attention mechanisms identify which historical measurements most inform current predictions. Foundation model embeddings at each timepoint provide richer input representations than raw laboratory values alone.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: Static Genetics, Dynamic Clinical Context
</div>
</div>
<div class="callout-body-container callout-body">
<p>The fundamental design choice in temporal genomic risk modeling is how to combine time-invariant genetic features (germline sequence does not change) with time-varying clinical context (laboratory values, disease progression, treatment response). The most effective architectures treat genetics as a “prior” that sets baseline risk trajectory, then update predictions as clinical observations accumulate. This mirrors clinical reasoning: genetic predisposition establishes susceptibility, but current clinical state determines immediate risk.</p>
</div>
</div>
<p>The choice between survival and longitudinal frameworks depends on the clinical question and available data. When the goal is baseline risk stratification (identifying high-risk patients at a single decision point), survival models with static genomic features often suffice. When the goal is dynamic monitoring (detecting deterioration as it develops), longitudinal models that update predictions as new measurements arrive become necessary. Hybrid approaches that initialize with genomic risk and update based on clinical trajectory combine the strengths of both paradigms.</p>
</section>
<section id="sec-ch28-evaluation" class="level2" data-number="28.6">
<h2 data-number="28.6" class="anchored" data-anchor-id="sec-ch28-evaluation"><span class="header-section-number">28.6</span> Evaluation for Clinical Deployment</h2>
<p>High performance on held-out test sets is necessary but far from sufficient for clinical deployment. Risk models must satisfy multiple evidence standards that typical machine learning papers do not address, and teams planning translation must understand these requirements from the outset rather than discovering them after development is complete.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Imagine you have developed a foundation model-based cardiovascular risk predictor that achieves auROC of 0.82 on your test set, substantially better than the 0.76 of the traditional Pooled Cohort Equations. A health system is interested in deploying it. What questions should they ask before integration? What evidence would you need beyond test set performance? Think about this before reading the evaluation framework below.</p>
</div>
</div>
<section id="sec-ch28-discrimination" class="level3" data-number="28.6.1">
<h3 data-number="28.6.1" class="anchored" data-anchor-id="sec-ch28-discrimination"><span class="header-section-number">28.6.1</span> Discrimination</h3>
<p>Discrimination measures how well a model ranks patients by risk, distinguishing those who will experience outcomes from those who will not. For binary endpoints like disease occurrence within a fixed time window, the <strong>area under the receiver operating characteristic curve (auROC)</strong> summarizes discrimination across all classification thresholds (<a href="../part_3/p3-ch12-evaluation.html#sec-ch12-metrics-genomic-tasks" class="quarto-xref"><span>Section 12.6</span></a>). When outcomes are rare (severe adverse drug reactions, specific disease subtypes), the <strong>area under the precision-recall curve (auPRC)</strong> better reflects how well the model identifies true positives among many negatives. For survival tasks with censoring, the concordance index and time-dependent auROC generalize these metrics to the time-to-event setting.</p>
<p>Strong discrimination is necessary but not sufficient. A model that correctly ranks patients but systematically overestimates or underestimates absolute risk magnitudes will lead to inappropriate clinical decisions. If a model predicts 5% risk for patients who actually experience 15% event rates, physicians using those predictions will undertreat. Conversely, systematically inflated predictions lead to overtreatment with attendant harms and costs.</p>
</section>
<section id="sec-ch28-calibration" class="level3" data-number="28.6.2">
<h3 data-number="28.6.2" class="anchored" data-anchor-id="sec-ch28-calibration"><span class="header-section-number">28.6.2</span> Calibration</h3>
<p><strong>Calibration</strong> asks whether predicted probabilities match observed frequencies. If a model assigns 20% risk to a group of patients, approximately 20% should experience the outcome. Well-calibrated predictions can be interpreted at face value and used directly for clinical decision-making; miscalibrated predictions mislead regardless of discrimination quality.</p>
<p>Assessment involves calibration plots comparing predicted risk deciles to observed event rates, statistical tests like the Hosmer-Lemeshow test, and proper scoring rules like the Brier score that combine calibration and discrimination (<a href="../part_3/p3-ch12-evaluation.html#sec-ch12-calibration" class="quarto-xref"><span>Section 12.11</span></a>). The methodological foundations for these assessments, including temperature scaling and isotonic regression approaches, are detailed in <a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-post-hoc-calibration" class="quarto-xref"><span>Section 24.3</span></a>. These assessments must be stratified by clinically relevant subgroups (ancestry, sex, age, comorbidity burden) because a model well-calibrated overall may be systematically miscalibrated for specific populations.</p>
<p>For polygenic score-informed models, calibration requires particular attention. Raw polygenic scores are typically centered and scaled rather than calibrated to absolute risk. Why are raw scores uncalibrated? A PGS is constructed by summing effect sizes across variants, producing a relative ranking rather than an absolute probability. The score distribution depends on the training population’s allele frequencies and LD structure; the same score percentile maps to different absolute risks depending on baseline disease incidence, age, sex, and environmental exposures. Without anchoring to an external incidence rate, the score carries no inherent probability interpretation. Mapping a score to an absolute event probability requires post-hoc models incorporating baseline incidence and clinical covariates. Foundation models can shift score distributions as architectures evolve, meaning recalibration may be necessary when updating encoders. The connection to <a href="../part_6/p6-ch24-uncertainty.html" class="quarto-xref"><span>Chapter 24</span></a> is direct: calibration is one form of uncertainty quantification, assessing whether model confidence aligns with actual outcome frequencies.</p>
</section>
<section id="sec-ch28-clinical-utility" class="level3" data-number="28.6.3">
<h3 data-number="28.6.3" class="anchored" data-anchor-id="sec-ch28-clinical-utility"><span class="header-section-number">28.6.3</span> Clinical Utility</h3>
<p>Beyond discrimination and calibration, <strong>clinical utility</strong> asks whether using the model will change decisions beneficially. Net reclassification improvement quantifies how many patients are appropriately moved across risk thresholds compared to a baseline model. Decision curve analysis estimates net benefit across threshold probabilities, accounting for the relative costs of false positives and false negatives in specific clinical contexts.</p>
<p>For foundation model-based tools, these analyses must demonstrate incremental value over existing alternatives. If a complex genomic foundation model provides only marginal improvement over a traditional polygenic score plus standard clinical calculator, the additional complexity, cost, and implementation burden may not be justified. The relevant comparison is not “better than nothing” but “better than what clinicians can already access.”</p>
<div id="tbl-evaluation-pillars" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-evaluation-pillars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;28.5: The three pillars of clinical evaluation for risk prediction models.
</figcaption>
<div aria-describedby="tbl-evaluation-pillars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Evaluation Dimension</th>
<th>Key Question</th>
<th>Primary Metrics</th>
<th>Subgroup Requirements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discrimination</td>
<td>Does the model rank patients correctly?</td>
<td>auROC, auPRC, C-index</td>
<td>By ancestry, sex, age</td>
</tr>
<tr class="even">
<td>Calibration</td>
<td>Do predicted probabilities match reality?</td>
<td>Calibration slope, ECE, Brier</td>
<td>By ancestry, comorbidity</td>
</tr>
<tr class="odd">
<td>Clinical utility</td>
<td>Does using the model improve decisions?</td>
<td>NRI, decision curves, net benefit</td>
<td>By decision threshold</td>
</tr>
<tr class="even">
<td>Incremental value</td>
<td>Is it better than existing tools?</td>
<td>Delta-metrics vs.&nbsp;baseline</td>
<td>Across care settings</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Baseline Requirements for Rigorous Evaluation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Baseline Requirements for Rigorous Evaluation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Claims that foundation model-based risk tools improve upon “state-of-the-art” polygenic prediction require verification of baseline strength. The minimum baseline battery for rigorous evaluation should include:</p>
<ol type="1">
<li><strong>LDpred2-auto</strong> or LDpred2-grid: LD-aware Bayesian method that estimates polygenicity and heritability directly</li>
<li><strong>PRS-CS</strong> or PRS-CS-auto: Continuous shrinkage prior accommodating highly polygenic architectures</li>
<li><strong>SBayesR</strong> or SBayesRC: Mixture model approach; annotation-integrated version provides additional benchmark</li>
<li><strong>Published PGS</strong> from PGS Catalog for the specific trait, representing community-validated scores</li>
<li><strong>XGBoost or random forest</strong>: Non-deep-learning ML alternative establishing whether neural network complexity is necessary</li>
</ol>
<p>Using only clumping-and-thresholding (C+T) as baseline artificially inflates apparent foundation model gains by 16-60%. When properly tuned linear methods are included, neural networks for polygenic prediction often perform only 93-95% as well, with apparent nonlinear advantages reflecting implicit LD modeling rather than genuine epistasis detection or representation learning <span class="citation" data-cites="ge_polygenic_2019">(<a href="../bib/references.html#ref-ge_polygenic_2019" role="doc-biblioref">Ge et al. 2019</a>)</span>.</p>
<p>The diagnostic question: does your foundation model approach outperform the best available linear method, or only weak linear methods? Incremental improvement over strong baselines justifies deployment complexity; improvement only over weak baselines does not.</p>
</div>
</div>
</section>
<section id="sec-ch28-validation-hierarchy" class="level3" data-number="28.6.4">
<h3 data-number="28.6.4" class="anchored" data-anchor-id="sec-ch28-validation-hierarchy"><span class="header-section-number">28.6.4</span> Validation Hierarchy</h3>
<p>Evidence strength depends critically on validation design. Internal validation through cross-validation or temporal splits within development data is useful but insufficient due to potential overfitting and subtle data leakage issues discussed in <a href="../part_3/p3-ch12-evaluation.html#sec-ch12-label-leakage" class="quarto-xref"><span>Section 12.4.1</span></a>. External validation across institutions and ancestries tests the same locked model in independent health systems and diverse populations. This step is essential for assessing whether performance reflects genuine biological signal versus idiosyncratic features of the development dataset.</p>
<div id="fig-validation-hierarchy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-validation-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/03-fig-validation-hierarchy.svg" class="img-fluid figure-img"></p>
<figcaption>Clinical validation hierarchy from internal holdout to prospective trials</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-validation-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.3: Clinical validation hierarchy. From bottom: internal holdout validation is easiest but overestimates deployment performance; external retrospective validation tests generalization across institutions; prospective observational validation monitors real-time performance without influencing care; prospective interventional trials demonstrate clinical utility through randomized comparisons; long-term outcome tracking provides ultimate validation but is rarely achieved. Each level requires greater investment but provides stronger evidence.
</figcaption>
</figure>
</div>
<p>Prospective observational validation runs the model silently alongside clinical care without influencing decisions, measuring real-time performance and drift in deployment conditions. Prospective interventional trials use randomized or quasi-experimental designs to assess whether model-guided care actually improves outcomes, equity, and cost-effectiveness compared to usual care.</p>
<p>For most foundation model-based tools, regulators and health systems expect robust external validation at minimum. High-stakes applications (cancer prognosis affecting treatment intensity, pharmacogenomic predictions affecting drug choice) may require prospective interventional evidence. The investment required increases at each level of the hierarchy, but so does the confidence that deployment will produce benefit rather than harm.</p>
</section>
</section>
<section id="sec-ch28-uncertainty" class="level2" data-number="28.7">
<h2 data-number="28.7" class="anchored" data-anchor-id="sec-ch28-uncertainty"><span class="header-section-number">28.7</span> Uncertainty Quantification</h2>
<p>In clinical settings, models must know when they do not know. A risk prediction offered with false confidence is more dangerous than one accompanied by appropriate uncertainty bounds, because the former invites unwarranted action while the latter prompts appropriate caution or additional evaluation.</p>
<p>Two sources of uncertainty require distinction. <strong>Aleatoric uncertainty</strong> reflects irreducible noise in the outcome: even with perfect input features, some patients with identical measured characteristics will experience different outcomes due to unmeasured variables, stochastic biology, or measurement error. <strong>Epistemic uncertainty</strong> reflects model limitations: insufficient training data, architectural constraints, or distributional shift between training and deployment conditions. Aleatoric uncertainty cannot be reduced by collecting more data or improving models; epistemic uncertainty can (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-types" class="quarto-xref"><span>Section 24.1</span></a>).</p>
<div id="fig-clinical-uncertainty" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clinical-uncertainty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/04-fig-clinical-uncertainty.svg" class="img-fluid figure-img"></p>
<figcaption>Communicating uncertainty in clinical risk prediction</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clinical-uncertainty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.4: Communicating uncertainty in clinical risk prediction. Single point estimates without context can mislead; intervals with best estimates provide actionable uncertainty. Visual formats include icon arrays (intuitive for patients), risk thermometers (familiar to clinicians), and contextual comparisons. Decision support should integrate uncertainty directly: flagging predictions with high epistemic uncertainty, showing confidence bands around thresholds, and providing sensitivity analysis.
</figcaption>
</figure>
</div>
<p>Practical uncertainty quantification methods include ensemble approaches, where multiple models trained with different random seeds provide prediction intervals based on their disagreement (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-deep-ensembles" class="quarto-xref"><span>Section 24.4.1</span></a>). Monte Carlo dropout approximates Bayesian uncertainty by averaging predictions across stochastic forward passes (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-mc-dropout" class="quarto-xref"><span>Section 24.4.2</span></a>). <strong>Conformal prediction</strong> provides principled prediction intervals with guaranteed coverage under exchangeability assumptions, avoiding the distributional assumptions required by parametric methods (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-conformal" class="quarto-xref"><span>Section 24.5</span></a>). Temperature scaling post-hoc adjusts model outputs to improve calibration without retraining (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-post-hoc-calibration" class="quarto-xref"><span>Section 24.3</span></a>).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A foundation model-based risk tool provides a prediction of 35% 10-year cardiovascular risk for a patient of Nigerian ancestry, along with a wide confidence interval of 15-55%. The model was trained primarily on European-ancestry data. Is this wide interval more likely reflecting aleatoric or epistemic uncertainty? What would you recommend the clinician do with this prediction?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This wide interval primarily reflects epistemic uncertainty due to distributional shift: the model has limited training data from African-ancestry populations and thus low confidence in its predictions. The clinician should interpret this prediction with caution, consider it alongside other risk factors, and potentially order additional testing rather than making treatment decisions based solely on this uncertain estimate.</p>
</div>
</div>
</div>
</div>
</div>
<p>For foundation model-based systems, uncertainty decomposes into genomic and clinical components. Genomic uncertainty reflects confidence in variant effect predictions, fine-mapping probabilities, or embedding reliability; it increases for variants from underrepresented populations, rare variants with limited training examples, or sequences falling outside the distribution seen during pretraining. Clinical uncertainty reflects extrapolation to new care settings, practice patterns, or patient populations not represented in development data.</p>
<p><strong>Selective prediction</strong> allows models to abstain when uncertainty exceeds thresholds, flagging cases for human review rather than providing potentially misleading predictions (<a href="../part_6/p6-ch24-uncertainty.html#sec-ch24-selective-prediction" class="quarto-xref"><span>Section 24.7</span></a>). This is particularly important for patients from rare ancestries underrepresented in training data or with unusual clinical presentations. The tension between coverage (providing predictions for all patients) and reliability (ensuring predictions are trustworthy) must be navigated thoughtfully, ideally with input from the clinicians who will use the system.</p>
</section>
<section id="sec-ch28-fairness" class="level2" data-number="28.8">
<h2 data-number="28.8" class="anchored" data-anchor-id="sec-ch28-fairness"><span class="header-section-number">28.8</span> Fairness and Health Equity</h2>
<p>Many genomic and electronic health record datasets encode historical inequities in who gets genotyped, which populations are recruited into biobanks, and how healthcare is documented and delivered. Risk models trained on such data can amplify disparities if not carefully evaluated and designed.</p>
<p>The structural biases that genomic datasets inherit, from sequencing cohort recruitment to biobank composition to ClinVar submission patterns, create cascading effects on model performance. These biases manifest not as random noise but as systematic underperformance for populations historically excluded from genomic research (<a href="../part_3/p3-ch13-confounding.html#sec-ch13-ancestry-confounding" class="quarto-xref"><span>Section 13.2.1</span></a>).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: Bias Compounds Through the Pipeline
</div>
</div>
<div class="callout-body-container callout-body">
<p>Underrepresentation of non-European ancestries compounds at each stage of the genomic AI pipeline. GWAS discovery is underpowered. Fine-mapping resolution is reduced due to different LD patterns. Variant effect predictors have fewer training examples. PRS portability suffers. Foundation model embeddings are less well-calibrated. Each layer of the stack inherits and potentially amplifies the biases of preceding layers, making end-to-end equity evaluation essential rather than optional.</p>
</div>
</div>
<p>The ancestry bias in genome-wide association studies persists in foundation model applications. As discussed in <a href="../part_1/p1-ch03-gwas.html#sec-ch03-portability" class="quarto-xref"><span>Section 3.7</span></a>, polygenic scores derived from European-ancestry data substantially underperform in other populations. Foundation models have the opportunity but not the guarantee to improve portability by leveraging functional priors that transfer across ancestries (sequence-based deleteriousness does not depend on population-specific linkage disequilibrium) and by incorporating multi-ancestry training data. Whether they succeed depends on training data composition, evaluation practices, and explicit attention to cross-ancestry performance throughout development.</p>
<div id="fig-fairness-assessment" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fairness-assessment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/05-A-fig-fairness-assessment.svg" class="img-fluid figure-img"></p>
<figcaption>Ancestry-stratified performance reveals masked disparities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/05-B-fig-fairness-assessment.svg" class="img-fluid figure-img"></p>
<figcaption>Calibration varies by group with overconfidence for underrepresented</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/05-C-fig-fairness-assessment.svg" class="img-fluid figure-img"></p>
<figcaption>Bias accumulates from training data through deployment</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/05-D-fig-fairness-assessment.svg" class="img-fluid figure-img"></p>
<figcaption>Mitigation strategies for equitable performance</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fairness-assessment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.5: Fairness assessment in clinical genomic AI. (A) Ancestry-stratified performance reveals disparities masked by aggregate metrics: African ancestry AUC significantly lower than European. (B) Calibration varies by group: models may be overconfident for underrepresented populations. (C) Bias accumulates: European-dominated training data leads to models that underperform on other populations, compounded by EHR biases. (D) Mitigation strategies: stratified evaluation disclosure, training reweighting, group-specific calibration, and uncertainty flagging for underrepresented inputs.
</figcaption>
</figure>
</div>
<p>Electronic health record features introduce additional bias sources. Which patients receive genetic testing, which laboratory tests are ordered, how diagnoses are coded, and how thoroughly clinical notes are documented all differ systematically across patient populations, care settings, and health systems. A model trained on one institution’s data may encode those institutional patterns rather than underlying biology.</p>
<p>Health equity evaluation requires disparity metrics measuring performance differences in discrimination, calibration, and clinical utility across subgroups defined by ancestry, sex, socioeconomic proxies, and care site. Access metrics assess whether financial, geographic, or systemic barriers limit which patients can benefit from genomic risk tools. Outcome metrics evaluate whether clinical actions triggered by predictions differ across groups and whether benefits accrue equitably or concentrate among already-advantaged populations.</p>
<p>Technical mitigation strategies include reweighting training data to reduce representation disparities, group-wise calibration ensuring equitable performance across subgroups, and localized fine-tuning using deployment-site data. These approaches are discussed further in <a href="../part_3/p3-ch13-confounding.html#sec-ch13-mitigation" class="quarto-xref"><span>Section 13.9</span></a>. Technical interventions alone cannot overcome structural inequities. Non-technical approaches including expanding sequencing access, subsidizing testing for underserved populations, and designing workflows that accommodate diverse care settings are equally essential.</p>
<p>The core principle is that equity cannot be an afterthought addressed during final evaluation. It must inform pretraining data selection, benchmark choice, validation study design, and deployment planning from the outset. A model that appears well-calibrated overall but is miscalibrated for specific populations will exacerbate rather than reduce health disparities.</p>
<p>The governance frameworks, regulatory considerations, and responsible development practices for ensuring equitable clinical AI are examined in <a href="../part_6/p6-ch27-regulatory.html#sec-ch27-regulatory" class="quarto-xref"><span>Section 27.1</span></a>.</p>
</section>
<section id="sec-ch28-clinical-integration" class="level2" data-number="28.9">
<h2 data-number="28.9" class="anchored" data-anchor-id="sec-ch28-clinical-integration"><span class="header-section-number">28.9</span> Clinical Integration</h2>
<p>Even a comprehensively validated model can fail in practice if it does not integrate into clinical workflows. Genomic risk predictions must reach clinicians at decision points, in formats that support rather than disrupt care delivery, with appropriate interpretability and uncertainty communication.</p>
<div id="fig-clinical-workflow" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clinical-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/06-fig-clinical-workflow.svg" class="img-fluid figure-img"></p>
<figcaption>Clinical workflow integration for genomic risk prediction</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clinical-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.6: Clinical workflow integration for genomic risk prediction. From data collection through processing, result generation, clinical review, and action. Foundation models contribute during processing and result generation. Human oversight checkpoints ensure clinician review before action. Adoption barriers include compute infrastructure, reimbursement, liability concerns, and clinician trust. Effective integration requires attention to timing, display, and action triggers at each stage.
</figcaption>
</figure>
</div>
<section id="sec-ch28-workflow-patterns" class="level3" data-number="28.9.1">
<h3 data-number="28.9.1" class="anchored" data-anchor-id="sec-ch28-workflow-patterns"><span class="header-section-number">28.9.1</span> Workflow Integration Patterns</h3>
<p>Clinical genomics has established pathways for returning results through CLIA-certified laboratories, structured reports, and genetic counseling. Foundation model-based risk tools can augment these pathways in two primary ways. Laboratory interpretation augmentation uses foundation model predictions to prioritize variants for manual review, provide richer functional annotations, and suggest likely disease mechanisms supporting differential diagnosis. Direct risk embedding in electronic health records precomputes risk scores for patients with genomic data, surfaces them in structured fields or clinical dashboards, and triggers alerts when thresholds are crossed.</p>
<p>Design choices include batch versus on-demand computation (batch overnight processing is often preferable given foundation model computational costs and the relative stability of genomic data), synchronous alerts at order entry versus asynchronous reports in clinical inboxes, and whether high-impact predictions require human-in-the-loop review before reaching front-line clinicians.</p>
<p>The specifics vary by clinical context. Pharmacogenomic alerts might appear synchronously at prescription order entry, providing immediate guidance on drug selection or dosing. Cardiometabolic risk scores might appear in primary care dashboards updated weekly, informing prevention discussions at annual visits. Oncology prognosis estimates might be generated at diagnosis and reviewed in tumor board settings where multidisciplinary teams make treatment decisions.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Integration Patterns by Use Case
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Pharmacogenomics:</strong> Synchronous alerts at prescription entry. Pre-compute patient drug-gene interaction profiles. Alert must include actionable alternatives, not just warnings.</p>
<p><strong>Primary care prevention:</strong> Batch scoring with dashboard display. Weekly updates sufficient given slow-changing genomic risk. Integrate with existing cardiovascular risk calculators.</p>
<p><strong>Oncology prognosis:</strong> Generate at diagnosis for tumor board review. Include uncertainty bounds and subgroup performance caveats. Human geneticist review before clinical action.</p>
<p><strong>Rare disease diagnosis:</strong> On-demand for active diagnostic workups. Prioritize interpretability (which variants, what mechanisms) over pure risk scores.</p>
</div>
</div>
</section>
<section id="sec-ch28-system-architecture" class="level3" data-number="28.9.2">
<h3 data-number="28.9.2" class="anchored" data-anchor-id="sec-ch28-system-architecture"><span class="header-section-number">28.9.2</span> System Architecture</h3>
<p>From an engineering perspective, foundation model-based clinical tools typically require a secure model-serving endpoint handling inference requests, input adapters transforming laboratory and electronic health record data into model-ready formats, output adapters mapping predictions to structured clinical concepts or user-facing text, and logging infrastructure providing audit trails and enabling drift detection.</p>
<p>Regulated settings impose additional requirements: versioning of models, data pipelines, and reference genomes with complete reproducibility; access controls and network segmentation protecting genomic data; and validation environments separated from production for safe testing of updates. Practical guidance on hardware requirements, deployment patterns, and cost estimation appears in <a href="../appendix/app-b-compute.html" class="quarto-xref"><span>Appendix B</span></a>.</p>
</section>
<section id="sec-ch28-monitoring" class="level3" data-number="28.9.3">
<h3 data-number="28.9.3" class="anchored" data-anchor-id="sec-ch28-monitoring"><span class="header-section-number">28.9.3</span> Post-Deployment Monitoring</h3>
<p>Clinical deployment begins rather than ends the model lifecycle. Practice patterns evolve as new treatments and guidelines emerge. Patient populations shift as screening programs expand or contract. Laboratory assays and sequencing pipelines change, introducing distributional shifts in input features.</p>
<p>Monitoring systems should track input distributions (genotype frequencies, electronic health record feature patterns) to detect when current patients differ from training populations. Output distributions (risk score histograms, threshold-crossing rates) reveal whether model behavior is changing. Performance metrics computed via rolling windows or periodic audits detect calibration or discrimination degradation before clinical consequences accumulate.</p>
<p>When drift is detected, responses range from recalibration (adjusting the score-to-probability mapping while preserving ranking behavior) through partial retraining (updating prediction heads while keeping foundation model weights fixed) to full model updates (retraining encoders, requiring renewed validation). The modular separation between foundation model backbones and clinical prediction heads facilitates this maintenance: encoders can be versioned and swapped with compatibility testing while prediction heads adapt to local deployment conditions.</p>
<p>Incident response processes allow clinicians to report surprising or harmful predictions, triggering root-cause analysis and potential remediation. Governance structures including AI oversight committees review models periodically and establish clear criteria for deprecation when performance degrades below acceptable thresholds.</p>
</section>
</section>
<section id="sec-ch28-regulatory" class="level2" data-number="28.10">
<h2 data-number="28.10" class="anchored" data-anchor-id="sec-ch28-regulatory"><span class="header-section-number">28.10</span> Regulatory and Quality Frameworks</h2>
<p>Foundation model-based clinical tools exist on a spectrum from research-only applications supporting hypothesis generation through clinical decision support tools informing diagnosis or management to regulated medical devices subject to formal oversight. The regulatory classification depends on intended use, risk level, and the claims made for the tool.</p>
<p>Jurisdictions differ in specifics, but common expectations include transparent descriptions of training data and known limitations, quantitative performance evidence across relevant subgroups, plans for post-market surveillance and incident reporting, and change management procedures for model updates. Beyond formal regulation, health systems typically require standard operating procedures for deployment and decommissioning, model cards describing training data and limitations, validation reports documenting evaluation evidence, and governance structures reviewing and approving new tools (<a href="../part_6/p6-ch27-regulatory.html#sec-ch27-regulatory" class="quarto-xref"><span>Section 27.1</span></a>).</p>
<p>Foundation models introduce additional documentation requirements. Descriptions of pretraining corpora must specify which genomes, assays, and populations were included. Fine-tuning datasets and label definitions require detailed documentation. Procedures for updating to new genome builds, reference panels, or assay types must be established and tested. The modular separation between pretrained encoders and clinical prediction heads can ease regulatory management by allowing independent updates to each component, but this requires careful version control and compatibility testing to ensure that updating one component does not degrade performance of the combined system.</p>
</section>
<section id="sec-ch28-case-studies" class="level2" data-number="28.11">
<h2 data-number="28.11" class="anchored" data-anchor-id="sec-ch28-case-studies"><span class="header-section-number">28.11</span> Case Studies</h2>
<p>Three stylized case studies illustrate how foundation model features integrate into clinical risk prediction across different disease contexts, time horizons, and decision types.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>As you read each case study, consider: (1) What specific clinical decision does the prediction inform? (2) What evidence would be required before deployment? (3) What equity considerations apply? These questions connect the abstract principles discussed earlier to concrete clinical scenarios.</p>
</div>
</div>
<section id="sec-ch28-case-cardio" class="level3" data-number="28.11.1">
<h3 data-number="28.11.1" class="anchored" data-anchor-id="sec-ch28-case-cardio"><span class="header-section-number">28.11.1</span> Cardiometabolic Risk Stratification</h3>
<p>A 52-year-old man presents to his primary care physician for an annual wellness visit. His LDL cholesterol is 145 mg/dL, blood pressure is 138/88 mmHg, and hemoglobin A1c is 5.9%, placing him in the prediabetic range. His father had a myocardial infarction at age 58. The standard Pooled Cohort Equations estimate his 10-year atherosclerotic cardiovascular disease risk at 8.2%, just below the threshold where guidelines recommend statin therapy.</p>
<p>A foundation model-augmented risk system could refine this assessment. Variant effect scores from DNA foundation models annotate variants in cardiometabolic risk loci with predicted regulatory and coding impacts, combining sequence-based scores with fine-mapping probabilities to prioritize likely causal variants (<a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-dna-vep" class="quarto-xref"><span>Section 18.3</span></a>; <a href="../part_4/p4-ch18-vep-fm.html#sec-ch18-combining-evidence" class="quarto-xref"><span>Section 18.4</span></a>). A polygenic embedding model like <em>Delphi</em> or <em>G2PT</em> produces a genome-wide representation capturing nonlinear risk structure beyond simple effect size sums <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="../bib/references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="../bib/references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. This genomic embedding combines with electronic health record features through an intermediate fusion architecture, producing an updated 10-year risk estimate of 11.4%, above the treatment threshold.</p>
<div id="fig-cardio-case-study" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cardio-case-study-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_7/ch28/07-fig-cardio-case-study.svg" class="img-fluid figure-img"></p>
<figcaption>FM-enhanced cardiovascular risk prediction case study</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cardio-case-study-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;28.7: Case study: FM-enhanced cardiovascular risk prediction. A 45-year-old male with family history integrates genetic PRS (enhanced by regulatory variant effects), LDLR coding variant (scored by AlphaMissense), inflammatory expression signature, and clinical features. FM-integrated prediction (28% 10-year risk) exceeds both traditional Framingham (18%) and PRS-only (24%) approaches. Clinical action: statin therapy with annual monitoring. Caveat: model validated primarily in European populations; additional caution warranted for other ancestries.
</figcaption>
</figure>
</div>
<p>The clinical value depends on what this refined estimate enables. If genomic foundation model features merely replicate traditional polygenic score information with higher computational cost, the benefit is marginal. But if the embedding captures pathway-level structure that identifies this patient’s risk as concentrating in LDL metabolism pathways rather than inflammatory or thrombotic mechanisms, that information might strengthen the indication for statin therapy specifically. Attention-based attributions highlighting which genomic regions contribute most to the elevated risk could inform counseling about heritability and family screening.</p>
<p>External validation across multiple health systems and ancestries would need to demonstrate that the foundation model approach provides calibrated predictions and meaningful reclassification improvement over traditional tools. Equity analysis would verify that performance holds across the diverse populations the health system serves rather than degrading for non-European ancestries underrepresented in training data.</p>
</section>
<section id="sec-ch28-case-oncology" class="level3" data-number="28.11.2">
<h3 data-number="28.11.2" class="anchored" data-anchor-id="sec-ch28-case-oncology"><span class="header-section-number">28.11.2</span> Oncology Prognosis</h3>
<p>A 64-year-old woman has undergone surgical resection for stage II colorectal cancer with microsatellite stable tumor characteristics. Her oncology team must decide whether adjuvant chemotherapy is warranted given the balance between recurrence risk reduction and treatment toxicity. Traditional staging provides prognostic information, but substantial heterogeneity exists within stage categories.</p>
<p>Foundation models can enrich prognostic assessment through multiple channels. Tumor mutation profiles encoded through models like <em>SetQuence</em> or <em>SetOmic</em> produce embeddings capturing the specific constellation of somatic alterations beyond simple mutation counts <span class="citation" data-cites="jurenaite_setquence_2024">(<a href="../bib/references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>)</span>. Transcriptomic profiling integrated through <em>GLUE</em>-style latent spaces adds expression context reflecting tumor microenvironment and pathway activity <span class="citation" data-cites="cao_glue_2022">(<a href="../bib/references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>)</span>. Graph neural network-based subtyping assigns the tumor to a molecular subtype with characteristic prognosis and treatment response patterns <span class="citation" data-cites="li_mogcn_2022">(<a href="../bib/references.html#ref-li_mogcn_2022" role="doc-biblioref">Li et al. 2022</a>)</span>.</p>
<p>These tumor-level representations combine with germline pharmacogenomic features (variants affecting fluoropyrimidine metabolism that influence toxicity risk) and clinical features (performance status, comorbidities, patient preferences) in a survival model predicting two-year recurrence hazard. A high-risk prediction might favor more intensive adjuvant therapy, while low-risk predictions might support observation with close surveillance.</p>
<p>The validation requirements are stringent. Retrospective analysis of institutional cohorts establishes proof of concept, but prospective validation in cohorts receiving contemporary treatment regimens is necessary given the rapid evolution of oncology care. Interpretability connecting predictions to specific mutations, pathways, or molecular subtypes supports clinical adoption by providing rationale beyond a black-box hazard estimate.</p>
</section>
<section id="sec-ch28-case-pharmacogenomics" class="level3" data-number="28.11.3">
<h3 data-number="28.11.3" class="anchored" data-anchor-id="sec-ch28-case-pharmacogenomics"><span class="header-section-number">28.11.3</span> Pharmacogenomic Adverse Event Prediction</h3>
<p>A 45-year-old man with newly diagnosed epilepsy requires anticonvulsant therapy. Carbamazepine is a common first-line choice, but it carries risk of severe cutaneous adverse reactions including Stevens-Johnson syndrome and toxic epidermal necrolysis. The <em>HLA-B*15:02</em> allele is strongly associated with carbamazepine hypersensitivity in patients of Asian ancestry, and FDA-approved drug labeling recommends genetic testing before initiating therapy in at-risk populations.</p>
<p>This established pharmacogenomic association illustrates both the potential and limitations of current approaches. Single-variant associations with high effect sizes enable straightforward clinical implementation, but they cover a small fraction of drug-gene interactions. Many patients who do not carry <em>HLA-B</em>15:02* still experience adverse reactions, suggesting additional genetic (and non-genetic) risk factors that single-variant testing misses.</p>
<p>Foundation models could extend pharmacogenomic prediction beyond established single-gene associations. Resources like PharmGKB <span class="citation" data-cites="whirl-carrillo_pharmacogenomics_2012">(<a href="../bib/references.html#ref-whirl-carrillo_pharmacogenomics_2012" role="doc-biblioref">Whirl-Carrillo et al. 2012</a>)</span> provide curated drug-gene-variant associations that serve as ground truth for model development and validation, though coverage remains incomplete for many drug classes. Variant effect scores across HLA genes, drug metabolism enzymes, and immune-related loci provide features reflecting the patient’s overall pharmacogenetic landscape (<a href="../part_1/p1-ch02-data.html#sec-ch02-pharmacogenomics" class="quarto-xref"><span>Section 2.8.4</span></a>). These features aggregate into a polygenic adverse event risk score that captures contributions from many variants rather than relying on individual high-effect alleles. Combined with clinical features (renal function affecting drug clearance, concomitant medications with interaction potential, prior adverse reaction history), the model predicts adverse event probability specific to the proposed drug.</p>
<p>The validation challenge is severe. Serious adverse drug reactions are rare, making endpoint ascertainment difficult and underpowered. Case-control designs enriched for adverse events may overestimate model performance compared to prospective deployment. Multi-site validation across healthcare systems with different prescribing patterns and population ancestry compositions is essential.</p>
<p>Clinical implementation requires integration at the point of prescribing, providing actionable information when drug selection decisions are being made. This argues for pre-computed pharmacogenomic profiles that alert at order entry rather than reactive testing after a prescription is written. The interpretability requirement is particularly acute: clinicians must understand why a model flags a patient as high-risk for a specific drug to make informed risk-benefit decisions.</p>
</section>
</section>
<section id="sec-ch28-translation-test" class="level2" data-number="28.12">
<h2 data-number="28.12" class="anchored" data-anchor-id="sec-ch28-translation-test"><span class="header-section-number">28.12</span> Translation as the Test</h2>
<p>Success for genomic foundation models in clinical medicine will depend less on model scale and more on rigorous translation. Problem definition, evidence generation, equity evaluation, regulatory compliance, workflow integration, and post-deployment monitoring each introduce opportunities for failure. Models that clear all hurdles are rare; models that skip stages fail in deployment regardless of their technical sophistication.</p>
<p>The representational advances that foundation models provide become valuable only when they flow through validated, equitable, well-integrated clinical tools into decisions that improve patient outcomes. A pathogenicity score with state-of-the-art discrimination adds nothing to care if it reaches clinicians at the wrong moment, in the wrong format, without appropriate uncertainty communication. A risk prediction that performs excellently on average but fails systematically for underrepresented populations may widen health disparities rather than narrow them. Technical capability is necessary but not sufficient for clinical impact.</p>
<p>Rare disease diagnosis illustrates these translation principles in a particularly high-stakes context: where risk prediction addresses population-level stratification, variant interpretation addresses individual patients, with different evidence requirements, clinical workflows, and definitions of success (<a href="p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>What are the three main limitations of traditional polygenic risk scores that foundation model features aim to address?</li>
<li>Compare early, intermediate, and late fusion architectures for integrating genomic and clinical features. When would you choose each approach?</li>
<li>Why is calibration distinct from discrimination, and why does it matter for clinical deployment?</li>
<li>How does bias compound through the genomic AI pipeline, from GWAS to foundation model predictions?</li>
<li>What is the difference between analytical validity, clinical validity, and clinical utility? Give an example where a model has one but not the others.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>PRS Limitations</strong>: Traditional polygenic scores have three main limitations: (1) they lack mechanistic insight by reducing genomes to single numbers without indicating which biological pathways drive risk, (2) they show poor cross-ancestry portability because they are derived from European-dominated GWAS data and depend on population-specific linkage disequilibrium patterns, and (3) they remain disconnected from clinical workflows by existing outside electronic health records where decisions actually happen. Foundation model embeddings address these by preserving information about which genomic regions contribute to risk, leveraging sequence-based functional priors that transfer across ancestries, and enabling integration architectures that combine genomic and clinical data within EHR systems.</p></li>
<li><p><strong>Fusion Architectures</strong>: Early fusion concatenates all features into a single input and trains a unified model, allowing arbitrary interactions but requiring complete data for all patients and risking dominance by the strongest signal source. Intermediate fusion trains separate encoders for each modality then combines their embeddings through attention or cross-modal transformers, offering modularity and graceful degradation while still capturing cross-modal interactions. Late fusion trains independent models per modality and combines their predictions through ensemble methods, handling missing data excellently but potentially underutilizing cross-modal structure. Choose early fusion for dense complete datasets, intermediate fusion for evolving foundation model ecosystems requiring modularity, and late fusion when data availability varies substantially across patients.</p></li>
<li><p><strong>Calibration vs Discrimination</strong>: Discrimination measures how well a model ranks patients by risk (whether those who develop disease score higher than those who do not), typically assessed via auROC. Calibration measures whether predicted probabilities match observed frequencies (whether patients assigned 20% risk actually experience events at 20% rate). A model can have excellent discrimination but poor calibration if it correctly ranks patients but systematically over- or underestimates absolute risk magnitudes. This matters for clinical deployment because treatment decisions depend on absolute risk thresholds: miscalibrated predictions lead to inappropriate treatment (undertreatment if risks are underestimated, overtreatment if inflated) even when patient ranking is correct.</p></li>
<li><p><strong>Bias Compounding</strong>: Bias accumulates at each stage of the genomic AI pipeline due to European ancestry overrepresentation in genomic datasets. GWAS discovery power is reduced for non-European populations, leading to weaker effect size estimates. Fine-mapping resolution suffers because linkage disequilibrium patterns differ across ancestries. Variant effect predictors have fewer training examples from underrepresented populations. Polygenic scores built from these components show poor portability and reduced accuracy. Foundation model embeddings trained on biased data produce less calibrated representations for non-European ancestries. Each layer inherits and potentially amplifies the biases of preceding layers, making ancestry-stratified evaluation essential at every stage rather than only at final deployment.</p></li>
<li><p><strong>Validity Levels</strong>: Analytical validity means the test accurately measures what it claims (e.g., genotyping array correctly calls variants). Clinical validity means the measurement associates with the clinical outcome (e.g., polygenic score correlates with disease risk). Clinical utility means using the test improves patient outcomes (e.g., knowing the score leads to interventions that reduce disease incidence). A model can have high analytical and clinical validity but no clinical utility if the resulting predictions do not change clinical decisions: for example, a perfectly accurate test for a biomarker that strongly predicts disease but for which no effective interventions exist would have excellent validity but provide no utility since knowing the result does not enable actions that improve outcomes.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p>This chapter examined the translation of genomic foundation models into clinical risk prediction tools that can improve patient outcomes.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><p><strong>From PRS to embeddings:</strong> Traditional polygenic scores are scalar summaries with limited mechanistic insight and poor cross-ancestry portability. Foundation models produce rich embeddings that preserve information about which variants matter, how they interact, and why they contribute to risk.</p></li>
<li><p><strong>Fusion architectures:</strong> Early, intermediate, and late fusion strategies offer different tradeoffs for combining genomic and clinical features. Intermediate fusion typically provides the best balance of modularity, cross-modal learning, and graceful degradation for missing data.</p></li>
<li><p><strong>Evaluation beyond discrimination:</strong> Clinical deployment requires not just good ranking (discrimination) but also accurate probability estimates (calibration) and demonstrated benefit over existing tools (clinical utility). Each must be evaluated across clinically relevant subgroups.</p></li>
<li><p><strong>Validation hierarchy:</strong> Evidence strength increases from internal validation through external validation, prospective observational studies, and prospective interventional trials. Most foundation model tools require at minimum robust external validation.</p></li>
<li><p><strong>Uncertainty quantification:</strong> Distinguishing aleatoric (irreducible) from epistemic (model-limited) uncertainty enables appropriate clinical responses. Selective prediction allows abstention when confidence is low.</p></li>
<li><p><strong>Equity as design principle:</strong> Bias compounds through the genomic AI pipeline. Equity evaluation must span discrimination, calibration, and clinical utility across ancestry, sex, and socioeconomic subgroups. Technical mitigation alone cannot overcome structural inequities.</p></li>
<li><p><strong>Workflow integration:</strong> Valid models fail in practice without appropriate integration into clinical workflows, monitoring for drift, and governance structures for oversight and incident response.</p></li>
</ul>
<p><strong>Looking Ahead:</strong> <a href="p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a> applies these translation principles to rare disease diagnosis, where the stakes are individual patients rather than population-level risk stratification, and where foundation models offer particularly compelling advantages over traditional approaches.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-benegas_gpn_2023" class="csl-entry" role="listitem">
Benegas, Gonzalo, Sanjit Singh Batra, and Yun S. Song. 2023. <span>“[<span>GPN</span>] <span>DNA</span> Language Models Are Powerful Predictors of Genome-Wide Variant Effects.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (44): e2311219120. <a href="https://doi.org/10.1073/pnas.2311219120">https://doi.org/10.1073/pnas.2311219120</a>.
</div>
<div id="ref-camillo_cpgpt_2024" class="csl-entry" role="listitem">
Camillo, Lucas Paulo de Lima, Raghav Sehgal, Jenel Armstrong, Albert T. Higgins-Chen, Steve Horvath, and Bo Wang. 2024. <span>“<span>CpGPT</span>: A <span>Foundation</span> <span>Model</span> for <span>DNA</span> <span>Methylation</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.24.619766">https://doi.org/10.1101/2024.10.24.619766</a>.
</div>
<div id="ref-cao_glue_2022" class="csl-entry" role="listitem">
Cao, Zhi-Jie, and Ge Gao. 2022. <span>“[<span>GLUE</span>] <span>Multi</span>-Omics Single-Cell Data Integration and Regulatory Inference with Graph-Linked Embedding.”</span> <em>Nature Biotechnology</em> 40 (10): 1458–66. <a href="https://doi.org/10.1038/s41587-022-01284-4">https://doi.org/10.1038/s41587-022-01284-4</a>.
</div>
<div id="ref-clarke_deeprvat_2024" class="csl-entry" role="listitem">
Clarke, Brian, Eva Holtkamp, Hakime Öztürk, Marcel Mück, Magnus Wahlberg, Kayla Meyer, Felix Munzlinger, et al. 2024. <span>“[<span>DeepRVAT</span>] <span>Integration</span> of Variant Annotations Using Deep Set Networks Boosts Rare Variant Association Testing.”</span> <em>Nature Genetics</em> 56 (10): 2271–80. <a href="https://doi.org/10.1038/s41588-024-01919-z">https://doi.org/10.1038/s41588-024-01919-z</a>.
</div>
<div id="ref-dalla-torre_nucleotide_2023" class="csl-entry" role="listitem">
Dalla-Torre, Hugo, Liam Gonzalez, Javier Mendoza-Revilla, Nicolas Lopez Carranza, Adam Henryk Grzywaczewski, Francesco Oteri, Christian Dallago, et al. 2023. <span>“Nucleotide <span>Transformer</span>: Building and Evaluating Robust Foundation Models for Human Genomics.”</span> <em>Nature Methods</em> 22 (2): 287–97. <a href="https://doi.org/10.1038/s41592-024-02523-z">https://doi.org/10.1038/s41592-024-02523-z</a>.
</div>
<div id="ref-dibaeinia_prsformer_2025" class="csl-entry" role="listitem">
Dibaeinia, Payam, Chris German, Suyash Shringarpure, Adam Auton, and Aly A. Khan. 2025. <span>“<span>PRSformer</span>: <span>Disease</span> <span>Prediction</span> from <span>Million</span>-<span>Scale</span> <span>Individual</span> <span>Genotypes</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2025.10.26.684578">https://doi.org/10.1101/2025.10.26.684578</a>.
</div>
<div id="ref-elgart_non-linear_2022" class="csl-entry" role="listitem">
Elgart, Michael, Genevieve Lyons, Santiago Romero-Brufau, Nuzulul Kurniansyah, Jennifer A. Brody, Xiuqing Guo, Henry J. Lin, et al. 2022. <span>“Non-Linear Machine Learning Models Incorporating <span>SNPs</span> and <span>PRS</span> Improve Polygenic Prediction in Diverse Human Populations.”</span> <em>Communications Biology</em> 5 (1): 856. <a href="https://doi.org/10.1038/s42003-022-03812-z">https://doi.org/10.1038/s42003-022-03812-z</a>.
</div>
<div id="ref-ge_polygenic_2019" class="csl-entry" role="listitem">
Ge, Tian, Chia-Yen Chen, Yang Ni, Yen-Chen Anne Feng, and Jordan W. Smoller. 2019. <span>“Polygenic Prediction via <span>Bayesian</span> Regression and Continuous Shrinkage Priors.”</span> <em>Nature Communications</em> 10 (1): 1776. <a href="https://doi.org/10.1038/s41467-019-09718-5">https://doi.org/10.1038/s41467-019-09718-5</a>.
</div>
<div id="ref-georgantas_delphi_2024" class="csl-entry" role="listitem">
Georgantas, Costa, Zoltán Kutalik, and Jonas Richiardi. 2024. <span>“Delphi: <span>A</span> <span>Deep</span>-Learning <span>Method</span> for <span>Polygenic</span> <span>Risk</span> <span>Prediction</span>.”</span> medRxiv. <a href="https://doi.org/10.1101/2024.04.19.24306079">https://doi.org/10.1101/2024.04.19.24306079</a>.
</div>
<div id="ref-jurenaite_setquence_2024" class="csl-entry" role="listitem">
Jurenaite, Neringa, Daniel León-Periñán, Veronika Donath, Sunna Torge, and René Jäkel. 2024. <span>“<span>SetQuence</span> &amp; <span>SetOmic</span>: <span>Deep</span> Set Transformers for Whole Genome and Exome Tumour Analysis.”</span> <em>BioSystems</em> 235 (January): 105095. <a href="https://doi.org/10.1016/j.biosystems.2023.105095">https://doi.org/10.1016/j.biosystems.2023.105095</a>.
</div>
<div id="ref-katzman_deepsurv_2018" class="csl-entry" role="listitem">
Katzman, Jared L., Uri Shaham, Alexander Cloninger, Jonathan Bates, Tingting Jiang, and Yuval Kluger. 2018. <span>“<span>DeepSurv</span>: Personalized Treatment Recommender System Using a <span>Cox</span> Proportional Hazards Deep Neural Network.”</span> <em>BMC Medical Research Methodology</em> 18 (1): 24. <a href="https://doi.org/10.1186/s12874-018-0482-1">https://doi.org/10.1186/s12874-018-0482-1</a>.
</div>
<div id="ref-lee_g2pt_2025" class="csl-entry" role="listitem">
Lee, Ingoo, Zachary S. Wallace, Yuqi Wang, Sungjoon Park, Hojung Nam, Amit R. Majithia, and Trey Ideker. 2025. <span>“[<span>G2PT</span>] <span>A</span> Genotype-Phenotype Transformer to Assess and Explain Polygenic Risk.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.23.619940">https://doi.org/10.1101/2024.10.23.619940</a>.
</div>
<div id="ref-li_mogcn_2022" class="csl-entry" role="listitem">
Li, Xiao, Jie Ma, Ling Leng, Mingfei Han, Mansheng Li, Fuchu He, and Yunping Zhu. 2022. <span>“<span>MoGCN</span>: <span>A</span> <span>Multi</span>-<span>Omics</span> <span>Integration</span> <span>Method</span> <span>Based</span> on <span>Graph</span> <span>Convolutional</span> <span>Network</span> for <span>Cancer</span> <span>Subtype</span> <span>Analysis</span>.”</span> <em>Frontiers in Genetics</em> 13 (February). <a href="https://doi.org/10.3389/fgene.2022.806842">https://doi.org/10.3389/fgene.2022.806842</a>.
</div>
<div id="ref-nagpal_deep_2021" class="csl-entry" role="listitem">
Nagpal, Chirag, Xinyu Li, and Artur Dubrawski. 2021. <span>“Deep <span>Survival</span> <span>Machines</span>: <span>Fully</span> <span>Parametric</span> <span>Survival</span> <span>Regression</span> and <span>Representation</span> <span>Learning</span> for <span>Censored</span> <span>Data</span> <span>With</span> <span>Competing</span> <span>Risks</span>.”</span> <em>IEEE Journal of Biomedical and Health Informatics</em> 25 (8): 3163–75. <a href="https://doi.org/10.1109/JBHI.2021.3052441">https://doi.org/10.1109/JBHI.2021.3052441</a>.
</div>
<div id="ref-nguyen_hyenadna_2023" class="csl-entry" role="listitem">
Nguyen, Eric, Michael Poli, Marjan Faizi, Armin Thomas, Callum Birch-Sykes, Michael Wornow, Aman Patel, et al. 2023. <span>“<span>HyenaDNA</span>: <span>Long</span>-<span>Range</span> <span>Genomic</span> <span>Sequence</span> <span>Modeling</span> at <span>Single</span> <span>Nucleotide</span> <span>Resolution</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2306.15794">https://doi.org/10.48550/arXiv.2306.15794</a>.
</div>
<div id="ref-rakowski_mifm_2025" class="csl-entry" role="listitem">
Rakowski, Alexander, and Christoph Lippert. 2025. <span>“[<span>MIFM</span>] <span>Multiple</span> Instance Fine-Mapping: Predicting Causal Regulatory Variants with a Deep Sequence Model.”</span> medRxiv. <a href="https://doi.org/10.1101/2025.06.13.25329551">https://doi.org/10.1101/2025.06.13.25329551</a>.
</div>
<div id="ref-ruan_improving_2022" class="csl-entry" role="listitem">
Ruan, Yunfeng, Yen-Feng Lin, Yen-Chen Anne Feng, Chia-Yen Chen, Max Lam, Zhenglin Guo, Lin He, et al. 2022. <span>“Improving Polygenic Prediction in Ancestrally Diverse Populations.”</span> <em>Nature Genetics</em> 54 (5): 573–80. <a href="https://doi.org/10.1038/s41588-022-01054-7">https://doi.org/10.1038/s41588-022-01054-7</a>.
</div>
<div id="ref-tipirneni_self-supervised_2022" class="csl-entry" role="listitem">
Tipirneni, Sindhu, and Chandan K. Reddy. 2022. <span>“Self-<span>Supervised</span> <span>Transformer</span> for <span>Sparse</span> and <span>Irregularly</span> <span>Sampled</span> <span>Multivariate</span> <span>Clinical</span> <span>Time</span>-<span>Series</span>.”</span> <em>ACM Trans. Knowl. Discov. Data</em> 16 (6): 105:1–17. <a href="https://doi.org/10.1145/3516367">https://doi.org/10.1145/3516367</a>.
</div>
<div id="ref-whirl-carrillo_pharmacogenomics_2012" class="csl-entry" role="listitem">
Whirl-Carrillo, M, E M McDonagh, J M Hebert, L Gong, K Sangkuhl, C F Thorn, R B Altman, and T E Klein. 2012. <span>“Pharmacogenomics <span>Knowledge</span> for <span>Personalized</span> <span>Medicine</span>.”</span> <em>Clinical Pharmacology &amp; Therapeutics</em> 92 (4): 414–17. <a href="https://doi.org/10.1038/clpt.2012.96">https://doi.org/10.1038/clpt.2012.96</a>.
</div>
<div id="ref-yun_regle_2023" class="csl-entry" role="listitem">
Yun, Taedong, Justin Cosentino, Babak Behsaz, Zachary R. McCaw, Davin Hill, Robert Luben, Dongbing Lai, et al. 2023. <span>“[<span>REGLE</span>] <span>Unsupervised</span> Representation Learning Improves Genomic Discovery and Risk Prediction for Respiratory and Circulatory Functions and Diseases.”</span> medRxiv. <a href="https://doi.org/10.1101/2023.04.28.23289285">https://doi.org/10.1101/2023.04.28.23289285</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_7/p7--applications.html" class="pagination-link" aria-label="Part VII: Applications &amp; Frontiers">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part VII: Applications &amp; Frontiers</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_7/p7-ch29-rare-disease.html" class="pagination-link" aria-label="Rare Disease Diagnosis">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>