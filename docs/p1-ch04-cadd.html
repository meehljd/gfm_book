<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Deleteriousness Scores – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p2-ch05-reg.html" rel="next">
<link href="./p1-ch03-pgs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html">Part I: Data &amp; Pre-DL Methods</a></li><li class="breadcrumb-item"><a href="./p1-ch04-cadd.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Data &amp; Pre-DL Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NGS &amp; Variant Calling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Foundational Genomics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: CNN Seq-to-Function Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regulatory Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transcriptional Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-splice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Splicing Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Transformers Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch08-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch09-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">DNA Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Long-range Hybrid Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: GFMs &amp; Multi-omics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch12-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch13-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch14-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics &amp; Systems Context</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Reliability &amp; Interpretation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch15-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Model Evaluation &amp; Benchmarks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch16-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch17-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part VI: Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch18-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch19-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch20-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-variant-prioritization-challenge" id="toc-the-variant-prioritization-challenge" class="nav-link active" data-scroll-target="#the-variant-prioritization-challenge"><span class="header-section-number">4.1</span> The Variant Prioritization Challenge</a></li>
  <li><a href="#the-evolutionary-proxy-training-strategy" id="toc-the-evolutionary-proxy-training-strategy" class="nav-link" data-scroll-target="#the-evolutionary-proxy-training-strategy"><span class="header-section-number">4.2</span> The Evolutionary Proxy Training Strategy</a>
  <ul class="collapse">
  <li><a href="#proxy-neutral-variants" id="toc-proxy-neutral-variants" class="nav-link" data-scroll-target="#proxy-neutral-variants"><span class="header-section-number">4.2.1</span> Proxy-Neutral Variants</a></li>
  <li><a href="#proxy-deleterious-variants" id="toc-proxy-deleterious-variants" class="nav-link" data-scroll-target="#proxy-deleterious-variants"><span class="header-section-number">4.2.2</span> Proxy-Deleterious Variants</a></li>
  <li><a href="#training-objective" id="toc-training-objective" class="nav-link" data-scroll-target="#training-objective"><span class="header-section-number">4.2.3</span> Training Objective</a></li>
  </ul></li>
  <li><a href="#integration-of-diverse-annotations" id="toc-integration-of-diverse-annotations" class="nav-link" data-scroll-target="#integration-of-diverse-annotations"><span class="header-section-number">4.3</span> Integration of Diverse Annotations</a>
  <ul class="collapse">
  <li><a href="#gene-model-annotations" id="toc-gene-model-annotations" class="nav-link" data-scroll-target="#gene-model-annotations"><span class="header-section-number">4.3.1</span> Gene Model Annotations</a></li>
  <li><a href="#conservation-and-constraint" id="toc-conservation-and-constraint" class="nav-link" data-scroll-target="#conservation-and-constraint"><span class="header-section-number">4.3.2</span> Conservation and Constraint</a></li>
  <li><a href="#epigenetic-and-regulatory-activity" id="toc-epigenetic-and-regulatory-activity" class="nav-link" data-scroll-target="#epigenetic-and-regulatory-activity"><span class="header-section-number">4.3.3</span> Epigenetic and Regulatory Activity</a></li>
  <li><a href="#additional-features" id="toc-additional-features" class="nav-link" data-scroll-target="#additional-features"><span class="header-section-number">4.3.4</span> Additional Features</a></li>
  </ul></li>
  <li><a href="#model-architecture-and-scoring" id="toc-model-architecture-and-scoring" class="nav-link" data-scroll-target="#model-architecture-and-scoring"><span class="header-section-number">4.4</span> Model Architecture and Scoring</a>
  <ul class="collapse">
  <li><a href="#machine-learning-framework" id="toc-machine-learning-framework" class="nav-link" data-scroll-target="#machine-learning-framework"><span class="header-section-number">4.4.1</span> Machine Learning Framework</a></li>
  <li><a href="#phred-scaled-scores" id="toc-phred-scaled-scores" class="nav-link" data-scroll-target="#phred-scaled-scores"><span class="header-section-number">4.4.2</span> PHRED-Scaled Scores</a></li>
  </ul></li>
  <li><a href="#cadd-v1.7-integration-of-deep-learning-predictions" id="toc-cadd-v1.7-integration-of-deep-learning-predictions" class="nav-link" data-scroll-target="#cadd-v1.7-integration-of-deep-learning-predictions"><span class="header-section-number">4.5</span> CADD v1.7: Integration of Deep Learning Predictions</a>
  <ul class="collapse">
  <li><a href="#protein-language-model-features" id="toc-protein-language-model-features" class="nav-link" data-scroll-target="#protein-language-model-features"><span class="header-section-number">4.5.1</span> Protein Language Model Features</a></li>
  <li><a href="#regulatory-cnn-predictions" id="toc-regulatory-cnn-predictions" class="nav-link" data-scroll-target="#regulatory-cnn-predictions"><span class="header-section-number">4.5.2</span> Regulatory CNN Predictions</a></li>
  <li><a href="#extended-conservation-scores" id="toc-extended-conservation-scores" class="nav-link" data-scroll-target="#extended-conservation-scores"><span class="header-section-number">4.5.3</span> Extended Conservation Scores</a></li>
  <li><a href="#performance-improvements" id="toc-performance-improvements" class="nav-link" data-scroll-target="#performance-improvements"><span class="header-section-number">4.5.4</span> Performance Improvements</a></li>
  </ul></li>
  <li><a href="#benchmarking-against-alternative-approaches" id="toc-benchmarking-against-alternative-approaches" class="nav-link" data-scroll-target="#benchmarking-against-alternative-approaches"><span class="header-section-number">4.6</span> Benchmarking Against Alternative Approaches</a>
  <ul class="collapse">
  <li><a href="#coding-variants" id="toc-coding-variants" class="nav-link" data-scroll-target="#coding-variants"><span class="header-section-number">4.6.1</span> Coding Variants</a></li>
  <li><a href="#non-coding-variants" id="toc-non-coding-variants" class="nav-link" data-scroll-target="#non-coding-variants"><span class="header-section-number">4.6.2</span> Non-coding Variants</a></li>
  <li><a href="#population-frequency-correlation" id="toc-population-frequency-correlation" class="nav-link" data-scroll-target="#population-frequency-correlation"><span class="header-section-number">4.6.3</span> Population Frequency Correlation</a></li>
  <li><a href="#limitations-and-circularity-with-clinvar" id="toc-limitations-and-circularity-with-clinvar" class="nav-link" data-scroll-target="#limitations-and-circularity-with-clinvar"><span class="header-section-number">4.6.4</span> Limitations and Circularity with ClinVar</a></li>
  </ul></li>
  <li><a href="#significance-for-genomic-deep-learning" id="toc-significance-for-genomic-deep-learning" class="nav-link" data-scroll-target="#significance-for-genomic-deep-learning"><span class="header-section-number">4.7</span> Significance for Genomic Deep Learning</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p1-ch01-ngs.html">Part I: Data &amp; Pre-DL Methods</a></li><li class="breadcrumb-item"><a href="./p1-ch04-cadd.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-cadd" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>…</li>
<li>…</li>
</ul>
</div>
</div>
<section id="the-variant-prioritization-challenge" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-variant-prioritization-challenge"><span class="header-section-number">4.1</span> The Variant Prioritization Challenge</h2>
<p>Across a typical human genome there are millions of variants—most of them rare, and the vast majority functionally neutral. For any individual with a suspected genetic condition, the central interpretability problem is to identify the handful of variants that plausibly contribute to disease from this enormous background.</p>
<p>The data resources in <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> give us multiple, complementary views:</p>
<ul>
<li><strong>Population frequency</strong> from gnomAD and related resources tells us what variation survives in large cohorts of ostensibly healthy individuals <span class="citation" data-cites="gnomAD">(<a href="references.html#ref-gnomAD" role="doc-biblioref"><span>“The <span>Genome</span> <span>Aggregation</span> <span>Database</span> (<span class="nocase">gnomAD</span>)”</span> n.d.</a>)</span>.</li>
<li><strong>Functional genomics</strong> from ENCODE, Roadmap, and other consortia indicates which regions are biochemically active.</li>
<li><strong>Clinical databases</strong> such as ClinVar and HGMD collect expert-curated variant classifications from case reports and diagnostic labs.</li>
</ul>
<p>Each source is partial. Population databases are dominated by common, mostly tolerated variants. Functional genomics data is noisy and often context-specific. Clinical databases are sparse and heavily biased toward well-studied genes and variant types.</p>
<p>Before deep learning, many variant effect predictors tackled this problem by focusing on <strong>one narrow signal</strong>:</p>
<ul>
<li>Sequence conservation (e.g., phyloP (<span class="citation" data-cites="siepel_phastcons_2005">Siepel et al. (<a href="references.html#ref-siepel_phastcons_2005" role="doc-biblioref">2005</a>)</span>), GERP (<span class="citation" data-cites="davydov_gerp_2010">Davydov et al. (<a href="references.html#ref-davydov_gerp_2010" role="doc-biblioref">2010</a>)</span>))</li>
<li>Protein-level features (e.g., SIFT (<span class="citation" data-cites="ng_sift_2003">Ng and Henikoff (<a href="references.html#ref-ng_sift_2003" role="doc-biblioref">2003</a>)</span>), PolyPhen (<span class="citation" data-cites="adzhubei_polyphen_2010">Adzhubei et al. (<a href="references.html#ref-adzhubei_polyphen_2010" role="doc-biblioref">2010</a>)</span>))</li>
<li>Simple positional annotations (e.g., distance to splice sites)</li>
</ul>
<p><a href="https://cadd.gs.washington.edu/">Combined Annotation-Dependent Depletion (CADD)</a> was a step change: it defined a <strong>general framework</strong> for genome-wide variant prioritization that integrates dozens of heterogeneous annotations and uses <strong>evolutionary depletion as a proxy label</strong> <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>. Rather than training directly on small sets of known pathogenic vs benign variants, CADD contrasts variants that survived purifying selection in humans with matched simulated variants that “could have occurred but did not.”</p>
<p>This chapter focuses on the CADD framework because it establishes design patterns that show up repeatedly in later deep learning models: proxy labels, large-scale training, integration of diverse features, and genome-wide coverage.</p>
</section>
<section id="the-evolutionary-proxy-training-strategy" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-evolutionary-proxy-training-strategy"><span class="header-section-number">4.2</span> The Evolutionary Proxy Training Strategy</h2>
<p>CADD’s most important conceptual move was to avoid the scarcity and bias of curated pathogenic variants by constructing a <strong>synthetic classification problem</strong>:</p>
<blockquote class="blockquote">
<p>“How different do the annotations of observed human variants look from those of matched, simulated variants that have <em>not</em> survived evolution?”</p>
</blockquote>
<section id="proxy-neutral-variants" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="proxy-neutral-variants"><span class="header-section-number">4.2.1</span> Proxy-Neutral Variants</h3>
<p>CADD defines a <strong>proxy-neutral</strong> class from variants that are actually observed in human populations:</p>
<ul>
<li>Single nucleotide variants (SNVs) and short indels from large sequencing datasets such as the 1000 Genomes Project and early gnomAD-like resources.</li>
<li>Typically restricted to variants with high derived allele frequency (DAF), under the assumption that alleles that have drifted to high frequency are unlikely to be strongly deleterious over recent human evolutionary time.</li>
</ul>
<p>These variants are not guaranteed to be benign, but, on average, they are <strong>enriched for tolerated alleles</strong> that have survived purifying selection.</p>
</section>
<section id="proxy-deleterious-variants" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="proxy-deleterious-variants"><span class="header-section-number">4.2.2</span> Proxy-Deleterious Variants</h3>
<p>To construct the opposing class, CADD <strong>simulates mutations</strong> across the genome:</p>
<ul>
<li>The simulation matches local trinucleotide (or more complex) sequence context so that the spectrum of simulated mutations reflects realistic mutation processes.</li>
<li>Mutation rates are scaled in local genomic windows to approximate heterogeneous mutation rates (e.g., elevated at CpGs) <span class="citation" data-cites="rentzsch_cadd_2019 schubach_cadd_2024">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</li>
<li>The key idea is that simulated variants represent changes that <em>could</em> occur but are generally <em>not</em> observed at high frequency in large cohorts.</li>
</ul>
<p>These simulated variants are treated as <strong>proxy-deleterious</strong>: enriched for potential alleles that are disfavored by selection, even though many individual simulated variants will in fact be neutral.</p>
</section>
<section id="training-objective" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="training-objective"><span class="header-section-number">4.2.3</span> Training Objective</h3>
<p>With proxy-neutral and proxy-deleterious sets in hand, CADD trains a <strong>binary classifier</strong>:</p>
<ul>
<li>Input: a vector of annotations describing each variant (Section “Integration of Diverse Annotations”).</li>
<li>Label: simulated (proxy-deleterious) vs observed (proxy-neutral).</li>
<li>Objective: learn a scoring function that assigns higher scores to simulated variants.</li>
</ul>
<p>Early CADD models used linear support vector machines trained on millions of simulated vs observed variants with dozens of annotations <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>. Later versions, including CADD v1.7, use a <strong>logistic regression–style machine learning model</strong> over an expanded feature set to assign numerical deleteriousness scores to all possible SNVs and small indels <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
<p>This “evolutionary depletion” setup is conceptually similar to modern self-supervised learning:</p>
<ul>
<li>The labels are <strong>not clinical</strong> (pathogenic vs benign) but derived from a <strong>proxy signal</strong> (survival under selection).</li>
<li>The training set is extremely large (tens of millions of variants), enabling complex models and rich decision boundaries.</li>
<li>The resulting scores are then <strong>re-used downstream</strong> for many different tasks—rare disease gene discovery, variant filtration pipelines, and evaluation baselines.</li>
</ul>
</section>
</section>
<section id="integration-of-diverse-annotations" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="integration-of-diverse-annotations"><span class="header-section-number">4.3</span> Integration of Diverse Annotations</h2>
<p>CADD’s second pillar is <strong>integrating many weak, noisy annotations into a single composite score</strong>. Where earlier tools might rely on one or a few scores, CADD combines more than 60 features in its original incarnation and substantially more in v1.7 <span class="citation" data-cites="rentzsch_cadd_2019 schubach_cadd_2024">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
<p>Because <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> already surveys the underlying resources, we focus here on the <em>categories</em> of features and how they function in CADD. For details on individual databases (ENCODE, Roadmap, gnomAD, ClinVar, etc.), see <a href="p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a>.</p>
<section id="gene-model-annotations" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="gene-model-annotations"><span class="header-section-number">4.3.1</span> Gene Model Annotations</h3>
<p>These features describe the <strong>local gene and transcript context</strong> of each variant:</p>
<ul>
<li>Sequence consequence (e.g., synonymous, missense, nonsense, frameshift, splice site).</li>
<li>Distance to exon–intron boundaries and untranslated regions.</li>
<li>Gene-level attributes, such as known disease associations or gene constraint metrics (e.g., pLI, LOEUF), derived from population data <span class="citation" data-cites="gnomAD">(<a href="references.html#ref-gnomAD" role="doc-biblioref"><span>“The <span>Genome</span> <span>Aggregation</span> <span>Database</span> (<span class="nocase">gnomAD</span>)”</span> n.d.</a>)</span>.</li>
</ul>
<p>These annotations allow CADD to distinguish, for example, a synonymous variant in a tolerant gene from a truncating variant in a highly constrained gene.</p>
</section>
<section id="conservation-and-constraint" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="conservation-and-constraint"><span class="header-section-number">4.3.2</span> Conservation and Constraint</h3>
<p>A major feature block captures <strong>evolutionary conservation</strong>:</p>
<ul>
<li>Base-level conservation metrics such as GERP, phastCons, and phyloP, computed over multi-species alignments (<span class="citation" data-cites="siepel_phastcons_2005">Siepel et al. (<a href="references.html#ref-siepel_phastcons_2005" role="doc-biblioref">2005</a>)</span>, <span class="citation" data-cites="davydov_gerp_2010">Davydov et al. (<a href="references.html#ref-davydov_gerp_2010" role="doc-biblioref">2010</a>)</span>).</li>
<li>Regional measures of evolutionary constraint and mutation rate.</li>
</ul>
<p>Highly conserved positions tend to be functionally important. CADD uses these conservation scores as some of its strongest signals that a variant may be deleterious, particularly in non-coding regions where direct functional labels are scarce <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>.</p>
</section>
<section id="epigenetic-and-regulatory-activity" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="epigenetic-and-regulatory-activity"><span class="header-section-number">4.3.3</span> Epigenetic and Regulatory Activity</h3>
<p>CADD also incorporates <strong>regulatory annotations</strong> derived from functional genomics:</p>
<ul>
<li>DNase I hypersensitivity and ATAC-seq peaks.</li>
<li>ChIP–seq signals for histone marks and transcription factors (from ENCODE, Roadmap, and related efforts).</li>
<li>Chromatin state segmentations that summarize combinatorial patterns of marks.</li>
</ul>
<p>These features provide a view of whether a variant lies in an active enhancer, promoter, or other regulatory element, and help prioritize non-coding variants that disrupt regulatory regions.</p>
</section>
<section id="additional-features" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="additional-features"><span class="header-section-number">4.3.4</span> Additional Features</h3>
<p>Additional features capture <strong>sequence and genomic context</strong>:</p>
<ul>
<li>Local GC content and CpG dinucleotide context.</li>
<li>Segmental duplications and low-complexity regions.</li>
<li>Protein-level features for coding variants, such as amino acid properties and legacy scores like SIFT and PolyPhen <span class="citation" data-cites="ng_sift_2003">Adzhubei et al. (<a href="references.html#ref-adzhubei_polyphen_2010" role="doc-biblioref">2010</a>)</span>.</li>
</ul>
<p>Not every individual annotation is informative in isolation. The power of CADD lies in learning <strong>how to weight and combine</strong> these heterogeneous signals.</p>
</section>
</section>
<section id="model-architecture-and-scoring" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="model-architecture-and-scoring"><span class="header-section-number">4.4</span> Model Architecture and Scoring</h2>
<section id="machine-learning-framework" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="machine-learning-framework"><span class="header-section-number">4.4.1</span> Machine Learning Framework</h3>
<p>CADD’s classifier operates on a high-dimensional feature vector <span class="math inline">\(x\)</span> for each variant:</p>
<ul>
<li>In early versions, a <strong>linear SVM</strong> was trained on ~30 million observed and simulated variants with 63 annotations, plus some interaction terms <span class="citation" data-cites="rentzsch_cadd_2019 rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>, <a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">2019</a>)</span>.</li>
<li>In CADD v1.7, the framework uses a logistic regression–style model and an expanded annotation set but retains the same basic paradigm of contrasting simulated and observed variants <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</li>
</ul>
<p>Conceptually, the classifier learns a score <span class="math inline">\(s(x)\)</span> such that:</p>
<ul>
<li>Large positive values indicate variants whose annotation profiles resemble the <strong>proxy-deleterious</strong> class.</li>
<li>Large negative values indicate variants whose profiles resemble the <strong>proxy-neutral</strong> class.</li>
</ul>
<p>The raw output of this classifier is often referred to as the <strong>C-score</strong> or <strong>raw CADD score</strong>.</p>
</section>
<section id="phred-scaled-scores" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="phred-scaled-scores"><span class="header-section-number">4.4.2</span> PHRED-Scaled Scores</h3>
<p>Raw CADD scores are not directly interpretable as probabilities or effect sizes. To provide a more intuitive scale, CADD defines <strong>PHRED-like scaled scores</strong> based on the rank of each variant among all possible single-nucleotide substitutions in the reference genome <span class="citation" data-cites="rentzsch_cadd_2019 schubach_cadd_2024">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>:</p>
<ul>
<li>Scaled score 10 ≈ variant is in the <strong>top 10%</strong> most deleterious predicted substitutions.</li>
<li>Scaled score 20 ≈ <strong>top 1%</strong>.</li>
<li>Scaled score 30 ≈ <strong>top 0.1%</strong>.</li>
</ul>
<p>In other words, the scaled score compresses the raw scores into a 1–99 range that reflects <strong>percentile rank</strong> rather than an absolute effect size. This has several practical consequences:</p>
<ul>
<li>A simple, rank-based interpretation (“is this variant in the top x% of predicted deleteriousness?”).</li>
<li>Comparability across CADD versions: a score of 20 always means “top 1%” even if the underlying model and features change.</li>
<li>Coarser resolution in the bulk of the distribution: many common or mildly deleterious variants share similar scaled scores.</li>
</ul>
<p>In rare disease pipelines, it is common to apply basic <strong>CADD filters</strong>—e.g., focusing on variants with scaled scores ≥ 15 or ≥ 20—to enrich for potentially deleterious hits before more detailed interpretation.</p>
</section>
</section>
<section id="cadd-v1.7-integration-of-deep-learning-predictions" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="cadd-v1.7-integration-of-deep-learning-predictions"><span class="header-section-number">4.5</span> CADD v1.7: Integration of Deep Learning Predictions</h2>
<p>CADD v1.7 illustrates how the original framework naturally accommodates <strong>deep learning outputs and modern sequence models</strong> <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
<section id="protein-language-model-features" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="protein-language-model-features"><span class="header-section-number">4.5.1</span> Protein Language Model Features</h3>
<p>For protein-coding variants, CADD v1.7 integrates scores from <strong>protein language models</strong> such as ESM-1v <span class="citation" data-cites="meier_esm-1v_2021">(<a href="references.html#ref-meier_esm-1v_2021" role="doc-biblioref">Meier et al. 2021</a>)</span>. These models:</p>
<ul>
<li>Are trained self-supervised on hundreds of millions of protein sequences.</li>
<li>Learn contextual embeddings and per-residue “likelihoods” that reflect evolutionary plausibility and functional constraints.</li>
<li>Provide powerful per-variant scores for missense, nonsense, and frameshift events.</li>
</ul>
<p>By embedding ESM-1v–derived features into its annotation set, CADD v1.7 effectively <strong>delegates part of the representation learning to a large foundational protein model</strong>, then uses its own classifier to recalibrate and integrate these signals with other annotations <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
</section>
<section id="regulatory-cnn-predictions" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="regulatory-cnn-predictions"><span class="header-section-number">4.5.2</span> Regulatory CNN Predictions</h3>
<p>For non-coding variants, CADD v1.7 incorporates <strong>regulatory variant effect predictions</strong> from sequence-based convolutional neural networks trained on chromatin accessibility and related assays <span class="citation" data-cites="zhou_deepsea_2015 schubach_cadd_2024">(<a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>. These CNNs:</p>
<ul>
<li>Take raw DNA sequence as input.</li>
<li>Predict a battery of chromatin features (e.g., TF binding, histone marks).</li>
<li>Provide per-variant delta scores reflecting the predicted impact of a mutation on these regulatory readouts.</li>
</ul>
<p>In this way, CADD v1.7 uses early sequence-to-function CNNs (like those discussed in Chapters 5 and 6) as <strong>feature generators</strong> in its broader integrative framework.</p>
</section>
<section id="extended-conservation-scores" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="extended-conservation-scores"><span class="header-section-number">4.5.3</span> Extended Conservation Scores</h3>
<p>CADD v1.7 also updates its conservation and mutation-rate features to include:</p>
<ul>
<li>Deeper mammalian alignments from projects like Zoonomia.</li>
<li>Improved models of genome-wide mutation rates and regional constraint <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</li>
</ul>
<p>These updates help sharpen the evolutionary signal, particularly in non-coding regions and for variant types that were under-represented in earlier releases.</p>
</section>
<section id="performance-improvements" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="performance-improvements"><span class="header-section-number">4.5.4</span> Performance Improvements</h3>
<p>CADD v1.7 is evaluated on several benchmark sets <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>:</p>
<ul>
<li><strong>ClinVar and gnomAD/ExAC variants</strong>, where pathogenic vs benign labels provide a coarse clinical ground truth.</li>
<li><strong>Deep mutational scanning (DMS)</strong> assays for coding variants, summarized in ProteinGym <span class="citation" data-cites="notin_proteingym_2023">(<a href="references.html#ref-notin_proteingym_2023" role="doc-biblioref">Notin et al. 2023</a>)</span>.</li>
<li>Saturation mutagenesis reporter assays for promoters and enhancers, capturing regulatory variant effects.</li>
</ul>
<p>Across these benchmarks, incorporating PLM scores, regulatory CNN predictions, and updated conservation features yields <strong>consistent improvements in classification and ranking performance</strong> compared to earlier CADD versions.</p>
</section>
</section>
<section id="benchmarking-against-alternative-approaches" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="benchmarking-against-alternative-approaches"><span class="header-section-number">4.6</span> Benchmarking Against Alternative Approaches</h2>
<section id="coding-variants" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="coding-variants"><span class="header-section-number">4.6.1</span> Coding Variants</h3>
<p>For coding variants, CADD is one among many deleteriousness scores:</p>
<ul>
<li>Legacy tools such as SIFT and PolyPhen focus on protein sequence and structure (<span class="citation" data-cites="ng_sift_2003">Ng and Henikoff (<a href="references.html#ref-ng_sift_2003" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="adzhubei_polyphen_2010">Adzhubei et al. (<a href="references.html#ref-adzhubei_polyphen_2010" role="doc-biblioref">2010</a>)</span>).</li>
<li>Ensemble scores (e.g., REVEL, MetaLR) combine multiple predictors.</li>
<li>Modern methods exploit PLMs, structure prediction (AlphaFold), and other deep learning architectures.</li>
</ul>
<p>In many comparisons, CADD’s <strong>combination of evolutionary, protein, and gene-context features</strong> yields performance that is competitive with or superior to specialized scores for Mendelian disease variant prioritization, especially when used as part of a broader interpretation pipeline <span class="citation" data-cites="rentzsch_cadd_2019 schubach_cadd_2024">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p>
</section>
<section id="non-coding-variants" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="non-coding-variants"><span class="header-section-number">4.6.2</span> Non-coding Variants</h3>
<p>Non-coding variant interpretation is inherently more challenging:</p>
<ul>
<li>Ground-truth pathogenic variants are rarer and more biased toward specific genes and regulatory elements.</li>
<li>Functional genomics assays often provide noisy, context-specific readouts.</li>
</ul>
<p>Here, CADD’s integration of regulatory annotations and conservation allows it to <strong>rank plausible non-coding candidates genome-wide</strong>, particularly in promoters and enhancers covered by ENCODE/Roadmap-like data <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>. However, its performance depends heavily on the availability and quality of underlying annotations.</p>
</section>
<section id="population-frequency-correlation" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="population-frequency-correlation"><span class="header-section-number">4.6.3</span> Population Frequency Correlation</h3>
<p>Because CADD uses evolution as a training signal, its scores naturally correlate with <strong>population allele frequencies</strong>:</p>
<ul>
<li>Common variants in gnomAD tend to have low CADD scores.</li>
<li>Very rare variants (especially singletons) show a broad distribution, with a subset in the extreme high-score tail <span class="citation" data-cites="rentzsch_cadd_2019 gnomAD">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>; <a href="references.html#ref-gnomAD" role="doc-biblioref"><span>“The <span>Genome</span> <span>Aggregation</span> <span>Database</span> (<span class="nocase">gnomAD</span>)”</span> n.d.</a>)</span>.</li>
</ul>
<p>This correlation is useful—high CADD scores often highlight variants under purifying selection—but it also means that <strong>CADD partially recapitulates frequency filtering</strong>. In downstream pipelines, it is important not to double-count this signal (e.g., by applying both aggressive frequency cutoffs and strict CADD thresholds).</p>
</section>
<section id="limitations-and-circularity-with-clinvar" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="limitations-and-circularity-with-clinvar"><span class="header-section-number">4.6.4</span> Limitations and Circularity with ClinVar</h3>
<p>CADD is now deeply embedded in variant interpretation workflows, and this success raises an important methodological issue: <strong>circularity between CADD and clinical databases such as ClinVar.</strong></p>
<p>Two forms of circularity are particularly relevant:</p>
<ol type="1">
<li><p><strong>Evaluation circularity</strong></p>
<ul>
<li>CADD v1.7 is evaluated in part on datasets derived from ClinVar, ExAC/gnomAD, and 1000 Genomes variants <span class="citation" data-cites="schubach_cadd_2024">(<a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</li>
<li>However, ClinVar submissions increasingly incorporate in silico evidence, including CADD scores, as part of their classification process.</li>
<li>When we evaluate CADD on ClinVar after ClinVar curation has already used CADD, we risk <strong>overestimating performance</strong>, because the model is partially being judged against labels that it helped create.</li>
</ul></li>
<li><p><strong>Feedback into training and model development</strong></p>
<ul>
<li>Although the core CADD training labels are based on simulated vs observed variants, ClinVar and related resources still influence model development: they guide feature engineering, threshold selection, and choice of evaluation benchmarks.</li>
<li>Over time, variants that are consistently prioritized by CADD are more likely to receive follow-up, be published, and enter ClinVar as “likely pathogenic,” reinforcing the underlying signal.</li>
</ul></li>
</ol>
<p>This kind of <strong>sociotechnical feedback loop</strong> is not unique to CADD; it is a general challenge for widely-used predictive tools in genomics and medicine. For CADD and successor models, it motivates several best practices:</p>
<ul>
<li>Include evaluation datasets that are <strong>independent of clinical curation pipelines</strong>, such as DMS experiments, reporter assays, and population-based burden tests.</li>
<li>Report performance separately on <strong>pre-CADD</strong> and <strong>post-CADD</strong> ClinVar subsets when possible.</li>
<li>Treat performance on ClinVar as a <strong>sanity check</strong>, not the sole or primary measure of model quality.</li>
</ul>
<p>These concerns foreshadow similar issues we will encounter later in the book when genomic foundation models are evaluated on benchmarks that themselves rely on older predictive tools.</p>
</section>
</section>
<section id="significance-for-genomic-deep-learning" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="significance-for-genomic-deep-learning"><span class="header-section-number">4.7</span> Significance for Genomic Deep Learning</h2>
<p>CADD sits at an important historical junction between <strong>hand-crafted feature integration</strong> and modern <strong>deep, self-supervised representation learning</strong>. Several aspects of its design resonate throughout the rest of this book:</p>
<ol type="1">
<li><p><strong>Annotation integration as a precursor to multi-task deep models</strong></p>
<p>CADD’s integration of dozens of annotations into a single score anticipates later deep learning models that predict many functional genomics readouts from sequence and then reuse these as building blocks (Chapters 5–7 and 11). In CADD v1.7, the boundary blurs: deep networks (ESM-1v, regulatory CNNs) now <em>provide</em> features that CADD integrates <span class="citation" data-cites="meier_esm-1v_2021 zhou_deepsea_2015 schubach_cadd_2024">(<a href="references.html#ref-meier_esm-1v_2021" role="doc-biblioref">Meier et al. 2021</a>; <a href="references.html#ref-zhou_deepsea_2015" role="doc-biblioref">Zhou and Troyanskaya 2015</a>; <a href="references.html#ref-schubach_cadd_2024" role="doc-biblioref">Schubach et al. 2024</a>)</span>.</p></li>
<li><p><strong>Evolutionary proxy labels as a template for self-supervision</strong></p>
<p>Training on simulated vs observed variants uses the <strong>signature of selection</strong> as a rich, weak supervisory signal <span class="citation" data-cites="rentzsch_cadd_2019">(<a href="references.html#ref-rentzsch_cadd_2019" role="doc-biblioref">Rentzsch et al. 2019</a>)</span>. This is conceptually similar to masked language modeling and other self-supervised tasks that exploit abundant unlabeled data (Chapters 8–10).</p></li>
<li><p><strong>Genome-wide coverage and scalability</strong></p>
<p>By scoring all possible SNVs in the reference genome, CADD demonstrated the feasibility and utility of <strong>precomputing genome-wide variant scores</strong> for use in downstream analyses. Many genomic foundation models now do something analogous: precompute embeddings or predictions for every base or variant and expose them as reusable resources.</p></li>
<li><p><strong>Composable with deep learning</strong></p>
<p>CADD is not a direct competitor to modern sequence-based deep models; instead, it increasingly <strong>incorporates them as features</strong> while providing a stable, interpretable interface (PHRED-like scores) to end users. This “deep features + shallow integrator” pattern appears repeatedly in practical deployments.</p></li>
</ol>
<p>As we move into the CNN-based sequence-to-function models of Part II and the Transformer-based genomic foundation models of Parts III and IV, it is helpful to remember that CADD solved a difficult problem—variant prioritization under data scarcity and heterogeneity—using tools that were available at the time. The models that follow expand on CADD’s core ideas by learning representations directly from sequence and by tying those representations to richer experimental readouts, but they still rely on many of the same data resources and confront many of the same challenges around evaluation, bias, and circularity.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-adzhubei_polyphen_2010" class="csl-entry" role="listitem">
Adzhubei, Ivan A., Steffen Schmidt, Leonid Peshkin, Vasily E. Ramensky, Anna Gerasimova, Peer Bork, Alexey S. Kondrashov, and Shamil R. Sunyaev. 2010. <span>“A Method and Server for Predicting Damaging Missense Mutations.”</span> <em>Nature Methods</em> 7 (4): 248–49. <a href="https://doi.org/10.1038/nmeth0410-248">https://doi.org/10.1038/nmeth0410-248</a>.
</div>
<div id="ref-davydov_gerp_2010" class="csl-entry" role="listitem">
Davydov, Eugene V., David L. Goode, Marina Sirota, Gregory M. Cooper, Arend Sidow, and Serafim Batzoglou. 2010. <span>“Identifying a <span>High</span> <span>Fraction</span> of the <span>Human</span> <span>Genome</span> to Be Under <span>Selective</span> <span>Constraint</span> <span>Using</span> <span>GERP</span>++.”</span> <em>PLOS Computational Biology</em> 6 (12): e1001025. <a href="https://doi.org/10.1371/journal.pcbi.1001025">https://doi.org/10.1371/journal.pcbi.1001025</a>.
</div>
<div id="ref-meier_esm-1v_2021" class="csl-entry" role="listitem">
Meier, Joshua, Roshan Rao, Robert Verkuil, Jason Liu, Tom Sercu, and Alexander Rives. 2021. <span>“[<span>ESM</span>-1v] <span>Language</span> Models Enable Zero-Shot Prediction of the Effects of Mutations on Protein Function.”</span> bioRxiv. <a href="https://doi.org/10.1101/2021.07.09.450648">https://doi.org/10.1101/2021.07.09.450648</a>.
</div>
<div id="ref-ng_sift_2003" class="csl-entry" role="listitem">
Ng, Pauline C., and Steven Henikoff. 2003. <span>“<span>SIFT</span>: <span>Predicting</span> Amino Acid Changes That Affect Protein Function.”</span> <em>Nucleic Acids Research</em> 31 (13): 3812–14. <a href="https://doi.org/10.1093/nar/gkg509">https://doi.org/10.1093/nar/gkg509</a>.
</div>
<div id="ref-notin_proteingym_2023" class="csl-entry" role="listitem">
Notin, Pascal, Aaron Kollasch, Daniel Ritter, Lood van Niekerk, Steffanie Paul, Han Spinner, Nathan Rollins, et al. 2023. <span>“<span>ProteinGym</span>: <span>Large</span>-<span>Scale</span> <span>Benchmarks</span> for <span>Protein</span> <span>Fitness</span> <span>Prediction</span> and <span>Design</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 36 (December): 64331–79. <a href="https://papers.nips.cc/paper_files/paper/2023/hash/cac723e5ff29f65e3fcbb0739ae91bee-Abstract-Datasets_and_Benchmarks.html">https://papers.nips.cc/paper_files/paper/2023/hash/cac723e5ff29f65e3fcbb0739ae91bee-Abstract-Datasets_and_Benchmarks.html</a>.
</div>
<div id="ref-rentzsch_cadd_2019" class="csl-entry" role="listitem">
Rentzsch, Philipp, Daniela Witten, Gregory M Cooper, Jay Shendure, and Martin Kircher. 2019. <span>“<span>CADD</span>: Predicting the Deleteriousness of Variants Throughout the Human Genome.”</span> <em>Nucleic Acids Research</em> 47 (D1): D886–94. <a href="https://doi.org/10.1093/nar/gky1016">https://doi.org/10.1093/nar/gky1016</a>.
</div>
<div id="ref-schubach_cadd_2024" class="csl-entry" role="listitem">
Schubach, Max, Thorben Maass, Lusiné Nazaretyan, Sebastian Röner, and Martin Kircher. 2024. <span>“<span>CADD</span> V1.7: Using Protein Language Models, Regulatory <span>CNNs</span> and Other Nucleotide-Level Scores to Improve Genome-Wide Variant Predictions.”</span> <em>Nucleic Acids Research</em> 52 (D1): D1143–54. <a href="https://doi.org/10.1093/nar/gkad989">https://doi.org/10.1093/nar/gkad989</a>.
</div>
<div id="ref-siepel_phastcons_2005" class="csl-entry" role="listitem">
Siepel, Adam, Gill Bejerano, Jakob S. Pedersen, Angie S. Hinrichs, Minmei Hou, Kate Rosenbloom, Hiram Clawson, et al. 2005. <span>“[<span>PhastCons</span>] <span>Evolutionarily</span> Conserved Elements in Vertebrate, Insect, Worm, and Yeast Genomes.”</span> <em>Genome Research</em> 15 (8): 1034–50. <a href="https://doi.org/10.1101/gr.3715005">https://doi.org/10.1101/gr.3715005</a>.
</div>
<div id="ref-gnomAD" class="csl-entry" role="listitem">
<span>“The <span>Genome</span> <span>Aggregation</span> <span>Database</span> (<span class="nocase">gnomAD</span>).”</span> n.d. Accessed July 3, 2025. <a href="https://www.nature.com/immersive/d42859-020-00002-x/index.html">https://www.nature.com/immersive/d42859-020-00002-x/index.html</a>.
</div>
<div id="ref-zhou_deepsea_2015" class="csl-entry" role="listitem">
Zhou, Jian, and Olga G. Troyanskaya. 2015. <span>“[<span>DeepSEA</span>] <span>Predicting</span> Effects of Noncoding Variants with Deep Learning–Based Sequence Model.”</span> <em>Nature Methods</em> 12 (10): 931–34. <a href="https://doi.org/10.1038/nmeth.3547">https://doi.org/10.1038/nmeth.3547</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p1-ch03-pgs.html" class="pagination-link" aria-label="GWAS &amp; Polygenic Scores">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p2-ch05-reg.html" class="pagination-link" aria-label="Regulatory Prediction">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regulatory Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>