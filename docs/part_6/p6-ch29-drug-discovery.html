<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>29&nbsp; Drug Discovery – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_6/p6-ch30-design.html" rel="next">
<link href="../part_6/p6-ch28-rare-disease.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_6/p6--applications.html">Part VI: Clinical Translation</a></li><li class="breadcrumb-item"><a href="../part_6/p6-ch29-drug-discovery.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Drug Discovery</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Sequence Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmarks and Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch12-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch14-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch15-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch16-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch17-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch19-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch20-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch21-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch22-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Trust</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch24-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch25-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Causal Inference with Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch26-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Clinical Translation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch28-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch29-drug-discovery.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch30-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch31-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch29-genetic-foundation" id="toc-sec-ch29-genetic-foundation" class="nav-link active" data-scroll-target="#sec-ch29-genetic-foundation"><span class="header-section-number">29.1</span> Genetic Foundation of Target Selection</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-variant-to-gene" id="toc-sec-ch29-variant-to-gene" class="nav-link" data-scroll-target="#sec-ch29-variant-to-gene"><span class="header-section-number">29.1.1</span> From Variant-Level Predictions to Gene-Level Evidence</a></li>
  <li><a href="#sec-ch29-safety-efficacy" id="toc-sec-ch29-safety-efficacy" class="nav-link" data-scroll-target="#sec-ch29-safety-efficacy"><span class="header-section-number">29.1.2</span> Linking Genetics to Target Safety and Efficacy</a></li>
  </ul></li>
  <li><a href="#sec-ch29-network-discovery" id="toc-sec-ch29-network-discovery" class="nav-link" data-scroll-target="#sec-ch29-network-discovery"><span class="header-section-number">29.2</span> Network-Aware Target Discovery and Repurposing</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-network-propagation" id="toc-sec-ch29-network-propagation" class="nav-link" data-scroll-target="#sec-ch29-network-propagation"><span class="header-section-number">29.2.1</span> Propagating Genetic Signals Through Networks</a></li>
  <li><a href="#sec-ch29-repurposing" id="toc-sec-ch29-repurposing" class="nav-link" data-scroll-target="#sec-ch29-repurposing"><span class="header-section-number">29.2.2</span> Drug Repurposing Through Shared Representations</a></li>
  </ul></li>
  <li><a href="#sec-ch29-dti-prediction" id="toc-sec-ch29-dti-prediction" class="nav-link" data-scroll-target="#sec-ch29-dti-prediction"><span class="header-section-number">29.3</span> Drug-Target Interaction Prediction</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-binding-prediction" id="toc-sec-ch29-binding-prediction" class="nav-link" data-scroll-target="#sec-ch29-binding-prediction"><span class="header-section-number">29.3.1</span> Representing Targets for Binding Prediction</a></li>
  <li><a href="#sec-ch29-selectivity" id="toc-sec-ch29-selectivity" class="nav-link" data-scroll-target="#sec-ch29-selectivity"><span class="header-section-number">29.3.2</span> Selectivity and Off-Target Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch29-toxicity" id="toc-sec-ch29-toxicity" class="nav-link" data-scroll-target="#sec-ch29-toxicity"><span class="header-section-number">29.4</span> Toxicity Prediction from Genomic Context</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-genetic-liabilities" id="toc-sec-ch29-genetic-liabilities" class="nav-link" data-scroll-target="#sec-ch29-genetic-liabilities"><span class="header-section-number">29.4.1</span> Genetic Evidence of Target Liabilities</a></li>
  <li><a href="#sec-ch29-expression-toxicity" id="toc-sec-ch29-expression-toxicity" class="nav-link" data-scroll-target="#sec-ch29-expression-toxicity"><span class="header-section-number">29.4.2</span> Expression-Based Toxicity Prediction</a></li>
  <li><a href="#sec-ch29-integrated-toxicity" id="toc-sec-ch29-integrated-toxicity" class="nav-link" data-scroll-target="#sec-ch29-integrated-toxicity"><span class="header-section-number">29.4.3</span> Integrating Genomic Context with Chemical Properties</a></li>
  </ul></li>
  <li><a href="#sec-ch29-functional-screens" id="toc-sec-ch29-functional-screens" class="nav-link" data-scroll-target="#sec-ch29-functional-screens"><span class="header-section-number">29.5</span> Functional Genomics Screens and Perturbation Models</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-library-design" id="toc-sec-ch29-library-design" class="nav-link" data-scroll-target="#sec-ch29-library-design"><span class="header-section-number">29.5.1</span> Designing Informative Perturbation Libraries</a></li>
  <li><a href="#sec-ch29-perturb-seq" id="toc-sec-ch29-perturb-seq" class="nav-link" data-scroll-target="#sec-ch29-perturb-seq"><span class="header-section-number">29.5.2</span> Perturb-seq and Transcriptomic Readouts</a></li>
  <li><a href="#sec-ch29-lab-in-loop" id="toc-sec-ch29-lab-in-loop" class="nav-link" data-scroll-target="#sec-ch29-lab-in-loop"><span class="header-section-number">29.5.3</span> Closing the Loop: Lab-in-the-Loop Refinement</a></li>
  </ul></li>
  <li><a href="#sec-ch29-biomarkers" id="toc-sec-ch29-biomarkers" class="nav-link" data-scroll-target="#sec-ch29-biomarkers"><span class="header-section-number">29.6</span> Biomarker Development and Patient Stratification</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-stratification-features" id="toc-sec-ch29-stratification-features" class="nav-link" data-scroll-target="#sec-ch29-stratification-features"><span class="header-section-number">29.6.1</span> Foundation Model Features for Stratification</a></li>
  <li><a href="#sec-ch29-multi-omic-biomarkers" id="toc-sec-ch29-multi-omic-biomarkers" class="nav-link" data-scroll-target="#sec-ch29-multi-omic-biomarkers"><span class="header-section-number">29.6.2</span> Multi-Omic Biomarker Discovery</a></li>
  <li><a href="#sec-ch29-trial-design" id="toc-sec-ch29-trial-design" class="nav-link" data-scroll-target="#sec-ch29-trial-design"><span class="header-section-number">29.6.3</span> Trial Design and Endpoint Selection</a></li>
  </ul></li>
  <li><a href="#sec-ch29-industry-workflows" id="toc-sec-ch29-industry-workflows" class="nav-link" data-scroll-target="#sec-ch29-industry-workflows"><span class="header-section-number">29.7</span> Industry Workflows and Infrastructure</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-model-infrastructure" id="toc-sec-ch29-model-infrastructure" class="nav-link" data-scroll-target="#sec-ch29-model-infrastructure"><span class="header-section-number">29.7.1</span> Building Model Infrastructure</a></li>
  <li><a href="#sec-ch29-build-buy-finetune" id="toc-sec-ch29-build-buy-finetune" class="nav-link" data-scroll-target="#sec-ch29-build-buy-finetune"><span class="header-section-number">29.7.2</span> Strategic Choices: Build, Buy, or Fine-Tune</a></li>
  <li><a href="#sec-ch29-timelines" id="toc-sec-ch29-timelines" class="nav-link" data-scroll-target="#sec-ch29-timelines"><span class="header-section-number">29.7.3</span> Industry Context: Timelines and Decision Gates</a></li>
  <li><a href="#sec-ch29-ip-data" id="toc-sec-ch29-ip-data" class="nav-link" data-scroll-target="#sec-ch29-ip-data"><span class="header-section-number">29.7.4</span> Intellectual Property and Data Considerations</a></li>
  </ul></li>
  <li><a href="#sec-ch29-evaluation" id="toc-sec-ch29-evaluation" class="nav-link" data-scroll-target="#sec-ch29-evaluation"><span class="header-section-number">29.8</span> Evaluation and Validation</a>
  <ul class="collapse">
  <li><a href="#sec-ch29-benchmark-limits" id="toc-sec-ch29-benchmark-limits" class="nav-link" data-scroll-target="#sec-ch29-benchmark-limits"><span class="header-section-number">29.8.1</span> Benchmark Limitations</a></li>
  <li><a href="#sec-ch29-prediction-validation" id="toc-sec-ch29-prediction-validation" class="nav-link" data-scroll-target="#sec-ch29-prediction-validation"><span class="header-section-number">29.8.2</span> From Prediction to Validation</a></li>
  </ul></li>
  <li><a href="#sec-ch29-molecular-design" id="toc-sec-ch29-molecular-design" class="nav-link" data-scroll-target="#sec-ch29-molecular-design"><span class="header-section-number">29.9</span> Connections to Molecular Design</a></li>
  <li><a href="#sec-ch29-conclusion" id="toc-sec-ch29-conclusion" class="nav-link" data-scroll-target="#sec-ch29-conclusion"><span class="header-section-number">29.10</span> Prioritization, Not Automation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_6/p6--applications.html">Part VI: Clinical Translation</a></li><li class="breadcrumb-item"><a href="../part_6/p6-ch29-drug-discovery.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Drug Discovery</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch29-drug-discovery" class="quarto-section-identifier"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Nine out of ten drug candidates fail. Most were doomed before they started.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Prerequisites:</strong> This chapter builds on variant effect prediction (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>), protein language models (<a href="../part_3/p3-ch15-protein-lm.html#sec-ch15-esm-family" class="quarto-xref"><span>Section 15.1</span></a>), regulatory foundation models (<a href="../part_3/p3-ch16-regulatory.html#sec-ch16-enformer" class="quarto-xref"><span>Section 16.2</span></a>), and network analysis (<a href="../part_4/p4-ch21-networks.html" class="quarto-xref"><span>Chapter 21</span></a>). Familiarity with GWAS concepts (<a href="../part_1/p1-ch03-gwas.html" class="quarto-xref"><span>Chapter 3</span></a>) and fine-mapping (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-fine-mapping" class="quarto-xref"><span>Section 3.4</span></a>) is essential. The confounding concepts from <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a> are particularly relevant for understanding validation challenges.</p>
<p><strong>Learning Objectives:</strong> After completing this chapter, you should be able to:</p>
<ol type="1">
<li>Explain why genetically supported targets succeed at higher rates in clinical trials</li>
<li>Describe pipelines for aggregating variant-level predictions into gene-level target evidence</li>
<li>Contrast network-aware and single-gene approaches to target discovery</li>
<li>Evaluate drug-target interaction predictions using protein and chemical embeddings</li>
<li>Design foundation model-guided functional genomics screens</li>
<li>Apply foundation model features to biomarker development and patient stratification</li>
<li>Navigate strategic choices for foundation model deployment in industry settings</li>
</ol>
<p><strong>Estimated time:</strong> 45-60 minutes</p>
</div>
</div>
<p>More than 90% of drug candidates that enter clinical trials fail. They fail because they targeted the wrong gene. They fail because the patient population was too heterogeneous for a single mechanism to succeed. They fail because preclinical models predicted efficacy that did not translate to humans. They fail because safety signals emerged only at scale. The pharmaceutical industry spends billions of dollars on programs that will not produce approved therapies, and the cost of this attrition propagates to the drugs that do succeed: higher prices, longer development timelines, and reduced investment in diseases with smaller markets. The fundamental bottleneck is not generating drug candidates but identifying, early in the process, which targets and which patients offer the highest probability of success.</p>
<p>Human genetics provides one of the strongest predictors of clinical success. Targets with genetic support succeed in trials at roughly twice the rate of targets without such support; human mutations that cause phenotypes resembling the therapeutic goal provide direct evidence that modulating the target affects the disease.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case Study: PCSK9 and Genetic Target Validation
</div>
</div>
<div class="callout-body-container callout-body">
<p>PCSK9 exemplifies the power of genetic evidence for drug development. In 2003, researchers identified rare gain-of-function mutations in PCSK9 that caused familial hypercholesterolemia. In 2006, loss-of-function variants in PCSK9 were discovered that reduced LDL cholesterol by 28% and coronary heart disease risk by 88% in carriers—a natural experiment showing that PCSK9 inhibition would be safe and efficacious.</p>
<p>This genetic validation de-risked PCSK9 as a target. Multiple pharmaceutical companies developed PCSK9 inhibitors (evolocumab, alirocumab), which received FDA approval in 2015—just 12 years from gene discovery to approved drug, remarkably fast for novel targets. Clinical trials confirmed what genetics predicted: ~60% LDL reduction and significant cardiovascular event reduction.</p>
<p>Compare to targets without genetic support: The average Phase II success rate for novel mechanisms is approximately 25%. For PCSK9, the mechanism was validated by human genetics before the first patient was dosed. This is what “2x success rate for genetically supported targets” looks like in practice.</p>
</div>
</div>
<p>Yet exploiting this signal is harder than it sounds. Genome-wide association studies have identified thousands of disease-associated loci, but most point to noncoding regions where the causal gene is unclear. Even when a gene is implicated, the direction of effect often remains ambiguous. Translating a statistical association into a validated therapeutic target typically requires a decade of work and hundreds of millions of dollars in follow-up studies.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: The Genetic Validation Advantage
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two-fold improvement in clinical trial success rates for genetically supported targets represents one of the most robust findings in drug development. This effect persists across therapeutic areas and development phases. Foundation models amplify this advantage by providing mechanistic context that explains <em>why</em> a genetic association matters, not just <em>that</em> it exists.</p>
</div>
</div>
<p>Genomic foundation models offer a path through this translational bottleneck. Rather than treating each target identification program as a <em>de novo</em> effort, foundation models encode biological knowledge learned across millions of sequences into reusable representations. A <strong>variant effect predictor</strong> can score any missense mutation’s functional impact without task-specific retraining. A regulatory model can predict expression consequences of noncoding variants across tissues. Network models can propagate genetic signals to identify pathway relationships invisible in single-gene analyses. These capabilities connect to drug discovery through target prioritization and genetic validation, network-aware approaches that identify modules and repurposing opportunities, foundation model-guided functional genomics screens, and biomarker development for patient stratification.</p>
<section id="sec-ch29-genetic-foundation" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sec-ch29-genetic-foundation"><span class="header-section-number">29.1</span> Genetic Foundation of Target Selection</h2>
<p>Human genetics provides uniquely causal evidence for target selection. Unlike expression correlations or pathway membership, genetic associations reflect the consequences of lifelong modulation of gene activity in human populations. Multiple analyses over the past decade have demonstrated that genetically supported targets succeed in clinical trials at roughly twice the rate of targets without genetic evidence <em>[Citation Needed]</em>. Targets implicated by Mendelian disease genetics, <strong>genome-wide association study (GWAS)</strong> hits, or functional variants show higher probabilities of success in phase II and III trials compared to targets selected through other means.</p>
<div id="fig-target-prioritization" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-target-prioritization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_6/ch29/01-fig-target-prioritization.svg" class="img-fluid figure-img"></p>
<figcaption>Drug target prioritization pipeline</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-target-prioritization-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.1: Drug target prioritization pipeline. Starting from disease understanding (GWAS, expression signatures), targets progress through causal inference (Mendelian randomization confirms causation), target property assessment (druggability, safety), and experimental validation (CRISPR, animal models). Foundation models contribute at each stage: integrating multi-omic associations, prioritizing causal variants, predicting druggability, and interpreting validation data. Critical context: only ~5% of targets entering clinical development succeed.
</figcaption>
</figure>
</div>
<p>This empirical observation motivates building pipelines where genetic architecture serves as a first-class input to target identification. Genomic foundation models extend this logic by providing richer biological context and enabling <strong>transfer learning</strong> across diseases and modalities. Rather than simple “variants near gene X,” foundation models encode regulatory architecture, chromatin state, three-dimensional genome interactions, cell-type specificity, and perturbation responses. A single model trained on diverse genomic and multi-omic data can be reused for multiple diseases and therapeutic areas, analogous to how language models transfer across domains.</p>
<section id="sec-ch29-variant-to-gene" class="level3" data-number="29.1.1">
<h3 data-number="29.1.1" class="anchored" data-anchor-id="sec-ch29-variant-to-gene"><span class="header-section-number">29.1.1</span> From Variant-Level Predictions to Gene-Level Evidence</h3>
<p>Drug discovery teams rarely care about individual variants per se; they care about genes and pathways. The fundamental challenge in target identification is therefore aggregating variant-level information into gene-level evidence that can guide target selection.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about the workflow below, consider: if you have thousands of GWAS-significant variants across hundreds of loci, what information would you need to convert these statistical signals into a ranked list of drug targets? What makes this problem difficult?</p>
</div>
</div>
<p>Consider a typical workflow. Starting from GWAS summary statistics (see <a href="../part_1/p1-ch02-data.html#sec-ch02-gwas-summary" class="quarto-xref"><span>Section 2.3.2</span></a>), statistical <strong>fine-mapping</strong> methods identify credible sets of potentially causal variants at each locus (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-fine-mapping" class="quarto-xref"><span>Section 3.4</span></a>). Sequence-based foundation models then score each candidate variant for regulatory or coding impact. Protein-centric variant effect predictors such as <em>AlphaMissense</em>, <em>GPN-MSA</em>, and the missense components of <em>AlphaGenome</em> combine <strong>protein language models</strong>, structural information, and evolutionary conservation to assess coding variants (<a href="../part_3/p3-ch15-protein-lm.html#sec-ch15-esm-family" class="quarto-xref"><span>Section 15.1</span></a>; <span class="quarto-unresolved-ref">?sec-ch14-protein-vep</span>) <span class="citation" data-cites="cheng_alphamissense_2023 benegas_gpn-msa_2024 avsec_alphagenome_2025 brandes_genome-wide_2023">(<a href="../bib/references.html#ref-cheng_alphamissense_2023" role="doc-biblioref">Cheng et al. 2023</a>; <a href="../bib/references.html#ref-benegas_gpn-msa_2024" role="doc-biblioref">Benegas et al. 2024</a>; <a href="../bib/references.html#ref-avsec_alphagenome_2025" role="doc-biblioref">Avsec, Latysheva, and Cheng 2025</a>; <a href="../bib/references.html#ref-brandes_genome-wide_2023" role="doc-biblioref">Brandes et al. 2023</a>)</span>. Regulatory foundation models including <em>Enformer</em>, <em>Borzoi</em>, and long-context DNA language models predict the consequences of noncoding variants on chromatin accessibility, transcription factor binding, and gene expression (<a href="../part_3/p3-ch16-regulatory.html#sec-ch16-enformer" class="quarto-xref"><span>Section 16.2</span></a>; <span class="quarto-unresolved-ref">?sec-ch14-enformer-vep</span>).</p>
<p>The critical step is connecting variants to genes. For coding variants, this mapping is straightforward: the variant lies within a gene’s coding sequence, and protein-level scores directly inform that gene’s candidacy. For noncoding variants, the mapping requires integrating chromatin conformation data (Hi-C, promoter-capture Hi-C), enhancer-gene predictions from models like <em>Enformer</em>, and <strong>expression quantitative trait locus (eQTL)</strong> data that empirically links variants to gene expression changes (see <a href="../part_1/p1-ch02-data.html#sec-ch02-expression" class="quarto-xref"><span>Section 2.5</span></a>). Fine-mapping approaches such as <em>MIFM</em> can help distinguish truly causal regulatory variants from correlated passengers, tightening the map from GWAS locus to variant to target gene (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-fine-mapping" class="quarto-xref"><span>Section 3.4</span></a>) <span class="citation" data-cites="wu_genome-wide_2024 rakowski_mifm_2025">(<a href="../bib/references.html#ref-wu_genome-wide_2024" role="doc-biblioref">Wu et al. 2024</a>; <a href="../bib/references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.</p>
<p>The following table summarizes the key evidence types for connecting variants to target genes:</p>
<div id="tbl-variant-to-gene-evidence" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-variant-to-gene-evidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.1: Evidence types for variant-to-gene mapping in drug target prioritization. Coding variants provide direct gene mappings, while noncoding variants require integration of multiple data sources.
</figcaption>
<div aria-describedby="tbl-variant-to-gene-evidence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Evidence Type</th>
<th>Variant Class</th>
<th>Data Source</th>
<th>Strength</th>
<th>Limitation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Direct coding</td>
<td>Missense, LoF</td>
<td>Sequence annotation</td>
<td>Unambiguous gene link</td>
<td>Rare variants, small effect sizes</td>
</tr>
<tr class="even">
<td>eQTL colocalization</td>
<td>Regulatory</td>
<td>GTEx, tissue-specific cohorts</td>
<td>Empirical gene expression link</td>
<td>Tissue-specific, LD confounding</td>
</tr>
<tr class="odd">
<td>Chromatin contact</td>
<td>Regulatory</td>
<td>Hi-C, pcHi-C</td>
<td>Physical enhancer-gene link</td>
<td>Resolution limits, cell-type specific</td>
</tr>
<tr class="even">
<td>FM enhancer prediction</td>
<td>Regulatory</td>
<td><em>Enformer</em>, <em>Borzoi</em></td>
<td>Functional prediction</td>
<td>Validation required</td>
</tr>
<tr class="odd">
<td>Network proximity</td>
<td>Both</td>
<td>PPI, pathway databases</td>
<td>Pathway context</td>
<td>Indirect evidence</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Gene-level aggregation proceeds by summarizing variant effects across all variants linked to each gene. For a given gene, this summary might include the burden of predicted loss-of-function variants in cases versus controls, the strongest regulatory variant effect sizes predicted by foundation models, constraint metrics indicating the gene’s intolerance to damaging variation (see <a href="../part_1/p1-ch02-data.html#sec-ch02-gnomad" class="quarto-xref"><span>Section 2.2.3</span></a>), and pleiotropy scores reflecting associations with other traits that might indicate safety liabilities or broader biological importance. From a foundation model perspective, the core idea is to treat gene-level evidence as an aggregation problem over high-dimensional variant embeddings. Rather than manually defining a handful of summary statistics, variant embeddings and predicted functional profiles can feed into downstream models that learn which patterns matter most for disease.</p>
</section>
<section id="sec-ch29-safety-efficacy" class="level3" data-number="29.1.2">
<h3 data-number="29.1.2" class="anchored" data-anchor-id="sec-ch29-safety-efficacy"><span class="header-section-number">29.1.2</span> Linking Genetics to Target Safety and Efficacy</h3>
<p>Classical human genetics has established several heuristics for target selection that foundation models can reinforce and extend. Human knockout individuals, people carrying biallelic loss-of-function variants, provide natural experiments on the consequences of gene inactivation. Protective variants that reduce disease risk suggest the directionality of therapeutic intervention: partial inhibition of a protein may be beneficial rather than harmful. <strong>Pleiotropy</strong>, meaning associations with many unrelated traits, may signal safety liabilities if modulating a target affects multiple physiological systems (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-phewas" class="quarto-xref"><span>Section 3.8</span></a>).</p>
<p>Foundation models sharpen these assessments. Fine-mapping methods combined with regulatory foundation models can distinguish causal variants from those merely in <strong>linkage disequilibrium</strong> with causal variants (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-ld" class="quarto-xref"><span>Section 3.3</span></a>). Variant effect scores from protein and regulatory models approximate effect sizes, helping differentiate subtle modulators from catastrophic loss-of-function mutations. Multi-task predictions across chromatin marks, transcription factor binding, expression, and splicing provide mechanistic hypotheses for how risk loci affect biology, moving beyond statistical association toward functional understanding.</p>
<p>The output of this workflow is a ranked list of candidate targets with structured evidence that can be compared across diseases and programs. Each target comes annotated with the strength of genetic evidence (effect sizes, fine-mapping probabilities), predicted mechanisms (coding versus regulatory, affected tissues), constraint information (tolerance to loss-of-function, essentiality), and druggability features (protein family, structural information, existing ligands).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A target gene has strong GWAS support (p &lt; 5e-8) but high pleiotropy (associated with 50+ traits in PheWAS) and high constraint (pLI &gt; 0.99). Should this gene be prioritized or deprioritized as a drug target? What additional information would help decide?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This gene should be approached cautiously and requires deeper investigation. High constraint suggests the gene is essential for viability, indicating potential toxicity from inhibition. High pleiotropy suggests modulating it affects many systems, raising concerns about on-target side effects. Additional information needed includes: which specific traits are associated (are they safety-relevant?), human knockout data from biobanks, tissue expression patterns, and whether the GWAS associations suggest the direction of effect aligns with therapeutic goals.</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch29-network-discovery" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sec-ch29-network-discovery"><span class="header-section-number">29.2</span> Network-Aware Target Discovery and Repurposing</h2>
<p>Individual genes do not operate in isolation. Proteins interact in complexes, genes participate in pathways, and regulatory networks coordinate cellular responses. Even with excellent variant-to-gene mapping, the biological context of a target shapes its therapeutic potential. Network-aware approaches propagate genetic signals through these relational structures to identify modules, bottleneck nodes, and repurposing opportunities.</p>
<section id="sec-ch29-network-propagation" class="level3" data-number="29.2.1">
<h3 data-number="29.2.1" class="anchored" data-anchor-id="sec-ch29-network-propagation"><span class="header-section-number">29.2.1</span> Propagating Genetic Signals Through Networks</h3>
<p>The basic intuition is that GWAS signals concentrated in a pathway or protein interaction module provide stronger evidence than isolated hits. A single gene with modest genetic support but tight functional connections to several strongly implicated genes may be a more attractive target than an isolated hit with stronger statistics but unclear biology.</p>
<p>Network-based methods integrate noncoding GWAS loci, regulatory annotations, and protein-protein interactomes to identify disease genes and evaluate drug repurposing opportunities in complex diseases. <strong>Graph neural network</strong> architectures (<span class="quarto-unresolved-ref">?sec-ch18-canonical-architectures</span>) can learn to propagate genetic evidence through interaction networks, scoring each gene not just by its direct genetic association but by its network context. The key methodological insight is that genes can be embedded jointly with their network neighbors, allowing the model to capture how genetic perturbations in one gene might affect functionally related genes. This propagation reflects biological reality: proteins function in complexes and pathways, so disrupting one component often affects the entire module. A mutation in a kinase may have minimal direct phenotypic effect if compensatory kinases exist, but that same mutation becomes consequential if the compensatory kinases are also compromised elsewhere in the pathway. Network propagation captures these dependencies that single-gene analysis misses.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: Single-Gene vs.&nbsp;Network Evidence
</div>
</div>
<div class="callout-body-container callout-body">
<p>Single-gene approaches treat each target independently based on its direct genetic association. Network-aware approaches recognize that an isolated GWAS hit with unclear mechanism may be less actionable than a gene with modest direct evidence but strong connections to well-validated disease biology. The value of network propagation lies in recovering “near-miss” targets that lack genome-wide significance individually but sit at the center of disease-relevant pathways.</p>
</div>
</div>
<p>Foundation model representations enhance these network approaches. Instead of representing each gene by a sparse vector of annotations, genes can be embedded using features derived from protein language models (<a href="../part_3/p3-ch15-protein-lm.html#sec-ch15-esm2" class="quarto-xref"><span>Section 15.1.3</span></a>), regulatory foundation models (<a href="../part_3/p3-ch16-regulatory.html#sec-ch16-enformer" class="quarto-xref"><span>Section 16.2</span></a>), and expression-based cell state encoders (<span class="quarto-unresolved-ref">?sec-ch16-clm</span>). These embeddings can then be used as node features in graph neural networks, enabling network-aware target prioritization (<span class="quarto-unresolved-ref">?sec-ch18-fm-embeddings</span>). These rich representations capture functional similarity beyond what interaction databases alone can provide. Two genes with similar protein language model embeddings likely share functional properties even if no direct interaction has been catalogued.</p>
<div id="fig-network-target-discovery" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-network-target-discovery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_6/ch29/02-fig-network-target-discovery.svg" class="img-fluid figure-img"></p>
<figcaption>Network-based drug target discovery</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-network-target-discovery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.2: Network-based drug target discovery. Known disease genes (red) seed network propagation through protein-protein interactions. Candidate targets (orange) accumulate high scores based on network proximity. Foundation model embeddings (ESM) provide node features that encode functional similarity, improving propagation beyond topology alone. Network context reveals targets missed by GWAS: genes may not harbor risk variants themselves but are functionally connected to disease mechanisms.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch29-repurposing" class="level3" data-number="29.2.2">
<h3 data-number="29.2.2" class="anchored" data-anchor-id="sec-ch29-repurposing"><span class="header-section-number">29.2.2</span> Drug Repurposing Through Shared Representations</h3>
<p>The same framework enables systematic drug repurposing. By representing drugs via their targets, gene expression signatures, and phenotypic effects, and representing diseases via their genetic architecture and molecular signatures, models can score drug-disease pairs based on representation similarity. If a drug’s target sits near genetically implicated genes in representation space, or if the drug’s expression signature opposes the disease signature, that drug becomes a repurposing candidate.</p>
<p>Network proximity provides one concrete operationalization: drugs whose targets are enriched near disease-risk genes, as measured by network diffusion or embedding similarity, may have therapeutic potential for that disease. Several retrospective analyses have found that such proximity predicts reduced disease incidence among users of particular drugs, though prospective validation remains limited.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case Study: Metformin and Network-Based Repurposing
</div>
</div>
<div class="callout-body-container callout-body">
<p>Metformin, a first-line type 2 diabetes treatment, illustrates network-based repurposing in action. Network analyses identified that metformin’s targets (primarily mitochondrial complex I and AMPK) have high proximity to genes implicated in cancer susceptibility, including STK11/LKB1 and TP53-related pathways.</p>
<p>Retrospective epidemiological analyses across multiple cohorts found that diabetic patients taking metformin had 10-40% reduced cancer incidence compared to patients on other diabetes medications, with particularly strong signals for colorectal and liver cancer. The network proximity score (mean shortest path from metformin targets to cancer genes: 1.8 hops) was in the top 5% of all approved drugs.</p>
<p>This hypothesis-generating finding led to prospective clinical trials testing metformin in cancer prevention and treatment. Results have been mixed: some trials show benefit in specific populations, others show no effect. The example illustrates both the promise of network-based repurposing (generating testable hypotheses from computational analysis) and its limitations (retrospective associations do not guarantee prospective efficacy).</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Correlation vs.&nbsp;Causation in Repurposing
</div>
</div>
<div class="callout-body-container callout-body">
<p>The caution here is fundamental: representation similarity is not causation. A drug that appears near disease genes in embedding space might act through that mechanism, or the association might reflect confounding by indication, survivorship bias, or other artifacts of observational data (see <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>). Network-based repurposing generates hypotheses; <strong>Mendelian randomization</strong>, natural experiments, and prospective trials must test them. Retrospective analyses claiming repurposing success should be viewed skeptically without prospective validation.</p>
</div>
</div>
</section>
</section>
<section id="sec-ch29-dti-prediction" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="sec-ch29-dti-prediction"><span class="header-section-number">29.3</span> Drug-Target Interaction Prediction</h2>
<p>Beyond identifying disease-relevant targets, foundation models can predict which molecules might modulate those targets. Drug-target interaction prediction sits at the interface between genomic and chemical foundation models, using biological representations to inform molecular design decisions.</p>
<div id="fig-drug-target-prediction" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-drug-target-prediction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_6/ch29/03-fig-drug-target-prediction.svg" class="img-fluid figure-img"></p>
<figcaption>Drug-target interaction prediction with foundation models</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-drug-target-prediction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.3: Drug-target interaction prediction with foundation models. Drug structures are encoded by chemical language models (ChemBERTa) while protein targets are encoded by protein foundation models (ESM-2). Combined embeddings predict binding probability and affinity. Applications span virtual screening (score targets for new drugs), drug repurposing (score known drugs for new targets), and off-target prediction (identify safety liabilities). Experimental validation remains essential: computational predictions prioritize but cannot substitute for binding assays.
</figcaption>
</figure>
</div>
<section id="sec-ch29-binding-prediction" class="level3" data-number="29.3.1">
<h3 data-number="29.3.1" class="anchored" data-anchor-id="sec-ch29-binding-prediction"><span class="header-section-number">29.3.1</span> Representing Targets for Binding Prediction</h3>
<p>Traditional drug-target interaction methods rely on sequence similarity, structural docking, or chemical fingerprint matching. Foundation model approaches replace these hand-crafted features with learned representations. Protein language model embeddings from <em>ESM-2</em> or similar architectures capture evolutionary and structural information that correlates with binding site properties (<a href="../part_3/p3-ch15-protein-lm.html#sec-ch15-esm2" class="quarto-xref"><span>Section 15.1.3</span></a>; <a href="../part_3/p3-ch15-protein-lm.html#sec-ch15-esm-family" class="quarto-xref"><span>Section 15.1</span></a>) <span class="citation" data-cites="lin_esm-2_2022">(<a href="../bib/references.html#ref-lin_esm-2_2022" role="doc-biblioref">Lin et al. 2022</a>)</span>. Ligand representations from chemical foundation models encode molecular properties relevant to binding affinity and selectivity.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Traditional drug-target interaction prediction requires experimental protein structures for docking. Why might protein language model embeddings enable binding prediction for targets without solved structures? What information do these embeddings capture that might correlate with binding behavior?</p>
<p><strong>The key insight:</strong> Protein language model embeddings encode evolutionary constraints on each position—which amino acids are tolerated, which co-evolve with other positions, which are absolutely conserved. These constraints reflect structural and functional requirements: a position buried in a hydrophobic core shows different evolutionary patterns than a solvent-exposed loop, and active site residues show patterns distinct from scaffolding regions. Binding sites are evolutionarily constrained because mutations that disrupt binding are selected against. Even without explicit structure, embeddings capture the statistical signatures of binding site residues: unusual conservation patterns, co-evolutionary relationships with other binding site positions, and amino acid preferences reflecting the chemical environment. Two proteins with similar binding site embeddings likely share binding site properties—enabling affinity prediction from sequence alone.</p>
</div>
</div>
<p>The prediction task becomes: given a protein embedding (derived from a protein language model) and a molecule embedding (derived from a chemical language model or graph neural network), predict binding affinity or interaction probability. These models can be trained on large databases of known drug-target interactions and binding affinities, then applied to predict interactions for novel targets or molecules.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: DTI Prediction for a Novel Kinase Target
</div>
</div>
<div class="callout-body-container callout-body">
<p>A drug discovery team identifies MAP4K4 as a target for metabolic disease based on GWAS and human knockout data. The team wants to find starting compounds before solving the crystal structure.</p>
<p><strong>Step 1: Generate target embedding.</strong> Extract ESM-2 embeddings for the MAP4K4 kinase domain (residues 1-320), producing a 1280-dimensional vector that encodes evolutionary constraints, predicted structural features, and sequence context.</p>
<p><strong>Step 2: Screen compound library.</strong> For each compound in a 100,000-compound kinase-focused library, compute ChemBERTa embeddings (768-dimensional molecular representations).</p>
<p><strong>Step 3: Predict binding.</strong> A DTI prediction model trained on ChEMBL binding data takes concatenated [protein; compound] embeddings and predicts IC50. For MAP4K4 against 100,000 compounds, this takes ~2 hours on a single GPU.</p>
<p><strong>Step 4: Prioritize hits.</strong> Top 100 predicted binders (predicted IC50 &lt; 100 nM) are selected for biochemical testing.</p>
<p><strong>Results:</strong> Of 100 computationally predicted binders, 23 showed confirmed binding (IC50 &lt; 1 μM) in biochemical assays—a 23% hit rate compared to ~1% for random screening. The top hit had IC50 = 47 nM, providing a validated starting point for medicinal chemistry without requiring structural data.</p>
<p>This example illustrates how protein foundation model embeddings enable structure-free virtual screening, dramatically reducing the compounds requiring experimental testing.</p>
</div>
</div>
<p>For genomics-focused applications, the protein representation is the critical contribution. A target identified through genetic validation can be immediately embedded using protein foundation models, enabling binding prediction without waiting for experimental structures or extensive biochemical characterization. This acceleration is particularly valuable for understudied targets where structural data is sparse.</p>
</section>
<section id="sec-ch29-selectivity" class="level3" data-number="29.3.2">
<h3 data-number="29.3.2" class="anchored" data-anchor-id="sec-ch29-selectivity"><span class="header-section-number">29.3.2</span> Selectivity and Off-Target Prediction</h3>
<p>The same framework extends to selectivity prediction. By comparing a drug’s predicted binding across all proteins in a proteome-scale embedding space, models can flag potential off-target interactions. A compound predicted to bind its intended target but also showing high affinity for kinases with cardiovascular expression, for example, might warrant additional safety characterization before advancement.</p>
<p>Foundation model representations capture protein family relationships and binding site similarities that inform off-target predictions. Two proteins with similar embeddings likely share structural features that could bind similar molecules. This information, combined with tissue expression data (<a href="../part_1/p1-ch02-data.html#sec-ch02-gtex" class="quarto-xref"><span>Section 2.5.1</span></a>) and phenome-wide association data linking genes to thousands of traits (<a href="../part_1/p1-ch03-gwas.html#sec-ch03-prs-phewas" class="quarto-xref"><span>Section 3.8.2</span></a>), enables preliminary safety profiling before expensive preclinical experiments.</p>
</section>
</section>
<section id="sec-ch29-toxicity" class="level2" data-number="29.4">
<h2 data-number="29.4" class="anchored" data-anchor-id="sec-ch29-toxicity"><span class="header-section-number">29.4</span> Toxicity Prediction from Genomic Context</h2>
<p>Safety failures represent a major cause of drug attrition, particularly in late-stage development where failures are most expensive. Genomic information provides several routes to earlier toxicity prediction.</p>
<section id="sec-ch29-genetic-liabilities" class="level3" data-number="29.4.1">
<h3 data-number="29.4.1" class="anchored" data-anchor-id="sec-ch29-genetic-liabilities"><span class="header-section-number">29.4.1</span> Genetic Evidence of Target Liabilities</h3>
<p>Human genetic data offers direct evidence of target-related toxicity. If loss-of-function variants in a target gene associate with adverse phenotypes in biobank populations, those phenotypes may emerge as on-target toxicities during therapeutic inhibition. Phenome-wide association studies across biobanks link genes to thousands of traits, from laboratory values to disease diagnoses to imaging features (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-phewas" class="quarto-xref"><span>Section 3.8</span></a>). A target strongly associated with QT prolongation, hepatotoxicity markers, or nephrotoxicity phenotypes warrants careful safety evaluation.</p>
<p>Foundation models enhance this analysis by providing more accurate variant effect predictions (distinguishing true loss-of-function from benign variants) and by integrating across evidence types (see <a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>). A gene might show modest individual associations with several safety-relevant traits that, when aggregated using foundation model representations, reveal a concerning pattern.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Genetic Safety Signals
</div>
</div>
<div class="callout-body-container callout-body">
<p>When evaluating genetic safety evidence for a target:</p>
<ol type="1">
<li><strong>Check PheWAS associations</strong> for the target gene, focusing on cardiac, hepatic, renal, and hematologic phenotypes</li>
<li><strong>Examine human knockouts</strong> in gnomAD and biobank cohorts for homozygous loss-of-function carriers</li>
<li><strong>Assess constraint</strong> (pLI, LOEUF) as a proxy for essential function that may indicate safety risk</li>
<li><strong>Evaluate pleiotropy</strong> breadth and whether off-target associations could become on-target toxicities</li>
<li><strong>Consider expression patterns</strong> in safety-relevant tissues using GTEx or single-cell atlases</li>
</ol>
<p>Remember: genetic evidence predicts <em>on-target</em> toxicity from the mechanism itself. Off-target toxicity requires separate assessment through binding prediction and selectivity profiling.</p>
</div>
</div>
</section>
<section id="sec-ch29-expression-toxicity" class="level3" data-number="29.4.2">
<h3 data-number="29.4.2" class="anchored" data-anchor-id="sec-ch29-expression-toxicity"><span class="header-section-number">29.4.2</span> Expression-Based Toxicity Prediction</h3>
<p>Tissue expression patterns inform toxicity risk. A target expressed highly in hepatocytes poses greater hepatotoxicity risk than one expressed primarily in the target tissue. Single-cell foundation models (<span class="quarto-unresolved-ref">?sec-ch18-cell-annotation</span>; <span class="quarto-unresolved-ref">?sec-ch19-imputation</span>) provide cell-type-resolved expression information, enabling predictions about which cell types might be affected by target modulation.</p>
<p>More sophisticated approaches use perturbation-response models trained on CRISPR screens and drug treatment data. Given a target knockdown or drug treatment, these models predict transcriptomic responses across cell types. If the predicted response signature resembles known toxicity signatures (mitochondrial stress, DNA damage response, inflammatory activation), that prediction informs safety risk assessment.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: Predicting Hepatotoxicity from Perturbation Signatures
</div>
</div>
<div class="callout-body-container callout-body">
<p>A candidate target, RIPK1, shows strong genetic support for inflammatory disease. Before advancing to animal studies, the team uses perturbation-response models to assess hepatotoxicity risk.</p>
<p><strong>Step 1: Predict transcriptomic response.</strong> Using a model trained on the Connectivity Map and CRISPR perturbation databases, predict the gene expression changes in hepatocytes following RIPK1 inhibition.</p>
<p><strong>Step 2: Compare to toxicity signatures.</strong> The predicted response shows: - 78% similarity to the “mitochondrial stress” signature (genes like DDIT3, ATF4, HSPA5 upregulated) - 45% similarity to the “apoptosis induction” signature - 12% similarity to the “DNA damage response” signature</p>
<p><strong>Step 3: Contextualize with genetic data.</strong> PheWAS analysis of RIPK1 loss-of-function variant carriers shows elevated liver enzyme levels (ALT, AST) compared to non-carriers (OR = 1.4, p = 0.02).</p>
<p><strong>Interpretation:</strong> The convergent evidence—perturbation signature similarity to mitochondrial stress + genetic association with liver enzyme elevation—suggests hepatotoxicity risk. The team designs the lead optimization campaign to monitor hepatocyte viability assays and prioritizes compounds with improved selectivity over related kinases expressed in liver.</p>
<p>This predictive safety signal emerged computationally before any animal testing, enabling risk-aware medicinal chemistry from the program’s outset.</p>
</div>
</div>
</section>
<section id="sec-ch29-integrated-toxicity" class="level3" data-number="29.4.3">
<h3 data-number="29.4.3" class="anchored" data-anchor-id="sec-ch29-integrated-toxicity"><span class="header-section-number">29.4.3</span> Integrating Genomic Context with Chemical Properties</h3>
<p>Ultimate toxicity prediction requires integrating target information with compound properties. The same molecule might be safe or toxic depending on its selectivity profile, metabolism, and tissue distribution. Foundation models provide the biological context (target properties, off-target predictions, expression patterns) that complements chemical property predictions (metabolism, reactivity, distribution) in integrated toxicity models.</p>
<p>The field remains early: prospective validation of foundation model toxicity predictions against clinical outcomes is limited. Current utility lies in prioritizing compounds for experimental toxicity testing and in generating hypotheses about liability mechanisms, rather than replacing traditional safety pharmacology.</p>
</section>
</section>
<section id="sec-ch29-functional-screens" class="level2" data-number="29.5">
<h2 data-number="29.5" class="anchored" data-anchor-id="sec-ch29-functional-screens"><span class="header-section-number">29.5</span> Functional Genomics Screens and Perturbation Models</h2>
<p>While human genetics offers observational evidence, drug discovery relies heavily on perturbation experiments that directly test hypotheses. CRISPR knockout and knockdown screens, saturation mutagenesis of protein domains, <strong>massively parallel reporter assays (MPRAs)</strong> of regulatory elements, and Perturb-seq experiments linking genetic perturbations to single-cell transcriptomic responses all generate data that both validates targets and improves models.</p>
<div id="fig-perturb-seq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-perturb-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_6/ch29/04-fig-perturb-seq.svg" class="img-fluid figure-img"></p>
<figcaption>Perturb-seq for mechanism discovery</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-perturb-seq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.4: Perturb-seq for mechanism discovery. Pooled CRISPR libraries target hundreds to thousands of genes; single-cell capture identifies both the perturbation (guide barcode) and its effect (expression profile). The resulting matrix directly measures gene-gene regulatory relationships—interventional data that foundation models cannot learn from observation alone. FM integration: predict perturbation effects for virtual screening, interpret expression signatures for mechanism discovery, and identify informative perturbations for active learning.
</figcaption>
</figure>
</div>
<section id="sec-ch29-library-design" class="level3" data-number="29.5.1">
<h3 data-number="29.5.1" class="anchored" data-anchor-id="sec-ch29-library-design"><span class="header-section-number">29.5.1</span> Designing Informative Perturbation Libraries</h3>
<p>Traditional pooled screens use simple design rules: one guide RNA per exon, or tiling a regulatory region at fixed spacing. Foundation models enable smarter library design by providing priors over which perturbations are likely to be informative.</p>
<p>Variant effect scores from protein foundation models can prioritize which amino acid positions are most likely to reveal functional differences when mutated. Positions predicted to be highly constrained and structurally important warrant more thorough coverage than positions predicted to be mutationally tolerant (<span class="quarto-unresolved-ref">?sec-ch14-protein-vep</span>). Regulatory foundation models can highlight which enhancer or promoter regions are predicted to have the largest expression effects in the cell type of interest, focusing screening effort on high-impact regions (<a href="../part_3/p3-ch16-regulatory.html#sec-ch16-enformer" class="quarto-xref"><span>Section 16.2</span></a>; <span class="quarto-unresolved-ref">?sec-ch14-enformer-vep</span>).</p>
<p>Beyond prioritization, foundation models can guide combinatorial design. <strong>Model uncertainty</strong>, the degree to which a model is confident in its predictions, identifies regions where experimental data would be most informative (<a href="../part_5/p5-ch23-uncertainty.html#sec-ch23-epistemic" class="quarto-xref"><span>Section 23.1.2</span></a>; <a href="../part_5/p5-ch23-uncertainty.html#sec-ch23-selective-prediction" class="quarto-xref"><span>Section 23.7</span></a>). Positions where the model makes uncertain predictions are precisely those where experimental measurement adds the most value. <strong>Active learning</strong> strategies that select perturbations to maximize expected information gain can dramatically improve the efficiency of screening campaigns. The principle underlying active learning is that not all experiments are equally informative: testing a variant where the model already has high confidence provides little new knowledge, while testing uncertain predictions resolves ambiguity and improves future predictions across related sequences. By iteratively selecting the most informative experiments, active learning can achieve the same model accuracy with 10-100x fewer measurements than random sampling, a critical advantage when each perturbation experiment costs significant time and resources.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>A foundation model predicts that positions 45-60 in a protein domain are highly constrained, while positions 120-135 have high uncertainty in their functional predictions. Which region should receive more variants in a saturation mutagenesis library, and why?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The high-uncertainty region (positions 120-135) should receive more variants. Active learning principles suggest testing where the model is uncertain provides the most information to improve predictions. The highly constrained region (45-60) will likely show most mutations are deleterious, which confirms existing predictions but teaches us little new. The uncertain region may reveal unexpected functional tolerance or sensitivity that refines the model for future predictions.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-ch29-perturb-seq" class="level3" data-number="29.5.2">
<h3 data-number="29.5.2" class="anchored" data-anchor-id="sec-ch29-perturb-seq"><span class="header-section-number">29.5.2</span> Perturb-seq and Transcriptomic Readouts</h3>
<p>Perturb-seq experiments combine pooled genetic screens with single-cell RNA sequencing, linking each perturbation to its transcriptomic consequences. These data are exceptionally rich: rather than a single phenotypic readout (viability, fluorescence), each cell provides a high-dimensional expression profile reflecting how the perturbation affected cellular state.</p>
<p>Foundation models trained on Perturb-seq data learn to predict transcriptomic responses to genetic perturbations (<span class="quarto-unresolved-ref">?sec-ch16-perturbation</span> for architectural details). Given a gene knockdown, these models predict which other genes will be up- or down-regulated, providing a functional signature for each target. Similar signatures suggest similar biology; divergent signatures suggest distinct mechanisms even for targets in the same pathway.</p>
<p>The drug discovery application is perturbation matching. Given a disease state characterized by a transcriptomic signature (perhaps derived from patient samples or disease models), foundation models can identify perturbations whose predicted response signature would move the system toward a healthier state. If knocking down gene X reverses the disease signature, X becomes a candidate therapeutic target. If treating with drug Y produces a signature similar to knocking down gene X, Y becomes a candidate molecule for that mechanism <em>[Citation Needed]</em>.</p>
</section>
<section id="sec-ch29-lab-in-loop" class="level3" data-number="29.5.3">
<h3 data-number="29.5.3" class="anchored" data-anchor-id="sec-ch29-lab-in-loop"><span class="header-section-number">29.5.3</span> Closing the Loop: Lab-in-the-Loop Refinement</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advanced Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section covers active learning and iterative experimental design. These concepts require familiarity with uncertainty quantification (<a href="../part_5/p5-ch23-uncertainty.html#sec-ch23-epistemic" class="quarto-xref"><span>Section 23.1.2</span></a>) and transfer learning (<span class="quarto-unresolved-ref">?sec-ch09-full-finetuning</span>). Readers may wish to review these topics before proceeding.</p>
</div>
</div>
<p>Iterative refinement represents a particularly valuable application of foundation models in functional genomics. Screen outcomes provide labeled examples that can <strong>fine-tune</strong> sequence-to-function models for the specific biological context of interest (<span class="quarto-unresolved-ref">?sec-ch09-full-finetuning</span> for transfer learning strategies).</p>
<p>Consider an MPRA that assays thousands of enhancer variants for their effects on reporter gene expression in a disease-relevant cell type. These sequence-activity pairs directly supervise expression-prediction foundation models, dramatically improving their accuracy for that locus and tissue. The refined model then makes better predictions for the next round of experiments, suggesting which additional variants would be most informative to test.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight: The Bayesian Interpretation of Lab-in-the-Loop
</div>
</div>
<div class="callout-body-container callout-body">
<p>This lab-in-the-loop cycle follows a Bayesian logic: foundation models provide the <em>prior</em> (general knowledge about sequence-function relationships learned from millions of sequences); experiments provide the <em>likelihood</em> (specific measurements in the system of interest); and the <em>posterior</em> (fine-tuned model) makes better predictions by combining both. The more informative the experiments (high uncertainty positions), the more the posterior improves over the prior.</p>
</div>
</div>
<p>This lab-in-the-loop cycle accelerates discovery while improving model accuracy in disease-relevant regions of sequence space. Foundation models provide the prior (general knowledge about sequence-function relationships); experiments provide the likelihood (specific measurements in the system of interest); and the posterior (updated model) makes better predictions for subsequent experiments.</p>
</section>
</section>
<section id="sec-ch29-biomarkers" class="level2" data-number="29.6">
<h2 data-number="29.6" class="anchored" data-anchor-id="sec-ch29-biomarkers"><span class="header-section-number">29.6</span> Biomarker Development and Patient Stratification</h2>
<p>Even when a target is well validated, many programs fail in clinical trials because the right patients were not enrolled, the right endpoints were not measured, or the treatment effect was diluted across a heterogeneous population. Foundation model representations provide new tools for defining and validating biomarkers.</p>
<div id="fig-biomarker-pipeline" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-biomarker-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_6/ch29/05-fig-biomarker-pipeline.svg" class="img-fluid figure-img"></p>
<figcaption>Biomarker discovery pipeline with foundation models</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-biomarker-pipeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.5: Biomarker discovery pipeline with foundation models. FM embeddings from patient molecular data provide rich features for association discovery with clinical outcomes. Candidate biomarkers emerge from features distinguishing responders from non-responders. Technical validation develops reproducible assays; clinical validation demonstrates utility in prospective trials. Timeline reality: discovery in months, but clinical validation requires years. Foundation models accelerate discovery but cannot bypass the clinical validation bottleneck required for regulatory approval and clinical adoption.
</figcaption>
</figure>
</div>
<section id="sec-ch29-stratification-features" class="level3" data-number="29.6.1">
<h3 data-number="29.6.1" class="anchored" data-anchor-id="sec-ch29-stratification-features"><span class="header-section-number">29.6.1</span> Foundation Model Features for Stratification</h3>
<p>Classical <strong>polygenic scores</strong> summarize additive effects of common variants on disease risk (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-pgs-construction" class="quarto-xref"><span>Section 3.5</span></a>). These scores have proven useful for patient enrichment in cardiovascular and metabolic disease trials, selecting patients at highest genetic risk who might benefit most from intervention <em>[Citation Needed]</em>. The enrichment logic is straightforward: if a drug reduces cardiovascular events by 30% relative risk, enrolling patients with 2x baseline risk doubles the absolute benefit and thus the statistical power to detect efficacy. High-risk patients also have more room for improvement, making treatment effects more detectable. Deep learning methods extend this approach by learning nonlinear genotype-phenotype mappings that capture interactions and nonadditive effects.</p>
<p>Foundation models enhance polygenic prediction in several ways. Instead of using raw genotypes as inputs, models can use variant effect scores, regulatory predictions, or gene-level embeddings derived from foundation models. This captures biological context that simple genotypes miss. Models trained on variant embeddings rather than binary genotype calls can capture subtle differences between variants at the same position, distinguishing a mildly damaging missense from a severely damaging one even when both are heterozygous.</p>
<p>Transfer across populations represents a particular strength (see <a href="../part_1/p1-ch03-gwas.html#sec-ch03-portability" class="quarto-xref"><span>Section 3.7</span></a>). Foundation models trained on diverse genomes provide representations that may generalize more robustly across ancestries than models trained on individual cohorts. Fine-mapping-aware approaches that use foundation model features can reduce dependence on linkage disequilibrium patterns that vary across populations, potentially improving the portability of genetic risk predictors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Traditional polygenic scores use the same weight for all heterozygous carriers of a given variant. How might foundation model embeddings allow more nuanced scoring? What information could distinguish two patients who are both heterozygous for a missense variant in the same gene?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked Example: FM-Enhanced Stratification for Cardiovascular Risk
</div>
</div>
<div class="callout-body-container callout-body">
<p>A Phase III trial for a PCSK9 inhibitor wants to enrich enrollment for high-risk patients. Compare traditional PRS to FM-enhanced stratification:</p>
<p><strong>Traditional PRS approach:</strong> - Sum of ~1 million GWAS effect sizes × genotypes - European-ancestry cohort: AUC = 0.64 for 10-year cardiovascular events - African-ancestry cohort: AUC = 0.58 (lower due to LD pattern differences) - All variants weighted equally regardless of functional impact</p>
<p><strong>FM-enhanced approach:</strong> 1. For each variant, compute AlphaMissense pathogenicity score (coding) or Enformer regulatory impact (noncoding) 2. Weight variants by functional impact: high-impact variants (score &gt; 0.8) receive 3× weight 3. Include FM-derived features: aggregate burden of predicted loss-of-function variants in LDL-related genes</p>
<p><strong>Results on held-out validation cohort (n = 15,000):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metric</th>
<th>Traditional PRS</th>
<th>FM-Enhanced</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>European AUC</td>
<td>0.64</td>
<td>0.68</td>
<td>+6%</td>
</tr>
<tr class="even">
<td>African AUC</td>
<td>0.58</td>
<td>0.65</td>
<td>+12%</td>
</tr>
<tr class="odd">
<td>Top decile relative risk</td>
<td>2.8×</td>
<td>3.4×</td>
<td>+21%</td>
</tr>
<tr class="even">
<td>Sample size for 80% power</td>
<td>4,200</td>
<td>3,100</td>
<td>-26%</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation:</strong> FM-enhanced stratification provides modest overall improvement but substantially reduces ancestry-dependent performance gaps. The 26% reduction in required sample size translates to millions of dollars in trial cost savings and faster time to results.</p>
<p>The improvement comes from FM embeddings capturing functional information that generalizes across populations better than LD-dependent effect sizes. Two patients with the same genotype at a variant may have different FM-predicted impacts based on their full genetic context.</p>
</div>
</div>
</section>
<section id="sec-ch29-multi-omic-biomarkers" class="level3" data-number="29.6.2">
<h3 data-number="29.6.2" class="anchored" data-anchor-id="sec-ch29-multi-omic-biomarkers"><span class="header-section-number">29.6.2</span> Multi-Omic Biomarker Discovery</h3>
<p>Beyond germline genetics, drug development increasingly leverages somatic genomics, transcriptomics, proteomics, and other molecular readouts. Tumor sequencing combined with expression profiling characterizes the molecular landscape of each patient’s cancer. Single-cell multiome data (RNA plus ATAC) reveal cell-state heterogeneity that bulk assays miss (see <a href="../part_4/p4-ch19-single-cell.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
<p>Foundation models trained on these data types provide embeddings that capture patient-level molecular profiles. Set-based architectures that treat each patient’s genomic features as a set (rather than assuming fixed feature positions) can handle the heterogeneity of tumor genomes, where different patients have different mutations (<span class="quarto-unresolved-ref">?sec-ch19-strategies</span>). Gene regulatory network inference models trained on atlas-scale single-cell data can extract pathway activity scores that serve as mechanistically interpretable biomarkers.</p>
<p>The key shift is that biomarkers are no longer limited to a handful of hand-picked variants or expression markers. They become functions over high-dimensional genomic and multi-omic embeddings, learned in a data-driven way yet grounded in biological priors from foundation models. A biomarker might be a region of embedding space corresponding to patients with particular molecular subtypes, defined by the model rather than by manual curation.</p>
</section>
<section id="sec-ch29-trial-design" class="level3" data-number="29.6.3">
<h3 data-number="29.6.3" class="anchored" data-anchor-id="sec-ch29-trial-design"><span class="header-section-number">29.6.3</span> Trial Design and Endpoint Selection</h3>
<p>Foundation model predictions inform trial design at multiple stages. Patient enrichment uses genetic risk scores or molecular subtypes to select patients most likely to respond, increasing statistical power and reducing required sample sizes. Adaptive designs use intermediate biomarker responses to modify randomization or dosing during the trial. Endpoint selection uses molecular signatures to define pharmacodynamic biomarkers that indicate target engagement, supporting dose selection and early efficacy signals.</p>
<p>Regulatory agencies increasingly accept genomic biomarkers for patient selection in oncology and are developing frameworks for other therapeutic areas <em>[Citation Needed]</em>. The challenge is validation: demonstrating that foundation model predictions actually stratify patient outcomes requires prospective trials or well-designed retrospective analyses with appropriate controls for confounding (see <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>).</p>
</section>
</section>
<section id="sec-ch29-industry-workflows" class="level2" data-number="29.7">
<h2 data-number="29.7" class="anchored" data-anchor-id="sec-ch29-industry-workflows"><span class="header-section-number">29.7</span> Industry Workflows and Infrastructure</h2>
<p>For pharmaceutical and biotechnology organizations, the challenge is not whether they can access a foundation model but how to integrate these models into existing data platforms, governance structures, and decision-making processes.</p>
<section id="sec-ch29-model-infrastructure" class="level3" data-number="29.7.1">
<h3 data-number="29.7.1" class="anchored" data-anchor-id="sec-ch29-model-infrastructure"><span class="header-section-number">29.7.1</span> Building Model Infrastructure</h3>
<p>In mature organizations, foundation models should be treated as shared infrastructure rather than ad hoc scripts developed by individual project teams. A well-organized model catalog contains DNA language models (<em>Nucleotide Transformer</em>, <em>HyenaDNA</em>, <em>GENA-LM</em>), sequence-to-function models (<em>Enformer</em>, <em>Borzoi</em>), and variant effect predictors (<em>AlphaMissense</em>, <em>GPN-MSA</em>, <em>CADD</em>) with documented capabilities, limitations, and appropriate use cases (see <a href="../appendix/app-d-models.html" class="quarto-xref"><span>Appendix D</span></a> for model reference).</p>
<p>Feature services provide centralized APIs that accept variants, genomic intervals, or genes as input and return embeddings, predicted functional profiles, or risk features. Centralization enables consistency across programs and avoids redundant computation. Logging and versioning ensure that analyses can be reproduced even as models and data evolve.</p>
<p>Data governance maintains clear separation between models trained on public data versus sensitive internal cohorts. Internal data, including proprietary clinical trial data, patient samples, and collaborator contributions, requires careful handling. Guardrails define where internal data can be used for fine-tuning and how resulting models can be shared or published.</p>
</section>
<section id="sec-ch29-build-buy-finetune" class="level3" data-number="29.7.2">
<h3 data-number="29.7.2" class="anchored" data-anchor-id="sec-ch29-build-buy-finetune"><span class="header-section-number">29.7.2</span> Strategic Choices: Build, Buy, or Fine-Tune</h3>
<p>Organizations face three strategic options when adopting foundation models.</p>
<div id="tbl-build-buy-finetune" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-build-buy-finetune-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.2: Strategic options for foundation model adoption in drug discovery organizations. The optimal choice depends on internal data assets, computational resources, and use case specificity.
</figcaption>
<div aria-describedby="tbl-build-buy-finetune-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 25%">
<col style="width: 31%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Strategy</th>
<th>Advantages</th>
<th>Disadvantages</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Use external models as-is</strong></td>
<td>Low cost, community benchmarked, fast deployment</td>
<td>May not fit internal populations or assays</td>
<td>Early exploration, non-differentiated applications</td>
</tr>
<tr class="even">
<td><strong>Fine-tune open-source FMs</strong></td>
<td>Retains general knowledge, adapts to internal data</td>
<td>Requires compute and ML expertise, privacy controls</td>
<td>Companies with internal biobanks, proprietary phenotypes</td>
</tr>
<tr class="odd">
<td><strong>Train bespoke internal models</strong></td>
<td>Maximum control, aligned with specific use cases</td>
<td>Highest cost, risk of overfitting, long timelines</td>
<td>Unique data assets, differentiated therapeutic areas</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Using external models as-is offers low upfront cost and benefits from community benchmarking, but may not capture organization-specific populations, assays, or therapeutic areas. A model trained primarily on European ancestry populations may perform poorly on a company’s Asian-focused programs; a model trained on common cell lines may miss biology relevant to rare disease indications.</p>
<p>Fine-tuning open-source foundation models on internal data retains general representations while adapting to local data distributions (see <a href="../part_2/p2-ch09-transfer.html" class="quarto-xref"><span>Chapter 9</span></a> for fine-tuning approaches). This approach requires computational investment and careful privacy controls, but often provides the best balance of generality and specificity. A company with large internal biobank data can fine-tune a general variant effect predictor on that cohort, improving predictions for its patient populations without sacrificing the broad knowledge captured during pretraining.</p>
<p>Training bespoke internal models from scratch offers maximum control and allows alignment of pretraining objectives with specific use cases (see <a href="../part_2/p2-ch08-pretraining.html" class="quarto-xref"><span>Chapter 8</span></a>). A company focused on rare diseases might pretrain on sequences and phenotypes particularly relevant to that space. The cost is substantial: pretraining requires significant compute, data engineering, and machine learning expertise (see <a href="../appendix/app-b-compute.html" class="quarto-xref"><span>Appendix B</span></a>). There is also risk of overfitting to narrow internal datasets if the pretraining corpus is not sufficiently diverse.</p>
<p>In practice, most organizations adopt hybrid strategies. They start with public foundation models for early exploration and non-sensitive applications, gradually fine-tune on internal data as value becomes clear, and reserve from-scratch training for cases where unique data assets justify the investment. Lightweight model-serving infrastructure handles latency-sensitive applications such as clinical decision support, while heavier offline systems support large-scale research workloads.</p>
</section>
<section id="sec-ch29-timelines" class="level3" data-number="29.7.3">
<h3 data-number="29.7.3" class="anchored" data-anchor-id="sec-ch29-timelines"><span class="header-section-number">29.7.3</span> Industry Context: Timelines and Decision Gates</h3>
<p>Academic machine learning research optimizes benchmark performance; drug discovery optimizes probability of clinical and commercial success under time and resource constraints. Understanding industry context helps foundation model practitioners contribute effectively.</p>
<p>Drug discovery programs progress through gates: target validation, candidate selection, investigational new drug filing, and clinical trial phases. Each gate requires specific evidence: biological rationale, efficacy data, safety data, manufacturing feasibility. Foundation model contributions must align with gate requirements. A beautiful embedding space is valueless if it cannot be translated into evidence that advances a program through its next gate.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Aligning FM Work with Drug Development Gates
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 39%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Gate</th>
<th>Key Questions</th>
<th>FM Contribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Target validation</td>
<td>Is the target disease-relevant and modifiable?</td>
<td>Genetic evidence aggregation, VEP scoring, network context</td>
</tr>
<tr class="even">
<td>Lead selection</td>
<td>Which molecules have best target engagement?</td>
<td>DTI prediction, selectivity profiling</td>
</tr>
<tr class="odd">
<td>Preclinical</td>
<td>What are safety liabilities?</td>
<td>PheWAS-informed toxicity prediction, off-target flags</td>
</tr>
<tr class="even">
<td>Clinical Phase I</td>
<td>Is target engaged at tolerable doses?</td>
<td>Pharmacodynamic biomarkers</td>
</tr>
<tr class="odd">
<td>Clinical Phase II/III</td>
<td>Which patients respond?</td>
<td>Stratification biomarkers, enrichment scores</td>
</tr>
</tbody>
</table>
<p>For each application, ask: “What decision does this enable, and when must that decision be made?”</p>
</div>
</div>
<p>Timelines matter. A prediction that takes six months to validate experimentally may be worthless if the program decision must be made in three months. Foundation models that enable faster experiments (through better library design, prioritization, or interpretation) create more value than models that provide incrementally better predictions but require the same experimental timeline to validate.</p>
<p>Biotechnology companies and pharmaceutical companies operate differently. Biotechs often focus on single programs with limited resources, prioritizing speed and risk-taking. Pharma companies manage portfolios across therapeutic areas, prioritizing consistency and scalability. Foundation model infrastructure that serves one context may not serve the other. A boutique biotech might prefer lightweight, single-purpose models; a large pharma might invest in comprehensive infrastructure serving dozens of programs.</p>
</section>
<section id="sec-ch29-ip-data" class="level3" data-number="29.7.4">
<h3 data-number="29.7.4" class="anchored" data-anchor-id="sec-ch29-ip-data"><span class="header-section-number">29.7.4</span> Intellectual Property and Data Considerations</h3>
<p>Foundation models raise new questions around intellectual property, data sharing, and regulatory expectations that organizations must navigate.</p>
<p>Models trained on proprietary data can be valuable assets but are difficult to patent directly. The model architecture is typically based on published methods; the weights reflect training data that may include public and proprietary components. Downstream discoveries, including specific targets, biomarkers, and therapeutic hypotheses derived from foundation model analyses, are more clearly protectable but require careful documentation of inventive contribution.</p>
<p>Collaborative model development across institutions may require federated learning or model-to-data paradigms, especially for patient-level data. Genomic data carries re-identification risk (see <a href="../part_5/p5-ch26-regulatory.html#sec-ch26-privacy" class="quarto-xref"><span>Section 26.3</span></a>); sharing raw data, even for model training, requires appropriate consent and data use agreements. Federated approaches that train on local data without centralizing raw information can enable multi-institutional collaboration while respecting privacy constraints.</p>
<p>For regulatory submissions, foundation models used in drug development create documentation requirements. If a model informed target selection, patient stratification, or safety assessment, regulators may request information about model training, validation, and performance across subgroups (see <a href="../part_5/p5-ch26-regulatory.html#sec-ch26-regulatory" class="quarto-xref"><span>Section 26.1</span></a>). The confounding and interpretability challenges discussed in <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a> and <a href="../part_5/p5-ch24-interpretability.html" class="quarto-xref"><span>Chapter 24</span></a> become acute when models inform pivotal decisions in drug development. Clear documentation trails from model prediction to program decision support regulatory review.</p>
</section>
</section>
<section id="sec-ch29-evaluation" class="level2" data-number="29.8">
<h2 data-number="29.8" class="anchored" data-anchor-id="sec-ch29-evaluation"><span class="header-section-number">29.8</span> Evaluation and Validation</h2>
<p>Evaluating foundation model contributions to drug discovery requires carefully separating model performance from scientific and clinical validity. A model that achieves high benchmark scores may still fail to improve drug discovery outcomes; a model with modest benchmarks may provide actionable insights that advance programs.</p>
<section id="sec-ch29-benchmark-limits" class="level3" data-number="29.8.1">
<h3 data-number="29.8.1" class="anchored" data-anchor-id="sec-ch29-benchmark-limits"><span class="header-section-number">29.8.1</span> Benchmark Limitations</h3>
<p>Many published benchmarks draw targets and drugs from the same databases used to pretrain models, creating risk of leakage that inflates performance estimates (<a href="../part_2/p2-ch11-benchmarks.html#sec-ch11-benchmark-leakage" class="quarto-xref"><span>Section 12.4.4</span></a>; <a href="../part_2/p2-ch11-benchmarks.html#sec-ch11-leakage-detection" class="quarto-xref"><span>Section 12.4</span></a>). Repurposing success stories often rely on retrospective data mining with limited prospective validation. The ultimate test of a foundation model for drug discovery is whether it identifies targets that succeed in clinical trials, a test that takes years and confounds model contribution with countless other factors.</p>
<p>Confounding pervades drug discovery data (see <a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>). Models trained on observational clinical and genomic data inherit confounders from those data. Drug-disease associations learned by foundation models may reflect treatment patterns rather than true causal relationships. Confounding by indication (sicker patients receive different treatments), survivorship bias (only patients who survived long enough enter certain analyses), and healthcare access patterns all threaten validity. Genetic instruments and careful epidemiologic designs remain essential for causal claims that foundation model predictions cannot provide alone.</p>
</section>
<section id="sec-ch29-prediction-validation" class="level3" data-number="29.8.2">
<h3 data-number="29.8.2" class="anchored" data-anchor-id="sec-ch29-prediction-validation"><span class="header-section-number">29.8.2</span> From Prediction to Validation</h3>
<p>Foundation model predictions are hypotheses, not conclusions. A target ranked highly by genetic evidence and foundation model scoring still requires experimental validation. The value of foundation models lies in prioritizing which hypotheses to test, not in replacing experimental testing.</p>
<p>Validation strategies depend on the application. Target predictions can be validated through functional genomics screens that test whether predicted targets affect disease-relevant phenotypes. Biomarker predictions require retrospective validation on held-out cohorts or prospective validation in clinical trials. Repurposing predictions require real-world evidence analyses or prospective trials.</p>
<p>The timeline for validation matters. Some predictions can be tested in weeks (cell-based assays for target validation); others require years (clinical outcomes for biomarkers). Foundation model contributions should be assessed on timescales relevant to drug discovery decisions, not just immediate benchmark performance.</p>
</section>
</section>
<section id="sec-ch29-molecular-design" class="level2" data-number="29.9">
<h2 data-number="29.9" class="anchored" data-anchor-id="sec-ch29-molecular-design"><span class="header-section-number">29.9</span> Connections to Molecular Design</h2>
<p>Foundation model representations connect target identification to downstream molecular design. The bridge between genomic and molecular foundation models typically involves using target context as conditioning signals for molecule generation. Gene-level embeddings from genomic foundation models, reflecting genetic evidence, tissue specificity, and network context, can condition chemistry models that propose molecules targeting that gene.</p>
<p>Multi-modal foundation models jointly trained on DNA, RNA, proteins, structures, small molecules, and phenotypic readouts learn representations that span these modalities (see <a href="../part_4/p4-ch22-multi-omics.html" class="quarto-xref"><span>Chapter 22</span></a>). Such models can predict not just whether a molecule binds a target, but how target modulation in a particular genetic context might affect cellular phenotypes. Closed-loop optimization uses genomic foundation models to predict target relevance and liability, chemistry and protein foundation models to propose molecules, and experimental feedback to update both model types in active learning cycles.</p>
<p>The detailed treatment of molecular design belongs to <a href="p6-ch30-design.html" class="quarto-xref"><span>Chapter 30</span></a>. From a target identification perspective, the key point is that genomic foundation models determine whether a target is worth pursuing; downstream models then optimize how to hit it. The investment in accurate target identification and validation pays dividends throughout the drug discovery pipeline by ensuring that optimization efforts focus on targets with the highest probability of clinical success.</p>
</section>
<section id="sec-ch29-conclusion" class="level2" data-number="29.10">
<h2 data-number="29.10" class="anchored" data-anchor-id="sec-ch29-conclusion"><span class="header-section-number">29.10</span> Prioritization, Not Automation</h2>
<p>Foundation models connect to drug discovery not as replacements for experimental validation but as tools that reduce risk and focus resources. Target discovery workflows aggregate variant-level predictions into gene-level evidence, integrating fine-mapping, variant effect prediction, and regulatory modeling to prioritize candidates with strong genetic and mechanistic support. Network-aware approaches propagate genetic signals through protein and regulatory networks to identify druggable nodes and repurposing opportunities. Drug-target interaction prediction uses foundation model representations to assess binding, selectivity, and safety liabilities before synthesis. Functional genomics screens leverage foundation models for library design and iterative refinement. Biomarker development uses foundation model features for patient stratification and trial enrichment.</p>
<p>Throughout these applications, the value proposition is acceleration and prioritization, not automation of discovery. Foundation models help identify the most promising targets, design the most informative experiments, and select the patients most likely to benefit. Programs that would have required years of hypothesis testing can reach the right target faster. Screens that would have required exhaustive enumeration can focus on high-priority candidates. The fundamental uncertainties of drug development remain: targets validated genetically may still fail in trials, predictions of binding may not translate to efficacy, and patients selected by biomarkers may still not respond. Foundation models reduce risk without eliminating it.</p>
<p>Sequence design (<a href="p6-ch30-design.html" class="quarto-xref"><span>Chapter 30</span></a>) extends these ideas from analysis to generation, where foundation models not only evaluate existing sequences but propose new ones optimized for therapeutic function. The transition from interpretation to design represents the frontier where foundation models become engines for creating biology, not just understanding it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li>Why do genetically validated drug targets succeed at higher rates in clinical trials? What specific evidence does human genetics provide that other target selection methods lack?</li>
<li>Describe the pipeline for aggregating variant-level foundation model predictions into gene-level target prioritization. What are the key challenges in connecting noncoding variants to target genes?</li>
<li>How do network-aware approaches differ from single-gene analysis in target discovery? When might a gene with modest GWAS evidence be prioritized over one with stronger statistical association?</li>
<li>What is the difference between exploiting model predictions (choosing high-scoring designs) versus exploring uncertain regions in active learning? When should you prioritize each strategy?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Genetic validation advantage</strong>: Genetically validated targets succeed at approximately twice the rate of non-validated targets because human genetics provides causal evidence of target-disease relationships through lifelong modulation in real populations. Unlike correlational evidence from expression studies or pathway membership, genetic associations reflect actual consequences of gene function changes, including protective variants that indicate direction of effect and human knockouts that demonstrate the physiological consequences of complete gene inactivation.</p></li>
<li><p><strong>Variant-to-gene aggregation</strong>: The pipeline starts with GWAS summary statistics and fine-mapping to identify credible causal variants, then applies foundation models to score regulatory and coding impacts (using models like AlphaMissense for coding variants and Enformer for regulatory effects). The key challenge for noncoding variants is connecting them to target genes, which requires integrating chromatin conformation data (Hi-C), eQTL colocalization, enhancer-gene predictions from regulatory models, and network proximity evidence to determine which gene is actually affected by a regulatory variant.</p></li>
<li><p><strong>Network-aware vs.&nbsp;single-gene approaches</strong>: Network-aware approaches recognize that proteins function in complexes and pathways, so genetic evidence concentrated in a functional module provides stronger validation than isolated hits. A gene with modest GWAS significance but strong connections to multiple well-validated disease genes may be prioritized over an isolated genome-wide significant hit with unclear mechanism, because network context reveals “near-miss” targets that aggregate signals across functionally related genes rather than requiring each target to independently reach statistical significance.</p></li>
<li><p><strong>Exploitation vs.&nbsp;exploration in active learning</strong>: Exploitation means testing high-scoring predictions where the model is confident, which validates existing knowledge but provides limited new information. Exploration means testing regions where the model has high uncertainty, which maximally improves future predictions by resolving ambiguity. You should prioritize exploration when building foundational understanding (early screening phases) and shift toward exploitation when refining known mechanisms or selecting final candidates for advancement, as uncertain regions teach the model more and improve predictions across related sequences.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p><strong>Core Concepts:</strong></p>
<ul>
<li><strong>Genetic target validation</strong>: Targets with genetic support succeed at ~2x the rate of unsupported targets; foundation models provide mechanistic context for genetic associations</li>
<li><strong>Variant-to-gene aggregation</strong>: Pipelines integrate fine-mapping, VEP scoring, and regulatory predictions to rank candidate targets</li>
<li><strong>Network-aware discovery</strong>: Graph neural networks propagate genetic signals through interaction networks, recovering targets missed by single-gene analysis</li>
<li><strong>Drug-target interaction</strong>: Protein and chemical embeddings enable binding prediction without experimental structures</li>
<li><strong>Toxicity prediction</strong>: PheWAS associations, expression patterns, and off-target predictions inform safety assessment</li>
<li><strong>Functional genomics</strong>: Foundation models guide library design and enable perturbation matching for target validation</li>
<li><strong>Biomarker development</strong>: Foundation model features enhance polygenic prediction and enable multi-omic stratification</li>
<li><strong>Industry infrastructure</strong>: Strategic choices between external models, fine-tuning, and bespoke training depend on data assets and use cases</li>
</ul>
<p><strong>Key Themes:</strong></p>
<ol type="1">
<li>Foundation models provide <em>prioritization</em>, not <em>automation</em>—they identify what to test, not replace testing</li>
<li>Genetic evidence is necessary but not sufficient; experimental validation remains essential</li>
<li>Confounding pervades drug discovery data; causal inference requires careful epidemiologic design</li>
<li>Value is measured by advancing programs through gates, not benchmark performance</li>
<li>The lab-in-the-loop cycle connects foundation model predictions to experimental refinement</li>
</ol>
<p><strong>Connections:</strong> This chapter bridges variant effect prediction (<a href="../part_3/p3-ch17-vep-fm.html" class="quarto-xref"><span>Chapter 17</span></a>), network analysis (<a href="../part_4/p4-ch21-networks.html" class="quarto-xref"><span>Chapter 21</span></a>), and confounding (<a href="../part_2/p2-ch12-confounding.html" class="quarto-xref"><span>Chapter 12</span></a>) to practical drug discovery applications. The concepts connect forward to molecular design (<a href="p6-ch30-design.html" class="quarto-xref"><span>Chapter 30</span></a>).</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-avsec_alphagenome_2025" class="csl-entry" role="listitem">
Avsec, Ziga, Natasha Latysheva, and Jun Cheng. 2025. <span>“<span>AlphaGenome</span>: <span>AI</span> for Better Understanding the Genome.”</span> <em>Google DeepMind</em>. <a href="https://deepmind.google/discover/blog/alphagenome-ai-for-better-understanding-the-genome/">https://deepmind.google/discover/blog/alphagenome-ai-for-better-understanding-the-genome/</a>.
</div>
<div id="ref-benegas_gpn-msa_2024" class="csl-entry" role="listitem">
Benegas, Gonzalo, Carlos Albors, Alan J. Aw, Chengzhong Ye, and Yun S. Song. 2024. <span>“<span>GPN</span>-<span>MSA</span>: An Alignment-Based <span>DNA</span> Language Model for Genome-Wide Variant Effect Prediction.”</span> <em>bioRxiv</em>, April, 2023.10.10.561776. <a href="https://doi.org/10.1101/2023.10.10.561776">https://doi.org/10.1101/2023.10.10.561776</a>.
</div>
<div id="ref-brandes_genome-wide_2023" class="csl-entry" role="listitem">
Brandes, Nadav, Grant Goldman, Charlotte H. Wang, Chun Jimmie Ye, and Vasilis Ntranos. 2023. <span>“Genome-Wide Prediction of Disease Variant Effects with a Deep Protein Language Model.”</span> <em>Nature Genetics</em> 55 (9): 1512–22. <a href="https://doi.org/10.1038/s41588-023-01465-0">https://doi.org/10.1038/s41588-023-01465-0</a>.
</div>
<div id="ref-cheng_alphamissense_2023" class="csl-entry" role="listitem">
Cheng, Jun, Guido Novati, Joshua Pan, Clare Bycroft, Akvilė Žemgulytė, Taylor Applebaum, Alexander Pritzel, et al. 2023. <span>“[<span>AlphaMissense</span>] <span>Accurate</span> Proteome-Wide Missense Variant Effect Prediction with <span>AlphaMissense</span>.”</span> <em>Science</em> 381 (6664): eadg7492. <a href="https://doi.org/10.1126/science.adg7492">https://doi.org/10.1126/science.adg7492</a>.
</div>
<div id="ref-lin_esm-2_2022" class="csl-entry" role="listitem">
Lin, Zeming, Halil Akin, Roshan Rao, Brian Hie, Zhongkai Zhu, Wenting Lu, Allan dos Santos Costa, et al. 2022. <span>“[<span>ESM</span>-2] <span>Language</span> Models of Protein Sequences at the Scale of Evolution Enable Accurate Structure Prediction.”</span> bioRxiv. <a href="https://doi.org/10.1101/2022.07.20.500902">https://doi.org/10.1101/2022.07.20.500902</a>.
</div>
<div id="ref-rakowski_mifm_2025" class="csl-entry" role="listitem">
Rakowski, Alexander, and Christoph Lippert. 2025. <span>“[<span>MIFM</span>] <span>Multiple</span> Instance Fine-Mapping: Predicting Causal Regulatory Variants with a Deep Sequence Model.”</span> medRxiv. <a href="https://doi.org/10.1101/2025.06.13.25329551">https://doi.org/10.1101/2025.06.13.25329551</a>.
</div>
<div id="ref-wu_genome-wide_2024" class="csl-entry" role="listitem">
Wu, Yang, Zhili Zheng, Loic Thibaut2, Michael E. Goddard, Naomi R. Wray, Peter M. Visscher, and Jian Zeng. 2024. <span>“Genome-Wide Fine-Mapping Improves Identification of Causal Variants.”</span> <em>Research Square</em>, August, rs.3.rs–4759390. <a href="https://doi.org/10.21203/rs.3.rs-4759390/v1">https://doi.org/10.21203/rs.3.rs-4759390/v1</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_6/p6-ch28-rare-disease.html" class="pagination-link" aria-label="Rare Disease Diagnosis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_6/p6-ch30-design.html" class="pagination-link" aria-label="Sequence Design">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Sequence Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>