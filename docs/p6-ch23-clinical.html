<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>23&nbsp; Clinical Risk Prediction – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p6-ch24-variants.html" rel="next">
<link href="./p6--translation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p6--translation.html">Part VI — Translation and Application</a></li><li class="breadcrumb-item"><a href="./p6-ch23-clinical.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transformer Architecture for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-foundation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models: Concepts &amp; Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives &amp; Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning &amp; Deployment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">p4–multi-modal_multi-scale.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-sc-epi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-clinical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#from-polygenic-scores-to-foundation-model-enabled-risk" id="toc-from-polygenic-scores-to-foundation-model-enabled-risk" class="nav-link active" data-scroll-target="#from-polygenic-scores-to-foundation-model-enabled-risk"><span class="header-section-number">23.1</span> From Polygenic Scores to Foundation Model-Enabled Risk</a></li>
  <li><a href="#problem-framing-what-is-clinical-risk-prediction" id="toc-problem-framing-what-is-clinical-risk-prediction" class="nav-link" data-scroll-target="#problem-framing-what-is-clinical-risk-prediction"><span class="header-section-number">23.2</span> Problem Framing: What Is Clinical Risk Prediction?</a></li>
  <li><a href="#feature-sources-for-clinical-prediction" id="toc-feature-sources-for-clinical-prediction" class="nav-link" data-scroll-target="#feature-sources-for-clinical-prediction"><span class="header-section-number">23.3</span> Feature Sources for Clinical Prediction</a></li>
  <li><a href="#fusion-architectures" id="toc-fusion-architectures" class="nav-link" data-scroll-target="#fusion-architectures"><span class="header-section-number">23.4</span> Fusion Architectures</a></li>
  <li><a href="#evidence-standards-discrimination-calibration-and-clinical-utility" id="toc-evidence-standards-discrimination-calibration-and-clinical-utility" class="nav-link" data-scroll-target="#evidence-standards-discrimination-calibration-and-clinical-utility"><span class="header-section-number">23.5</span> Evidence Standards: Discrimination, Calibration, and Clinical Utility</a>
  <ul class="collapse">
  <li><a href="#discrimination" id="toc-discrimination" class="nav-link" data-scroll-target="#discrimination"><span class="header-section-number">23.5.1</span> Discrimination</a></li>
  <li><a href="#calibration-and-risk-stratification" id="toc-calibration-and-risk-stratification" class="nav-link" data-scroll-target="#calibration-and-risk-stratification"><span class="header-section-number">23.5.2</span> Calibration and Risk Stratification</a></li>
  <li><a href="#reclassification-and-net-benefit" id="toc-reclassification-and-net-benefit" class="nav-link" data-scroll-target="#reclassification-and-net-benefit"><span class="header-section-number">23.5.3</span> Reclassification and Net Benefit</a></li>
  <li><a href="#the-validation-hierarchy" id="toc-the-validation-hierarchy" class="nav-link" data-scroll-target="#the-validation-hierarchy"><span class="header-section-number">23.5.4</span> The Validation Hierarchy</a></li>
  <li><a href="#uncertainty-estimation" id="toc-uncertainty-estimation" class="nav-link" data-scroll-target="#uncertainty-estimation"><span class="header-section-number">23.5.5</span> Uncertainty Estimation</a></li>
  <li><a href="#fairness-bias-and-health-equity" id="toc-fairness-bias-and-health-equity" class="nav-link" data-scroll-target="#fairness-bias-and-health-equity"><span class="header-section-number">23.5.6</span> Fairness, Bias, and Health Equity</a></li>
  </ul></li>
  <li><a href="#clinical-integration-and-deployment" id="toc-clinical-integration-and-deployment" class="nav-link" data-scroll-target="#clinical-integration-and-deployment"><span class="header-section-number">23.6</span> Clinical Integration and Deployment</a>
  <ul class="collapse">
  <li><a href="#software-architecture-and-operationalization" id="toc-software-architecture-and-operationalization" class="nav-link" data-scroll-target="#software-architecture-and-operationalization"><span class="header-section-number">23.6.1</span> Software Architecture and Operationalization</a></li>
  </ul></li>
  <li><a href="#regulatory-and-quality-frameworks" id="toc-regulatory-and-quality-frameworks" class="nav-link" data-scroll-target="#regulatory-and-quality-frameworks"><span class="header-section-number">23.7</span> Regulatory and Quality Frameworks</a></li>
  <li><a href="#monitoring-drift-and-continual-learning" id="toc-monitoring-drift-and-continual-learning" class="nav-link" data-scroll-target="#monitoring-drift-and-continual-learning"><span class="header-section-number">23.8</span> Monitoring, Drift, and Continual Learning</a></li>
  <li><a href="#interpretability-and-clinician-trust" id="toc-interpretability-and-clinician-trust" class="nav-link" data-scroll-target="#interpretability-and-clinician-trust"><span class="header-section-number">23.9</span> Interpretability and Clinician Trust</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies"><span class="header-section-number">23.10</span> Case Studies</a>
  <ul class="collapse">
  <li><a href="#cardiometabolic-risk-stratification" id="toc-cardiometabolic-risk-stratification" class="nav-link" data-scroll-target="#cardiometabolic-risk-stratification"><span class="header-section-number">23.10.1</span> Cardiometabolic Risk Stratification</a></li>
  <li><a href="#oncology-risk-and-recurrence-prediction" id="toc-oncology-risk-and-recurrence-prediction" class="nav-link" data-scroll-target="#oncology-risk-and-recurrence-prediction"><span class="header-section-number">23.10.2</span> Oncology: Risk and Recurrence Prediction</a></li>
  <li><a href="#pharmacogenomics-and-adverse-drug-reaction-risk" id="toc-pharmacogenomics-and-adverse-drug-reaction-risk" class="nav-link" data-scroll-target="#pharmacogenomics-and-adverse-drug-reaction-risk"><span class="header-section-number">23.10.3</span> Pharmacogenomics and Adverse Drug Reaction Risk</a></li>
  </ul></li>
  <li><a href="#practical-checklist-for-translating-foundation-model-based-risk-models" id="toc-practical-checklist-for-translating-foundation-model-based-risk-models" class="nav-link" data-scroll-target="#practical-checklist-for-translating-foundation-model-based-risk-models"><span class="header-section-number">23.11</span> Practical Checklist for Translating Foundation Model-Based Risk Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p6--translation.html">Part VI — Translation and Application</a></li><li class="breadcrumb-item"><a href="./p6-ch23-clinical.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-clinical" class="quarto-section-identifier"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>Add figure: Clinical risk prediction pipeline overview showing data flow from genotype/EHR through GFM feature extraction to risk stratification and clinical decision support</li>
<li>Add figure: Validation hierarchy ladder showing progression from internal validation through external multi-site validation to prospective trials</li>
<li>Add figure: Calibration plot examples contrasting well-calibrated versus miscalibrated models, with stratification by ancestry</li>
<li>Add figure: Model drift monitoring dashboard concept showing input distribution shifts, output score histograms over time, and performance degradation alerts</li>
<li>Add figure: Multi-modal fusion architecture comparison (early, intermediate, late fusion) with representative genomic and clinical inputs</li>
<li>Add figure: System architecture diagram showing deployment infrastructure (sequencing lab, GFM service, EHR integration)</li>
<li>Add table: Evaluation metrics summary (discrimination, calibration, clinical utility) with appropriate use cases and limitations</li>
<li>Add table: Regulatory considerations for GFM-based clinical decision support systems across FDA, CE marking, and other frameworks</li>
<li>Consider adding decision curve example for cardiometabolic risk stratification showing net benefit across threshold probabilities</li>
</ul>
</div>
</div>
<p>Modern genomic foundation models provide increasingly rich representations of DNA, RNA, proteins, and multi-omic context. The preceding parts of this book have traced how these models learn from sequence and structure, predict molecular functions, and integrate information across biological scales. The natural next question is practical: how do we turn these representations into actionable predictions for individual patients?</p>
<p>This chapter focuses on clinical risk prediction and decision support, the task of estimating the probability, timing, or trajectory of outcomes such as incident disease, progression, recurrence, or adverse drug reactions. The discussion emphasizes how genomic foundation models and related deep learning approaches extend traditional polygenic scores with richer sequence-based features and epistatic structure through methods like Delphi, G2PT, and MIFM <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025 rakowski_mifm_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>; <a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>. These models combine genomic features with electronic health records and multi-omics to produce holistic patient-level risk representations, building on the systems-level integration strategies introduced in <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>. Throughout, the emphasis is on evaluation, calibration, uncertainty quantification, fairness considerations, and the practical realities of clinical deployment.</p>
<p>The chapter concludes with case studies in cardiometabolic risk, oncology risk and recurrence, and pharmacogenomics, illustrating how foundation models move from computational representations to clinical utility, followed by a practical checklist for translation teams.</p>
<section id="from-polygenic-scores-to-foundation-model-enabled-risk" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="from-polygenic-scores-to-foundation-model-enabled-risk"><span class="header-section-number">23.1</span> From Polygenic Scores to Foundation Model-Enabled Risk</h2>
<p>Classical polygenic risk scores (PRS) aggregate the effects of many common variants into a single number for a given disease, typically derived from genome-wide association studies (GWAS) and validated in held-out cohorts. As discussed in <a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a>, PRS have demonstrated that common variants contribute substantial risk for conditions such as coronary artery disease, breast cancer, and type 2 diabetes. However, traditional PRS face several limitations: they rely on linear models that cannot capture epistatic interactions, they perform poorly in non-European ancestries due to training data bias, and they reduce the entire genome to a single scalar that provides little mechanistic insight.</p>
<p>Genomic foundation models change this landscape in several ways. First, they provide richer genomic representations beyond simple linear combinations of effect sizes. Instead of relying solely on GWAS summary statistics, foundation models can encode sequence context, chromatin state, and three-dimensional genome features into high-dimensional embeddings that capture non-linear interactions and context-dependent effects. Second, they enable task-agnostic pretraining with task-specific adaptation. A single pretrained model can support many downstream clinical tasks through fine-tuning or feature extraction, amortizing the cost of large-scale pretraining across multiple applications. Third, they facilitate multi-modal risk models that naturally integrate genomic representations with electronic health records, imaging, and environmental data through the fusion architectures discussed in <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>.</p>
<p>In practice, a foundation model-enabled clinical risk system typically consists of one or more pretrained models generating variant-level or region-level embeddings, optional aggregation across the genome at the gene, pathway, or genome-wide level, and a downstream predictor that maps embeddings plus clinical covariates to risk scores or survival curves. This modular design separates the foundation model backbone from clinical prediction heads, enabling updates to either component while maintaining clear interfaces for validation and regulatory compliance.</p>
</section>
<section id="problem-framing-what-is-clinical-risk-prediction" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="problem-framing-what-is-clinical-risk-prediction"><span class="header-section-number">23.2</span> Problem Framing: What Is Clinical Risk Prediction?</h2>
<p>Clinical risk prediction is the task of mapping patient data to probabilistic statements about future outcomes. Critically, these predictions must be tied to actionable decisions rather than statistical association alone. The inputs include genotypes, family history, clinical measurements, imaging, and environmental factors. The outputs are probabilities or hazard estimates that answer specific clinical questions: What is this patient’s 10-year risk of coronary artery disease if treated with standard of care? Given current tumor characteristics and therapy, what is the hazard of recurrence within two years? If we start this medication, what is the probability of a severe adverse drug reaction in the next six months?</p>
<p>For a foundation model-based risk tool to achieve clinical adoption, you must explicitly define the outcome (incident disease, exacerbation, hospitalization, mortality, or composite endpoint), the time horizon (one-year versus 10-year risk, or lifetime risk), the target population (inclusion and exclusion criteria, age range, ancestry distribution, care setting), and the intended use case (screening, triage, preventive intervention targeting, treatment selection, or prognosis). Risk models are more likely to be adopted when they map to concrete actions such as intensifying screening programs, starting preventive therapies, tailoring surveillance frequency, or prioritizing patients for genetic counseling.</p>
<p>These questions fall into several archetypes that differ in their temporal structure and clinical context. Individual-level incident risk concerns whether a currently disease-free individual will develop disease within a specified time window, such as 10-year type 2 diabetes risk. Progression and complication risk asks which patients with an existing condition will develop complications, for example nephropathy in diabetes or heart failure after myocardial infarction. Prognosis and survival involve time-from-baseline to events such as death, recurrence, or transplant, often with censoring and competing risks that complicate standard regression approaches. Treatment response and toxicity prediction concerns whether a patient will benefit from one therapy versus another and their risk of severe toxicity or adverse drug reactions.</p>
<p>Genomic foundation models enter these problems as feature generators. They transform raw genomic and multi-omic data into structured embeddings, variant effect scores, or region-level functional annotations that can then be combined with clinical covariates in downstream prediction models. Real-world deployment typically requires fusing genomic features with electronic health records, imaging, and other omics, mirroring the multi-omics integration strategies discussed in <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>.</p>
</section>
<section id="feature-sources-for-clinical-prediction" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="feature-sources-for-clinical-prediction"><span class="header-section-number">23.3</span> Feature Sources for Clinical Prediction</h2>
<p>The features that enter clinical risk models can be organized into three broad categories that draw on different parts of the foundation model landscape.</p>
<p>The first category comprises genomics and regulatory features derived from DNA-level models. Zero-shot variant scores from DNA foundation models such as Nucleotide Transformer, HyenaDNA, and GPN provide sequence-based predictions of variant deleteriousness without requiring trait-specific training <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>. Coding variant scores from protein language models, including systems similar to AlphaMissense (discussed in earlier chapters), capture the impact of missense mutations on protein structure and function. Fine-mapped causal variant probabilities from methods like MIFM provide posterior estimates of which variants within a GWAS locus are likely causal, allowing risk models to weight variants by their evidence for causality rather than treating all associated variants equally <span class="citation" data-cites="rakowski_mifm_2025">(<a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.</p>
<p>The second category encompasses multi-omics and systems context features. Cell-type-resolved epigenomic and transcriptomic embeddings from frameworks like GLUE, SCGLUE, and CpGPT capture regulatory state across chromatin accessibility, methylation, and expression <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>. Rare-variant burden and pathway-level representations from DeepRVAT aggregate the predicted effects of multiple rare variants into gene-level or pathway-level impairment scores <span class="citation" data-cites="clarke_deeprvat_2024">(<a href="references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>. Tumor-level representations from models such as SetQuence and SetOmic, or from graph neural network-based cancer subtypers, encode the complex mutational landscapes of individual tumors <span class="citation" data-cites="jurenaite_setquence_2024 li_mogcn_2022 li_cgmega_2024">(<a href="references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>; <a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>; <a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>.</p>
<p>The third category includes clinical covariates and electronic health record data. Demographics, vitals, laboratory results, and medication history provide non-genomic risk factors that often have substantial predictive power. Problem lists, procedures, and imaging-derived features add diagnostic context. Time-varying trajectories of biomarkers such as estimated glomerular filtration rate, hemoglobin A1c, or tumor markers capture disease dynamics that static snapshots miss.</p>
</section>
<section id="fusion-architectures" class="level2" data-number="23.4">
<h2 data-number="23.4" class="anchored" data-anchor-id="fusion-architectures"><span class="header-section-number">23.4</span> Fusion Architectures</h2>
<p>Architecturally, risk models that combine these feature sources typically adopt one of the fusion strategies echoed from <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>, each with distinct tradeoffs.</p>
<p>Early fusion concatenates foundation model-derived genomic embeddings with static clinical covariates and feeds them into a single model such as a multilayer perceptron or survival regression. This approach is simple to implement and allows the model to learn arbitrary interactions between genomic and clinical features. However, early fusion is sensitive to differences in scale between modalities, handles missing data poorly since samples lacking one modality must be imputed or excluded, and can be dominated by whichever input has the most features or highest signal-to-noise ratio.</p>
<p>Intermediate fusion trains separate encoders for genomics, electronic health records, and multi-omics that produce modality-specific embeddings. A fusion layer, which might use attention mechanisms, cross-modal transformers, or graph-based integration, then combines these embeddings into a patient-level representation that downstream prediction heads use for risk estimation. Intermediate fusion is often most attractive from a practical standpoint because it allows modularity (foundation model encoders can be swapped as new versions become available) while still enabling cross-modal interactions that can capture how genomic risk manifests differently depending on clinical context.</p>
<p>Late fusion trains independent models for each modality, such as a polygenic score-only model and an electronic health record-only model, then combines their predictions through ensemble methods or a meta-model. This approach is robust to missing modalities since each sub-model operates independently, and it allows each modality to use whatever architecture works best for its data type. However, late fusion may underutilize cross-modal structure since interactions between genomic and clinical features can only be captured at the final combination stage rather than learned jointly.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> Schematic comparison of early, intermediate, and late fusion architectures for combining genomic foundation model features with clinical data. Show representative inputs (genotype matrices, EHR features, multi-omic profiles), encoder blocks, fusion mechanisms, and prediction heads. Annotate each with key advantages and limitations for clinical deployment.</p>
</div>
</div>
</section>
<section id="evidence-standards-discrimination-calibration-and-clinical-utility" class="level2" data-number="23.5">
<h2 data-number="23.5" class="anchored" data-anchor-id="evidence-standards-discrimination-calibration-and-clinical-utility"><span class="header-section-number">23.5</span> Evidence Standards: Discrimination, Calibration, and Clinical Utility</h2>
<p>Many genomic foundation models will initially be developed in research settings, but clinical deployment requires additional evidence beyond what is usually reported in machine learning papers. High performance on held-out test sets is necessary but not sufficient for clinical deployment. Risk models must be discriminative, well-calibrated, robust to distribution shift, and clinically useful in ways that justify the costs of implementation.</p>
<section id="discrimination" class="level3" data-number="23.5.1">
<h3 data-number="23.5.1" class="anchored" data-anchor-id="discrimination"><span class="header-section-number">23.5.1</span> Discrimination</h3>
<p>Discrimination measures how well a model ranks individuals by risk, distinguishing those who will experience an outcome from those who will not. For binary endpoints such as disease occurrence within a fixed time window, the area under the receiver operating characteristic curve (AUROC) summarizes discrimination across all possible classification thresholds. When outcomes are rare, as is often the case for severe adverse drug reactions or specific disease subtypes, the area under the precision-recall curve (AUPRC) is more informative because it is sensitive to how well the model identifies true positives among many negatives. For survival tasks with time-to-event outcomes and censoring, the concordance index (C-index) and time-dependent AUC generalize discrimination metrics to the survival setting.</p>
<p>Strong discrimination is necessary but not sufficient. A model that ranks patients correctly but systematically overestimates or underestimates absolute risks will lead to inappropriate clinical decisions. For a broader discussion of how discrimination metrics are used across molecular, variant-level, and trait-level tasks, see <a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>.</p>
</section>
<section id="calibration-and-risk-stratification" class="level3" data-number="23.5.2">
<h3 data-number="23.5.2" class="anchored" data-anchor-id="calibration-and-risk-stratification"><span class="header-section-number">23.5.2</span> Calibration and Risk Stratification</h3>
<p>Calibration asks whether predicted probabilities match observed frequencies. If a group of patients is assigned 20% risk of an event, approximately 20% of that group should actually experience it. Well-calibrated predictions can be taken at face value and used directly for clinical decision-making, whereas miscalibrated predictions mislead clinicians and patients regardless of how good the discrimination is.</p>
<p>Calibration is assessed through calibration plots that compare predicted risk deciles to observed event rates, statistical tests like the Hosmer-Lemeshow test, and proper scoring rules like the Brier score that combine calibration and discrimination into a single metric. These assessments should be stratified by clinically relevant subgroups such as ancestry, sex, and age, since a model that is well-calibrated overall may be systematically miscalibrated for specific populations.</p>
<p>For polygenic score-informed models, calibration is especially important because raw polygenic scores are often centered and scaled rather than calibrated to absolute risk. Mapping a polygenic score to an absolute probability of disease typically requires post-hoc models that incorporate baseline incidence and clinical covariates. Foundation models can shift score distributions as architectures evolve, meaning that recalibration may be required when swapping or updating encoders.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> Example calibration plots showing well-calibrated versus miscalibrated risk models, with stratification by ancestry group. Include observed versus predicted event rates across risk deciles, 95% confidence intervals, and annotations highlighting systematic over-prediction or under-prediction in specific subgroups.</p>
</div>
</div>
</section>
<section id="reclassification-and-net-benefit" class="level3" data-number="23.5.3">
<h3 data-number="23.5.3" class="anchored" data-anchor-id="reclassification-and-net-benefit"><span class="header-section-number">23.5.3</span> Reclassification and Net Benefit</h3>
<p>Beyond discrimination and calibration, clinical utility asks whether using the model will change decisions in a beneficial way. Net reclassification improvement quantifies how many patients are appropriately moved across risk thresholds compared to a baseline model. Decision curve analysis estimates net benefit across a range of risk thresholds, accounting for the relative costs of false positives and false negatives in clinical decision-making. For genomic foundation models, these analyses should demonstrate incremental value over existing tools such as traditional polygenic scores or clinical risk calculators.</p>
</section>
<section id="the-validation-hierarchy" class="level3" data-number="23.5.4">
<h3 data-number="23.5.4" class="anchored" data-anchor-id="the-validation-hierarchy"><span class="header-section-number">23.5.4</span> The Validation Hierarchy</h3>
<p>The strength of evidence depends critically on validation design. Internal validation through cross-validation or temporal splits within the development cohort is useful but insufficient for clinical deployment due to potential overfitting and subtle leakage, as discussed in <a href="p5-ch21-confound.html" class="quarto-xref"><span>Chapter 21</span></a>. External validation across institutions and ancestries, testing the same model in independent health systems and populations with different ancestry distributions, is essential for assessing robustness and transportability. Prospective observational validation runs the model silently in a live clinical system without influencing care, measuring real-time performance and drift over time. Prospective interventional trials use randomized or quasi-experimental designs to assess whether using the model actually improves patient outcomes, equity, and cost-effectiveness.</p>
<p>For most foundation model-based risk tools, regulators, payers, and health systems will expect at least robust external validation and, for high-stakes decisions, prospective evidence. The validation hierarchy reflects increasing confidence in clinical applicability, from internal studies that establish proof of concept to prospective trials that demonstrate real-world benefit.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> Validation hierarchy ladder showing progression from internal cross-validation through external multi-site validation (with diverse ancestries) to prospective trials and post-deployment monitoring. Overlay annotations showing where most genomic foundation model research currently stops versus what is required for clinical adoption.</p>
</div>
</div>
</section>
<section id="uncertainty-estimation" class="level3" data-number="23.5.5">
<h3 data-number="23.5.5" class="anchored" data-anchor-id="uncertainty-estimation"><span class="header-section-number">23.5.5</span> Uncertainty Estimation</h3>
<p>In high-stakes clinical settings, models should know when they do not know. Uncertainty quantification allows models to flag predictions where confidence is low, either because the input is unusual or because the model has limited evidence for its predictions.</p>
<p>Common approaches to uncertainty estimation include ensemble variance, where multiple models trained with different random seeds provide prediction intervals based on their disagreement, and Monte Carlo dropout, which approximates Bayesian uncertainty by averaging predictions across multiple stochastic forward passes. Conformal prediction provides a more principled framework for outputting risk intervals or prediction sets with guaranteed coverage under exchangeability assumptions.</p>
<p>For foundation model-based systems, uncertainty can be decomposed into genomic uncertainty (confidence in variant effect predictions, fine-mapping probabilities, or embedding reliability) and clinical uncertainty (extrapolation to new care settings, practice patterns, or patient populations). Selective prediction or abstention allows models to decline to make predictions on cases where uncertainty is high or inputs are out-of-distribution, such as patients from rare ancestries missing from training data or novel tumor subtypes that the model has not encountered. Communicating uncertainty transparently is a core component of responsible decision support.</p>
</section>
<section id="fairness-bias-and-health-equity" class="level3" data-number="23.5.6">
<h3 data-number="23.5.6" class="anchored" data-anchor-id="fairness-bias-and-health-equity"><span class="header-section-number">23.5.6</span> Fairness, Bias, and Health Equity</h3>
<p>Many genomic and electronic health record datasets reflect historical and structural inequities in who is genotyped, which populations are recruited into biobanks, and how healthcare is documented and delivered. Risk models can amplify these biases if not carefully evaluated and designed.</p>
<p>Ancestry and polygenic score portability remain central concerns. As discussed in <a href="p1-ch03-pgs.html" class="quarto-xref"><span>Chapter 3</span></a>, classical polygenic scores substantially underperform in under-represented ancestries due to the European bias in GWAS design. Foundation model-based methods such as Delphi and G2PT have the opportunity, but not the guarantee, to improve portability by leveraging functional priors and cross-ancestry information <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. Whether they succeed depends on training data composition, evaluation practices, and explicit attention to cross-ancestry performance.</p>
<p>Measurement and access bias affect electronic health record features. Which patients get genotyped, which laboratory tests are ordered, how diagnoses are coded, and how thoroughly clinical notes are documented all differ systematically across patient populations, care settings, and health systems. A model trained on one system’s data may encode these institutional patterns rather than underlying biology.</p>
<p>Health equity evaluation for foundation model-based tools should include disparity metrics that measure differences in AUROC, calibration, and net benefit across subgroups, along with error rates for high-stakes predictions. Access metrics assess who is eligible to receive the test and whether financial or geographic barriers exist. Outcome metrics evaluate whether clinical actions triggered by the model differ across groups and whether benefits accrue equitably or primarily to already advantaged populations.</p>
<p>Mitigation strategies include reweighting or resampling training data to reduce representation disparities, group-wise calibration and threshold setting to ensure equitable performance, and localized fine-tuning using data from the deployment site with careful attention to overfitting. However, technical interventions alone are insufficient. Non-technical approaches such as expanding sequencing access, subsidizing tests for underserved populations, and designing workflows that fit local constraints are equally essential.</p>
<p>Group-wise evaluation is essential. Calibration and discrimination should be assessed separately by ancestry, sex, socioeconomic proxies, and care site. A model that appears well-calibrated overall but is miscalibrated for specific groups will exacerbate rather than reduce health disparities. When necessary, fairness constraints such as equalized odds or affirmative designs targeting historically disadvantaged groups can be incorporated into model training, though such constraints involve tradeoffs with overall performance that must be navigated thoughtfully.</p>
<p>Equity is not an afterthought. For foundation models, it should inform what data to pretrain on, which benchmarks to report, and how to deploy models in practice.</p>
</section>
</section>
<section id="clinical-integration-and-deployment" class="level2" data-number="23.6">
<h2 data-number="23.6" class="anchored" data-anchor-id="clinical-integration-and-deployment"><span class="header-section-number">23.6</span> Clinical Integration and Deployment</h2>
<p>Even a beautifully validated model can fail in practice if it does not integrate into clinical workflows. Clinical genomics already has established pathways for returning results through CLIA-certified laboratories, structured reports, and genetic counseling. Genomic foundation models can augment these pathways in two main ways.</p>
<p>First, they can augment laboratory interpretation by prioritizing variants for manual review (see <a href="p5-ch20-vep.html" class="quarto-xref"><span>Chapter 20</span></a>), providing richer functional annotations such as predicted impact on splicing or chromatin accessibility, and suggesting likely disease mechanisms to support differential diagnosis. Second, they can embed risk predictions directly in the electronic health record by precomputing risk scores for patients with genomic data, surfacing these scores in structured fields or dashboards, and triggering alerts or best-practice advisories when thresholds are crossed.</p>
<p>Design choices include whether to use batch versus on-demand computation. Batch computation, such as overnight processing, is often preferable for foundation models because of their computational cost and the relative infrequency of genomic changes. Synchronous alerts at order entry versus asynchronous reports in an inbox represent another choice, as does the requirement for human-in-the-loop review by genetic counselors or specialty clinics before high-impact recommendations reach front-line clinicians.</p>
<section id="software-architecture-and-operationalization" class="level3" data-number="23.6.1">
<h3 data-number="23.6.1" class="anchored" data-anchor-id="software-architecture-and-operationalization"><span class="header-section-number">23.6.1</span> Software Architecture and Operationalization</h3>
<p>From a systems perspective, foundation model-based tools are typically deployed as services with several key components. A secure model-serving endpoint, whether on-premises or in a regulated cloud environment, handles inference requests. Input adapters transform laboratory and electronic health record data into model-ready formats. Output adapters map model outputs to structured concepts or user-facing text. Logging and monitoring infrastructure provides auditing capabilities and drift detection.</p>
<p>Regulated settings often require versioning of models, data pipelines, and reference genomes, along with audit trails for all predictions returned. Access controls and network segmentation protect genomic data, while validation environments separate from production allow safe testing of updates. For practical details about deployment patterns, hardware considerations, and monitoring stacks, see <a href="app-b-deployment.html" class="quarto-xref"><span>Appendix B</span></a>.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> System architecture diagram showing typical hospital deployment with sequencing laboratory and variant calling pipeline on the left, foundation model service (with model registry, feature store, monitoring) in the middle, and EHR with clinician-facing applications (risk dashboards, reports, alert pop-ups) on the right. Show data flows including one-time genomic upload and periodic recomputation, along with governance and approval checkpoints.</p>
</div>
</div>
</section>
</section>
<section id="regulatory-and-quality-frameworks" class="level2" data-number="23.7">
<h2 data-number="23.7" class="anchored" data-anchor-id="regulatory-and-quality-frameworks"><span class="header-section-number">23.7</span> Regulatory and Quality Frameworks</h2>
<p>It is crucial to distinguish between research-only foundation models used for discovery and hypothesis generation, clinical decision support tools that inform diagnosis or management, and in vitro diagnostic devices or laboratory-developed tests that may fall under medical device regulations. Jurisdictions differ in how they regulate AI-based clinical software, but common themes include the intended use and claims made for the tool, risk classification where high-risk tools face stricter oversight than low-risk educational reports, and change management procedures for updating models and retraining.</p>
<p>Regulators increasingly expect transparent descriptions of model training data and limitations, quantitative performance evidence across relevant subgroups, and plans for post-market surveillance and incident reporting. Beyond formal regulation, health systems often require standard operating procedures for model deployment and decommissioning, model cards and datasheets describing training data and known limitations, validation reports documenting evaluation evidence, and governance structures such as AI oversight committees that review and approve new tools.</p>
<p>Genomic foundation models introduce additional documentation needs including detailed descriptions of pretraining corpora (which genomes, which assays, from which populations), fine-tuning datasets and label definitions, and procedures for updating to new genome builds, reference panels, or assay types. The modular separation between pretrained encoders and clinical prediction heads can ease regulatory management by allowing updates to either component independently, but this requires clear versioning and compatibility testing.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> Summary table of regulatory considerations for foundation model-based clinical decision support systems. Include columns for regulatory framework (FDA, CE marking, others), device classification criteria, validation evidence requirements, post-market surveillance obligations, and considerations for model updates. Annotate with examples of how genomic foundation models might be classified under different frameworks.</p>
</div>
</div>
</section>
<section id="monitoring-drift-and-continual-learning" class="level2" data-number="23.8">
<h2 data-number="23.8" class="anchored" data-anchor-id="monitoring-drift-and-continual-learning"><span class="header-section-number">23.8</span> Monitoring, Drift, and Continual Learning</h2>
<p>Clinical deployment is not the end of the story but the beginning of a model lifecycle. Once deployed, foundation models and downstream risk models operate in non-stationary environments. Clinical practice patterns change as new treatments and guidelines emerge. Patient populations drift as screening programs expand or contract. Laboratory assays and sequencing pipelines evolve, introducing subtle distributional shifts in input features.</p>
<p>Monitoring systems should track input distributions such as genotype frequencies and electronic health record feature patterns to detect when the current patient population differs from the training population. Output distributions including risk score histograms and the fraction of patients above decision thresholds reveal whether model behavior is changing over time. Performance metrics over time, often computed via rolling windows or periodic audits, detect calibration or discrimination degradation before it becomes clinically consequential.</p>
<p>When drift is detected, several responses are possible depending on severity and type. Recalibration may suffice if the model’s ranking behavior remains sound but the mapping from scores to probabilities has shifted. Refitting a calibration layer to current data can restore well-calibrated predictions without retraining the entire model. Partial retraining of prediction heads or fusion layers can adapt to new environments while keeping foundation model weights fixed, preserving regulatory status of the backbone while adjusting to local conditions. Full continual learning, including updating foundation model backbones, requires careful safeguards to avoid catastrophic forgetting (where the model loses performance on previously well-handled cases) and maintain regulatory compliance.</p>
<p>Key components of post-deployment management include performance monitoring that tracks discrimination, calibration, and case-mix over time with separate evaluation by subgroup to detect emerging disparities. Data and concept drift monitoring watches for changes in laboratory workflows, sequencing technologies, patient populations, and the introduction of new therapies or screening programs that alter outcome incidence. Incident response processes allow clinicians to report surprising or harmful model behavior with root-cause analysis and remediation such as retraining or narrowing intended use. Governance and sunset decisions involve regular reviews by oversight committees and clear criteria for deprecating or replacing models.</p>
<p>Genomic foundation models complicate this lifecycle because updates to shared encoders can affect many downstream tools simultaneously. This argues for strong versioning and compatibility testing, staged rollouts with canary deployments, and clear communication to clinicians when underlying models change. The modular design patterns from <a href="p4-ch17-systems.html" class="quarto-xref"><span>Chapter 17</span></a>, with clear interfaces between foundation encoders and clinical prediction layers, are crucial for maintainable and updatable decision support systems.</p>
<div class="content-visible callout callout-style-default callout-note callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Visual suggestion:</strong> Model drift monitoring dashboard concept showing temporal trends in input distributions (allele frequencies, clinical feature distributions), output score histograms over time, and performance metrics (discrimination, calibration) with alert thresholds. Include examples of acceptable drift versus actionable degradation requiring intervention.</p>
</div>
</div>
</section>
<section id="interpretability-and-clinician-trust" class="level2" data-number="23.9">
<h2 data-number="23.9" class="anchored" data-anchor-id="interpretability-and-clinician-trust"><span class="header-section-number">23.9</span> Interpretability and Clinician Trust</h2>
<p>Genomic foundation models are often perceived as black boxes. In clinical settings, trust depends on more than raw performance. As discussed in <a href="p5-ch22-interp.html" class="quarto-xref"><span>Chapter 22</span></a>, interpretability methods range from simple feature importance to mechanistic model dissection. In clinical translation, you often need “interpretability for action” rather than comprehensive mechanistic understanding.</p>
<p>For variant-level predictions, this means highlighting specific variants, motifs, or genomic regions that drive risk. For multi-modal models, it involves showing contributions from genomic versus non-genomic features. For complex predictions, succinct rationales work best, such as “Genomic risk is high due to variants impacting LDL metabolism; clinical risk is elevated due to hypertension and smoking history.”</p>
<p>Communicating uncertainty is equally important. Clinically, you must differentiate aleatoric uncertainty (irreducible noise due to biology and measurement) from epistemic uncertainty (model uncertainty due to limited training data, especially in certain subgroups or genomic contexts). Practical strategies include reporting prediction intervals or credible intervals for risk estimates, especially near decision thresholds, flagging cases falling outside the training distribution such as ancestry extrapolation or rare variant patterns not seen during training, and using ensemble methods or Bayesian approaches to quantify epistemic uncertainty.</p>
<p>However, interpretability tools can themselves be misleading. They should be validated for stability and robustness and used to detect model failures such as shortcut learning from ancestry proxies rather than to retroactively justify any prediction. The goal is to provide clinicians with enough transparency to make informed decisions while acknowledging the inherent limitations of post-hoc explanation methods.</p>
</section>
<section id="case-studies" class="level2" data-number="23.10">
<h2 data-number="23.10" class="anchored" data-anchor-id="case-studies"><span class="header-section-number">23.10</span> Case Studies</h2>
<p>To make these ideas concrete, we examine three stylized case studies that build on models and concepts from earlier chapters. Each illustrates different aspects of foundation model integration into clinical risk prediction.</p>
<section id="cardiometabolic-risk-stratification" class="level3" data-number="23.10.1">
<h3 data-number="23.10.1" class="anchored" data-anchor-id="cardiometabolic-risk-stratification"><span class="header-section-number">23.10.1</span> Cardiometabolic Risk Stratification</h3>
<p>The goal of cardiometabolic risk stratification is to identify individuals at high risk of major adverse cardiovascular events, including myocardial infarction, stroke, and cardiovascular death, over a time horizon such as 10 years. This is among the most mature applications of genomic risk prediction, with established clinical frameworks like the Framingham Risk Score and ASCVD Risk Estimator providing baselines against which genomic augmentation can be evaluated.</p>
<p>The inputs for such a model combine genotype data from biobank-scale genotyping or whole-genome sequencing with foundation model features and clinical data. Variant effect scores from DNA foundation models like Nucleotide Transformer, HyenaDNA, and GPN provide sequence-based annotations for variants in cardiometabolic risk loci <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>. Polygenic models like Delphi or G2PT produce patient-level genomics embeddings tuned for cardiometabolic outcomes <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. Clinical data including age, sex, body mass index, blood pressure, lipids, smoking status, diabetes status, and current medications provide the non-genomic risk factors that drive most of the predictive signal in traditional risk scores.</p>
<p>A model design for this application might proceed in several stages. First, a DNA foundation model computes variant-level annotations such as predicted enhancer disruption in cardiomyocyte or hepatocyte contexts. Second, these annotations and genotypes feed into Delphi or G2PT to obtain a patient-level genomics embedding tuned for cardiometabolic outcomes. Third, an intermediate fusion network combines the genomics embedding with electronic health record covariates. Finally, the fused representation trains to predict 10-year major adverse cardiovascular event risk using survival or discrete-time hazard losses.</p>
<p>In clinical use, such a model would stratify patients into risk categories that inform statin initiation, consideration of PCSK9 inhibitors, or intensive lifestyle intervention. Individual-level explanations, drawing on G2PT attention weights or Delphi variant contributions, would highlight which variants and pathways most contributed to risk, connecting the prediction to interpretable biology. Equity evaluation would ensure that performance and calibration hold across ancestries and care sites, avoiding the portability failures that plague traditional polygenic scores.</p>
</section>
<section id="oncology-risk-and-recurrence-prediction" class="level3" data-number="23.10.2">
<h3 data-number="23.10.2" class="anchored" data-anchor-id="oncology-risk-and-recurrence-prediction"><span class="header-section-number">23.10.2</span> Oncology: Risk and Recurrence Prediction</h3>
<p>In oncology, the goal is often to predict recurrence risk and treatment benefit for patients with solid tumors after surgery or first-line therapy. Unlike cardiometabolic risk where germline variants dominate, oncology applications must integrate somatic mutation landscapes with germline background and multi-omic tumor characterization.</p>
<p>The inputs combine somatic landscapes from whole-exome or whole-genome tumor sequencing with tumor representations from deep set or transformer architectures such as SetQuence and SetOmic <span class="citation" data-cites="jurenaite_setquence_2024">(<a href="references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>)</span>. Multi-omics profiles of tumor expression, methylation, and chromatin can be integrated through frameworks like GLUE and CpGPT <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>. Graph neural network-based subtyping from models like MoGCN and CGMega provides embeddings or cluster assignments that capture tumor subtype structure <span class="citation" data-cites="li_mogcn_2022 li_cgmega_2024">(<a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>; <a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>. Clinical features including stage, grade, performance status, and treatment regimen provide essential prognostic context.</p>
<p>The model design encodes somatic mutation sets with SetQuence or SetOmic to obtain tumor-variant embeddings. Transcriptomic and epigenomic profiles integrate via GLUE-like latent spaces and CpGPT methylation embeddings. These combine with graph neural network-based subtype embeddings to capture tumor-microenvironment and histopathological context. The fused tumor-level representations join with clinical features in a time-to-recurrence model using flexible deep survival networks.</p>
<p>Clinical use would provide risk estimates that guide adjuvant therapy decisions, such as intensifying chemotherapy or adding targeted agents for high-risk patients. Candidate biomarkers or pathways identified through foundation model importance scores and attention maps could inform trial stratification. Continuous monitoring would track drift as treatment standards evolve, updating models to reflect new targeted therapies and immune checkpoint inhibitors that change the baseline hazard.</p>
</section>
<section id="pharmacogenomics-and-adverse-drug-reaction-risk" class="level3" data-number="23.10.3">
<h3 data-number="23.10.3" class="anchored" data-anchor-id="pharmacogenomics-and-adverse-drug-reaction-risk"><span class="header-section-number">23.10.3</span> Pharmacogenomics and Adverse Drug Reaction Risk</h3>
<p>The goal of pharmacogenomic risk prediction is to identify patients at high risk of severe adverse drug reactions before initiating therapy. Examples include myopathy on statins, severe cutaneous adverse reactions to certain antibiotics and anticonvulsants, and cardiotoxicity from oncology agents. Some pharmacogenomic associations, such as the HLA-B*5701 association with abacavir hypersensitivity, are well-established and already implemented clinically <span class="citation" data-cites="mallal_abacavir_2008">(<a href="references.html#ref-mallal_abacavir_2008" role="doc-biblioref">Mallal et al. 2008</a>)</span>. Foundation models offer the potential to extend such predictions to variants and drugs without established single-gene associations.</p>
<p>The inputs include germline variation in pharmacogenes such as the CYP family and HLA alleles, along with variants across the broader genome that might modulate drug metabolism or immune responses. Variant effect scores from both DNA and protein language models provide predictions of how coding and regulatory variants affect drug metabolism and immune genes. Clinical context including co-medications, comorbidities, organ function (particularly liver and kidney), and prior adverse reactions provides essential non-genomic risk factors.</p>
<p>The model design uses foundation models to derive mechanistically meaningful features for variants in pharmacogenes, such as predicted impact on protein stability, binding affinity, or gene regulation. These features aggregate across loci into a pharmacogenomic risk embedding, possibly using a G2PT-style transformer restricted to relevant genes <span class="citation" data-cites="lee_g2pt_2025">(<a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>. The genomic embedding combines with electronic health record data in a multi-task classification model that predicts adverse reaction risk for multiple drugs or drug classes simultaneously, sharing representation learning across related prediction tasks.</p>
<p>Clinical use would flag patients at high risk before initiating therapy, prompting genotype-guided drug choice or dose adjustment. Reports would tie risk predictions back to specific variants and pharmacogenes, aligned with existing clinical pharmacogenomics guidelines from organizations like CPIC and PharmGKB. Cross-ancestry evaluation would ensure that the model does not exacerbate existing disparities in access to safe and effective therapy, a particular concern given the European bias in pharmacogenomics research.</p>
</section>
</section>
<section id="practical-checklist-for-translating-foundation-model-based-risk-models" class="level2" data-number="23.11">
<h2 data-number="23.11" class="anchored" data-anchor-id="practical-checklist-for-translating-foundation-model-based-risk-models"><span class="header-section-number">23.11</span> Practical Checklist for Translating Foundation Model-Based Risk Models</h2>
<p>To close, we summarize a pragmatic checklist for teams aiming to translate foundation model-based models into clinical practice. This checklist distills the key considerations discussed throughout this chapter into actionable steps.</p>
<p><strong>Define the clinical problem clearly.</strong> What decision will change? For whom, and in what setting? What alternative tools exist, and how will this be better? Ensure the outcome, time horizon, target population, and use case are precisely specified and tied to actionable clinical decisions.</p>
<p><strong>Design the model with translation in mind.</strong> Choose inputs and outputs that can be reliably obtained in routine care. Plan for batch versus real-time inference based on computational constraints and clinical workflow. Consider requirements for latency, compute resources, and interpretability from the outset rather than as afterthoughts.</p>
<p><strong>Build robust evidence across the validation hierarchy.</strong> Start with rigorous internal validation using appropriate methodology as described in <a href="p5-ch19-eval.html" class="quarto-xref"><span>Chapter 19</span></a>. Progress to external, multi-site validation across diverse ancestries and demographics. Pursue prospective validation and, where feasible, interventional studies that demonstrate actual clinical benefit rather than statistical performance alone.</p>
<p><strong>Assess equity comprehensively.</strong> Evaluate performance and calibration across subgroups defined by ancestry, sex, age, and socioeconomic status. Examine who gets access to the test and who benefits from its use. Implement mitigation strategies for identified disparities and track equity metrics continuously over time.</p>
<p><strong>Prepare for regulation and governance.</strong> Clarify intended use and risk classification early in development. Create comprehensive documentation including model cards, standard operating procedures, and validation reports. Engage regulatory and institutional stakeholders before deployment rather than seeking approval as a final step.</p>
<p><strong>Integrate into clinical workflows thoughtfully.</strong> Co-design with clinicians, laboratory staff, and patients to ensure the tool fits existing workflows. Prototype interfaces and iterate based on usability testing. Avoid alert fatigue by prioritizing high-value, actionable outputs over comprehensive but overwhelming information displays.</p>
<p><strong>Plan for monitoring and model updates.</strong> Establish metrics and dashboards for ongoing performance monitoring across relevant subgroups. Define clear triggers for investigation and potential retraining. Maintain a model registry with detailed version histories and compatibility testing procedures.</p>
<p>If genomic foundation models are to realize their promise in clinical medicine, success will depend less on ever-larger models and more on humble, rigorous translation work: careful problem selection, evidence generation, stakeholder engagement, and vigilant stewardship. The modular design patterns discussed in this chapter, treating foundation models as feature extractors with clear separation from clinical prediction heads, embracing multi-modal fusion, prioritizing calibration and fairness, bridging interpretability and mechanism, and designing for continual learning, provide a framework for responsible deployment.</p>
<p>In the broader arc of this book, clinical risk prediction and decision support represent a key translation layer that connects the representational gains of genomic foundation models to the realities of patient care. The next chapters extend these ideas to other application domains: pathogenic variant discovery in rare disease and cancer workflows (<a href="p6-ch24-variants.html" class="quarto-xref"><span>Chapter 24</span></a>), and drug discovery and biotech applications (<a href="p6-ch25-drugs.html" class="quarto-xref"><span>Chapter 25</span></a>), further exploring how foundation models reshape translational genomics.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-benegas_gpn_2023" class="csl-entry" role="listitem">
Benegas, Gonzalo, Sanjit Singh Batra, and Yun S. Song. 2023. <span>“[<span>GPN</span>] <span>DNA</span> Language Models Are Powerful Predictors of Genome-Wide Variant Effects.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (44): e2311219120. <a href="https://doi.org/10.1073/pnas.2311219120">https://doi.org/10.1073/pnas.2311219120</a>.
</div>
<div id="ref-camillo_cpgpt_2024" class="csl-entry" role="listitem">
Camillo, Lucas Paulo de Lima, Raghav Sehgal, Jenel Armstrong, Albert T. Higgins-Chen, Steve Horvath, and Bo Wang. 2024. <span>“<span>CpGPT</span>: A <span>Foundation</span> <span>Model</span> for <span>DNA</span> <span>Methylation</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.24.619766">https://doi.org/10.1101/2024.10.24.619766</a>.
</div>
<div id="ref-cao_glue_2022" class="csl-entry" role="listitem">
Cao, Zhi-Jie, and Ge Gao. 2022. <span>“[<span>GLUE</span>] <span>Multi</span>-Omics Single-Cell Data Integration and Regulatory Inference with Graph-Linked Embedding.”</span> <em>Nature Biotechnology</em> 40 (10): 1458–66. <a href="https://doi.org/10.1038/s41587-022-01284-4">https://doi.org/10.1038/s41587-022-01284-4</a>.
</div>
<div id="ref-clarke_deeprvat_2024" class="csl-entry" role="listitem">
Clarke, Brian, Eva Holtkamp, Hakime Öztürk, Marcel Mück, Magnus Wahlberg, Kayla Meyer, Felix Munzlinger, et al. 2024. <span>“[<span>DeepRVAT</span>] <span>Integration</span> of Variant Annotations Using Deep Set Networks Boosts Rare Variant Association Testing.”</span> <em>Nature Genetics</em> 56 (10): 2271–80. <a href="https://doi.org/10.1038/s41588-024-01919-z">https://doi.org/10.1038/s41588-024-01919-z</a>.
</div>
<div id="ref-dalla-torre_nucleotide_2023" class="csl-entry" role="listitem">
Dalla-Torre, Hugo, Liam Gonzalez, Javier Mendoza-Revilla, Nicolas Lopez Carranza, Adam Henryk Grzywaczewski, Francesco Oteri, Christian Dallago, et al. 2023. <span>“Nucleotide <span>Transformer</span>: Building and Evaluating Robust Foundation Models for Human Genomics.”</span> <em>Nature Methods</em> 22 (2): 287–97. <a href="https://doi.org/10.1038/s41592-024-02523-z">https://doi.org/10.1038/s41592-024-02523-z</a>.
</div>
<div id="ref-georgantas_delphi_2024" class="csl-entry" role="listitem">
Georgantas, Costa, Zoltán Kutalik, and Jonas Richiardi. 2024. <span>“Delphi: <span>A</span> <span>Deep</span>-Learning <span>Method</span> for <span>Polygenic</span> <span>Risk</span> <span>Prediction</span>.”</span> medRxiv. <a href="https://doi.org/10.1101/2024.04.19.24306079">https://doi.org/10.1101/2024.04.19.24306079</a>.
</div>
<div id="ref-jurenaite_setquence_2024" class="csl-entry" role="listitem">
Jurenaite, Neringa, Daniel León-Periñán, Veronika Donath, Sunna Torge, and René Jäkel. 2024. <span>“<span>SetQuence</span> &amp; <span>SetOmic</span>: <span>Deep</span> Set Transformers for Whole Genome and Exome Tumour Analysis.”</span> <em>BioSystems</em> 235 (January): 105095. <a href="https://doi.org/10.1016/j.biosystems.2023.105095">https://doi.org/10.1016/j.biosystems.2023.105095</a>.
</div>
<div id="ref-lee_g2pt_2025" class="csl-entry" role="listitem">
Lee, Ingoo, Zachary S. Wallace, Yuqi Wang, Sungjoon Park, Hojung Nam, Amit R. Majithia, and Trey Ideker. 2025. <span>“[<span>G2PT</span>] <span>A</span> Genotype-Phenotype Transformer to Assess and Explain Polygenic Risk.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.23.619940">https://doi.org/10.1101/2024.10.23.619940</a>.
</div>
<div id="ref-li_cgmega_2024" class="csl-entry" role="listitem">
Li, Hao, Zebei Han, Yu Sun, Fu Wang, Pengzhen Hu, Yuang Gao, Xuemei Bai, et al. 2024. <span>“<span>CGMega</span>: Explainable Graph Neural Network Framework with Attention Mechanisms for Cancer Gene Module Dissection.”</span> <em>Nature Communications</em> 15 (1): 5997. <a href="https://doi.org/10.1038/s41467-024-50426-6">https://doi.org/10.1038/s41467-024-50426-6</a>.
</div>
<div id="ref-li_mogcn_2022" class="csl-entry" role="listitem">
Li, Xiao, Jie Ma, Ling Leng, Mingfei Han, Mansheng Li, Fuchu He, and Yunping Zhu. 2022. <span>“<span>MoGCN</span>: <span>A</span> <span>Multi</span>-<span>Omics</span> <span>Integration</span> <span>Method</span> <span>Based</span> on <span>Graph</span> <span>Convolutional</span> <span>Network</span> for <span>Cancer</span> <span>Subtype</span> <span>Analysis</span>.”</span> <em>Frontiers in Genetics</em> 13 (February). <a href="https://doi.org/10.3389/fgene.2022.806842">https://doi.org/10.3389/fgene.2022.806842</a>.
</div>
<div id="ref-mallal_abacavir_2008" class="csl-entry" role="listitem">
Mallal, Simon, Elizabeth Phillips, Giampiero Carosi, Jean-Michel Molina, Cassy Workman, Janez Tomažič, Eva Jägel-Guedes, et al. 2008. <span>“<span>HLA</span>-<span>B</span>*5701 <span>Screening</span> for <span>Hypersensitivity</span> to <span>Abacavir</span>.”</span> <em>New England Journal of Medicine</em> 358 (6): 568–79. <a href="https://doi.org/10.1056/NEJMoa0706135">https://doi.org/10.1056/NEJMoa0706135</a>.
</div>
<div id="ref-nguyen_hyenadna_2023" class="csl-entry" role="listitem">
Nguyen, Eric, Michael Poli, Marjan Faizi, Armin Thomas, Callum Birch-Sykes, Michael Wornow, Aman Patel, et al. 2023. <span>“<span>HyenaDNA</span>: <span>Long</span>-<span>Range</span> <span>Genomic</span> <span>Sequence</span> <span>Modeling</span> at <span>Single</span> <span>Nucleotide</span> <span>Resolution</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2306.15794">https://doi.org/10.48550/arXiv.2306.15794</a>.
</div>
<div id="ref-rakowski_mifm_2025" class="csl-entry" role="listitem">
Rakowski, Alexander, and Christoph Lippert. 2025. <span>“[<span>MIFM</span>] <span>Multiple</span> Instance Fine-Mapping: Predicting Causal Regulatory Variants with a Deep Sequence Model.”</span> medRxiv. <a href="https://doi.org/10.1101/2025.06.13.25329551">https://doi.org/10.1101/2025.06.13.25329551</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p6--translation.html" class="pagination-link" aria-label="Part VI — Translation and Application">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Part VI — Translation and Application</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p6-ch24-variants.html" class="pagination-link" aria-label="Pathogenic Variant Discovery">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>