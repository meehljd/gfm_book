<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Regulatory Models – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part_4/p4-ch18-vep-fm.html" rel="next">
<link href="../part_4/p4-ch16-protein-lm.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_4/p4--fm-families.html">Part IV: Foundation Model Families</a></li><li class="breadcrumb-item"><a href="../part_4/p4-ch17-regulatory.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch17-long-range" id="toc-sec-ch17-long-range" class="nav-link active" data-scroll-target="#sec-ch17-long-range"><span class="header-section-number">17.1</span> Long-Range Regulation Problem</a></li>
  <li><a href="#sec-ch17-enformer" id="toc-sec-ch17-enformer" class="nav-link" data-scroll-target="#sec-ch17-enformer"><span class="header-section-number">17.2</span> <em>Enformer</em>: Attention Meets Regulatory Genomics</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-enformer-architecture" id="toc-sec-ch17-enformer-architecture" class="nav-link" data-scroll-target="#sec-ch17-enformer-architecture"><span class="header-section-number">17.2.1</span> Architecture</a></li>
  <li><a href="#sec-ch17-enformer-training" id="toc-sec-ch17-enformer-training" class="nav-link" data-scroll-target="#sec-ch17-enformer-training"><span class="header-section-number">17.2.2</span> Training Data and Cross-Species Learning</a></li>
  <li><a href="#sec-ch17-enformer-vep" id="toc-sec-ch17-enformer-vep" class="nav-link" data-scroll-target="#sec-ch17-enformer-vep"><span class="header-section-number">17.2.3</span> Variant Effect Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch17-borzoi" id="toc-sec-ch17-borzoi" class="nav-link" data-scroll-target="#sec-ch17-borzoi"><span class="header-section-number">17.3</span> <em>Borzoi</em>: From Chromatin to Transcriptome</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-borzoi-transcription" id="toc-sec-ch17-borzoi-transcription" class="nav-link" data-scroll-target="#sec-ch17-borzoi-transcription"><span class="header-section-number">17.3.1</span> Beyond Transcription Initiation</a></li>
  <li><a href="#sec-ch17-borzoi-coverage" id="toc-sec-ch17-borzoi-coverage" class="nav-link" data-scroll-target="#sec-ch17-borzoi-coverage"><span class="header-section-number">17.3.2</span> Predicting Coverage at Nucleotide Resolution</a></li>
  <li><a href="#sec-ch17-borzoi-applications" id="toc-sec-ch17-borzoi-applications" class="nav-link" data-scroll-target="#sec-ch17-borzoi-applications"><span class="header-section-number">17.3.3</span> Applications Beyond Expression Level</a></li>
  </ul></li>
  <li><a href="#sec-ch17-sei" id="toc-sec-ch17-sei" class="nav-link" data-scroll-target="#sec-ch17-sei"><span class="header-section-number">17.4</span> <em>Sei</em>: A Regulatory Vocabulary from Sequence</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-sei-states" id="toc-sec-ch17-sei-states" class="nav-link" data-scroll-target="#sec-ch17-sei-states"><span class="header-section-number">17.4.1</span> Discrete Regulatory States</a></li>
  <li><a href="#sec-ch17-sei-complementary" id="toc-sec-ch17-sei-complementary" class="nav-link" data-scroll-target="#sec-ch17-sei-complementary"><span class="header-section-number">17.4.2</span> Complementary to Track Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch17-alphagenome" id="toc-sec-ch17-alphagenome" class="nav-link" data-scroll-target="#sec-ch17-alphagenome"><span class="header-section-number">17.5</span> <em>AlphaGenome</em>: Unifying Modalities at Megabase Scale</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-alphagenome-scale" id="toc-sec-ch17-alphagenome-scale" class="nav-link" data-scroll-target="#sec-ch17-alphagenome-scale"><span class="header-section-number">17.5.1</span> From 200kb to One Megabase</a></li>
  <li><a href="#sec-ch17-alphagenome-access" id="toc-sec-ch17-alphagenome-access" class="nav-link" data-scroll-target="#sec-ch17-alphagenome-access"><span class="header-section-number">17.5.2</span> Closed Weights, Open Questions</a></li>
  </ul></li>
  <li><a href="#sec-ch17-accomplishments" id="toc-sec-ch17-accomplishments" class="nav-link" data-scroll-target="#sec-ch17-accomplishments"><span class="header-section-number">17.6</span> What Hybrid Architectures Accomplish</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-spanning" id="toc-sec-ch17-spanning" class="nav-link" data-scroll-target="#sec-ch17-spanning"><span class="header-section-number">17.6.1</span> Spanning Enhancer-Promoter Distances</a></li>
  <li><a href="#sec-ch17-multitask" id="toc-sec-ch17-multitask" class="nav-link" data-scroll-target="#sec-ch17-multitask"><span class="header-section-number">17.6.2</span> Multi-Task Regularization</a></li>
  <li><a href="#sec-ch17-cross-species" id="toc-sec-ch17-cross-species" class="nav-link" data-scroll-target="#sec-ch17-cross-species"><span class="header-section-number">17.6.3</span> Cross-Species Constraints</a></li>
  <li><a href="#sec-ch17-unified-vep" id="toc-sec-ch17-unified-vep" class="nav-link" data-scroll-target="#sec-ch17-unified-vep"><span class="header-section-number">17.6.4</span> Unified Variant Effect Prediction</a></li>
  </ul></li>
  <li><a href="#sec-ch17-limitations" id="toc-sec-ch17-limitations" class="nav-link" data-scroll-target="#sec-ch17-limitations"><span class="header-section-number">17.7</span> Limitations and Open Challenges</a>
  <ul class="collapse">
  <li><a href="#sec-ch17-training-bias" id="toc-sec-ch17-training-bias" class="nav-link" data-scroll-target="#sec-ch17-training-bias"><span class="header-section-number">17.7.1</span> Training Data Constraints</a></li>
  <li><a href="#sec-ch17-finite-context" id="toc-sec-ch17-finite-context" class="nav-link" data-scroll-target="#sec-ch17-finite-context"><span class="header-section-number">17.7.2</span> Finite Context</a></li>
  <li><a href="#sec-ch17-missing-3d" id="toc-sec-ch17-missing-3d" class="nav-link" data-scroll-target="#sec-ch17-missing-3d"><span class="header-section-number">17.7.3</span> Missing Three-Dimensional Context</a></li>
  <li><a href="#sec-ch17-correlation" id="toc-sec-ch17-correlation" class="nav-link" data-scroll-target="#sec-ch17-correlation"><span class="header-section-number">17.7.4</span> Correlation Versus Causation</a></li>
  <li><a href="#sec-ch17-interpretability" id="toc-sec-ch17-interpretability" class="nav-link" data-scroll-target="#sec-ch17-interpretability"><span class="header-section-number">17.7.5</span> Interpretability Challenges</a></li>
  </ul></li>
  <li><a href="#sec-ch17-foundation-models" id="toc-sec-ch17-foundation-models" class="nav-link" data-scroll-target="#sec-ch17-foundation-models"><span class="header-section-number">17.8</span> Relationship to Foundation Models</a></li>
  <li><a href="#sec-ch17-prediction-explanation" id="toc-sec-ch17-prediction-explanation" class="nav-link" data-scroll-target="#sec-ch17-prediction-explanation"><span class="header-section-number">17.9</span> Prediction Without Explanation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../part_4/p4--fm-families.html">Part IV: Foundation Model Families</a></li><li class="breadcrumb-item"><a href="../part_4/p4-ch17-regulatory.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch17-regulatory" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Gene regulation happens at distances that most models cannot see.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimated reading time:</strong> 35-45 minutes</p>
<p><strong>Prerequisites:</strong> Understanding of convolutional neural networks (<a href="../part_2/p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a>), attention mechanisms (<a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a>), and functional genomics assays (<a href="../part_1/p1-ch02-data.html#sec-ch02-encode" class="quarto-xref"><span>Section 2.4.1</span></a>, <a href="../part_1/p1-ch02-data.html#sec-ch02-functional" class="quarto-xref"><span>Section 2.4</span></a>). Familiarity with variant effect prediction concepts (<a href="../part_1/p1-ch04-vep-classical.html" class="quarto-xref"><span>Chapter 4</span></a>) is helpful but not required.</p>
<p><strong>Learning Objectives:</strong> After completing this chapter, you should be able to:</p>
<ol type="1">
<li>Explain why short-context models fail to capture distal regulatory relationships and quantify the scale of the problem</li>
<li>Describe how hybrid CNN-transformer architectures balance computational efficiency with long-range modeling</li>
<li>Compare <em>Enformer</em>, <em>Borzoi</em>, <em>Sei</em>, and <em>AlphaGenome</em> in terms of their outputs, strengths, and appropriate use cases</li>
<li>Apply regulatory model predictions to variant effect interpretation and understand their limitations</li>
<li>Recognize the boundary conditions where regulatory models succeed and where they fail</li>
</ol>
<p><strong>Key Insight:</strong> Hybrid architectures solve a fundamental trade-off: convolutions efficiently compress sequence to manageable length, then attention enables direct information flow across regulatory distances that would otherwise be computationally prohibitive.</p>
</div>
</div>
<p>An enhancer 80 kilobases from a promoter can determine whether a gene is expressed in liver or brain. An insulator 50 kilobases downstream can block inappropriate activation from a neighboring regulatory domain. A disease-associated variant in an intergenic region may exert its effect by disrupting a distal element that contacts its target gene through chromatin looping. Mammalian gene regulation operates across distances that dwarf the context windows of most sequence models. The convolutional architectures examined in <a href="../part_2/p2-ch06-cnn.html" class="quarto-xref"><span>Chapter 6</span></a> excel at detecting local motifs but cannot span these distances. A model that processes sequences in kilobase windows treats regulatory elements tens of kilobases away as if they do not exist. For understanding human gene regulation, they effectively do not.</p>
<p>The <strong>attention mechanisms</strong> introduced in <a href="../part_2/p2-ch07-attention.html" class="quarto-xref"><span>Chapter 7</span></a> could theoretically model arbitrary-range dependencies, but naive transformer application to hundred-kilobase windows is computationally prohibitive. Attention scales quadratically with sequence length: doubling context length quadruples memory and computation. Processing 200 kilobases at single-nucleotide resolution would require attending over 200,000 positions simultaneously, far beyond practical limits. The field needed architectures that could span regulatory distances without the quadratic penalty.</p>
<p>Hybrid architectures resolve this tension by combining the strengths of both paradigms. A convolutional front-end efficiently extracts local sequence features and compresses the input to a manageable length, reducing 200 kilobases of sequence to a few thousand feature vectors. A <strong>transformer</strong> backbone then propagates information across this compressed representation through attention. The result is a new class of regulatory models that can capture enhancer-promoter interactions, predict the effects of distal variants on gene expression, and provide mechanistic hypotheses about long-range regulation. <em>Enformer</em>, the first widely adopted model in this class, processes 200-kilobase windows and predicts chromatin state, transcription initiation, and gene expression from sequence alone.</p>
<section id="sec-ch17-long-range" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sec-ch17-long-range"><span class="header-section-number">17.1</span> Long-Range Regulation Problem</h2>
<p>Consider a canonical mammalian gene with complex tissue-specific expression. The promoter sits at the transcription start site, but the sequences that determine when and where the gene is expressed may be scattered across a 200 kilobase neighborhood. Think of it like a marionette puppet: the puppet itself (the gene) sits in one location, but the strings controlling its movement (enhancers, silencers) may attach from positions far above, each string pulled by a different puppeteer (transcription factor) to produce coordinated motion. Multiple enhancers drive expression in different tissues; silencers suppress expression in inappropriate contexts; insulators demarcate regulatory domains. Chromatin looping brings these distal elements into physical proximity with the promoter, but the loops themselves are dynamic and cell-type-specific.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading further, consider: if you wanted to predict whether a gene is expressed in liver versus brain, what genomic features beyond the promoter sequence might you need to examine? How far from the gene might relevant information lie?</p>
</div>
</div>
<p>Short-context models face an information-theoretic barrier in this setting. A model with a 2 kilobase <strong>receptive field</strong> cannot distinguish a variant in an enhancer 50 kilobases upstream from a variant in neutral sequence at the same distance. Both fall outside the model’s effective context. Stacking more convolutional layers or using dilated convolutions can expand the receptive field, but the computational path between distant positions grows long, and gradients attenuate over many layers. Models like <em>Basenji2</em> pushed convolutional receptive fields to tens of kilobases through aggressive pooling, but purely convolutional architectures struggle to propagate information across hundreds of kilobases without impractical depth, a limitation examined in <a href="../part_2/p2-ch06-cnn.html#sec-ch06-receptive-field" class="quarto-xref"><span>Section 6.6</span></a>.</p>
<p>The scale of the problem becomes concrete when examining enhancer-promoter distances in the human genome. Median enhancer-promoter distances in many tissues span 20 to 50 kilobases, with substantial fractions exceeding 100 kilobases <span class="citation" data-cites="gasperini_genome-wide_2019">(<a href="../bib/references.html#ref-gasperini_genome-wide_2019" role="doc-biblioref">Gasperini et al. 2019</a>)</span>. <strong>Topologically associating domains (TADs)</strong>, which define the neighborhoods within which regulatory elements typically interact, range from hundreds of kilobases to several megabases. A model that cannot span these distances cannot fully capture the regulatory grammar of the genome.</p>
<p>The biological reality of long-range regulation was established by systematic studies mapping GWAS variants to functional elements. <span class="citation" data-cites="maurano_systematic_2012">Maurano et al. (<a href="../bib/references.html#ref-maurano_systematic_2012" role="doc-biblioref">2012</a>)</span> demonstrated that disease-associated variants are overwhelmingly enriched in regulatory regions rather than coding sequences, with enrichment patterns specific to cell types relevant to each disease. This foundational observation motivates the entire enterprise of regulatory modeling: if most disease variants act through regulatory mechanisms, understanding those mechanisms requires models that can capture the regulatory grammar of the genome.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>The scale mismatch between model context and regulatory biology is not a minor inconvenience–it is a fundamental barrier. A 2kb context window can see only 1% of a 200kb regulatory neighborhood. Models that work well for detecting individual motifs systematically fail for tasks requiring integration of distal information.</p>
</div>
</div>
<p>Attention mechanisms offer a direct solution: by computing pairwise interactions between all positions, attention can model dependencies across arbitrary distances in a single layer. The cost is quadratic scaling with sequence length. A naive transformer operating on 200,000 base pairs at single-nucleotide resolution would require attention matrices with 40 billion entries, far exceeding practical memory limits. Hybrid architectures sidestep this constraint by using convolutions to compress the sequence before attention, reducing the effective sequence length to a few thousand <strong>tokens</strong> while preserving the information needed for long-range modeling.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Predict Before You Look">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Predict Before You Look
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before viewing the table below, make a prediction: Which architectural approach do you expect will achieve the best balance between long-range modeling capability and computational efficiency? Consider the trade-offs between context window size, computational scaling, and the ability to capture distant regulatory interactions. What constraints might limit pure CNNs versus pure transformers, and how might hybrid approaches address these limitations?</p>
</div>
</div>
<div id="tbl-arch-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arch-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17.1: Comparison of architectural approaches for regulatory sequence modeling. Hybrid architectures achieve the best trade-off between context length and computational tractability.
</figcaption>
<div aria-describedby="tbl-arch-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 16%">
<col style="width: 21%">
<col style="width: 22%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Architecture Type</th>
<th>Context Window</th>
<th>Effective Resolution</th>
<th>Computational Scaling</th>
<th>Long-Range Modeling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pure CNN (<em>DeepSEA</em>, <em>Basset</em>)</td>
<td>1-2 kb</td>
<td>Single nucleotide</td>
<td>Linear</td>
<td>None (outside receptive field)</td>
</tr>
<tr class="even">
<td>Dilated CNN (<em>Basenji2</em>)</td>
<td>40-130 kb</td>
<td>~128 bp bins</td>
<td>Linear</td>
<td>Indirect (many layers)</td>
</tr>
<tr class="odd">
<td>Pure Transformer</td>
<td>Limited by memory</td>
<td>Single nucleotide</td>
<td>Quadratic</td>
<td>Direct (single layer)</td>
</tr>
<tr class="even">
<td>Hybrid CNN-Transformer (<em>Enformer</em>)</td>
<td>200 kb</td>
<td>~128 bp bins</td>
<td>Quadratic on compressed</td>
<td>Direct (attention)</td>
</tr>
<tr class="odd">
<td>Efficient Attention (<em>AlphaGenome</em>)</td>
<td>~1 Mb</td>
<td>Variable</td>
<td>Sub-quadratic</td>
<td>Direct (optimized)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="fig-long-range-regulation" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-long-range-regulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/01-A-fig-long-range-regulation.svg" class="img-fluid figure-img"></p>
<figcaption>Regulatory elements span large genomic distances</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/01-B-fig-long-range-regulation.svg" class="img-fluid figure-img"></p>
<figcaption>Model context limits what can be captured</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/01-C-fig-long-range-regulation.svg" class="img-fluid figure-img"></p>
<figcaption>Expression prediction requires long-range integration</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/01-D-fig-long-range-regulation.svg" class="img-fluid figure-img"></p>
<figcaption>Distribution of enhancer-promoter distances</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-long-range-regulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.1: Long-range regulation demands long-context models. (A) A typical gene locus with promoter at TSS, enhancers 20-100kb away, and CTCF boundary elements defining the regulatory domain. (B) Different models see different portions of this landscape: DeepSEA (1kb) captures only the promoter; Basenji2 (40kb) includes proximal regulation; Enformer (200kb) spans most functional elements; AlphaGenome (1Mb) captures entire topologically associating domains. (C) Expression prediction requires integrating signals across the full regulatory landscape; variants in distant enhancers can have effects as large as promoter mutations. (D) Distribution of enhancer-promoter distances: median 20-50kb with substantial fraction exceeding 100kb.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch17-enformer" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sec-ch17-enformer"><span class="header-section-number">17.2</span> <em>Enformer</em>: Attention Meets Regulatory Genomics</h2>
<p><em>Enformer</em> <span class="citation" data-cites="avsec_enformer_2021">(<a href="../bib/references.html#ref-avsec_enformer_2021" role="doc-biblioref">Ž. Avsec et al. 2021</a>)</span> demonstrated that combining convolutional compression with transformer attention could dramatically improve expression prediction from sequence. The model processes 200 kilobase windows of DNA and predicts thousands of chromatin and transcription tracks across cell types and species, establishing a template that subsequent models have extended and refined.</p>
<section id="sec-ch17-enformer-architecture" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="sec-ch17-enformer-architecture"><span class="header-section-number">17.2.1</span> Architecture</h3>
<p>The <em>Enformer</em> architecture consists of three stages that progressively transform raw sequence into multi-task predictions.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Computational Detail">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Computational Detail
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following section describes <em>Enformer’s</em> architecture in detail. Understanding the precise mechanics helps when interpreting predictions and troubleshooting unexpected results, but the core concept is straightforward: compress with convolutions, then model long-range interactions with attention.</p>
</div>
</div>
<p>The convolutional stem takes <strong>one-hot encoded</strong> DNA (four channels for A, C, G, T) and applies a series of convolutional blocks with residual connections. Each block includes convolutions that detect local patterns, <strong>batch normalization</strong> and nonlinearities, and pooling operations that reduce sequence length while increasing channel depth. By the end of the stem, a 200 kilobase input has been compressed to roughly 1,500 tokens, each representing approximately 128 base pairs of underlying sequence. This compression strategy resembles how a city planner might study traffic patterns. Rather than tracking every individual car (each nucleotide), they aggregate traffic into neighborhood-level summaries (128 bp bins), preserving the essential flow information while making the analysis tractable. This compression is essential: it reduces the attention computation from quadratic in 200,000 to quadratic in 1,500, a reduction of roughly 17,000-fold in memory requirements.</p>
<p>Why is this particular compression strategy effective? The convolutional stem preserves local motif information while discarding positional precision that regulatory biology does not require. A transcription factor binding site is roughly 6-12 base pairs; whether it occurs at position 50,127 or 50,135 rarely matters for function. The 128 bp bins are large enough to contain complete motifs while small enough to preserve the spatial relationships between regulatory elements. Whether an enhancer is 50 kb or 51 kb from a promoter makes little functional difference, but whether it is 10 kb or 100 kb away matters greatly. The hierarchical compression also allows the model to learn features at multiple scales: early convolutional layers detect individual motifs, while later layers combine motifs into composite regulatory patterns before attention integrates across long distances.</p>
<p>The transformer trunk operates on the compressed sequence through a stack of self-attention layers. Each layer computes attention scores between all pairs of positions, allowing information to flow directly between any two locations in the 200 kilobase window. Relative positional encodings preserve information about the distances between elements, which matters for regulatory biology where the spacing between motifs often carries functional significance. The combination of multi-head attention and feed-forward layers enables the model to learn complex, position-dependent relationships across the full window.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why does Enformer use relative positional encodings in the transformer rather than absolute positional encodings? Consider what information about regulatory elements matters for their function.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Relative positional encodings preserve information about the <em>distance</em> between regulatory elements (e.g., an enhancer is 50kb from a promoter) rather than their absolute positions in the genome. This matters because regulatory function depends on spacing relationships: whether two motifs are 100bp apart versus 10kb apart affects their interaction, but not on whether they are at genomic coordinate 10,000 or 10,000,000. This design choice reflects biological reality: evolution preserves regulatory spacing more than absolute positions.</p>
</div>
</div>
</div>
</div>
</div>
<p>Task-specific output heads branch from the shared transformer backbone. Separate heads predict different types of outputs: DNase accessibility and ATAC-seq signal (chromatin openness), histone modifications including H3K4me3, H3K27ac, and other marks, CAGE signal reflecting transcription initiation, and additional functional genomics readouts where training data is available. Each head consists of convolutional and linear layers that transform the shared representation into track-specific predictions.</p>
<p>The multi-task design serves multiple purposes. Different assays provide complementary supervision: chromatin accessibility reflects regulatory potential, histone marks indicate active enhancers and promoters, and CAGE captures transcriptional output. Training on all assays jointly encourages the backbone to learn representations that capture the full regulatory cascade from accessible chromatin through enhancer activation to transcription initiation.</p>
<div id="fig-enformer-architecture" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-enformer-architecture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/02-fig-enformer-architecture.svg" class="img-fluid figure-img"></p>
<figcaption>Enformer hybrid CNN-transformer architecture</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-enformer-architecture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.2: Enformer architecture combining convolutional compression with transformer attention. Stage 1 (Convolutional Stem): compresses 200kb input to ~1,500 tokens through pooling, achieving 100× reduction while preserving local motif features. Stage 2 (Transformer Trunk): 8-head self-attention with relative positional encodings enables direct information flow between any positions, modeling long-range regulatory relationships. Stage 3 (Task-Specific Heads): shared representations branch to ~5,000 output tracks spanning chromatin accessibility, histone modifications, and transcription signals across cell types. The hybrid design makes attention computationally tractable (quadratic on 1,500 rather than 200,000 positions) while preserving the ability to model enhancer-promoter interactions spanning the full 200kb window.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ch17-enformer-training" class="level3" data-number="17.2.2">
<h3 data-number="17.2.2" class="anchored" data-anchor-id="sec-ch17-enformer-training"><span class="header-section-number">17.2.2</span> Training Data and Cross-Species Learning</h3>
<p>Where does a model learn what an enhancer looks like, or that H3K27ac marks active regulatory regions? The answer shapes everything the model can and cannot do. <em>Enformer</em> trains on functional genomics data from both human and mouse, spanning hundreds of assays and cell types. The chromatin accessibility, histone modification, and transcription initiation assays introduced in <a href="../part_1/p1-ch02-data.html#sec-ch02-encode" class="quarto-xref"><span>Section 2.4.1</span></a> and <a href="../part_1/p1-ch02-data.html#sec-ch02-functional" class="quarto-xref"><span>Section 2.4</span></a> provide the supervision signals: DNase-seq and ATAC-seq measure regulatory potential, ChIP-seq for histone marks identifies active enhancers and promoters, and CAGE captures where transcription begins. Human training data derives largely from ENCODE and Roadmap Epigenomics consortia, supplemented by CAGE data from FANTOM and additional chromatin profiling studies . Mouse data from analogous consortia provides complementary supervision.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Regulatory Genomics Assays: What They Measure">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regulatory Genomics Assays: What They Measure
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sequence-to-function models learn from experimental measurements of regulatory activity. Understanding what each assay captures clarifies what models can and cannot learn.</p>
<p><strong>Chromatin accessibility assays</strong> identify regions where DNA is not tightly wrapped around nucleosomes, making it available for transcription factor binding:</p>
<ul>
<li><strong>DNase-seq</strong> uses DNase I enzyme to cut accessible DNA; sequencing reads pile up at open chromatin regions</li>
<li><strong>ATAC-seq</strong> uses Tn5 transposase, which preferentially inserts into accessible regions; faster and requires fewer cells than DNase-seq</li>
</ul>
<p><strong>Transcription factor binding assays</strong> identify where specific proteins bind DNA:</p>
<ul>
<li><strong>ChIP-seq</strong> (Chromatin Immunoprecipitation followed by sequencing) uses antibodies to pull down DNA bound by a target protein; widely used for transcription factors and histone modifications</li>
<li><strong>CUT&amp;RUN</strong> and <strong>CUT&amp;Tag</strong> are newer methods that require fewer cells and produce less background noise</li>
</ul>
<p><strong>Histone modification assays</strong> reveal chromatin states associated with regulatory function:</p>
<ul>
<li><strong>H3K4me3</strong> marks active promoters</li>
<li><strong>H3K27ac</strong> marks active enhancers and promoters</li>
<li><strong>H3K27me3</strong> marks repressed regions (Polycomb silencing)</li>
<li><strong>H3K36me3</strong> marks transcribed gene bodies</li>
</ul>
<p><strong>Transcription assays</strong> measure where and how much transcription occurs:</p>
<ul>
<li><strong>CAGE</strong> (Cap Analysis of Gene Expression) captures transcript 5’ ends, precisely mapping transcription start sites</li>
<li><strong>RNA-seq</strong> measures steady-state RNA levels across exons and introns</li>
<li><strong>PRO-seq</strong> and <strong>GRO-seq</strong> measure nascent transcription by capturing RNA polymerase-associated RNA</li>
</ul>
<p><strong>Regulatory activity assays</strong> directly measure enhancer function:</p>
<ul>
<li><strong>STARR-seq</strong> (Self-Transcribing Active Regulatory Region sequencing) tests thousands of sequences for enhancer activity by measuring their ability to drive transcription of themselves</li>
<li><strong>MPRA</strong> (Massively Parallel Reporter Assays) tests sequences in reporter gene constructs</li>
</ul>
<p><strong>Chromatin conformation assays</strong> reveal 3D genome organization:</p>
<ul>
<li><strong>Hi-C</strong> captures all chromatin contacts genome-wide</li>
<li><strong>Micro-C</strong> provides higher resolution contact maps</li>
<li><strong>HiChIP</strong> and <strong>PLAC-seq</strong> enrich for contacts involving specific proteins</li>
</ul>
<p>Each assay type provides different supervision signal. Accessibility assays indicate regulatory potential; binding assays identify specific factors; activity assays measure functional output. Models trained on combinations learn richer regulatory representations than those trained on any single assay type.</p>
<div id="fig-regulatory-assays" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regulatory-assays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/06-fig-regulatory-assays.svg" class="img-fluid figure-img"></p>
<figcaption>Regulatory genomics assays and their signals</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regulatory-assays-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.3: Regulatory genomics assays provide complementary supervision for sequence-to-function models. Left column: Assay types organized by what they measure. Chromatin accessibility (DNase-seq, ATAC-seq) identifies open regions available for TF binding. Histone ChIP-seq reveals active promoters (H3K4me3), active enhancers (H3K27ac), and repressed regions (H3K27me3). CAGE captures transcription initiation sites. Right column: How signals appear in data. Each assay generates read pileups at specific genomic features, which models learn to predict from sequence. Multi-task training on diverse assays encourages learning of generalizable regulatory representations rather than assay-specific artifacts.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider <em>Enformer’s</em> training setup. If the model is trained on data primarily from ENCODE and Roadmap Epigenomics consortia, which cell types do you expect it will predict well for, and which might it struggle with? Think about what cell types these consortia focused on.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Enformer will predict well for common cell lines like K562, HepG2, GM12878, and major tissue types extensively profiled by these consortia. It will likely struggle with rare cell types, disease-specific cell states, developmental stages not represented in the data, and tissue types that are difficult to culture or obtain. Predictions for underrepresented contexts should be interpreted with appropriate caution.</p>
</div>
</div>
</div>
</div>
</div>
<p>Cross-species training confers several advantages. Regulatory sequences that are functionally constrained evolve more slowly than neutral sequence, so mouse and human share many regulatory motifs and principles despite 80 million years of divergence. Training on both species helps the model distinguish conserved regulatory logic from species-specific noise, reduces <strong>overfitting</strong> to idiosyncrasies of human data, expands the effective training set without requiring additional human samples, and implicitly emphasizes evolutionarily conserved patterns that are more likely to be functionally important.</p>
<p>The training objective combines losses across all tracks, positions, and species. Count-based likelihoods (Poisson or negative binomial) handle sequencing-derived signals, while correlation-based objectives ensure the model captures the overall shape of coverage profiles. Per-track weighting prevents abundant assays from dominating gradients.</p>
</section>
<section id="sec-ch17-enformer-vep" class="level3" data-number="17.2.3">
<h3 data-number="17.2.3" class="anchored" data-anchor-id="sec-ch17-enformer-vep"><span class="header-section-number">17.2.3</span> Variant Effect Prediction</h3>
<p>The clinical and scientific value of <em>Enformer</em> lies substantially in its ability to predict how sequence variants alter regulatory activity. The procedure follows a straightforward logic: extract a 200 kilobase window containing the variant, compute predictions for the reference allele, compute predictions for the alternative allele, and compare the outputs across all tracks and positions.</p>
<p><strong>Worked Example: Scoring a Regulatory Variant</strong></p>
<p>Consider an intergenic variant 45 kilobases upstream of gene <em>X</em>, identified in a GWAS for liver enzyme levels. To interpret this variant with <em>Enformer</em>:</p>
<ol type="1">
<li><strong>Extract window</strong>: Center a 200kb window on the variant position, ensuring both the variant and the <em>X</em> promoter fall within the window</li>
<li><strong>Generate sequences</strong>: Create reference and alternative versions differing only at the variant position</li>
<li><strong>Forward pass</strong>: Run both sequences through <em>Enformer</em>, obtaining predictions for ~5,000 tracks at ~1,500 positions each</li>
<li><strong>Compute delta</strong>: Subtract reference predictions from alternative predictions</li>
<li><strong>Interpret</strong>: Focus on relevant tracks (liver cell types) and positions (enhancer region around variant, promoter region of gene <em>X</em>)</li>
<li><strong>Quantify</strong>: If CAGE signal at the <em>X</em> promoter decreases by 0.3 log-fold in HepG2 but not in other cell types, this suggests a liver-specific regulatory effect consistent with the GWAS phenotype</li>
</ol>
<p>The resulting variant effect scores span thousands of dimensions, one for each assay and cell type. A variant might increase predicted DNase accessibility in one cell type while decreasing predicted CAGE signal in another, suggesting context-dependent regulatory effects. By aggregating predictions around gene promoters, researchers can estimate variant effects on gene expression in specific tissues.</p>
<p>Validation against GTEx <strong>expression quantitative trait loci (eQTLs)</strong> demonstrated that <em>Enformer’s</em> predictions correlate with observed genetic effects on expression <span class="citation" data-cites="avsec_enformer_2021">(<a href="../bib/references.html#ref-avsec_enformer_2021" role="doc-biblioref">Ž. Avsec et al. 2021</a>)</span>. Variants with large predicted effects on promoter-proximal CAGE signal were enriched among significant eQTLs. Notably, this correlation extended to distal variants: sequence changes 50 kilobases or more from a gene’s transcription start site still showed predictive power when they fell in regions of predicted regulatory activity. This long-range predictive capacity distinguishes <em>Enformer</em> from short-context models and validates the architectural investment in extended context windows. These predictions integrate with classical variant effect methods (<a href="../part_1/p1-ch04-vep-classical.html" class="quarto-xref"><span>Chapter 4</span></a>) and foundation model approaches (<a href="p4-ch18-vep-fm.html#sec-ch18-enformer-vep" class="quarto-xref"><span>Section 18.3.2</span></a>) to provide comprehensive variant interpretation, with clinical workflow integration detailed in <a href="../part_7/p7-ch29-rare-disease.html#sec-ch29-fm-scoring" class="quarto-xref"><span>Section 29.1.4</span></a>.</p>
<div id="fig-regulatory-vep-workflow" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regulatory-vep-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/03-fig-regulatory-vep-workflow.svg" class="img-fluid figure-img"></p>
<figcaption>Enformer variant effect prediction workflow</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regulatory-vep-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.4: Enformer variant effect prediction workflow. Step 1: Center a 200kb window on the variant and construct reference and alternative sequences. Step 2: Run parallel forward passes to obtain track predictions for both sequences across all 5,000+ assay tracks. Step 3: Compute delta between alternative and reference predictions to identify affected tracks and positions. Step 4: Interpret cell-type-specific effects: reduced DNase in liver suggests tissue-specific regulatory disruption; H3K27ac decrease at enhancer indicates weakened enhancer activity; CAGE decrease at promoter predicts reduced expression. Validation against GTEx eQTLs confirms that predicted expression effects correlate with observed genetic associations, including for variants 50+ kb from their target genes.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch17-borzoi" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="sec-ch17-borzoi"><span class="header-section-number">17.3</span> <em>Borzoi</em>: From Chromatin to Transcriptome</h2>
<p>While <em>Enformer</em> predicts transcription initiation through CAGE, RNA-seq captures a richer picture of gene expression: not just where transcription begins, but how the transcript is spliced, which isoforms dominate, where transcription terminates, and how stable the resulting mRNA is. <em>Borzoi</em> <span class="citation" data-cites="linder_borzoi_2025">(<a href="../bib/references.html#ref-linder_borzoi_2025" role="doc-biblioref">Linder et al. 2025</a>)</span> extends the hybrid architecture paradigm to predict full RNA-seq coverage profiles, enabling a unified view of how sequence variation affects the entire transcriptional program.</p>
<section id="sec-ch17-borzoi-transcription" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="sec-ch17-borzoi-transcription"><span class="header-section-number">17.3.1</span> Beyond Transcription Initiation</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>CAGE measures where transcription begins, but what aspects of gene expression does it miss? Consider what happens to an RNA molecule after transcription initiates. What regulatory events occur post-transcriptionally that could affect protein output?</p>
</div>
</div>
<p>A single gene can produce multiple transcript isoforms through alternative promoter usage, alternative splicing, and alternative polyadenylation. These isoforms may have different stabilities, different translation efficiencies, and different functions. A variant that shifts isoform ratios without changing total expression could have substantial phenotypic consequences: a switch from a cytoplasmic to a nuclear isoform, for instance, or inclusion of a premature stop codon in the predominant transcript.</p>
<p>CAGE and chromatin assays cannot capture these complexities. They measure where transcription might begin and what the chromatin environment looks like, but they do not reveal how RNA polymerase traverses the gene body, where splicing occurs, or which 3’ end is selected. RNA-seq coverage profiles encode all of this information: exon boundaries appear as coverage drops at intron junctions, alternative splicing manifests as variable junction usage, and polyadenylation site choice appears in the coverage pattern near gene 3’ ends.</p>
</section>
<section id="sec-ch17-borzoi-coverage" class="level3" data-number="17.3.2">
<h3 data-number="17.3.2" class="anchored" data-anchor-id="sec-ch17-borzoi-coverage"><span class="header-section-number">17.3.2</span> Predicting Coverage at Nucleotide Resolution</h3>
<p>Teaching a model to predict where reads pile up sounds straightforward, but RNA-seq coverage varies by orders of magnitude (from thousands of reads on highly expressed exons to near-zero in introns), and the sharp transitions at splice junctions encode critical information. How do you train a model to capture both the forest and the trees? <em>Borzoi</em> addresses this challenge by building on an <em>Enformer</em>-style backbone with modifications tailored to RNA-seq prediction. The convolutional stem and transformer trunk follow similar principles, compressing long input windows and propagating information through attention. Output heads predict stranded RNA-seq coverage across the window, with additional heads for complementary signals like PRO-seq (nascent transcription), CAGE, and other assays when available.</p>
<p>Training on RNA-seq coverage imposes different demands than training on chromatin marks. Coverage varies over orders of magnitude between introns and exons; the model must capture both the overall expression level and the fine structure of the coverage profile. Junction reads that span splice sites provide particularly informative supervision, as they directly constrain the model to learn splicing patterns. The loss function balances accurate prediction of coverage levels with faithful reproduction of the coverage shape, including sharp transitions at exon boundaries.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why do junction reads (reads spanning splice sites) provide particularly informative training signal for Borzoi? What would happen if the model were trained only on exonic coverage without junction information?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Junction reads directly constrain the model to learn splicing patterns by providing explicit supervision about which exons are connected in mature transcripts. Without junction information, the model could learn to predict high coverage on exons and low coverage on introns, but it would not learn <em>which</em> exons are spliced together, alternative splicing patterns, or splice site recognition sequences. Junction reads force the model to understand the combinatorial logic of exon inclusion and exclusion, not just expression levels.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-ch17-borzoi-applications" class="level3" data-number="17.3.3">
<h3 data-number="17.3.3" class="anchored" data-anchor-id="sec-ch17-borzoi-applications"><span class="header-section-number">17.3.3</span> Applications Beyond Expression Level</h3>
<p>A variant that causes exon skipping does not change how much gene expression you see; it changes <em>which</em> transcript you get. If your model only predicts total expression levels, this pathogenic variant looks harmless. What can we do with full coverage predictions that simple expression quantification misses? By predicting full RNA-seq coverage, <em>Borzoi</em> enables analyses that go beyond simple expression quantification. Splicing variant effects can be assessed by comparing predicted coverage at exons and junctions under reference and alternative alleles. A variant that reduces predicted junction reads for a particular exon suggests exon skipping; increased junction reads to a cryptic splice site suggests aberrant splicing. These predictions complement specialized splicing models like <em>SpliceAI</em> (<a href="../part_2/p2-ch06-cnn.html#sec-ch06-spliceai" class="quarto-xref"><span>Section 6.5</span></a>), providing additional context about how splicing changes fit within the broader transcriptional program. The integration of <em>Borzoi</em> splicing predictions with <em>SpliceAI</em> scores is examined in <a href="p4-ch18-vep-fm.html#sec-ch18-spliceai" class="quarto-xref"><span>Section 18.3.1</span></a>.</p>
<p>Alternative promoter usage becomes visible through coverage patterns near transcription start sites. A variant that increases coverage downstream of one TSS while decreasing it downstream of another suggests a shift in promoter preference. Such shifts can alter the 5’ UTR of the resulting transcript, affecting translation efficiency and regulatory motif content.</p>
<p>Polyadenylation site choice affects 3’ UTR length and content. Shorter 3’ UTRs may escape microRNA-mediated repression; longer ones may include additional regulatory elements. <em>Borzoi’s</em> coverage predictions around annotated polyadenylation sites can reveal variants that shift site usage, potentially explaining effects on mRNA stability and translation that would be invisible to chromatin-based models.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Borzoi</em> shifts the paradigm from predicting regulatory potential (chromatin state) to predicting regulatory outcome (RNA processing). This matters clinically because many disease-causing variants act through splicing or other post-transcriptional mechanisms that chromatin-focused models cannot detect.</p>
</div>
</div>
<div id="fig-borzoi-rnaseq" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-borzoi-rnaseq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/04-A-fig-borzoi-rnaseq.svg" class="img-fluid figure-img"></p>
<figcaption>RNA-seq captures post-transcriptional processing</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/04-B-fig-borzoi-rnaseq.svg" class="img-fluid figure-img"></p>
<figcaption>Borzoi predicts coverage at nucleotide resolution</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/04-C-fig-borzoi-rnaseq.svg" class="img-fluid figure-img"></p>
<figcaption>Variant effects on RNA processing</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/04-D-fig-borzoi-rnaseq.svg" class="img-fluid figure-img"></p>
<figcaption>Integration with specialized splicing models</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-borzoi-rnaseq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.5: Borzoi extends regulatory prediction from chromatin to transcriptome. (A) While chromatin assays capture regulatory potential, RNA-seq reveals regulatory outcome: exon structure, splice junctions, and polyadenylation site usage. (B) Borzoi predicts stranded RNA-seq coverage profiles, reproducing sharp exon boundaries and junction structure from sequence alone. (C) Variant effect prediction extends to post-transcriptional mechanisms: altered splicing, shifted promoter usage, and changed polyadenylation patterns that would be invisible to chromatin-focused models. (D) Borzoi predictions integrate with specialized tools like SpliceAI, providing complementary context about how splicing changes fit within broader transcriptional programs.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch17-sei" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="sec-ch17-sei"><span class="header-section-number">17.4</span> <em>Sei</em>: A Regulatory Vocabulary from Sequence</h2>
<p>While <em>Enformer</em> and <em>Borzoi</em> predict continuous coverage tracks, <em>Sei</em> <span class="citation" data-cites="chen_deepsea_2022">(<a href="../bib/references.html#ref-chen_deepsea_2022" role="doc-biblioref">Chen et al. 2022</a>)</span> takes a complementary approach: learning a discrete vocabulary of sequence classes that capture distinct regulatory activities. Rather than predicting thousands of individual assays, <em>Sei</em> maps sequences to a reduced set of regulatory states, each associated with characteristic chromatin and transcription patterns.</p>
<section id="sec-ch17-sei-states" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="sec-ch17-sei-states"><span class="header-section-number">17.4.1</span> Discrete Regulatory States</h3>
<p>A promoter that is active in liver but silent in brain is not just “partially open”—it is in fundamentally different regulatory states. But how many distinct states exist, and what sequence features define them? Tracking thousands of individual assay predictions makes these questions hard to answer. <em>Sei</em> builds on observations that chromatin states cluster into interpretable categories: active promoters, strong enhancers, poised enhancers, heterochromatin, and so forth. Previous methods like ChromHMM defined such states from observed chromatin marks in specific cell types . <em>Sei</em> learns to predict sequence class membership directly from DNA, asking what regulatory identity a sequence carries based on its intrinsic properties.</p>
<p>The model predicts 40 sequence classes derived from clustering patterns across chromatin accessibility, histone modifications, and <strong>transcription factor</strong> binding. Each class corresponds to a recognizable regulatory state: promoter-like sequences, enhancer-like sequences, CTCF binding sites, repressed regions, and various intermediate states. The output is not a single class assignment but a probability distribution over classes, reflecting the observation that many sequences have context-dependent regulatory potential.</p>
</section>
<section id="sec-ch17-sei-complementary" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="sec-ch17-sei-complementary"><span class="header-section-number">17.4.2</span> Complementary to Track Prediction</h3>
<p>When a clinician asks “what kind of regulatory element did this variant hit?”, answering “it reduced H3K27ac by 0.3 log-fold in HepG2 cells” is technically precise but practically opaque. What they want to know is: did the variant disrupt an enhancer, a promoter, or something else entirely? <em>Sei</em> and <em>Enformer</em>-style models serve complementary purposes. <em>Enformer</em> provides detailed, quantitative predictions across specific assays and cell types; <em>Sei</em> provides a compressed, interpretable summary of regulatory identity. For variant interpretation, both perspectives can be valuable. <em>Enformer</em> might reveal that a variant reduces predicted H3K27ac signal in liver but not heart; <em>Sei</em> might reveal that the same variant shifts sequence class membership from “strong enhancer” toward “weak enhancer,” a more immediately interpretable characterization.</p>
<p>The regulatory vocabulary approach also facilitates systematic analysis across many variants. Rather than tracking changes in thousands of individual tracks, researchers can ask how a set of variants affects the distribution of regulatory classes, identifying patterns that might be obscured in high-dimensional track space.</p>
<div id="fig-sei-vocabulary" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sei-vocabulary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/07-fig-sei-vocabulary.svg" class="img-fluid figure-img"></p>
<figcaption>Sei regulatory vocabulary classes</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sei-vocabulary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.6: Sei discrete regulatory vocabulary. Instead of predicting thousands of continuous tracks, Sei classifies sequences into 40 regulatory states derived from clustering chromatin accessibility, histone modifications, and transcription factor binding patterns. Top: Example sequence classes organized by function: active promoters, strong/weak enhancers, CTCF-bound insulators, poised elements, and repressed regions. Bottom: Variant interpretation using the vocabulary. A variant shifts probability mass from “Strong Enhancer” toward “Weak Enhancer” class, an interpretable statement that complements Enformer’s quantitative track predictions.
</figcaption>
</figure>
</div>
<div id="tbl-model-outputs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-outputs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17.2: Comparison of regulatory model outputs and their appropriate use cases. Different models excel at different aspects of regulatory prediction.
</figcaption>
<div aria-describedby="tbl-model-outputs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 25%">
<col style="width: 38%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Output Type</th>
<th>Number of Outputs</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Enformer</em></td>
<td>Continuous tracks</td>
<td>~5,000 (cell type x assay)</td>
<td>Quantitative, cell-type-specific predictions</td>
</tr>
<tr class="even">
<td><em>Borzoi</em></td>
<td>RNA-seq coverage</td>
<td>Per-position, stranded</td>
<td>Splicing, isoform, RNA processing effects</td>
</tr>
<tr class="odd">
<td><em>Sei</em></td>
<td>Discrete classes</td>
<td>40 probability scores</td>
<td>Interpretable regulatory state changes</td>
</tr>
<tr class="even">
<td><em>AlphaGenome</em></td>
<td>Multi-modal</td>
<td>Chromatin + RNA + contacts</td>
<td>Comprehensive, unified predictions</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check: Which Regulatory Model?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check: Which Regulatory Model?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For each scenario below, which regulatory model would you choose and why?</p>
<ol type="1">
<li><p>A clinical geneticist wants to explain to a patient why their intronic variant likely disrupts a liver enhancer. They need output the patient can understand.</p></li>
<li><p>A researcher suspects a variant affects alternative splicing of a transcript but has no experimental data. They need quantitative predictions of exon inclusion changes.</p></li>
<li><p>A diagnostic lab needs to score 50,000 variants from a biobank cohort. They require locally-runnable predictions with version control for reproducibility.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Sei</strong> - The discrete regulatory vocabulary (“strong enhancer” → “weak enhancer”) is more interpretable for non-specialists than continuous track predictions. The clinician can say “this variant shifts the sequence from acting like an enhancer to acting like background.”</p></li>
<li><p><strong>Borzoi</strong> - Unlike Enformer which predicts transcription initiation, Borzoi predicts RNA-seq coverage including splicing effects. For splicing-specific questions, Borzoi provides quantitative exon inclusion predictions that complement SpliceAI.</p></li>
<li><p><strong>Enformer</strong> - For high-throughput clinical applications requiring reproducibility, Enformer’s open weights enable local deployment without sending patient data externally. Version-controlled predictions are essential for diagnostic validation.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch17-alphagenome" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="sec-ch17-alphagenome"><span class="header-section-number">17.5</span> <em>AlphaGenome</em>: Unifying Modalities at Megabase Scale</h2>
<p><em>AlphaGenome</em> <span class="citation" data-cites="avsec_alphagenome_2025">(<a href="../bib/references.html#ref-avsec_alphagenome_2025" role="doc-biblioref">Z. Avsec, Latysheva, and Cheng 2025</a>)</span> extends the hybrid modeling paradigm in two directions: longer context windows (approximately one megabase) and broader output modalities spanning chromatin, expression, splicing, and three-dimensional contacts. The goal is a single model that provides a comprehensive view of how sequence determines regulatory state.</p>
<section id="sec-ch17-alphagenome-scale" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="sec-ch17-alphagenome-scale"><span class="header-section-number">17.5.1</span> From 200kb to One Megabase</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Enformer</em> processes 200kb windows. <em>AlphaGenome</em> extends to approximately 1Mb. What additional biological features could a model capture with this extended context? Think about the sizes of topologically associating domains (TADs) and super-enhancers.</p>
</div>
</div>
<p>The megabase context window pushes against computational limits even with hybrid architectures. <em>AlphaGenome</em> addresses this through efficient attention mechanisms that reduce the quadratic cost, hierarchical processing that handles different output modalities at appropriate resolutions, and architectural refinements accumulated from <em>Enformer</em> and <em>Borzoi</em> development.</p>
<p>The output repertoire spans chromatin accessibility and histone modifications (following <em>Enformer</em>), gene expression and RNA coverage (following <em>Borzoi</em>), splicing predictions including exon inclusion and junction usage, and contact predictions reflecting three-dimensional chromatin organization.</p>
<p>Unifying these modalities in a single model offers several advantages. The backbone representation must capture information relevant to all outputs, encouraging learning of features that connect chromatin state to transcription to RNA processing. Variant effect predictions become coherent across modalities: a single forward pass reveals how a variant affects chromatin, expression, splicing, and contacts, rather than requiring separate runs through independent models.</p>
</section>
<section id="sec-ch17-alphagenome-access" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="sec-ch17-alphagenome-access"><span class="header-section-number">17.5.2</span> Closed Weights, Open Questions</h3>
<p>The most capable model is useless if you cannot use it on your data. When patient genomic sequences cannot leave your institution’s servers, API-only access becomes a barrier, not a convenience. Who controls the model matters as much as what the model can do. <em>AlphaGenome</em> is primarily available through an API interface rather than as a downloadable model. This arrangement simplifies use for many applications: researchers can score variants without managing large model weights or specialized hardware. It also introduces constraints around data privacy, customization, and integration with local pipelines. Clinical applications that cannot send patient sequence data to external services may be unable to use API-only models directly, motivating interest in openly available alternatives.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Practical Guidance: Choosing a Regulatory Model">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Guidance: Choosing a Regulatory Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Use <em>Enformer</em> when:</strong></p>
<ul>
<li>You need open-source, locally runnable predictions</li>
<li>Chromatin state and transcription initiation are your primary interests</li>
<li>You want to fine-tune or adapt the model for custom tasks</li>
<li>You require reproducible, version-controlled predictions</li>
</ul>
<p><strong>Use <em>Borzoi</em> when:</strong></p>
<ul>
<li>Splicing effects are important for your variants</li>
<li>You need RNA-level predictions beyond transcription initiation</li>
<li>You are integrating with other splicing predictors like <em>SpliceAI</em></li>
<li>Post-transcriptional regulation is clinically relevant</li>
</ul>
<p><strong>Use <em>Sei</em> when:</strong></p>
<ul>
<li>You need interpretable regulatory state classifications</li>
<li>You are analyzing many variants and want compressed summaries</li>
<li>Communicating results to non-specialists is important</li>
<li>You want to identify variants that shift regulatory identity</li>
</ul>
<p><strong>Use <em>AlphaGenome</em> when:</strong></p>
<ul>
<li>You need the most comprehensive multi-modal predictions</li>
<li>Data privacy constraints allow API usage</li>
<li>3D contact predictions are relevant to your question</li>
<li>You want unified predictions across chromatin, RNA, and structure</li>
</ul>
</div>
</div>
<p>From the perspective of variant interpretation workflows, <em>AlphaGenome</em> provides a comprehensive set of predictions from a single query. A variant can be assessed for effects on local chromatin state, expression of nearby genes, splicing of overlapping transcripts, and potential disruption of chromatin contacts, all from the same underlying model. The challenge lies in synthesizing these multiple outputs into actionable conclusions, a topic addressed in <a href="p4-ch18-vep-fm.html#sec-ch18-alphagenome" class="quarto-xref"><span>Section 18.3.4</span></a>, with practical workflow integration in <a href="p4-ch18-vep-fm.html#sec-ch18-workflow-design" class="quarto-xref"><span>Section 18.4.3</span></a>.</p>
</section>
</section>
<section id="sec-ch17-accomplishments" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="sec-ch17-accomplishments"><span class="header-section-number">17.6</span> What Hybrid Architectures Accomplish</h2>
<p>The progression from <em>DeepSEA</em> through <em>Enformer</em>, <em>Borzoi</em>, and <em>AlphaGenome</em> reflects accumulating solutions to specific limitations. Each model addresses constraints that bounded its predecessor’s utility.</p>
<section id="sec-ch17-spanning" class="level3" data-number="17.6.1">
<h3 data-number="17.6.1" class="anchored" data-anchor-id="sec-ch17-spanning"><span class="header-section-number">17.6.1</span> Spanning Enhancer-Promoter Distances</h3>
<p>An enhancer 80 kilobases from a promoter was invisible to earlier models: not uncertain, not weakly detected, but completely absent from the prediction. What do we gain when we can finally see it? The most direct contribution is enabling long-range interaction modeling. A 200 kilobase context window encompasses the distances over which most <em>cis</em>-regulatory interactions occur. Attention mechanisms allow the model to learn direct relationships between enhancers and promoters without requiring information to propagate through many intermediate layers. Empirically, this translates to improved prediction of expression and better correlation with eQTLs, particularly for variants in distal regulatory elements.</p>
</section>
<section id="sec-ch17-multitask" class="level3" data-number="17.6.2">
<h3 data-number="17.6.2" class="anchored" data-anchor-id="sec-ch17-multitask"><span class="header-section-number">17.6.2</span> Multi-Task Regularization</h3>
<p>Why train one model on thousands of different assays instead of training specialized models for each? The naive expectation might be that a model focused solely on predicting gene expression would outperform one distracted by chromatin accessibility and histone modifications. Yet the opposite proves true. Training on hundreds of assays jointly constrains the model to learn representations that generalize across regulatory modalities. A feature useful only for predicting H3K4me3 in one cell type provides less gradient signal than a feature useful across chromatin, transcription, and accessibility. This multi-task pressure steers the model toward learning fundamental regulatory logic rather than assay-specific artifacts.</p>
<p>Why does multi-task training produce better representations than single-task training? The answer lies in what the shared backbone must learn to succeed across all tasks. Predicting chromatin accessibility requires recognizing transcription factor binding motifs. Predicting gene expression requires recognizing how those motifs combine into functional enhancers. Predicting histone modifications requires recognizing the sequence features that recruit chromatin modifiers. No single feature set suffices for all tasks, so the backbone must learn a rich vocabulary of regulatory features, precisely the vocabulary needed for robust variant effect prediction. In contrast, a model trained only on one assay might exploit assay-specific artifacts (batch effects, mapping biases, cell-line idiosyncrasies) that happen to correlate with the training signal but do not reflect genuine regulatory biology.</p>
</section>
<section id="sec-ch17-cross-species" class="level3" data-number="17.6.3">
<h3 data-number="17.6.3" class="anchored" data-anchor-id="sec-ch17-cross-species"><span class="header-section-number">17.6.3</span> Cross-Species Constraints</h3>
<p>If human and mouse regulatory sequences have diverged over 80 million years of evolution, why would training on both species together help rather than hurt? The answer reveals something fundamental about what we want these models to learn. Training on human and mouse together further regularizes the model. Species-specific binding site variants, repetitive elements, and technical artifacts in training data affect one species but not the other. Features that generalize across species are more likely to reflect conserved regulatory mechanisms. This provides a form of evolutionary validation built into the training process.</p>
<p>Why does cross-species training work when human and mouse regulatory sequences have diverged substantially? The key insight is that core regulatory logic is more conserved than specific sequences. The transcription factors that drive liver expression in humans are largely the same as those in mice, even if the exact positions and sequences of binding sites have shifted. A model trained on both species must learn what HNF4A binding looks like in general, not just where HNF4A binds in one particular genome. This abstraction makes the model robust to sequence variation while preserving sensitivity to functional features, exactly the properties needed for predicting effects of human genetic variants, which by definition differ from the reference sequence the model was trained on.</p>
</section>
<section id="sec-ch17-unified-vep" class="level3" data-number="17.6.4">
<h3 data-number="17.6.4" class="anchored" data-anchor-id="sec-ch17-unified-vep"><span class="header-section-number">17.6.4</span> Unified Variant Effect Prediction</h3>
<p>Running a variant through five different models and reconciling contradictory outputs is tedious at best and misleading at worst. What if one model could give you chromatin effects, expression changes, and splicing consequences in a single coherent prediction? Perhaps most practically valuable, hybrid models provide a unified framework for variant effect prediction on expression and related phenotypes. Rather than assembling scores from multiple specialized models, researchers can query a single model for comprehensive predictions. The outputs span cell types and assays, enabling tissue-specific interpretation of regulatory variants. This capability integrates naturally with the variant interpretation workflows described in <a href="p4-ch18-vep-fm.html#sec-ch18-combining-evidence" class="quarto-xref"><span>Section 18.4</span></a> and the clinical applications examined in <a href="../part_7/p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>. The calibration of these multi-track predictions for clinical use is addressed in <a href="p4-ch18-vep-fm.html#sec-ch18-calibration" class="quarto-xref"><span>Section 18.5</span></a>.</p>
</section>
</section>
<section id="sec-ch17-limitations" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="sec-ch17-limitations"><span class="header-section-number">17.7</span> Limitations and Open Challenges</h2>
<p>Despite their power, long-context regulatory models face fundamental limitations that bound their current utility and define directions for future development.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Knowledge Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Knowledge Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reading about limitations, reflect: based on what you know about how these models are trained, what categories of failure would you expect? Consider training data, model architecture, and the biology of gene regulation.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Expected failure categories include: training data bias (poor performance on underrepresented cell types and populations), finite context windows missing trans-acting factors and distant regulatory elements, inability to model 3D chromatin structure from linear sequence, and correlation-based learning that may not capture true causal mechanisms. The models learn associations between sequence and functional readouts but cannot distinguish which patterns are causally important versus merely correlated.</p>
</div>
</div>
</div>
</div>
</div>
<section id="sec-ch17-training-bias" class="level3" data-number="17.7.1">
<h3 data-number="17.7.1" class="anchored" data-anchor-id="sec-ch17-training-bias"><span class="header-section-number">17.7.1</span> Training Data Constraints</h3>
<p>Your patient has a variant in a regulatory element active in pancreatic beta cells. Will the model’s prediction be reliable? That depends entirely on whether beta cells were well-represented in training, and the model will not tell you if they were not. Functional genomics data is biased in coverage, overrepresenting well-studied cell types (embryonic stem cells, K562, HepG2, lymphoblastoid cell lines) while leaving many tissue types and disease-relevant cell states poorly covered. Models trained on available data will perform better in represented contexts and may fail silently in underrepresented ones. Ancestry bias compounds the problem: most functional genomics studies derive from individuals of European descent, limiting the diversity of haplotypes and regulatory variants represented in training data. These data gaps are examined more comprehensively in <a href="../part_1/p1-ch02-data.html#sec-ch02-encode" class="quarto-xref"><span>Section 2.4.1</span></a> and <a href="../part_1/p1-ch02-data.html#sec-ch02-functional" class="quarto-xref"><span>Section 2.4</span></a>.</p>
<p>These biases propagate to variant effect predictions. A variant in a regulatory element active primarily in pancreatic beta cells may receive poor predictions if beta cell data is sparse in training. A variant on a <strong>haplotype</strong> common in African populations but rare in Europeans may fall outside the model’s effective training distribution. Users must recognize that prediction confidence varies with representation in training data, a consideration that current models do not explicitly communicate. <a href="../part_3/p3-ch13-confounding.html" class="quarto-xref"><span>Chapter 13</span></a> examines how such biases can compromise model validity.</p>
</section>
<section id="sec-ch17-finite-context" class="level3" data-number="17.7.2">
<h3 data-number="17.7.2" class="anchored" data-anchor-id="sec-ch17-finite-context"><span class="header-section-number">17.7.2</span> Finite Context</h3>
<p>A transcription factor binding 50 megabases away can determine whether your gene of interest is expressed. A structural variant duplicating a distant super-enhancer can drive oncogene activation. No fixed window, however large, can see everything that matters. Even megabase-scale windows capture only local regulation. <em>Trans</em>-acting factors, three-dimensional contacts spanning multiple megabases, and whole-chromosome organization fall outside model context. Structural variants that rearrange large genomic segments, duplicate enhancers, or create novel fusion genes cannot be modeled within fixed-window architectures. The reference genome assumption underlying these models further limits their applicability to complex haplotypes and populations with substantial structural variation relative to the reference.</p>
</section>
<section id="sec-ch17-missing-3d" class="level3" data-number="17.7.3">
<h3 data-number="17.7.3" class="anchored" data-anchor-id="sec-ch17-missing-3d"><span class="header-section-number">17.7.3</span> Missing Three-Dimensional Context</h3>
<p>Two enhancers equidistant from a promoter in linear sequence may have completely different effects: one brought into contact through a chromatin loop, the other sequestered in a different nuclear compartment. The genome is folded, but these models read it flat. Linear sequence models treat DNA as a one-dimensional string, but gene regulation occurs in three-dimensional nuclear space. Chromatin loops bring distal elements into proximity; nuclear compartmentalization segregates active and repressed regions; phase-separated condensates concentrate regulatory factors. While <em>AlphaGenome</em> predicts some contact features, current hybrid models do not fully integrate three-dimensional chromatin organization. The relationship between linear sequence, three-dimensional structure, and regulatory output remains incompletely captured. <a href="../part_5/p5-ch21-3d-genome.html" class="quarto-xref"><span>Chapter 21</span></a> examines models that explicitly address chromatin architecture.</p>
</section>
<section id="sec-ch17-correlation" class="level3" data-number="17.7.4">
<h3 data-number="17.7.4" class="anchored" data-anchor-id="sec-ch17-correlation"><span class="header-section-number">17.7.4</span> Correlation Versus Causation</h3>
<p>A model that perfectly predicts expression levels might still be completely wrong about why genes are expressed. It could be learning batch effects, GC content, or any signal correlated with the training labels without understanding regulatory mechanism. How do we know when a model has learned biology versus artifacts? Hybrid models learn correlations between sequence and functional readouts, not causal mechanisms. A variant might receive a high predicted effect score because it disrupts a motif correlated with expression in training data, not because the motif causally drives expression. Attribution methods can identify which sequence features contribute to predictions, but attribution is not validation. High-confidence predictions require experimental confirmation through approaches like massively parallel reporter assays, CRISPR perturbation, or allelic series analysis.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Insight">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Prediction accuracy and mechanistic understanding are different things. A model can achieve high correlation with experimental measurements by learning any predictive signal, even confounded ones. The fact that a model accurately predicts expression does not mean it has learned the correct causal mechanism.</p>
</div>
</div>
</section>
<section id="sec-ch17-interpretability" class="level3" data-number="17.7.5">
<h3 data-number="17.7.5" class="anchored" data-anchor-id="sec-ch17-interpretability"><span class="header-section-number">17.7.5</span> Interpretability Challenges</h3>
<p>When Enformer predicts that a variant disrupts gene expression, can we ask <em>why</em>? What motif was disrupted? What regulatory logic was broken? With hundreds of millions of parameters, the answer is rarely straightforward. The scale of these models (hundreds of millions of parameters) makes mechanistic interpretation difficult. Attention patterns provide some insight into which positions the model considers related, but attention weights are not guaranteed to reflect the model’s actual computational strategy. Attribution methods (saliency maps, integrated gradients) can highlight important input positions, but the features the model constructs from those positions remain opaque. <a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a> examines these interpretability methods and their limitations in detail.</p>
<div id="fig-regulatory-limitations" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regulatory-limitations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/05-A-fig-regulatory-limitations.svg" class="img-fluid figure-img"></p>
<figcaption>Training data bias limits generalization</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/05-B-fig-regulatory-limitations.svg" class="img-fluid figure-img"></p>
<figcaption>Linear models miss 3D chromatin context</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/05-C-fig-regulatory-limitations.svg" class="img-fluid figure-img"></p>
<figcaption>Correlation vs.&nbsp;causation in predictions</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/part_4/ch17/05-D-fig-regulatory-limitations.svg" class="img-fluid figure-img"></p>
<figcaption>Context limitations miss trans-acting effects</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regulatory-limitations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.7: Limitations of long-context regulatory models. (A) Training data bias: cell lines like K562 and HepG2 dominate ENCODE; disease-relevant cell states are underrepresented. Predictions may be unreliable for untrained contexts. (B) Missing 3D context: models process linear sequence, but chromatin folds into loops and compartments that bring distant elements into physical proximity. Long-range effects may occur through 3D contacts that linear context misses. (C) Correlation vs.&nbsp;causation: high predicted effect may reflect training correlations rather than true causal relationships. Validation requires experimental perturbation. (D) Finite context: even 1Mb windows cannot capture trans-acting factors encoded elsewhere in the genome, nor structural variants spanning megabases.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ch17-foundation-models" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="sec-ch17-foundation-models"><span class="header-section-number">17.8</span> Relationship to Foundation Models</h2>
<p>Long-context regulatory models occupy an interesting position in the genomic foundation model landscape. They share key characteristics with <strong>foundation models</strong>: large scale, broad training data, strong performance across tasks, and utility as feature extractors for downstream applications. Yet they differ from self-supervised DNA language models (<a href="p4-ch15-dna-lm.html" class="quarto-xref"><span>Chapter 15</span></a>) in their heavy reliance on supervised, task-specific training signals.</p>
<p><em>Enformer</em> and its descendants can be viewed as highly specialized foundation models, pretrained on the specific task of regulatory prediction and adaptable to related applications. Their representations encode regulatory logic learned from functional genomics supervision, complementing the sequence patterns learned by self-supervised models from raw DNA. In practice, the two approaches may prove most powerful in combination: self-supervised models provide sequence representations from evolutionary context, while supervised regulatory models provide representations from functional genomics context. Integrating these representations for tasks like variant effect prediction is an active area of development, explored further in <a href="p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the difference between <em>Enformer</em> (supervised on functional genomics data) and DNA language models like <em>Nucleotide Transformer</em> (self-supervised on sequence alone). What types of regulatory patterns might each approach learn well? What might each miss?</p>
</div>
</div>
<p>From a practical standpoint, hybrid regulatory models remain among the most directly useful genomic deep learning systems for variant interpretation. They provide quantitative, tissue-specific predictions for regulatory variants, outperform short-context alternatives on distal regulatory elements, and integrate naturally into variant prioritization workflows. Their limitations are real but understood; their strengths are substantial and empirically validated.</p>
</section>
<section id="sec-ch17-prediction-explanation" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="sec-ch17-prediction-explanation"><span class="header-section-number">17.9</span> Prediction Without Explanation</h2>
<p>Long-range regulatory prediction from sequence is tractable. <em>Enformer</em> established that hybrid convolutional neural network (CNN)-transformer architectures could span 200 kilobases and predict expression-related chromatin features. <em>Borzoi</em> extended coverage to the full transcriptome with improved quantitative accuracy. <em>AlphaGenome</em> unified multiple regulatory modalities at megabase scale, predicting chromatin accessibility, histone modifications, transcription factor binding, and gene expression from a single architecture. Each generation captures more of the regulatory landscape with greater fidelity to experimental measurements.</p>
<p>Yet these models predict regulatory outcomes without explaining regulatory mechanism. They learn that certain sequence patterns associate with certain expression levels, but they do not represent enhancer-promoter contacts, transcription factor cascades, or the causal chain from sequence to phenotype. The attention patterns that span long distances may correspond to genuine regulatory interactions or may reflect confounded sequence features that happen to predict expression. Interpretability methods (<a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a>) can probe what patterns models have learned, but high prediction accuracy does not guarantee mechanistic insight.</p>
<p>This distinction shapes how regulatory model predictions should be used. For variant effect prediction (<a href="p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>), regulatory models provide one input among several: they predict whether a variant alters chromatin accessibility or expression, while protein language models (<a href="p4-ch16-protein-lm.html" class="quarto-xref"><span>Chapter 16</span></a>) assess coding consequences and evolutionary models quantify constraint. The clinical integration of these signals (<a href="../part_7/p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>) requires understanding what each model contributes and where each is likely to fail. Regulatory models excel at predicting noncoding variant effects when the relevant cell type is represented in training data; they struggle with cell types absent from training and with variants acting through mechanisms not captured by the output tracks they predict.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Apply Your Knowledge">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Apply Your Knowledge
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to predict the regulatory impact of a variant located 50kb from the nearest gene. Based on what you have learned in this chapter, which model architecture would you choose and why? What input features would be most important?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Chapter Summary">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Summary
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-tip callout-titled" title="Test Yourself">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Test Yourself
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before reviewing the summary, test your recall:</p>
<ol type="1">
<li><p>Why do short-context models fundamentally fail at modeling mammalian gene regulation? What is the scale of the problem (provide specific distance ranges)?</p></li>
<li><p>Explain the hybrid CNN-transformer architecture strategy. How does Enformer achieve a 200kb context window without requiring quadratic attention over 200,000 positions?</p></li>
<li><p>Compare Enformer, Borzoi, and Sei in terms of what they predict and what applications they are best suited for. What are the key differences in their outputs?</p></li>
<li><p>What does it mean that regulatory models provide “prediction without explanation”? Why is high accuracy at predicting expression not the same as understanding regulatory mechanism?</p></li>
<li><p>Identify three critical limitations of current regulatory models that prevent them from capturing the full complexity of gene regulation. For each, explain what biological information is missing.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Check Your Answers">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check Your Answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Scale mismatch</strong>: Short-context models have receptive fields of 1-2 kb or at most tens of kb through dilated convolutions, but mammalian enhancers are typically 20-50 kb from their target promoters, with substantial fractions exceeding 100 kb. Topologically associating domains (TADs) range from hundreds of kb to several megabases. A model with a 2kb window can see only 1% of a 200kb regulatory neighborhood, treating distant enhancers as if they do not exist.</p></li>
<li><p><strong>Hybrid architecture efficiency</strong>: Enformer uses a convolutional stem to compress 200kb of sequence down to ~1,500 tokens (each representing ~128bp bins), reducing the sequence length by approximately 100×. This makes attention computationally tractable because attention scales quadratically with sequence length: operating on 1,500 positions instead of 200,000 reduces memory requirements by roughly 17,000-fold. The convolutions preserve local motif information while discarding positional precision that biology does not require, then the transformer attention enables direct information flow between any positions in the compressed representation.</p></li>
<li><p><strong>Model output comparison</strong>: Enformer predicts ~5,000 continuous chromatin and transcription tracks (DNase, histone marks, CAGE) across cell types, best for quantitative tissue-specific predictions. Borzoi predicts full RNA-seq coverage profiles at nucleotide resolution, best for splicing effects and post-transcriptional regulation. Sei predicts probabilities across 40 discrete regulatory state classes (promoter-like, enhancer-like, etc.), best for interpretable regulatory identity changes and compressed variant summaries. AlphaGenome unifies chromatin, RNA, and 3D contact predictions at megabase scale via API.</p></li>
<li><p><strong>Prediction vs.&nbsp;explanation</strong>: High accuracy means the model has learned sequence patterns that correlate with expression measurements, but correlation does not imply the model understands causal mechanisms. A variant might score high because it disrupts a motif correlated with expression in training data rather than because that motif causally drives expression. The model does not represent enhancer-promoter contacts, transcription factor cascades, or the mechanistic chain from sequence to phenotype; it learns statistical associations that predict outcomes without explaining how regulation actually works.</p></li>
<li><p><strong>Three critical limitations</strong>:</p>
<ol type="1">
<li><p>Training data bias: models overrepresent well-studied cell types (K562, HepG2, lymphoblastoid lines) and European ancestry, causing poor performance on underrepresented tissues and populations where prediction confidence is unknown.</p></li>
<li><p>Finite context windows: even 1Mb contexts cannot capture trans-acting factors encoded elsewhere in the genome, structural variants spanning multiple megabases, or whole-chromosome organization effects.</p></li>
<li><p>Missing 3D chromatin structure: models treat DNA as linear sequence but regulation occurs in 3D nuclear space where chromatin loops bring distant elements into physical proximity; current models do not fully integrate how linear sequence determines 3D organization and how that structure mediates regulatory function.</p></li>
</ol></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Long-range regulation problem</strong>: Mammalian gene regulation operates across 20-100+ kb, beyond the reach of short-context models</li>
<li><strong>Hybrid architectures</strong>: CNN compression + transformer attention balances computational efficiency with long-range modeling</li>
<li><strong>Multi-task learning</strong>: Training on diverse functional genomics assays encourages learning of generalizable regulatory features</li>
<li><strong>Cross-species training</strong>: Human and mouse data together emphasize evolutionarily conserved patterns</li>
</ul>
<p><strong>Model Comparison:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>Context</th>
<th>Key Outputs</th>
<th>Access</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Enformer</em></td>
<td>200 kb</td>
<td>Chromatin, CAGE (~5,000 tracks)</td>
<td>Open weights</td>
</tr>
<tr class="even">
<td><em>Borzoi</em></td>
<td>200+ kb</td>
<td>RNA-seq coverage, splicing</td>
<td>Open weights</td>
</tr>
<tr class="odd">
<td><em>Sei</em></td>
<td>~4 kb</td>
<td>40 regulatory class probabilities</td>
<td>Open weights</td>
</tr>
<tr class="even">
<td><em>AlphaGenome</em></td>
<td>~1 Mb</td>
<td>Chromatin + RNA + contacts</td>
<td>API only</td>
</tr>
</tbody>
</table>
<p><strong>Critical Limitations:</strong></p>
<ol type="1">
<li>Training data bias toward well-studied cell types and European ancestry</li>
<li>Finite context misses <em>trans</em>-acting factors and structural variants</li>
<li>Linear sequence representation ignores 3D chromatin organization</li>
<li>Correlation-based learning does not guarantee causal understanding</li>
<li>Model scale (hundreds of millions of parameters) impedes interpretation</li>
</ol>
<p><strong>Clinical Applications:</strong></p>
<ul>
<li>Variant effect prediction for noncoding/regulatory variants</li>
<li>Tissue-specific expression predictions</li>
<li>Integration with classical VEP methods and protein language models</li>
<li>See <a href="p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a> for detailed variant interpretation workflows</li>
</ul>
<p><strong>Looking Forward:</strong></p>
<ul>
<li><a href="p4-ch18-vep-fm.html" class="quarto-xref"><span>Chapter 18</span></a>: How to combine regulatory model predictions with other evidence</li>
<li><a href="../part_5/p5-ch21-3d-genome.html" class="quarto-xref"><span>Chapter 21</span></a>: Models that explicitly address chromatin architecture</li>
<li><a href="../part_6/p6-ch25-interpretability.html" class="quarto-xref"><span>Chapter 25</span></a>: Methods for probing what these models learn</li>
<li><a href="../part_7/p7-ch29-rare-disease.html" class="quarto-xref"><span>Chapter 29</span></a>: Clinical application in diagnostic workflows</li>
</ul>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-avsec_enformer_2021" class="csl-entry" role="listitem">
Avsec, Žiga, Vikram Agarwal, D. Visentin, J. Ledsam, A. Grabska-Barwinska, Kyle R. Taylor, Yannis Assael, J. Jumper, Pushmeet Kohli, and David R. Kelley. 2021. <span>“[<span>Enformer</span>] <span>Effective</span> Gene Expression Prediction from Sequence by Integrating Long-Range Interactions.”</span> <em>Nature Methods</em> 18 (October): 1196–1203. <a href="https://doi.org/10.1038/s41592-021-01252-x">https://doi.org/10.1038/s41592-021-01252-x</a>.
</div>
<div id="ref-avsec_alphagenome_2025" class="csl-entry" role="listitem">
Avsec, Ziga, Natasha Latysheva, and Jun Cheng. 2025. <span>“<span>AlphaGenome</span>: <span>AI</span> for Better Understanding the Genome.”</span>
</div>
<div id="ref-chen_deepsea_2022" class="csl-entry" role="listitem">
Chen, Kathleen M., Aaron K. Wong, Olga G. Troyanskaya, and Jian Zhou. 2022. <span>“[<span>DeepSEA</span> <span>Sei</span>] <span>A</span> Sequence-Based Global Map of Regulatory Activity for Deciphering Human Genetics.”</span> <em>Nature Genetics</em> 54 (7): 940–49. <a href="https://doi.org/10.1038/s41588-022-01102-2">https://doi.org/10.1038/s41588-022-01102-2</a>.
</div>
<div id="ref-gasperini_genome-wide_2019" class="csl-entry" role="listitem">
Gasperini, Molly, Andrew J. Hill, José L. McFaline-Figueroa, Beth Martin, Seungsoo Kim, Melissa D. Zhang, Dana Jackson, et al. 2019. <span>“A <span>Genome</span>-Wide <span>Framework</span> for <span>Mapping</span> <span>Gene</span> <span>Regulation</span> via <span>Cellular</span> <span>Genetic</span> <span>Screens</span>.”</span> <em>Cell</em> 176 (1): 377–390.e19. <a href="https://doi.org/10.1016/j.cell.2018.11.029">https://doi.org/10.1016/j.cell.2018.11.029</a>.
</div>
<div id="ref-linder_borzoi_2025" class="csl-entry" role="listitem">
Linder, Johannes, Divyanshi Srivastava, Han Yuan, Vikram Agarwal, and David R. Kelley. 2025. <span>“[<span>Borzoi</span>] <span>Predicting</span> <span>RNA</span>-Seq Coverage from <span>DNA</span> Sequence as a Unifying Model of Gene Regulation.”</span> <em>Nature Genetics</em> 57 (4): 949–61. <a href="https://doi.org/10.1038/s41588-024-02053-6">https://doi.org/10.1038/s41588-024-02053-6</a>.
</div>
<div id="ref-maurano_systematic_2012" class="csl-entry" role="listitem">
Maurano, Matthew T., Richard Humbert, Eric Rynes, Robert E. Thurman, Eric Haugen, Hao Wang, Alex P. Reynolds, et al. 2012. <span>“Systematic <span>Localization</span> of <span>Common</span> <span>Disease</span>-<span>Associated</span> <span>Variation</span> in <span>Regulatory</span> <span>DNA</span>.”</span> <em>Science</em> 337 (6099): 1190–95. <a href="https://doi.org/10.1126/science.1222794">https://doi.org/10.1126/science.1222794</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../part_4/p4-ch16-protein-lm.html" class="pagination-link" aria-label="Protein Language Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part_4/p4-ch18-vep-fm.html" class="pagination-link" aria-label="Variant Effect Prediction">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>