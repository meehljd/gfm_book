<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix C — Data Curation – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../appendix/app-d-models.html" rel="next">
<link href="../appendix/app-b-compute.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appendix/app-a-dl.html">Appendices</a></li><li class="breadcrumb-item"><a href="../appendix/app-c-data-curation.html"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_1/p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Data Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch03-gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS and Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_1/p1-ch04-vep-classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Variant Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_2/p2--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch05-representations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tokens and Embeddings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch06-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Convolutional Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_2/p2-ch07-attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transformers and Attention</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_3/p3--learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Learning &amp; Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch08-pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch10-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Adaptation Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch11-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmark Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch12-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluation Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_3/p3-ch13-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Confounding and Data Leakage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_4/p4--fm-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Foundation Model Families</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch14-fm-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Foundation Model Paradigm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch15-dna-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">DNA Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch16-protein-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch17-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regulatory Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_4/p4-ch18-vep-fm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_5/p5--cellular-context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Cellular Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch19-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">RNA Structure and Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch20-single-cell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Single-Cell Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch21-3d-genome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">3D Genome Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch22-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Graph and Network Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_5/p5-ch23-multi-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Multi-Omics Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_6/p6--responsible-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Responsible Deployment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch24-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch25-interpretability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch26-causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Causality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_6/p6-ch27-regulatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Regulatory and Governance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part_7/p7--applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Applications &amp; Frontiers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch28-clinical-risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch29-rare-disease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Rare Disease Diagnosis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch30-drug-discovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Drug Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch31-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part_7/p7-ch32-frontiers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Frontiers and Synthesis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bib/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-b-compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-c-data-curation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-d-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-e-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-f-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/app-g-learning-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Statistical Learning Theory Primer</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-apx-c-sources" id="toc-sec-apx-c-sources" class="nav-link active" data-scroll-target="#sec-apx-c-sources"><span class="header-section-number">C.1</span> Data Sources</a>
  <ul class="collapse">
  <li><a href="#reference-genomes-and-assemblies" id="toc-reference-genomes-and-assemblies" class="nav-link" data-scroll-target="#reference-genomes-and-assemblies"><span class="header-section-number">C.1.1</span> Reference Genomes and Assemblies</a></li>
  <li><a href="#population-scale-sequencing" id="toc-population-scale-sequencing" class="nav-link" data-scroll-target="#population-scale-sequencing"><span class="header-section-number">C.1.2</span> Population-Scale Sequencing</a></li>
  <li><a href="#protein-sequence-databases" id="toc-protein-sequence-databases" class="nav-link" data-scroll-target="#protein-sequence-databases"><span class="header-section-number">C.1.3</span> Protein Sequence Databases</a></li>
  <li><a href="#functional-annotation" id="toc-functional-annotation" class="nav-link" data-scroll-target="#functional-annotation"><span class="header-section-number">C.1.4</span> Functional Annotation</a></li>
  <li><a href="#clinical-variant-databases" id="toc-clinical-variant-databases" class="nav-link" data-scroll-target="#clinical-variant-databases"><span class="header-section-number">C.1.5</span> Clinical Variant Databases</a></li>
  <li><a href="#access-and-licensing" id="toc-access-and-licensing" class="nav-link" data-scroll-target="#access-and-licensing"><span class="header-section-number">C.1.6</span> Access and Licensing</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-quality" id="toc-sec-apx-c-quality" class="nav-link" data-scroll-target="#sec-apx-c-quality"><span class="header-section-number">C.2</span> Quality Filtering</a>
  <ul class="collapse">
  <li><a href="#sequence-quality-filters" id="toc-sequence-quality-filters" class="nav-link" data-scroll-target="#sequence-quality-filters"><span class="header-section-number">C.2.1</span> Sequence Quality Filters</a></li>
  <li><a href="#variant-quality-filters" id="toc-variant-quality-filters" class="nav-link" data-scroll-target="#variant-quality-filters"><span class="header-section-number">C.2.2</span> Variant Quality Filters</a></li>
  <li><a href="#annotation-quality" id="toc-annotation-quality" class="nav-link" data-scroll-target="#annotation-quality"><span class="header-section-number">C.2.3</span> Annotation Quality</a></li>
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data"><span class="header-section-number">C.2.4</span> Handling Missing Data</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-dedup" id="toc-sec-apx-c-dedup" class="nav-link" data-scroll-target="#sec-apx-c-dedup"><span class="header-section-number">C.3</span> Deduplication</a>
  <ul class="collapse">
  <li><a href="#exact-deduplication" id="toc-exact-deduplication" class="nav-link" data-scroll-target="#exact-deduplication"><span class="header-section-number">C.3.1</span> Exact Deduplication</a></li>
  <li><a href="#near-duplicate-detection" id="toc-near-duplicate-detection" class="nav-link" data-scroll-target="#near-duplicate-detection"><span class="header-section-number">C.3.2</span> Near-Duplicate Detection</a></li>
  <li><a href="#redundancy-levels" id="toc-redundancy-levels" class="nav-link" data-scroll-target="#redundancy-levels"><span class="header-section-number">C.3.3</span> Redundancy Levels</a></li>
  <li><a href="#train-test-deduplication" id="toc-train-test-deduplication" class="nav-link" data-scroll-target="#train-test-deduplication"><span class="header-section-number">C.3.4</span> Train-Test Deduplication</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-contamination" id="toc-sec-apx-c-contamination" class="nav-link" data-scroll-target="#sec-apx-c-contamination"><span class="header-section-number">C.4</span> Contamination Detection</a>
  <ul class="collapse">
  <li><a href="#types-of-contamination" id="toc-types-of-contamination" class="nav-link" data-scroll-target="#types-of-contamination"><span class="header-section-number">C.4.1</span> Types of Contamination</a></li>
  <li><a href="#screening-approaches" id="toc-screening-approaches" class="nav-link" data-scroll-target="#screening-approaches"><span class="header-section-number">C.4.2</span> Screening Approaches</a></li>
  <li><a href="#benchmark-contamination" id="toc-benchmark-contamination" class="nav-link" data-scroll-target="#benchmark-contamination"><span class="header-section-number">C.4.3</span> Benchmark Contamination</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-provenance" id="toc-sec-apx-c-provenance" class="nav-link" data-scroll-target="#sec-apx-c-provenance"><span class="header-section-number">C.5</span> Data Provenance</a>
  <ul class="collapse">
  <li><a href="#metadata-requirements" id="toc-metadata-requirements" class="nav-link" data-scroll-target="#metadata-requirements"><span class="header-section-number">C.5.1</span> Metadata Requirements</a></li>
  <li><a href="#documentation-template" id="toc-documentation-template" class="nav-link" data-scroll-target="#documentation-template"><span class="header-section-number">C.5.2</span> Documentation Template</a></li>
  <li><a href="#version-control" id="toc-version-control" class="nav-link" data-scroll-target="#version-control"><span class="header-section-number">C.5.3</span> Version Control</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-bias" id="toc-sec-apx-c-bias" class="nav-link" data-scroll-target="#sec-apx-c-bias"><span class="header-section-number">C.6</span> Bias Assessment</a>
  <ul class="collapse">
  <li><a href="#population-bias" id="toc-population-bias" class="nav-link" data-scroll-target="#population-bias"><span class="header-section-number">C.6.1</span> Population Bias</a></li>
  <li><a href="#gene-coverage-bias" id="toc-gene-coverage-bias" class="nav-link" data-scroll-target="#gene-coverage-bias"><span class="header-section-number">C.6.2</span> Gene Coverage Bias</a></li>
  <li><a href="#ascertainment-bias" id="toc-ascertainment-bias" class="nav-link" data-scroll-target="#ascertainment-bias"><span class="header-section-number">C.6.3</span> Ascertainment Bias</a></li>
  <li><a href="#label-bias" id="toc-label-bias" class="nav-link" data-scroll-target="#label-bias"><span class="header-section-number">C.6.4</span> Label Bias</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-building" id="toc-sec-apx-c-building" class="nav-link" data-scroll-target="#sec-apx-c-building"><span class="header-section-number">C.7</span> Building Training Sets</a>
  <ul class="collapse">
  <li><a href="#step-1-define-scope" id="toc-step-1-define-scope" class="nav-link" data-scroll-target="#step-1-define-scope"><span class="header-section-number">C.7.1</span> Step 1: Define Scope</a></li>
  <li><a href="#step-2-identify-sources" id="toc-step-2-identify-sources" class="nav-link" data-scroll-target="#step-2-identify-sources"><span class="header-section-number">C.7.2</span> Step 2: Identify Sources</a></li>
  <li><a href="#step-3-download-and-verify" id="toc-step-3-download-and-verify" class="nav-link" data-scroll-target="#step-3-download-and-verify"><span class="header-section-number">C.7.3</span> Step 3: Download and Verify</a></li>
  <li><a href="#step-4-quality-filter" id="toc-step-4-quality-filter" class="nav-link" data-scroll-target="#step-4-quality-filter"><span class="header-section-number">C.7.4</span> Step 4: Quality Filter</a></li>
  <li><a href="#step-5-deduplicate" id="toc-step-5-deduplicate" class="nav-link" data-scroll-target="#step-5-deduplicate"><span class="header-section-number">C.7.5</span> Step 5: Deduplicate</a></li>
  <li><a href="#step-6-split-data" id="toc-step-6-split-data" class="nav-link" data-scroll-target="#step-6-split-data"><span class="header-section-number">C.7.6</span> Step 6: Split Data</a></li>
  <li><a href="#step-7-assess-bias" id="toc-step-7-assess-bias" class="nav-link" data-scroll-target="#step-7-assess-bias"><span class="header-section-number">C.7.7</span> Step 7: Assess Bias</a></li>
  <li><a href="#step-8-document" id="toc-step-8-document" class="nav-link" data-scroll-target="#step-8-document"><span class="header-section-number">C.7.8</span> Step 8: Document</a></li>
  </ul></li>
  <li><a href="#sec-apx-c-datacards" id="toc-sec-apx-c-datacards" class="nav-link" data-scroll-target="#sec-apx-c-datacards"><span class="header-section-number">C.8</span> Data Cards</a></li>
  <li><a href="#sec-apx-c-checklist" id="toc-sec-apx-c-checklist" class="nav-link" data-scroll-target="#sec-apx-c-checklist"><span class="header-section-number">C.9</span> Checklist</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appendix/app-a-dl.html">Appendices</a></li><li class="breadcrumb-item"><a href="../appendix/app-c-data-curation.html"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Curation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-apx-c-data-curation" class="quarto-section-identifier">Appendix C — Data Curation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Training genomic foundation models requires carefully curated datasets that balance scale with quality. Poor data curation propagates errors into model representations, creating systematic biases that persist through downstream applications. This appendix provides practical guidance for constructing training sets, detecting contamination, and documenting data provenance.</p>
<section id="sec-apx-c-sources" class="level2" data-number="C.1">
<h2 data-number="C.1" class="anchored" data-anchor-id="sec-apx-c-sources"><span class="header-section-number">C.1</span> Data Sources</h2>
<p>Genomic foundation models draw from diverse data sources, each with distinct characteristics, biases, and access requirements.</p>
<section id="reference-genomes-and-assemblies" class="level3" data-number="C.1.1">
<h3 data-number="C.1.1" class="anchored" data-anchor-id="reference-genomes-and-assemblies"><span class="header-section-number">C.1.1</span> Reference Genomes and Assemblies</h3>
<p><strong>Human reference genome</strong> (GRCh38/hg38) provides the coordinate system for human genomics:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Assembly</th>
<th>Release</th>
<th>Key Features</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GRCh38</td>
<td>2013</td>
<td>Current standard, alternate loci</td>
</tr>
<tr class="even">
<td>T2T-CHM13</td>
<td>2022</td>
<td>First complete human genome</td>
</tr>
<tr class="odd">
<td>Pangenome</td>
<td>2023</td>
<td>Graph-based, population diversity</td>
</tr>
</tbody>
</table>
<p><strong>Species genomes</strong> from Ensembl, NCBI, and UCSC provide sequences for comparative genomics and cross-species pretraining.</p>
<p><strong>Considerations</strong>: - Reference genome represents a single haplotype, missing population diversity - Repetitive regions and centromeres are poorly represented in older assemblies - Coordinate systems differ between assemblies; ensure consistency</p>
</section>
<section id="population-scale-sequencing" class="level3" data-number="C.1.2">
<h3 data-number="C.1.2" class="anchored" data-anchor-id="population-scale-sequencing"><span class="header-section-number">C.1.2</span> Population-Scale Sequencing</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Resource</th>
<th>Samples</th>
<th>Data Type</th>
<th>Access</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>gnomAD</strong></td>
<td>730,000+</td>
<td>Exomes/genomes</td>
<td>Open</td>
</tr>
<tr class="even">
<td><strong>UK Biobank</strong></td>
<td>500,000</td>
<td>WGS, WES, arrays</td>
<td>Controlled</td>
</tr>
<tr class="odd">
<td><strong>All of Us</strong></td>
<td>1,000,000+</td>
<td>WGS</td>
<td>Controlled</td>
</tr>
<tr class="even">
<td><strong>TOPMed</strong></td>
<td>180,000+</td>
<td>WGS</td>
<td>Controlled</td>
</tr>
<tr class="odd">
<td><strong>1000 Genomes</strong></td>
<td>3,200</td>
<td>WGS</td>
<td>Open</td>
</tr>
</tbody>
</table>
<p>Population databases provide variant frequency information and diverse genetic backgrounds. gnomAD’s open access makes it valuable for training; controlled-access resources like UK Biobank require applications and data use agreements.</p>
</section>
<section id="protein-sequence-databases" class="level3" data-number="C.1.3">
<h3 data-number="C.1.3" class="anchored" data-anchor-id="protein-sequence-databases"><span class="header-section-number">C.1.3</span> Protein Sequence Databases</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Database</th>
<th>Sequences</th>
<th>Coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>UniRef100</strong></td>
<td>300M+</td>
<td>Non-redundant proteins</td>
</tr>
<tr class="even">
<td><strong>UniRef90</strong></td>
<td>150M+</td>
<td>90% identity clusters</td>
</tr>
<tr class="odd">
<td><strong>UniRef50</strong></td>
<td>55M+</td>
<td>50% identity clusters</td>
</tr>
<tr class="even">
<td><strong>UniParc</strong></td>
<td>500M+</td>
<td>All known proteins</td>
</tr>
</tbody>
</table>
<p>UniRef provides clustered protein sequences at different identity thresholds, enabling control over sequence redundancy during pretraining. Lower redundancy (UniRef50) reduces training time but may miss sequence diversity; higher redundancy captures more variation but increases computational cost.</p>
</section>
<section id="functional-annotation" class="level3" data-number="C.1.4">
<h3 data-number="C.1.4" class="anchored" data-anchor-id="functional-annotation"><span class="header-section-number">C.1.4</span> Functional Annotation</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Resource</th>
<th>Assays</th>
<th>Cell Types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ENCODE</strong></td>
<td>ChIP-seq, ATAC-seq, RNA-seq</td>
<td>500+</td>
</tr>
<tr class="even">
<td><strong>Roadmap</strong></td>
<td>Histone marks, DNase</td>
<td>127</td>
</tr>
<tr class="odd">
<td><strong>GTEx</strong></td>
<td>RNA-seq</td>
<td>54 tissues</td>
</tr>
<tr class="even">
<td><strong>FANTOM5</strong></td>
<td>CAGE</td>
<td>1,800+</td>
</tr>
</tbody>
</table>
<p>Functional genomics data provides supervision signals for regulatory sequence models. ENCODE and Roadmap offer consistent protocols across cell types; GTEx provides tissue-specific expression. Data quality varies by assay and cell type; metadata review is essential.</p>
</section>
<section id="clinical-variant-databases" class="level3" data-number="C.1.5">
<h3 data-number="C.1.5" class="anchored" data-anchor-id="clinical-variant-databases"><span class="header-section-number">C.1.5</span> Clinical Variant Databases</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Database</th>
<th>Variants</th>
<th>Curation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ClinVar</strong></td>
<td>2M+</td>
<td>Submitter-dependent</td>
</tr>
<tr class="even">
<td><strong>HGMD</strong></td>
<td>350K+</td>
<td>Expert curated</td>
</tr>
<tr class="odd">
<td><strong>ClinGen</strong></td>
<td>Genes + variants</td>
<td>Expert panels</td>
</tr>
<tr class="even">
<td><strong>LOVD</strong></td>
<td>Gene-specific</td>
<td>Variable</td>
</tr>
</tbody>
</table>
<p>ClinVar provides the largest open-access collection of clinical variant interpretations but includes submitter variability and classification conflicts. See <a href="../part_1/p1-ch02-data.html" class="quarto-xref"><span>Chapter 2</span></a> for detailed discussion of ClinVar biases.</p>
</section>
<section id="access-and-licensing" class="level3" data-number="C.1.6">
<h3 data-number="C.1.6" class="anchored" data-anchor-id="access-and-licensing"><span class="header-section-number">C.1.6</span> Access and Licensing</h3>
<p>Data access requirements vary:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Access Type</th>
<th>Examples</th>
<th>Requirements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Open</strong></td>
<td>gnomAD, 1000G, ClinVar</td>
<td>None</td>
</tr>
<tr class="even">
<td><strong>Registered</strong></td>
<td>ENCODE, GTEx</td>
<td>Account creation</td>
</tr>
<tr class="odd">
<td><strong>Controlled</strong></td>
<td>UK Biobank, dbGaP</td>
<td>Application, IRB approval</td>
</tr>
<tr class="even">
<td><strong>Commercial</strong></td>
<td>HGMD Professional</td>
<td>Subscription</td>
</tr>
</tbody>
</table>
<p><strong>Controlled-access data</strong> requires: - Institutional review board (IRB) approval - Data use agreements (DUA) - Secure computing environments - Compliance with return/destruction policies</p>
</section>
</section>
<section id="sec-apx-c-quality" class="level2" data-number="C.2">
<h2 data-number="C.2" class="anchored" data-anchor-id="sec-apx-c-quality"><span class="header-section-number">C.2</span> Quality Filtering</h2>
<p>Raw genomic data contains errors from sequencing, alignment, and annotation. Quality filtering removes problematic entries before training.</p>
<section id="sequence-quality-filters" class="level3" data-number="C.2.1">
<h3 data-number="C.2.1" class="anchored" data-anchor-id="sequence-quality-filters"><span class="header-section-number">C.2.1</span> Sequence Quality Filters</h3>
<p><strong>For DNA sequences</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Filter</th>
<th>Threshold</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>N content</td>
<td>&lt;5%</td>
<td>Removes poorly sequenced regions</td>
</tr>
<tr class="even">
<td>Low complexity</td>
<td>DUST score</td>
<td>Removes repetitive sequence</td>
</tr>
<tr class="odd">
<td>Length</td>
<td>Task-dependent</td>
<td>Ensures sufficient context</td>
</tr>
<tr class="even">
<td>GC content</td>
<td>Species-appropriate</td>
<td>Flags contamination</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_sequence(seq, max_n_frac<span class="op">=</span><span class="fl">0.05</span>, min_length<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Basic sequence quality filter."""</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    n_frac <span class="op">=</span> seq.count(<span class="st">'N'</span>) <span class="op">/</span> <span class="bu">len</span>(seq)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_frac <span class="op">&gt;</span> max_n_frac:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(seq) <span class="op">&lt;</span> min_length:</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>For protein sequences</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Filter</th>
<th>Threshold</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X content</td>
<td>&lt;1%</td>
<td>Removes ambiguous residues</td>
</tr>
<tr class="even">
<td>Length</td>
<td>30–10,000 AA</td>
<td>Filters fragments and artifacts</td>
</tr>
<tr class="odd">
<td>Stop codons</td>
<td>0 internal</td>
<td>Removes pseudogenes</td>
</tr>
</tbody>
</table>
</section>
<section id="variant-quality-filters" class="level3" data-number="C.2.2">
<h3 data-number="C.2.2" class="anchored" data-anchor-id="variant-quality-filters"><span class="header-section-number">C.2.2</span> Variant Quality Filters</h3>
<p>Variant calls include false positives from sequencing errors and alignment artifacts:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Filter</th>
<th>Typical Threshold</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>QUAL</strong></td>
<td>&gt;20</td>
<td>Phred-scaled quality</td>
</tr>
<tr class="even">
<td><strong>DP</strong></td>
<td>&gt;10</td>
<td>Read depth</td>
</tr>
<tr class="odd">
<td><strong>GQ</strong></td>
<td>&gt;20</td>
<td>Genotype quality</td>
</tr>
<tr class="even">
<td><strong>FILTER</strong></td>
<td>PASS</td>
<td>Caller-specific filters</td>
</tr>
<tr class="odd">
<td><strong>AF_gnomAD</strong></td>
<td>&lt;0.01 for rare</td>
<td>Population frequency</td>
</tr>
</tbody>
</table>
<p>GATK and other variant callers apply default filters; additional filtering may be needed for training data. Overly stringent filtering biases toward common variants; overly permissive filtering includes false positives.</p>
</section>
<section id="annotation-quality" class="level3" data-number="C.2.3">
<h3 data-number="C.2.3" class="anchored" data-anchor-id="annotation-quality"><span class="header-section-number">C.2.3</span> Annotation Quality</h3>
<p>Clinical annotations have variable quality:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Quality Indicator</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Review status</strong> (ClinVar)</td>
<td>Stars indicate curation level</td>
</tr>
<tr class="even">
<td><strong>Submission count</strong></td>
<td>More submissions increase confidence</td>
</tr>
<tr class="odd">
<td><strong>Date</strong></td>
<td>Recent annotations reflect current knowledge</td>
</tr>
<tr class="even">
<td><strong>Conflicts</strong></td>
<td>Multiple interpretations reduce reliability</td>
</tr>
</tbody>
</table>
<p><strong>Filtering strategy for ClinVar</strong>: - Require ≥2 stars review status for training labels - Exclude variants with conflicting interpretations - Consider date cutoffs for temporal validation</p>
</section>
<section id="handling-missing-data" class="level3" data-number="C.2.4">
<h3 data-number="C.2.4" class="anchored" data-anchor-id="handling-missing-data"><span class="header-section-number">C.2.4</span> Handling Missing Data</h3>
<p>Missing annotations are common:</p>
<ul>
<li><strong>Explicit missing</strong>: Marked as unknown/uncertain</li>
<li><strong>Implicit missing</strong>: Simply not annotated</li>
</ul>
<p>Strategies: - Exclude samples with critical missing fields - Impute where appropriate (mean, median, model-based) - Model missingness explicitly (separate category) - Document missing data rates</p>
</section>
</section>
<section id="sec-apx-c-dedup" class="level2" data-number="C.3">
<h2 data-number="C.3" class="anchored" data-anchor-id="sec-apx-c-dedup"><span class="header-section-number">C.3</span> Deduplication</h2>
<p>Duplicate sequences inflate dataset size without providing new information and can cause train-test leakage.</p>
<section id="exact-deduplication" class="level3" data-number="C.3.1">
<h3 data-number="C.3.1" class="anchored" data-anchor-id="exact-deduplication"><span class="header-section-number">C.3.1</span> Exact Deduplication</h3>
<p>Remove identical sequences:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> deduplicate_exact(sequences):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Remove exact duplicate sequences."""</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    seen <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    unique <span class="op">=</span> []</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq <span class="kw">in</span> sequences:</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        seq_hash <span class="op">=</span> hashlib.md5(seq.encode()).hexdigest()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seq_hash <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            seen.add(seq_hash)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            unique.append(seq)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="near-duplicate-detection" class="level3" data-number="C.3.2">
<h3 data-number="C.3.2" class="anchored" data-anchor-id="near-duplicate-detection"><span class="header-section-number">C.3.2</span> Near-Duplicate Detection</h3>
<p>Sequences differing by few positions may represent the same biological entity:</p>
<p><strong>For DNA</strong>: - MinHash/LSH for approximate matching - CD-HIT for clustering at identity thresholds - MMseqs2 for scalable clustering</p>
<p><strong>For proteins</strong>: - CD-HIT at 90%, 70%, 50%, 30% identity - MMseqs2 for large-scale clustering - PSI-BLAST for remote homology</p>
<p><strong>Example CD-HIT usage</strong>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster at 90% sequence identity</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cd-hit</span> <span class="at">-i</span> proteins.fasta <span class="at">-o</span> proteins_nr90.fasta <span class="at">-c</span> 0.9 <span class="at">-n</span> 5</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster at 50% identity (requires different word size)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cd-hit</span> <span class="at">-i</span> proteins.fasta <span class="at">-o</span> proteins_nr50.fasta <span class="at">-c</span> 0.5 <span class="at">-n</span> 3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="redundancy-levels" class="level3" data-number="C.3.3">
<h3 data-number="C.3.3" class="anchored" data-anchor-id="redundancy-levels"><span class="header-section-number">C.3.3</span> Redundancy Levels</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Redundancy</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>100% (no dedup)</strong></td>
<td>Maximum data, risk of memorization</td>
</tr>
<tr class="even">
<td><strong>90% identity</strong></td>
<td>Reduce near-duplicates, preserve variants</td>
</tr>
<tr class="odd">
<td><strong>70% identity</strong></td>
<td>Balance diversity and coverage</td>
</tr>
<tr class="even">
<td><strong>50% identity</strong></td>
<td>Maximize diversity, may lose variants</td>
</tr>
<tr class="odd">
<td><strong>30% identity</strong></td>
<td>Remote homologs only</td>
</tr>
</tbody>
</table>
<p>The optimal redundancy level depends on the task and model capacity. Larger models can benefit from more redundancy; smaller models may need aggressive deduplication.</p>
</section>
<section id="train-test-deduplication" class="level3" data-number="C.3.4">
<h3 data-number="C.3.4" class="anchored" data-anchor-id="train-test-deduplication"><span class="header-section-number">C.3.4</span> Train-Test Deduplication</h3>
<p>Critical for valid evaluation:</p>
<ol type="1">
<li>Define test set sequences first</li>
<li>Remove training sequences similar to test sequences</li>
<li>Use appropriate similarity threshold (often 30–50% for proteins)</li>
<li>Document the deduplication procedure</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_test_similar(train_seqs, test_seqs, threshold<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Remove training sequences similar to test set."""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use MMseqs2 or similar for actual implementation</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is pseudocode for the concept</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    clean_train <span class="op">=</span> []</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> train_seq <span class="kw">in</span> train_seqs:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">any</span>(similarity(train_seq, test_seq) <span class="op">&gt;</span> threshold</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> test_seq <span class="kw">in</span> test_seqs):</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            clean_train.append(train_seq)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> clean_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sec-apx-c-contamination" class="level2" data-number="C.4">
<h2 data-number="C.4" class="anchored" data-anchor-id="sec-apx-c-contamination"><span class="header-section-number">C.4</span> Contamination Detection</h2>
<p>Contamination introduces sequences from unintended sources, corrupting training data.</p>
<section id="types-of-contamination" class="level3" data-number="C.4.1">
<h3 data-number="C.4.1" class="anchored" data-anchor-id="types-of-contamination"><span class="header-section-number">C.4.1</span> Types of Contamination</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 32%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Source</th>
<th>Detection</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Cross-species</strong></td>
<td>Sample mix-up, xenograft</td>
<td>BLAST to species databases</td>
</tr>
<tr class="even">
<td><strong>Microbial</strong></td>
<td>Sample contamination</td>
<td>Screen against microbial genomes</td>
</tr>
<tr class="odd">
<td><strong>Adapter</strong></td>
<td>Library prep artifacts</td>
<td>Match adapter sequences</td>
</tr>
<tr class="even">
<td><strong>Vector</strong></td>
<td>Cloning artifacts</td>
<td>Screen UniVec database</td>
</tr>
<tr class="odd">
<td><strong>Human</strong></td>
<td>Non-human samples</td>
<td>Screen against human genome</td>
</tr>
</tbody>
</table>
</section>
<section id="screening-approaches" class="level3" data-number="C.4.2">
<h3 data-number="C.4.2" class="anchored" data-anchor-id="screening-approaches"><span class="header-section-number">C.4.2</span> Screening Approaches</h3>
<p><strong>BLAST-based screening</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Screen against human genome for non-human samples</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">blastn</span> <span class="at">-query</span> sequences.fasta <span class="at">-db</span> human_genome <span class="dt">\</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">-outfmt</span> 6 <span class="at">-evalue</span> 1e-10 <span class="op">&gt;</span> human_hits.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Specialized tools</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Tool</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>FastQ Screen</strong></td>
<td>Multi-genome contamination</td>
</tr>
<tr class="even">
<td><strong>Kraken2</strong></td>
<td>Taxonomic classification</td>
</tr>
<tr class="odd">
<td><strong>BBDuk</strong></td>
<td>Adapter/contaminant removal</td>
</tr>
<tr class="even">
<td><strong>VecScreen</strong></td>
<td>Vector contamination</td>
</tr>
</tbody>
</table>
</section>
<section id="benchmark-contamination" class="level3" data-number="C.4.3">
<h3 data-number="C.4.3" class="anchored" data-anchor-id="benchmark-contamination"><span class="header-section-number">C.4.3</span> Benchmark Contamination</h3>
<p>A subtle but critical issue: test benchmarks contaminated in pretraining data inflate performance estimates.</p>
<p><strong>Detection</strong>: - Search pretraining corpus for benchmark sequences - Check for substring matches, not just exact matches - Verify temporal separation (benchmark created after pretraining data)</p>
<p><strong>Prevention</strong>: - Document pretraining data sources and dates - Use chromosome-based holdouts where possible - Report contamination checks in publications</p>
</section>
</section>
<section id="sec-apx-c-provenance" class="level2" data-number="C.5">
<h2 data-number="C.5" class="anchored" data-anchor-id="sec-apx-c-provenance"><span class="header-section-number">C.5</span> Data Provenance</h2>
<p>Tracking data origins enables reproducibility and debugging.</p>
<section id="metadata-requirements" class="level3" data-number="C.5.1">
<h3 data-number="C.5.1" class="anchored" data-anchor-id="metadata-requirements"><span class="header-section-number">C.5.1</span> Metadata Requirements</h3>
<p>Essential metadata for each data source:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Source</strong></td>
<td>Database/repository name</td>
</tr>
<tr class="even">
<td><strong>Version</strong></td>
<td>Release version or date</td>
</tr>
<tr class="odd">
<td><strong>Access date</strong></td>
<td>When data was downloaded</td>
</tr>
<tr class="even">
<td><strong>URL</strong></td>
<td>Exact download location</td>
</tr>
<tr class="odd">
<td><strong>Processing</strong></td>
<td>Filters and transformations applied</td>
</tr>
<tr class="even">
<td><strong>Checksum</strong></td>
<td>MD5/SHA256 for verification</td>
</tr>
</tbody>
</table>
</section>
<section id="documentation-template" class="level3" data-number="C.5.2">
<h3 data-number="C.5.2" class="anchored" data-anchor-id="documentation-template"><span class="header-section-number">C.5.2</span> Documentation Template</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data_manifest.yaml</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dataset</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">"variant_training_v2"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">created</span><span class="kw">:</span><span class="at"> </span><span class="st">"2024-01-15"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sources</span><span class="kw">:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">"ClinVar"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">"2024-01"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://ftp.ncbi.nlm.nih.gov/pub/clinvar/..."</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">checksum</span><span class="kw">:</span><span class="at"> </span><span class="st">"abc123..."</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">filters</span><span class="kw">:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">"review_status &gt;= 2 stars"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">"no conflicting interpretations"</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">records_raw</span><span class="kw">:</span><span class="at"> </span><span class="dv">2500000</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">records_filtered</span><span class="kw">:</span><span class="at"> </span><span class="dv">850000</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">"gnomAD"</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">"4.0"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">url</span><span class="kw">:</span><span class="at"> </span><span class="st">"https://gnomad.broadinstitute.org/..."</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">checksum</span><span class="kw">:</span><span class="at"> </span><span class="st">"def456..."</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">filters</span><span class="kw">:</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">"FILTER == PASS"</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">"AF &gt; 0.001"</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">records_raw</span><span class="kw">:</span><span class="at"> </span><span class="dv">750000000</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">records_filtered</span><span class="kw">:</span><span class="at"> </span><span class="dv">45000000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">processing</span><span class="kw">:</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">deduplication</span><span class="kw">:</span><span class="at"> </span><span class="st">"exact + 90% identity clustering"</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">train_test_split</span><span class="kw">:</span><span class="at"> </span><span class="st">"chromosome-based (chr8 test)"</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="fu">final_counts</span><span class="kw">:</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">train</span><span class="kw">:</span><span class="at"> </span><span class="dv">800000</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="dv">50000</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">test</span><span class="kw">:</span><span class="at"> </span><span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="version-control" class="level3" data-number="C.5.3">
<h3 data-number="C.5.3" class="anchored" data-anchor-id="version-control"><span class="header-section-number">C.5.3</span> Version Control</h3>
<p>For reproducibility: - Store data manifests in version control - Use content-addressable storage for large files (DVC, git-lfs) - Tag dataset versions with model training runs - Archive exact preprocessing scripts</p>
</section>
</section>
<section id="sec-apx-c-bias" class="level2" data-number="C.6">
<h2 data-number="C.6" class="anchored" data-anchor-id="sec-apx-c-bias"><span class="header-section-number">C.6</span> Bias Assessment</h2>
<p>Training data biases propagate into model predictions. Proactive assessment enables mitigation.</p>
<section id="population-bias" class="level3" data-number="C.6.1">
<h3 data-number="C.6.1" class="anchored" data-anchor-id="population-bias"><span class="header-section-number">C.6.1</span> Population Bias</h3>
<p>Genomic databases are not representative of global populations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Database</th>
<th>European</th>
<th>African</th>
<th>Asian</th>
<th>Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ClinVar</td>
<td>~70%</td>
<td>~5%</td>
<td>~15%</td>
<td>~10%</td>
</tr>
<tr class="even">
<td>gnomAD</td>
<td>~50%</td>
<td>~10%</td>
<td>~25%</td>
<td>~15%</td>
</tr>
<tr class="odd">
<td>UK Biobank</td>
<td>~95%</td>
<td>~2%</td>
<td>~2%</td>
<td>~1%</td>
</tr>
</tbody>
</table>
<p><strong>Consequences</strong>: - Variant frequency estimates biased toward Europeans - Pathogenic variants in non-European populations underrepresented - Models may perform worse on underrepresented populations</p>
<p><strong>Assessment</strong>: - Compute ancestry distribution of training samples - Evaluate model performance stratified by ancestry - Document limitations for underrepresented groups</p>
</section>
<section id="gene-coverage-bias" class="level3" data-number="C.6.2">
<h3 data-number="C.6.2" class="anchored" data-anchor-id="gene-coverage-bias"><span class="header-section-number">C.6.2</span> Gene Coverage Bias</h3>
<p>Some genes are more studied than others:</p>
<ul>
<li>Cancer genes (<em>BRCA1</em>, <em>TP53</em>) have extensive annotation</li>
<li>Novel disease genes have sparse data</li>
<li>Gene function determines ascertainment</li>
</ul>
<p><strong>Assessment</strong>: - Plot variants per gene vs.&nbsp;gene length - Identify genes with suspiciously high/low variant counts - Consider gene-level normalization</p>
</section>
<section id="ascertainment-bias" class="level3" data-number="C.6.3">
<h3 data-number="C.6.3" class="anchored" data-anchor-id="ascertainment-bias"><span class="header-section-number">C.6.3</span> Ascertainment Bias</h3>
<p>Clinical databases reflect clinical practice:</p>
<ul>
<li>Common diseases overrepresented</li>
<li>Severe phenotypes more likely to reach clinical attention</li>
<li>Geographic patterns in healthcare access</li>
</ul>
<p><strong>Assessment</strong>: - Compare phenotype distribution to population prevalence - Identify systematic gaps in disease coverage - Document clinical ascertainment assumptions</p>
</section>
<section id="label-bias" class="level3" data-number="C.6.4">
<h3 data-number="C.6.4" class="anchored" data-anchor-id="label-bias"><span class="header-section-number">C.6.4</span> Label Bias</h3>
<p>Annotations reflect annotator knowledge and conventions:</p>
<ul>
<li>Historical classifications may be outdated</li>
<li>Different submitters use different standards</li>
<li>Pathogenicity thresholds vary by context</li>
</ul>
<p><strong>Assessment</strong>: - Track annotation dates and sources - Identify conflicting labels - Consider temporal validation (train on old, test on new)</p>
</section>
</section>
<section id="sec-apx-c-building" class="level2" data-number="C.7">
<h2 data-number="C.7" class="anchored" data-anchor-id="sec-apx-c-building"><span class="header-section-number">C.7</span> Building Training Sets</h2>
<p>Practical workflow for constructing training data.</p>
<section id="step-1-define-scope" class="level3" data-number="C.7.1">
<h3 data-number="C.7.1" class="anchored" data-anchor-id="step-1-define-scope"><span class="header-section-number">C.7.1</span> Step 1: Define Scope</h3>
<ul>
<li>What sequences will the model process?</li>
<li>What predictions will it make?</li>
<li>What populations/contexts must it serve?</li>
</ul>
</section>
<section id="step-2-identify-sources" class="level3" data-number="C.7.2">
<h3 data-number="C.7.2" class="anchored" data-anchor-id="step-2-identify-sources"><span class="header-section-number">C.7.2</span> Step 2: Identify Sources</h3>
<ul>
<li>List candidate data sources</li>
<li>Assess access requirements and licenses</li>
<li>Evaluate quality and coverage</li>
</ul>
</section>
<section id="step-3-download-and-verify" class="level3" data-number="C.7.3">
<h3 data-number="C.7.3" class="anchored" data-anchor-id="step-3-download-and-verify"><span class="header-section-number">C.7.3</span> Step 3: Download and Verify</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download with verification</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://example.com/data.vcf.gz</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">md5sum</span> data.vcf.gz  <span class="co"># Compare to published checksum</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Document in manifest</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Downloaded data.vcf.gz on </span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> data_log.txt</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"MD5: </span><span class="va">$(</span><span class="fu">md5sum</span> data.vcf.gz<span class="va">)</span><span class="st">"</span> <span class="op">&gt;&gt;</span> data_log.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-4-quality-filter" class="level3" data-number="C.7.4">
<h3 data-number="C.7.4" class="anchored" data-anchor-id="step-4-quality-filter"><span class="header-section-number">C.7.4</span> Step 4: Quality Filter</h3>
<p>Apply appropriate filters for each data type: - Sequence quality (N content, length, complexity) - Variant quality (QUAL, DP, GQ, FILTER) - Annotation quality (review status, conflicts)</p>
</section>
<section id="step-5-deduplicate" class="level3" data-number="C.7.5">
<h3 data-number="C.7.5" class="anchored" data-anchor-id="step-5-deduplicate"><span class="header-section-number">C.7.5</span> Step 5: Deduplicate</h3>
<ul>
<li>Remove exact duplicates</li>
<li>Cluster at appropriate identity threshold</li>
<li>Ensure train-test separation</li>
</ul>
</section>
<section id="step-6-split-data" class="level3" data-number="C.7.6">
<h3 data-number="C.7.6" class="anchored" data-anchor-id="step-6-split-data"><span class="header-section-number">C.7.6</span> Step 6: Split Data</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Split</th>
<th>Purpose</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Train</strong></td>
<td>Model training</td>
<td>80–90%</td>
</tr>
<tr class="even">
<td><strong>Validation</strong></td>
<td>Hyperparameter tuning</td>
<td>5–10%</td>
</tr>
<tr class="odd">
<td><strong>Test</strong></td>
<td>Final evaluation</td>
<td>5–10%</td>
</tr>
</tbody>
</table>
<p><strong>Splitting strategies</strong>: - Random (simple but may leak related samples) - Chromosome-based (ensures spatial separation) - Temporal (train on older data, test on newer) - Gene-family-based (tests generalization to new genes)</p>
</section>
<section id="step-7-assess-bias" class="level3" data-number="C.7.7">
<h3 data-number="C.7.7" class="anchored" data-anchor-id="step-7-assess-bias"><span class="header-section-number">C.7.7</span> Step 7: Assess Bias</h3>
<ul>
<li>Compute population/gene/phenotype distributions</li>
<li>Compare to expected distributions</li>
<li>Document known biases and limitations</li>
</ul>
</section>
<section id="step-8-document" class="level3" data-number="C.7.8">
<h3 data-number="C.7.8" class="anchored" data-anchor-id="step-8-document"><span class="header-section-number">C.7.8</span> Step 8: Document</h3>
<ul>
<li>Create comprehensive data manifest</li>
<li>Archive preprocessing scripts</li>
<li>Record final counts and splits</li>
<li>Publish data card with limitations</li>
</ul>
</section>
</section>
<section id="sec-apx-c-datacards" class="level2" data-number="C.8">
<h2 data-number="C.8" class="anchored" data-anchor-id="sec-apx-c-datacards"><span class="header-section-number">C.8</span> Data Cards</h2>
<p>A <strong>data card</strong> documents dataset characteristics for users:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dataset: VariantBench-v2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Purpose: Training variant effect predictors</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Size: 950,000 variants (800K train / 50K val / 100K test)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Created: January 2024</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sources</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ClinVar 2024-01 (pathogenic/benign labels)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>gnomAD 4.0 (population frequencies)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Curation</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Required 2+ stars review status</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Excluded conflicting interpretations</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>90% identity clustering applied</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Chromosome 8 held out for testing</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Known Biases</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>70% European ancestry</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cancer genes overrepresented (*BRCA1*: 15K variants)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Recent submissions may have unstable classifications</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intended Use</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Training and evaluating pathogenicity predictors</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOT suitable for: clinical diagnosis without validation</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Updates</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>v2.1 (March 2024): Added 50K variants from new ClinVar release</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-apx-c-checklist" class="level2" data-number="C.9">
<h2 data-number="C.9" class="anchored" data-anchor-id="sec-apx-c-checklist"><span class="header-section-number">C.9</span> Checklist</h2>
<p>Before using a dataset for training:</p>
<p><strong>Data Quality</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Sources documented with versions and dates</label></li>
<li><label><input type="checkbox">Quality filters applied and documented</label></li>
<li><label><input type="checkbox">Deduplication performed at appropriate threshold</label></li>
<li><label><input type="checkbox">Train-test leakage prevented</label></li>
</ul>
<p><strong>Bias Assessment</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Population distribution analyzed</label></li>
<li><label><input type="checkbox">Gene coverage distribution analyzed</label></li>
<li><label><input type="checkbox">Ascertainment biases documented</label></li>
<li><label><input type="checkbox">Label quality assessed</label></li>
</ul>
<p><strong>Documentation</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Data manifest created</label></li>
<li><label><input type="checkbox">Preprocessing scripts archived</label></li>
<li><label><input type="checkbox">Data card written</label></li>
<li><label><input type="checkbox">Limitations clearly stated</label></li>
</ul>
<p><strong>Reproducibility</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Checksums recorded</label></li>
<li><label><input type="checkbox">Random seeds documented</label></li>
<li><label><input type="checkbox">Scripts version-controlled</label></li>
<li><label><input type="checkbox">Environment recorded</label></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../appendix/app-b-compute.html" class="pagination-link" aria-label="Deployment and Compute">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Deployment and Compute</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../appendix/app-d-models.html" class="pagination-link" aria-label="Model Reference">
        <span class="nav-page-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Model Reference</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025-2026, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>