<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Single-Cell &amp; Epigenomic Models – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p4-ch16-networks.html" rel="next">
<link href="./p3-ch14-hybrid.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d1e9b63c6b6094879b9f94a7628e3370.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4-ch15-sc-epi.html">p4–multi-modal_multi-scale.qmd</a></li><li class="breadcrumb-item"><a href="./p4-ch15-sc-epi.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1--foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch01-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sequencing: From Reads to Variants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch02-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Genomic Data Landscape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch03-pgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">GWAS &amp; Polygenic Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1-ch04-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2--principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Core Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch05-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch06-transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transformer Architecture for Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch07-foundation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genomic Foundation Models: Concepts &amp; Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch08-pretrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pretraining Objectives &amp; Strategies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2-ch09-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transfer Learning &amp; Deployment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3--architectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Deep Learning Architectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch10-cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CNN Sequence-to-Function Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch11-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">DNA and Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch12-rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">RNA &amp; Transcript-Level Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch13-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3-ch14-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">p4–multi-modal_multi-scale.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch15-sc-epi.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch16-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p4-ch17-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Omics &amp; Systems Biology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p5--eval-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Evaluation and Reliability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch18-benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Benchmarks for Genomic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch19-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evaluation of Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch20-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch21-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p5-ch22-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p6--translation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI — Translation and Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch23-clinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch24-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch25-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch26-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Sequence Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p6-ch27-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Future Work &amp; Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-a-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-b-deployment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Model Deployment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-c-model-list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Referenced Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-d-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-e-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#cpgpt-a-foundation-model-for-dna-methylation" id="toc-cpgpt-a-foundation-model-for-dna-methylation" class="nav-link active" data-scroll-target="#cpgpt-a-foundation-model-for-dna-methylation"><span class="header-section-number">15.1</span> CpGPT: A Foundation Model for DNA Methylation</a>
  <ul class="collapse">
  <li><a href="#methylation-as-a-systems-hub" id="toc-methylation-as-a-systems-hub" class="nav-link" data-scroll-target="#methylation-as-a-systems-hub"><span class="header-section-number">15.1.1</span> Methylation as a Systems Hub</a></li>
  <li><a href="#architecture-and-pretraining" id="toc-architecture-and-pretraining" class="nav-link" data-scroll-target="#architecture-and-pretraining"><span class="header-section-number">15.1.2</span> Architecture and Pretraining</a></li>
  <li><a href="#downstream-applications-and-transfer-learning" id="toc-downstream-applications-and-transfer-learning" class="nav-link" data-scroll-target="#downstream-applications-and-transfer-learning"><span class="header-section-number">15.1.3</span> Downstream Applications and Transfer Learning</a></li>
  </ul></li>
  <li><a href="#single-cell-foundation-models" id="toc-single-cell-foundation-models" class="nav-link" data-scroll-target="#single-cell-foundation-models"><span class="header-section-number">15.2</span> Single-Cell Foundation Models</a>
  <ul class="collapse">
  <li><a href="#the-promise-of-cellular-language-models" id="toc-the-promise-of-cellular-language-models" class="nav-link" data-scroll-target="#the-promise-of-cellular-language-models"><span class="header-section-number">15.2.1</span> The Promise of Cellular Language Models</a></li>
  <li><a href="#geneformer-network-biology-through-pretraining" id="toc-geneformer-network-biology-through-pretraining" class="nav-link" data-scroll-target="#geneformer-network-biology-through-pretraining"><span class="header-section-number">15.2.2</span> Geneformer: Network Biology Through Pretraining</a></li>
  <li><a href="#scgpt-generative-pretraining-for-multi-omics" id="toc-scgpt-generative-pretraining-for-multi-omics" class="nav-link" data-scroll-target="#scgpt-generative-pretraining-for-multi-omics"><span class="header-section-number">15.2.3</span> scGPT: Generative Pretraining for Multi-Omics</a></li>
  <li><a href="#transcriptformer-and-cross-species-modeling" id="toc-transcriptformer-and-cross-species-modeling" class="nav-link" data-scroll-target="#transcriptformer-and-cross-species-modeling"><span class="header-section-number">15.2.4</span> TranscriptFormer and Cross-Species Modeling</a></li>
  </ul></li>
  <li><a href="#glue-graph-linked-unified-embedding-for-single-cell-multi-omics" id="toc-glue-graph-linked-unified-embedding-for-single-cell-multi-omics" class="nav-link" data-scroll-target="#glue-graph-linked-unified-embedding-for-single-cell-multi-omics"><span class="header-section-number">15.3</span> GLUE: Graph-Linked Unified Embedding for Single-Cell Multi-Omics</a>
  <ul class="collapse">
  <li><a href="#the-unpaired-integration-challenge" id="toc-the-unpaired-integration-challenge" class="nav-link" data-scroll-target="#the-unpaired-integration-challenge"><span class="header-section-number">15.3.1</span> The Unpaired Integration Challenge</a></li>
  <li><a href="#architecture-and-training" id="toc-architecture-and-training" class="nav-link" data-scroll-target="#architecture-and-training"><span class="header-section-number">15.3.2</span> Architecture and Training</a></li>
  <li><a href="#applications-and-extensions" id="toc-applications-and-extensions" class="nav-link" data-scroll-target="#applications-and-extensions"><span class="header-section-number">15.3.3</span> Applications and Extensions</a></li>
  </ul></li>
  <li><a href="#d-genome-prediction-models" id="toc-d-genome-prediction-models" class="nav-link" data-scroll-target="#d-genome-prediction-models"><span class="header-section-number">15.4</span> 3D Genome Prediction Models</a>
  <ul class="collapse">
  <li><a href="#the-structural-dimension-of-gene-regulation" id="toc-the-structural-dimension-of-gene-regulation" class="nav-link" data-scroll-target="#the-structural-dimension-of-gene-regulation"><span class="header-section-number">15.4.1</span> The Structural Dimension of Gene Regulation</a></li>
  <li><a href="#akita-sequence-to-contact-prediction" id="toc-akita-sequence-to-contact-prediction" class="nav-link" data-scroll-target="#akita-sequence-to-contact-prediction"><span class="header-section-number">15.4.2</span> Akita: Sequence-to-Contact Prediction</a></li>
  <li><a href="#extensions-and-related-models" id="toc-extensions-and-related-models" class="nav-link" data-scroll-target="#extensions-and-related-models"><span class="header-section-number">15.4.3</span> Extensions and Related Models</a></li>
  </ul></li>
  <li><a href="#design-patterns-and-practical-considerations" id="toc-design-patterns-and-practical-considerations" class="nav-link" data-scroll-target="#design-patterns-and-practical-considerations"><span class="header-section-number">15.5</span> Design Patterns and Practical Considerations</a></li>
  <li><a href="#practical-challenges" id="toc-practical-challenges" class="nav-link" data-scroll-target="#practical-challenges"><span class="header-section-number">15.6</span> Practical Challenges</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">15.7</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p4-ch15-sc-epi.html">p4–multi-modal_multi-scale.qmd</a></li><li class="breadcrumb-item"><a href="./p4-ch15-sc-epi.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-epi" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Single-Cell &amp; Epigenomic Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The preceding chapters traced how genomic foundation models evolved from early convolutional networks for local regulatory elements to large transformers that operate directly on DNA, RNA, and protein sequences. Those models treat the genome primarily as a one-dimensional string and learn how sequence encodes local biochemical activities and variant effects.</p>
<p>Single-cell and epigenomic assays add a different perspective. Rather than asking “what does this sequence do in isolation?”, they capture the state of cells and tissues as they develop, respond to environment, and progress toward disease. DNA methylation, chromatin accessibility, histone marks, and three-dimensional genome folding provide multi-scale readouts of regulatory state that sequence-only models cannot fully capture. Single-cell RNA-seq and multi-omics further reveal how this state varies across individual cells, rather than in bulk averages.</p>
<p>This chapter surveys foundation models at three interconnected levels. First, we examine CpGPT, which treats DNA methylation as a sequence-like object amenable to transformer-based pretraining. Second, we explore cellular language models including Geneformer, scGPT, and TranscriptFormer that learn from massive single-cell transcriptomic corpora. Third, we examine GLUE and SCGLUE, which enable integration across modalities when different omics are measured in different cells. Finally, we survey models like Akita that predict three-dimensional chromatin contacts from DNA sequence alone. Throughout, a recurring theme is that these models treat high-dimensional, noisy measurements as tokens in a learned “language” of cellular state, then leverage large pretraining corpora to transfer across tasks, tissues, species, and technologies.</p>
<div class="content-visible callout callout-style-default callout-warning callout-titled" data-when-profile="draft">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>TODO:</strong></p>
<ul>
<li>Add figure: Opening schematic situating this chapter within the book’s progression (sequence models → cellular state models → systems integration)</li>
<li>Add figure: CpGPT architecture showing masked modeling objective, sample embeddings, and downstream task adaptation</li>
<li>Add figure: Single-cell foundation model comparison showing scGPT, Geneformer, and TranscriptFormer architectures with tokenization strategies</li>
<li>Add figure: GLUE framework diagram illustrating modality-specific VAEs, feature graph structure, and adversarial alignment objectives</li>
<li>Add figure: 3D genome prediction model comparison showing Akita and related architectures</li>
<li>Add table: Comparison of single-cell foundation models (training scale, tokenization, pretraining objectives, modalities, key tasks)</li>
<li>Add table: 3D genome prediction methods comparing input context, output resolution, and validated applications</li>
</ul>
</div>
</div>
<section id="cpgpt-a-foundation-model-for-dna-methylation" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="cpgpt-a-foundation-model-for-dna-methylation"><span class="header-section-number">15.1</span> CpGPT: A Foundation Model for DNA Methylation</h2>
<section id="methylation-as-a-systems-hub" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="methylation-as-a-systems-hub"><span class="header-section-number">15.1.1</span> Methylation as a Systems Hub</h3>
<p>DNA methylation occupies a privileged position in the regulatory hierarchy, sitting at a junction between genotype, environment, and phenotype. Methylation patterns integrate genetic influences, since sequence context affects which CpG sites can be methylated and polymorphisms can create or destroy CpG dinucleotides. They also integrate developmental programs, since methylation landscapes are extensively remodeled during differentiation and establish cell-type-specific regulatory states. Environmental exposures including diet, smoking, toxins, and stress leave lasting methylation signatures that persist long after the exposure ends.</p>
<p>Beyond serving as an integrative readout, methylation encodes rich information about cellular identity and state. Cell types can be distinguished by their methylation profiles, and within a cell type, methylation captures information about age, health status, and disease risk. Epigenetic clocks built from methylation data predict chronological age with remarkable accuracy, and deviations from predicted age correlate with mortality risk and disease burden <span class="citation" data-cites="camillo_cpgpt_2024">(<a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>.</p>
<p>Traditional methylation models have been task-specific: one model for age prediction, another for mortality risk, another for tissue classification. Each model is trained from scratch on labeled data for its particular task, learning whatever methylation patterns happen to be predictive without necessarily capturing general structure. CpGPT reframes methylation as a foundation modeling problem, using large-scale pretraining to learn representations that transfer across tasks.</p>
</section>
<section id="architecture-and-pretraining" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="architecture-and-pretraining"><span class="header-section-number">15.1.2</span> Architecture and Pretraining</h3>
<p>CpGPT, the Cytosine-phosphate-Guanine Pretrained Transformer, treats methylomes as sequences or sets of CpG sites and uses transformer-style self-attention to model their structure <span class="citation" data-cites="camillo_cpgpt_2024">(<a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>. The model was pretrained on over 1,500 DNA methylation datasets encompassing more than 100,000 samples from diverse tissues and conditions.</p>
<p>Several aspects of methylation structure make it amenable to transformer modeling. Local CpG correlations arise because nearby CpG sites tend to share methylation status, particularly within CpG islands. Long-range coordination reflects the fact that methylation patterns at distant genomic regions can be correlated through shared regulatory programs or chromatin compartmentalization. Global sample-level variation captures the systematic differences between samples that reflect tissue identity, age, disease status, and other biological variables.</p>
<p>The input representation tokenizes each methylation sample as a sequence of CpG sites with probe or genomic position identifiers, methylation beta values (often transformed or discretized), and optional metadata such as platform or tissue. The model combines local sequence context around each CpG with relative position along the genome and global sample-level embeddings representing tissue and condition.</p>
<p>CpGPT uses masked modeling objectives analogous to BERT-style language model pretraining. During training, a fraction of CpG methylation values are masked, and the model learns to predict the masked values from the surrounding context. This objective encourages the model to learn both local correlations between neighboring CpG sites and global patterns that distinguish different tissues or conditions.</p>
<p>The resulting embeddings capture sample-level representations that summarize methylation state. These embeddings can serve as inputs to downstream predictors, providing rich methylation features for risk scores, prognosis models, or treatment response prediction. They can function as one modality in a shared latent space that also includes expression, proteomics, and other data types. They can inject epigenetic state information into otherwise sequence-centric genomic foundation models, providing context about cellular identity and regulatory status.</p>
</section>
<section id="downstream-applications-and-transfer-learning" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="downstream-applications-and-transfer-learning"><span class="header-section-number">15.1.3</span> Downstream Applications and Transfer Learning</h3>
<p>Once pretrained, CpGPT supports several capabilities with minimal or no additional supervised training. The model can impute methylation levels at CpG sites not directly measured on a given array platform, effectively enabling array conversion between platforms such as EPIC and 450K by leveraging sequence context and co-methylation structure <span class="citation" data-cites="camillo_cpgpt_2024">(<a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>. This addresses a persistent challenge in methylation research where different studies use different array technologies.</p>
<p>For biological age prediction, fine-tuned CpGPT models match or exceed the performance of purpose-built epigenetic clocks while using a more general architecture. The learned embeddings cluster by tissue type without explicit supervision during pretraining, suggesting that the model captures biologically meaningful variation. For disease-associated methylation patterns, CpGPT can be adapted to distinguish cases from controls across multiple disease contexts through transfer learning.</p>
<p>The foundation model paradigm offers several advantages over task-specific methylation models. New tasks can be addressed through fine-tuning or linear probing rather than training from scratch. Representations learned from diverse tissues and conditions may generalize better than those learned from narrow disease-specific cohorts. The model provides a unified framework for understanding methylation variation across biological contexts.</p>
<p>Because CpGPT is transformer-based, its attention patterns and learned embeddings can be probed to rank CpGs by their contribution to specific predictions. This offers a route toward mechanistic insight, complementing purely statistical epigenetic clocks. However, important limitations remain. Most training data are bulk methylation, so cell-type-specific signals may be entangled. Methylation is a downstream readout of regulatory processes, so CpGPT captures associations but not necessarily causal mechanisms. Training remains constrained by the coverage and diversity of available cohorts in terms of ancestry, tissue types, and environmental exposures.</p>
</section>
</section>
<section id="single-cell-foundation-models" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="single-cell-foundation-models"><span class="header-section-number">15.2</span> Single-Cell Foundation Models</h2>
<section id="the-promise-of-cellular-language-models" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="the-promise-of-cellular-language-models"><span class="header-section-number">15.2.1</span> The Promise of Cellular Language Models</h3>
<p>The explosion of single-cell sequencing data has created training corpora of unprecedented scale for modeling cellular biology. Public repositories now contain tens of millions of single-cell transcriptomes spanning diverse tissues, developmental stages, disease states, and species. This scale approaches the data volumes that enabled large language models, motivating researchers to ask whether similar foundation model approaches could work for cellular data.</p>
<p>The analogy between language and single-cell biology runs deeper than dataset scale. In language, words combine according to grammatical rules to form sentences that convey meaning. In cells, genes combine according to regulatory programs to form expression profiles that define cellular identity and function. Just as language models learn syntax and semantics by predicting masked words, single-cell foundation models might learn regulatory logic by predicting masked genes.</p>
<p>Several groups have pursued this vision, producing models with different architectures, pretraining objectives, and downstream applications. The resulting cellular language models treat cells as documents or sentences, genes or features as tokens, and expression levels as token attributes. If a model can learn the “grammar” of which genes co-occur and how their expression levels vary across contexts, it may provide context-aware embeddings of genes and cells, support zero-shot or few-shot transfer to new datasets, and enable in silico perturbations where the model predicts how changing one gene or pathway affects the rest of the transcriptome.</p>
</section>
<section id="geneformer-network-biology-through-pretraining" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="geneformer-network-biology-through-pretraining"><span class="header-section-number">15.2.2</span> Geneformer: Network Biology Through Pretraining</h3>
<p>Geneformer was developed as a context-aware, attention-based model pretrained on approximately 30 million single-cell transcriptomes to enable context-specific predictions in network biology <span class="citation" data-cites="theodoris_geneformer_2023">(<a href="references.html#ref-theodoris_geneformer_2023" role="doc-biblioref">Theodoris et al. 2023</a>)</span>. The model’s key insight is that during pretraining, it gained a fundamental understanding of network dynamics, encoding network hierarchy in attention weights in a completely self-supervised manner.</p>
<p>The architecture treats each cell as a sentence, with genes serving as tokens. Rather than using raw expression counts, Geneformer ranks genes by their expression level relative to their typical expression across the training corpus. This rank-based encoding emphasizes which genes are unusually active or silent in each cell, capturing the contextual information that defines cell state. The representation discards absolute counts but preserves relative ordering, which is often more stable across datasets and platforms.</p>
<p>Pretraining uses a masked gene prediction objective. A fraction of genes are masked in each cell, and the model learns to predict which genes were masked based on the remaining expression context. This forces the model to learn co-expression patterns, regulatory relationships, and the gene combinations that characterize different cell states. The objective encourages learning of which genes tend to co-occur at particular ranks in specific cellular contexts, implicitly capturing regulatory modules and pathways.</p>
<p>After pretraining, Geneformer can be fine-tuned for diverse downstream tasks. Cell type annotation achieves high accuracy even with limited labeled examples, leveraging the general biological knowledge acquired during pretraining. Multi-batch integration benefits from representations that capture biological variation while being robust to technical artifacts. Perturbation response prediction uses the model’s implicit understanding of gene networks to anticipate how cells will respond to genetic or chemical perturbations. The model can also prioritize genes according to their influence on specific cell states or disease-relevant phenotypes.</p>
<p>Applied to disease modeling with limited patient data, Geneformer identified candidate therapeutic targets for cardiomyopathy by analyzing how disease-associated genes fit within the learned network structure <span class="citation" data-cites="theodoris_geneformer_2023">(<a href="references.html#ref-theodoris_geneformer_2023" role="doc-biblioref">Theodoris et al. 2023</a>)</span>. This demonstrates the potential for foundation models to accelerate discovery in rare diseases where large datasets are unavailable. Because the model encodes context-aware network information, it can often perform well in data-scarce settings.</p>
</section>
<section id="scgpt-generative-pretraining-for-multi-omics" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="scgpt-generative-pretraining-for-multi-omics"><span class="header-section-number">15.2.3</span> scGPT: Generative Pretraining for Multi-Omics</h3>
<p>scGPT extends the foundation model paradigm to single-cell multi-omics, training a generative pretrained transformer on over 33 million cells to learn representations useful across diverse downstream applications <span class="citation" data-cites="cui_scgpt_2024">(<a href="references.html#ref-cui_scgpt_2024" role="doc-biblioref">Cui et al. 2024</a>)</span>. The model is designed as a generalist backbone for single-cell analysis pipelines, analogous to how general-purpose language models serve text applications.</p>
<p>The model architecture includes several innovations tailored to single-cell data. Gene tokens are embedded using both learnable embeddings and position encodings that capture genomic location. Expression values are discretized into bins to handle the wide dynamic range and zero-inflation characteristic of single-cell data. Special tokens mark cell boundaries and indicate modality when multi-omic data are available. Attention masks and positional encodings are adapted so that the model can handle the unordered nature of gene sets while still benefiting from sequence-like inductive biases.</p>
<p>scGPT uses multiple pretraining objectives simultaneously. Masked gene prediction, analogous to BERT, encourages learning of co-expression patterns. Autoregressive generation predicts expression of one set of genes conditioned on others, enabling sampling and imputation. Contrastive objectives encourage cells from the same type or condition to cluster in embedding space while separating different types. These objectives are applied across diverse datasets to learn shared gene and cell embeddings that are reusable across tasks and modalities <span class="citation" data-cites="cui_scgpt_2024">(<a href="references.html#ref-cui_scgpt_2024" role="doc-biblioref">Cui et al. 2024</a>)</span>.</p>
<p>The combination of objectives and the scale of pretraining enable scGPT to excel across multiple downstream applications. Cell type annotation benefits from the rich representations learned during pretraining, including fine-grained subtypes. Multi-batch integration aligns cells from different experiments while preserving biological variation, addressing the pervasive batch effects in single-cell data. Multi-omic integration learns joint representations when cells have both RNA-seq and ATAC-seq measurements. Perturbation response prediction anticipates transcriptional changes following CRISPR knockouts or drug treatments. Gene network inference extracts regulatory relationships from attention patterns.</p>
</section>
<section id="transcriptformer-and-cross-species-modeling" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="transcriptformer-and-cross-species-modeling"><span class="header-section-number">15.2.4</span> TranscriptFormer and Cross-Species Modeling</h3>
<p>TranscriptFormer extends single-cell foundation models across evolutionary time, training on over 112 million cells spanning 1.5 billion years of evolution across 12 species <span class="citation" data-cites="pearce_transcriptformer_2025">(<a href="references.html#ref-pearce_transcriptformer_2025" role="doc-biblioref">Pearce et al. 2025</a>)</span>. This cross-species approach tests whether foundation models can learn regulatory principles that generalize beyond individual organisms.</p>
<p>The model uses a novel generative architecture that jointly models genes and transcripts, with specialized heads and attention mechanisms to capture their relationships. The autoregressive objective predicts genes and their expression levels in a causal fashion, enabling it to generate synthetic cells conditioned on prompts such as species, tissue, or cell type. Because the vocabulary spans multiple species, the model functions as a virtual instrument for probing cellular biology.</p>
<p>In zero-shot settings, TranscriptFormer demonstrates superior performance on both in-distribution and out-of-distribution cell type classification, with robust performance even for species separated by over 685 million years of evolutionary distance. This cross-species perspective reveals that core principles of cellular regulation are deeply conserved.</p>
<p>Cross-species transfer enables several applications not possible with single-species models. Cell type annotations can be transferred across species boundaries, accelerating atlas construction for less-studied organisms. Disease state identification in human cells benefits from regulatory patterns conserved across evolution. Gene-gene interactions predicted by the model align with independent experimental observations across species. The model can suggest conserved transcription factors and regulatory logic that operate across phylogeny.</p>
<p>The success of cross-species foundation models suggests that models trained on diverse organisms can capture universal patterns more effectively than models trained on any single species. This has implications for understanding both evolution and disease, as conserved regulatory programs often represent the most fundamental aspects of cellular function.</p>
</section>
</section>
<section id="glue-graph-linked-unified-embedding-for-single-cell-multi-omics" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="glue-graph-linked-unified-embedding-for-single-cell-multi-omics"><span class="header-section-number">15.3</span> GLUE: Graph-Linked Unified Embedding for Single-Cell Multi-Omics</h2>
<section id="the-unpaired-integration-challenge" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="the-unpaired-integration-challenge"><span class="header-section-number">15.3.1</span> The Unpaired Integration Challenge</h3>
<p>Single-cell experiments often profile different modalities in different cells. A typical study might include scRNA-seq data from one set of cells, scATAC-seq data from another set, and perhaps a small subset with both modalities measured simultaneously through multiome protocols. The central challenge is building a unified atlas that aligns these cells in a common space, recovers cell types and trajectories, and infers regulatory networks connecting chromatin to expression <span class="citation" data-cites="cao_glue_2022">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>)</span>.</p>
<p>This problem is harder than standard data integration because the feature spaces are entirely different. RNA-seq measures gene expression across roughly 20,000 genes. ATAC-seq measures chromatin accessibility across hundreds of thousands of peaks. There is no direct correspondence between features: a gene is not the same object as a peak. Aligning cells across modalities requires reasoning about how features in one modality relate to features in another.</p>
<p>Previous approaches addressed this through explicit feature conversion, for example by assigning ATAC-seq peaks to nearby genes and treating the resulting gene-level accessibility as comparable to expression. This conversion is straightforward but loses information, since the detailed structure of chromatin accessibility within a gene’s regulatory region is collapsed into a single number. It also introduces arbitrary choices about how to define gene-peak assignments.</p>
<p>GLUE, Graph-Linked Unified Embedding, addresses this problem by combining modality-specific encoders with a graph of biological prior knowledge linking features across omics. Rather than converting features, GLUE explicitly encodes regulatory relationships into a guidance graph and learns cell embeddings that are consistent with this graph.</p>
</section>
<section id="architecture-and-training" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="architecture-and-training"><span class="header-section-number">15.3.2</span> Architecture and Training</h3>
<p>GLUE consists of three key components that work together to align cells across modalities while respecting biological relationships between features <span class="citation" data-cites="cao_glue_2022">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>)</span>.</p>
<p>Modality-specific variational autoencoders provide the foundation. Each omic has its own encoder-decoder pair. Encoders map cells to a low-dimensional latent embedding, and decoders reconstruct modality-specific features from these embeddings. The variational structure encourages smooth, interpretable latent spaces. Generative distributions differ by modality to match data characteristics: negative binomial for count data, Bernoulli or Gaussian for others.</p>
<p>The feature graph encodes biological prior knowledge about relationships between features across modalities. Nodes represent genes, peaks, regulatory elements, and other genomic features. Edges connect ATAC peaks to the genes they might regulate based on genomic proximity or evidence from chromatin conformation capture experiments. Edges connect genes to the transcription factors that bind their promoters. The graph structure is provided as input rather than learned, allowing incorporation of external biological knowledge from databases, literature, and prior experiments.</p>
<p>A graph variational autoencoder learns feature embeddings from this guidance graph. These feature embeddings are then used in the decoders of the modality-specific VAEs, tying them to a common regulatory backbone. This ensures that biologically related features have similar representations and helps align the latent spaces of different modalities.</p>
<p>Adversarial alignment ensures that the latent embeddings from different modalities are truly integrated rather than merely correlated. A discriminator tries to distinguish which modality produced each latent embedding, and the encoders are trained to fool the discriminator. This adversarial objective forces the encoders to produce embeddings that are indistinguishable across modalities, creating a unified cell embedding space where cells from different modalities occupy a shared manifold.</p>
</section>
<section id="applications-and-extensions" class="level3" data-number="15.3.3">
<h3 data-number="15.3.3" class="anchored" data-anchor-id="applications-and-extensions"><span class="header-section-number">15.3.3</span> Applications and Extensions</h3>
<p>GLUE enables several applications beyond basic integration. Triple-omics integration combines gene expression, chromatin accessibility, and DNA methylation measured in different cells from the same tissue, producing unified cell type annotations that leverage all three data types. Regulatory inference uses the learned feature embeddings to identify candidate enhancer-gene links that can be validated against chromatin conformation capture data or eQTL evidence. The guidance graph and learned embeddings provide a regularized view of peak-gene-TF relationships that is more principled than simple distance-based assignment.</p>
<p>Cross-modal prediction becomes possible when cells are aligned in a common space. The model can predict chromatin accessibility from expression or vice versa, enabling imputation of missing modalities. Atlas construction at scale handles millions of cells across many batches and datasets, with the graph structure helping to distinguish biological variation from technical artifacts.</p>
<p>SCGLUE extends the framework specifically for single-cell applications, with optimizations for the scale and sparsity of single-cell data <span class="citation" data-cites="cao_glue_2022">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>)</span>. The adversarial alignment is refined to handle the batch effects common in single-cell experiments, and the graph structure is expanded to include tissue-specific regulatory relationships. SCGLUE scales to millions of cells while maintaining the biological grounding provided by the guidance graph.</p>
<p>The success of GLUE demonstrates that graph-guided integration, where biological prior knowledge structures the alignment objective, provides a more principled approach than feature conversion or purely data-driven alignment. The feature graph allows the model to learn biologically meaningful relationships while the adversarial objective ensures genuine integration across modalities. This pattern of combining learned representations with structured biological knowledge recurs throughout foundation models for genomics.</p>
</section>
</section>
<section id="d-genome-prediction-models" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="d-genome-prediction-models"><span class="header-section-number">15.4</span> 3D Genome Prediction Models</h2>
<section id="the-structural-dimension-of-gene-regulation" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="the-structural-dimension-of-gene-regulation"><span class="header-section-number">15.4.1</span> The Structural Dimension of Gene Regulation</h3>
<p>The linear genome folds into a complex three-dimensional structure that brings distant regulatory elements into spatial proximity with their target genes. This folding is not random: specific sequence features, particularly CTCF binding sites with their characteristic orientation dependence, organize the genome into topologically associating domains (TADs) and create specific chromatin contacts between enhancers and promoters.</p>
<p>Understanding how sequence encodes 3D structure is crucial for interpreting regulatory variants. A variant might sit far from any gene in linear distance but be brought into contact with a promoter through chromatin looping. Sequence-to-structure models that predict chromatin contacts from DNA sequence can identify such variants and predict how structural variants, which may create or disrupt loops, affect gene regulation. From a modeling perspective, 3D genome structure matters because many regulatory elements act over tens to hundreds of kilobases, disrupting chromatin loops can misregulate genes even when local sequence motifs remain intact, and structural variation and rearrangements are often key drivers of cancer and developmental disorders.</p>
<p>Hi-C, Micro-C, and related assays measure chromatin contacts but are expensive and typically low-resolution. Predictive models of 3D structure from sequence promise to infer structural consequences of non-coding SNVs and SVs, provide structural priors to sequence-to-expression models, and enable in silico mutagenesis of regulatory landscapes at scale.</p>
</section>
<section id="akita-sequence-to-contact-prediction" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="akita-sequence-to-contact-prediction"><span class="header-section-number">15.4.2</span> Akita: Sequence-to-Contact Prediction</h3>
<p>Akita demonstrated that convolutional neural networks can accurately predict genome folding from DNA sequence alone <span class="citation" data-cites="fudenberg_akita_2020">(<a href="references.html#ref-fudenberg_akita_2020" role="doc-biblioref">Fudenberg, Kelley, and Pollard 2020</a>)</span>. The model takes megabase-scale sequence as input and outputs predicted Hi-C contact maps, capturing the spatial proximity relationships between all pairs of positions in the input window.</p>
<p>The architecture uses an encoder-decoder structure. The input is a one-hot encoded DNA sequence of fixed length, typically around 1 megabase, centered on the region of interest. Deep convolutional blocks in the encoder extract hierarchical sequence features at multiple scales, capturing both the local motifs (particularly CTCF sites) that anchor chromatin loops and the broader sequence context that influences compartmentalization. Dilated convolutions and pooling expand receptive fields to capture long-range dependencies. The decoder reconstructs the two-dimensional contact matrix from the encoded sequence representation, typically at around 2 kilobase resolution.</p>
<p>Akita is trained on Hi-C and Micro-C contact maps from specific cell types, optimizing a loss function over predicted versus observed contact matrices. The model’s representations underscore the importance of an orientation-specific grammar for CTCF binding sites. Akita learns that CTCF sites pointing toward each other tend to anchor chromatin loops, while sites pointing away do not. This orientation dependence, known from molecular biology, emerges automatically from training on Hi-C data without explicit supervision.</p>
<p>Once trained, Akita enables rapid in silico predictions. Saturation mutagenesis experiments, prohibitively expensive to perform experimentally across megabase regions, can be simulated computationally by predicting the effect of every possible single-nucleotide change on chromatin structure. This reveals which positions are most critical for maintaining normal genome folding and which mutations might cause structural disruption.</p>
<p>Applications include interpreting eQTLs through the lens of 3D structure, making predictions for structural variants that create or delete CTCF sites, and probing species-specific genome folding by applying models trained on one species to sequences from another. The model can score the impact of every possible SNV or small indel on local contact patterns, suggesting which non-coding variants perturb loop structures relevant to gene expression <span class="citation" data-cites="fudenberg_akita_2020">(<a href="references.html#ref-fudenberg_akita_2020" role="doc-biblioref">Fudenberg, Kelley, and Pollard 2020</a>)</span>.</p>
</section>
<section id="extensions-and-related-models" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="extensions-and-related-models"><span class="header-section-number">15.4.3</span> Extensions and Related Models</h3>
<p>Several models have extended Akita’s sequence-to-structure paradigm. Orca scales to longer input contexts and higher resolution outputs, enabling prediction of finer structural features. DeepC uses transfer learning to predict 3D folding at megabase scales across different cell types. C.Origami incorporates additional training data and architectural refinements.</p>
<p>Subsequent work has also developed hierarchical and multi-scale models that predict contact maps at multiple resolutions and genomic scales. Architectures that better handle structural variants, including large deletions, inversions, and translocations, explicitly model rearranged sequence segments. Integration of 3D structure with expression predictors has emerged as a natural direction, where 3D models provide features or inductive biases to sequence-to-expression networks.</p>
<p>HiCDiffusion addresses a limitation of encoder-decoder architectures: the tendency to produce blurred contact maps that lack the sharp features of experimental Hi-C data. By combining the encoder-decoder with a diffusion model, HiCDiffusion produces high-resolution matrices that better resemble experimental results while maintaining similar correlation with ground truth.</p>
<p>These models collectively establish that 3D genome structure can be predicted from sequence, opening new possibilities for understanding how variants affect gene regulation through structural mechanisms that sequence-to-expression models like Enformer capture only indirectly. The mapping from sequence to 3D structure is sufficiently regular that deep learning can decode aspects of the structural grammar of the genome.</p>
</section>
</section>
<section id="design-patterns-and-practical-considerations" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="design-patterns-and-practical-considerations"><span class="header-section-number">15.5</span> Design Patterns and Practical Considerations</h2>
<p>Several design patterns recur across the models surveyed in this chapter, revealing common strategies for handling cellular and epigenomic data.</p>
<p>Tokenization strategies for cellular data require careful consideration. Geneformer’s rank-based encoding emphasizes relative expression and is stable across datasets and platforms. scGPT’s discretization handles the dynamic range of count data while enabling discrete prediction objectives. CpGPT tokenizes CpG sites with their methylation values and genomic positions. 3D genome models operate on fixed-length sequence windows. The choice of tokenization affects what biological signals the model can capture and how well representations transfer across datasets with different technical characteristics.</p>
<p>Pretraining objectives shape what models learn and which downstream tasks they support. Masked prediction encourages learning of co-occurrence patterns and local dependencies. Generative objectives enable sampling and imputation. Contrastive objectives emphasize discriminative features that separate cell types or conditions. Multi-task pretraining can combine benefits of multiple objectives, as demonstrated by scGPT’s simultaneous use of masked prediction, autoregressive generation, and contrastive learning. The choice of objective reflects assumptions about which aspects of biological structure are most important.</p>
<p>Graph structure provides biological grounding that can regularize learning and improve interpretability. GLUE’s feature graph encodes regulatory relationships that guide integration across modalities. Similar graph structures could incorporate protein-protein interactions, pathway membership, or other biological networks to constrain what models learn. This pattern of combining learned representations with structured biological knowledge helps ensure that models respect known biology while discovering new patterns.</p>
<p>Scale of pretraining enables generalization across contexts. Models trained on tens of millions of cells or hundreds of thousands of samples learn representations that transfer to new contexts better than models trained on smaller datasets. This argues for continued investment in large-scale data generation and aggregation. However, scale alone does not guarantee utility: the diversity of training data (across tissues, species, conditions, and platforms) matters as much as raw sample count.</p>
</section>
<section id="practical-challenges" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="practical-challenges"><span class="header-section-number">15.6</span> Practical Challenges</h2>
<p>Several challenges complicate the application of single-cell and epigenomic foundation models in practice.</p>
<p>Batch effects remain pervasive in single-cell data. Technical differences between experiments, protocols, and platforms can dominate biological signal. Foundation models that are robust to batch effects in their training data may struggle when applied to new batches not represented during pretraining. The field continues to grapple with distinguishing genuine biological variation from technical artifacts.</p>
<p>Cell type imbalance affects what models learn. Common cell types are overrepresented in training corpora, while rare populations may be poorly captured. Models may excel at identifying well-represented cell types while struggling with rare or novel populations. This has equity implications when rare cell types are disease-relevant or when certain tissues or conditions are systematically undersampled.</p>
<p>Evaluation complexity increases when ground truth is uncertain. Cell type labels in training data reflect current annotations that may be incomplete or inconsistent. Performance metrics on held-out data conflate model quality with annotation quality. Regulatory network predictions face similar challenges, as gold standard interaction sets are incomplete and context-dependent. Evaluation protocols must acknowledge these uncertainties rather than treating benchmarks as definitive.</p>
<p>Data imbalance and coverage biases extend beyond cell types. Common ancestries dominate current corpora, as do certain tissues and experimental protocols. Rare cell types, underrepresented populations, and less-studied organisms may be poorly modeled, with consequences for equity and generalizability. The field must invest in diverse data generation while developing methods that can generalize despite limited training examples.</p>
<p>Computational requirements for training and inference remain substantial. While smaller than the largest language models, single-cell foundation models still require significant GPU resources that may limit accessibility. Techniques such as distillation, quantization, and parameter-efficient fine-tuning are essential for broader adoption. Making models accessible to researchers without extensive computational infrastructure remains an important goal.</p>
<p>Domain shift between training and deployment contexts poses persistent challenges. Models trained on one technology platform, tissue type, or species may not transfer well to others. Even when transfer is possible, performance may degrade in ways that are difficult to predict or diagnose. Understanding the boundaries of model applicability requires careful characterization of both training data and deployment contexts.</p>
</section>
<section id="summary" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">15.7</span> Summary</h2>
<p>This chapter has surveyed foundation models that operate on epigenomic and single-cell readouts rather than primary DNA sequence alone. CpGPT demonstrates that methylation can be modeled as a sequence-like object amenable to transformer-based pretraining, with applications spanning biological age prediction, tissue classification, disease association, and platform conversion. Single-cell foundation models including Geneformer, scGPT, and TranscriptFormer learn cellular representations from massive transcriptomic corpora that transfer to diverse downstream tasks including cell type annotation, perturbation response prediction, gene network inference, and cross-species analysis. GLUE shows how graph-linked embeddings can align cells across modalities when different omics are measured in different cells, using biological prior knowledge to guide integration. 3D genome prediction models including Akita and its successors predict chromatin contacts from sequence, revealing how variants affect gene regulation through structural mechanisms.</p>
<p>These models extend the foundation model paradigm from sequence-only representations to the rich landscape of cellular identity and genome organization. They demonstrate that the principles enabling language models (large-scale pretraining, transfer learning, context-aware representations) can be adapted to biological domains where tokens represent genes, CpG sites, or genomic positions rather than words. The success of these adaptations depends critically on choosing appropriate tokenization strategies, pretraining objectives, and architectural inductive biases that reflect the structure of biological data.</p>
<p>Looking forward, several directions promise to enhance these models’ utility. Integration across levels of organization (sequence, epigenome, 3D structure, cellular state) could yield multi-scale representations that capture regulatory logic more completely than any single modality. Cross-species pretraining can reveal conserved principles while highlighting evolutionary innovations. Incorporation of temporal dynamics through developmental trajectories or disease progression could better capture how cellular states transition over time. The evaluation and interpretability principles developed in later chapters become especially important for these models, where ground truth is often uncertain and deployment stakes are high.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-camillo_cpgpt_2024" class="csl-entry" role="listitem">
Camillo, Lucas Paulo de Lima, Raghav Sehgal, Jenel Armstrong, Albert T. Higgins-Chen, Steve Horvath, and Bo Wang. 2024. <span>“<span>CpGPT</span>: A <span>Foundation</span> <span>Model</span> for <span>DNA</span> <span>Methylation</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.24.619766">https://doi.org/10.1101/2024.10.24.619766</a>.
</div>
<div id="ref-cao_glue_2022" class="csl-entry" role="listitem">
Cao, Zhi-Jie, and Ge Gao. 2022. <span>“[<span>GLUE</span>] <span>Multi</span>-Omics Single-Cell Data Integration and Regulatory Inference with Graph-Linked Embedding.”</span> <em>Nature Biotechnology</em> 40 (10): 1458–66. <a href="https://doi.org/10.1038/s41587-022-01284-4">https://doi.org/10.1038/s41587-022-01284-4</a>.
</div>
<div id="ref-cui_scgpt_2024" class="csl-entry" role="listitem">
Cui, Haotian, Chloe Wang, Hassaan Maan, Kuan Pang, Fengning Luo, Nan Duan, and Bo Wang. 2024. <span>“<span class="nocase">scGPT</span>: Toward Building a Foundation Model for Single-Cell Multi-Omics Using Generative <span>AI</span>.”</span> <em>Nature Methods</em> 21 (8): 1470–80. <a href="https://doi.org/10.1038/s41592-024-02201-0">https://doi.org/10.1038/s41592-024-02201-0</a>.
</div>
<div id="ref-fudenberg_akita_2020" class="csl-entry" role="listitem">
Fudenberg, Geoff, David R. Kelley, and Katherine S. Pollard. 2020. <span>“[<span>Akita</span>] <span>Predicting</span> <span>3D</span> Genome Folding from <span>DNA</span> Sequence with <span>Akita</span>.”</span> <em>Nature Methods</em> 17 (11): 1111–17. <a href="https://doi.org/10.1038/s41592-020-0958-x">https://doi.org/10.1038/s41592-020-0958-x</a>.
</div>
<div id="ref-pearce_transcriptformer_2025" class="csl-entry" role="listitem">
Pearce, James D., Sara E. Simmonds, Gita Mahmoudabadi, Lakshmi Krishnan, Giovanni Palla, Ana-Maria Istrate, Alexander Tarashansky, et al. 2025. <span>“[<span>TranscriptFormer</span>] <span>Cross</span>-<span>Species</span> <span>Generative</span> <span>Cell</span> <span>Atlas</span> <span>Across</span> 1.5 <span>Billion</span> <span>Years</span> of <span>Evolution</span>: <span>The</span> <span>TranscriptFormer</span> <span>Single</span>-Cell <span>Model</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2025.04.25.650731">https://doi.org/10.1101/2025.04.25.650731</a>.
</div>
<div id="ref-theodoris_geneformer_2023" class="csl-entry" role="listitem">
Theodoris, Christina V., Ling Xiao, Anant Chopra, Mark D. Chaffin, Zeina R. Al Sayed, Matthew C. Hill, Helene Mantineo, et al. 2023. <span>“[<span>Geneformer</span>] <span>Transfer</span> Learning Enables Predictions in Network Biology.”</span> <em>Nature</em> 618 (7965): 616–24. <a href="https://doi.org/10.1038/s41586-023-06139-9">https://doi.org/10.1038/s41586-023-06139-9</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p3-ch14-hybrid.html" class="pagination-link" aria-label="Long-range Hybrid Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p4-ch16-networks.html" class="pagination-link" aria-label="Graphs, Networks, and Biology">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Graphs, Networks, and Biology</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>