<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Clinical Risk Prediction – Genomic Foundation Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch-p5-variants.html" rel="next">
<link href="./ch-p4-interp.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a1553387a0f784068632030e9fbb8a3c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch-p5-clinical.html">Part V: Applications</a></li><li class="breadcrumb-item"><a href="./ch-p5-clinical.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Foundation Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Data &amp; Pre-DL Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p1-ngs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">NGS &amp; Variant Calling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p1-prs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">PRS &amp; GWAS Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p1-cadd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Deleteriousness Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p1-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Foundational Genomics Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: CNN Seq-to-Function Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p2-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regulatory Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p2-transc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Transcriptional Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p2-splice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Splicing Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Transformers Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p3-tokens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sequence Representation &amp; Tokens</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p3-plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Protein Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p3-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">DNA Foundation Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p3-hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Long-range Hybrid Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part IV: GFMs &amp; Multi-omics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p4-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Genomic FMs: Principles &amp; Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p4-vep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variant Effect Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p4-omics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multi-omics and Systems Context</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p4-confound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Confounders in Model Training</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p4-interp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part V: Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p5-clinical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p5-variants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-p5-drugs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Drug Discovery &amp; Biotech</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-dl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Deep Learning Primer for Genomics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-framing-what-is-clinical-risk-prediction" id="toc-problem-framing-what-is-clinical-risk-prediction" class="nav-link active" data-scroll-target="#problem-framing-what-is-clinical-risk-prediction"><span class="header-section-number">17.1</span> Problem Framing: What Is Clinical Risk Prediction?</a></li>
  <li><a href="#task-types-and-loss-functions" id="toc-task-types-and-loss-functions" class="nav-link" data-scroll-target="#task-types-and-loss-functions"><span class="header-section-number">17.2</span> Task Types and Loss Functions</a>
  <ul class="collapse">
  <li><a href="#binary-and-multi-label-classification" id="toc-binary-and-multi-label-classification" class="nav-link" data-scroll-target="#binary-and-multi-label-classification"><span class="header-section-number">17.2.1</span> Binary and Multi-label Classification</a></li>
  <li><a href="#survival-and-time-to-event-modeling" id="toc-survival-and-time-to-event-modeling" class="nav-link" data-scroll-target="#survival-and-time-to-event-modeling"><span class="header-section-number">17.2.2</span> Survival and Time-to-Event Modeling</a></li>
  <li><a href="#multi-task-risk-and-shared-representations" id="toc-multi-task-risk-and-shared-representations" class="nav-link" data-scroll-target="#multi-task-risk-and-shared-representations"><span class="header-section-number">17.2.3</span> Multi-task Risk and Shared Representations</a></li>
  </ul></li>
  <li><a href="#from-prs-to-gfm-enabled-risk-scores" id="toc-from-prs-to-gfm-enabled-risk-scores" class="nav-link" data-scroll-target="#from-prs-to-gfm-enabled-risk-scores"><span class="header-section-number">17.3</span> From PRS to GFM-Enabled Risk Scores</a>
  <ul class="collapse">
  <li><a href="#classical-prs-strengths-and-limitations" id="toc-classical-prs-strengths-and-limitations" class="nav-link" data-scroll-target="#classical-prs-strengths-and-limitations"><span class="header-section-number">17.3.1</span> Classical PRS: Strengths and Limitations</a></li>
  <li><a href="#deep-polygenic-risk-delphi-and-g2pt" id="toc-deep-polygenic-risk-delphi-and-g2pt" class="nav-link" data-scroll-target="#deep-polygenic-risk-delphi-and-g2pt"><span class="header-section-number">17.3.2</span> Deep Polygenic Risk: Delphi and G2PT</a></li>
  <li><a href="#fine-mapping-and-causal-variants-mifm" id="toc-fine-mapping-and-causal-variants-mifm" class="nav-link" data-scroll-target="#fine-mapping-and-causal-variants-mifm"><span class="header-section-number">17.3.3</span> Fine-mapping and Causal Variants: MIFM</a></li>
  </ul></li>
  <li><a href="#beyond-genotype-fusing-gfms-with-ehr-and-multi-omics" id="toc-beyond-genotype-fusing-gfms-with-ehr-and-multi-omics" class="nav-link" data-scroll-target="#beyond-genotype-fusing-gfms-with-ehr-and-multi-omics"><span class="header-section-number">17.4</span> Beyond Genotype: Fusing GFMs with EHR and Multi-omics</a>
  <ul class="collapse">
  <li><a href="#feature-sources" id="toc-feature-sources" class="nav-link" data-scroll-target="#feature-sources"><span class="header-section-number">17.4.1</span> Feature Sources</a></li>
  <li><a href="#fusion-patterns" id="toc-fusion-patterns" class="nav-link" data-scroll-target="#fusion-patterns"><span class="header-section-number">17.4.2</span> Fusion Patterns</a></li>
  </ul></li>
  <li><a href="#evaluation-discrimination-calibration-and-clinical-utility" id="toc-evaluation-discrimination-calibration-and-clinical-utility" class="nav-link" data-scroll-target="#evaluation-discrimination-calibration-and-clinical-utility"><span class="header-section-number">17.5</span> Evaluation: Discrimination, Calibration, and Clinical Utility</a>
  <ul class="collapse">
  <li><a href="#discrimination" id="toc-discrimination" class="nav-link" data-scroll-target="#discrimination"><span class="header-section-number">17.5.1</span> Discrimination</a></li>
  <li><a href="#calibration-and-risk-stratification" id="toc-calibration-and-risk-stratification" class="nav-link" data-scroll-target="#calibration-and-risk-stratification"><span class="header-section-number">17.5.2</span> Calibration and Risk Stratification</a></li>
  <li><a href="#uncertainty-estimation-and-when-not-to-predict" id="toc-uncertainty-estimation-and-when-not-to-predict" class="nav-link" data-scroll-target="#uncertainty-estimation-and-when-not-to-predict"><span class="header-section-number">17.5.3</span> Uncertainty Estimation and “When Not to Predict”</a></li>
  <li><a href="#fairness-bias-and-health-equity" id="toc-fairness-bias-and-health-equity" class="nav-link" data-scroll-target="#fairness-bias-and-health-equity"><span class="header-section-number">17.5.4</span> Fairness, Bias, and Health Equity</a></li>
  </ul></li>
  <li><a href="#prospective-validation-trials-and-regulation" id="toc-prospective-validation-trials-and-regulation" class="nav-link" data-scroll-target="#prospective-validation-trials-and-regulation"><span class="header-section-number">17.6</span> Prospective Validation, Trials, and Regulation</a></li>
  <li><a href="#monitoring-drift-and-continual-learning" id="toc-monitoring-drift-and-continual-learning" class="nav-link" data-scroll-target="#monitoring-drift-and-continual-learning"><span class="header-section-number">17.7</span> Monitoring, Drift, and Continual Learning</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies"><span class="header-section-number">17.8</span> Case Studies</a>
  <ul class="collapse">
  <li><a href="#cardiometabolic-risk-stratification" id="toc-cardiometabolic-risk-stratification" class="nav-link" data-scroll-target="#cardiometabolic-risk-stratification"><span class="header-section-number">17.8.1</span> Cardiometabolic Risk Stratification</a></li>
  <li><a href="#oncology-risk-and-recurrence-prediction" id="toc-oncology-risk-and-recurrence-prediction" class="nav-link" data-scroll-target="#oncology-risk-and-recurrence-prediction"><span class="header-section-number">17.8.2</span> Oncology: Risk and Recurrence Prediction</a></li>
  <li><a href="#pharmacogenomics-and-adverse-drug-reaction-risk" id="toc-pharmacogenomics-and-adverse-drug-reaction-risk" class="nav-link" data-scroll-target="#pharmacogenomics-and-adverse-drug-reaction-risk"><span class="header-section-number">17.8.3</span> Pharmacogenomics and Adverse Drug Reaction Risk</a></li>
  </ul></li>
  <li><a href="#practical-design-patterns-and-outlook" id="toc-practical-design-patterns-and-outlook" class="nav-link" data-scroll-target="#practical-design-patterns-and-outlook"><span class="header-section-number">17.9</span> Practical Design Patterns and Outlook</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch-p5-clinical.html">Part V: Applications</a></li><li class="breadcrumb-item"><a href="./ch-p5-clinical.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Clinical Risk Prediction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Modern genomic foundation models (GFMs) give us increasingly rich representations of DNA, RNA, proteins, and multi-omic context (Parts II–IV). The natural next question is: <strong>how do we turn these representations into actionable predictions for individual patients?</strong></p>
<p>This chapter focuses on <strong>clinical risk prediction and decision support</strong>—models that estimate the probability, timing, or trajectory of outcomes such as incident disease, progression, recurrence, or adverse drug reactions. We emphasize how GFMs and related deep models:</p>
<ul>
<li>Extend <strong>polygenic risk scores (PRS)</strong> with richer sequence-based features and epistatic structure (e.g., Delphi, G2PT, MIFM) <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025 rakowski_mifm_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>; <a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.<br>
</li>
<li>Combine <strong>genomic features with EHR and multi-omics</strong> to produce holistic patient-level risk representations, building on systems from Chapter 16 (e.g., GLUE, CpGPT, DeepRVAT) <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024 clarke_deeprvat_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>; <a href="references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>.<br>
</li>
<li>Are wrapped in <strong>evaluation, calibration, uncertainty, and fairness</strong> pipelines suitable for high-stakes clinical decisions.</li>
</ul>
<p>We end with case studies in <strong>cardiometabolic risk</strong>, <strong>oncology risk and recurrence</strong>, and <strong>pharmacogenomics / adverse drug reactions</strong>, illustrating how GFMs move from bench to bedside.</p>
<hr>
<section id="problem-framing-what-is-clinical-risk-prediction" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="problem-framing-what-is-clinical-risk-prediction"><span class="header-section-number">17.1</span> Problem Framing: What Is Clinical Risk Prediction?</h2>
<p>Clinical risk prediction is the task of mapping <strong>patient data</strong>—including genotypes, family history, clinical measurements, imaging, and environmental factors—to <strong>probabilistic statements about future outcomes</strong>. Concretely, a model might answer questions like:</p>
<ul>
<li>What is this patient’s <strong>10-year risk of coronary artery disease</strong> if treated with standard of care?<br>
</li>
<li>Given current tumor characteristics and therapy, what is the <strong>hazard of recurrence</strong> within 2 years?<br>
</li>
<li>If we start this medication, what is the <strong>probability of a severe adverse drug reaction (ADR)</strong> in the next 6 months?</li>
</ul>
<p>In practice, these tasks fall into a few archetypes:</p>
<ul>
<li><strong>Individual-level incident risk</strong>
<ul>
<li>Will a currently disease-free individual develop disease <em>within a specified time window</em> (e.g., 10-year type 2 diabetes risk)?<br>
</li>
</ul></li>
<li><strong>Progression and complication risk</strong>
<ul>
<li>Among individuals with an existing condition, who will develop complications (e.g., nephropathy in diabetes, heart failure after myocardial infarction)?<br>
</li>
</ul></li>
<li><strong>Prognosis and survival</strong>
<ul>
<li>Time-from-baseline to events such as death, recurrence, or transplant, often with censoring and competing risks.<br>
</li>
</ul></li>
<li><strong>Treatment response and toxicity</strong>
<ul>
<li>Will a patient benefit from therapy A vs B, and what is their risk of severe toxicity or ADR?</li>
</ul></li>
</ul>
<p>GFMs enter these problems as <strong>feature generators</strong>: they transform raw genomic and multi-omic data into structured embeddings, variant effect scores, or region-level functional annotations. These representations then feed classic supervised learning tasks—classification, regression, and survival modeling—alongside clinical covariates.</p>
<hr>
</section>
<section id="task-types-and-loss-functions" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="task-types-and-loss-functions"><span class="header-section-number">17.2</span> Task Types and Loss Functions</h2>
<p>Although GFMs provide sophisticated inputs, the <strong>prediction tasks</strong> themselves often re-use well-understood statistical frameworks.</p>
<section id="binary-and-multi-label-classification" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="binary-and-multi-label-classification"><span class="header-section-number">17.2.1</span> Binary and Multi-label Classification</h3>
<p>For many screening or triage problems, risk prediction is posed as:</p>
<blockquote class="blockquote">
<p>Will outcome <em>Y</em> occur within horizon <em>T</em>?</p>
</blockquote>
<p>Examples include incident atrial fibrillation within 5 years, or hospitalization for heart failure in the next 12 months. Models output a <strong>risk score</strong> ( = P(Y=1 x) ), trained with cross-entropy or focal losses.</p>
<p>Extensions:</p>
<ul>
<li><strong>Multi-label classification</strong>: Predict multiple outcomes (e.g., myocardial infarction, stroke, heart failure) simultaneously; share a common representation but separate output heads.<br>
</li>
<li><strong>Ordinal endpoints</strong>: Disease stages or severity scores modeled with ordinal losses instead of strictly binary outcomes.</li>
</ul>
<p>GFMs contribute by providing <strong>richer genetic features</strong> than traditional hand-crafted burden scores or PRS (e.g., variant-level embeddings from Nucleotide Transformer, GPN, or regulatory LMs) <span class="citation" data-cites="dalla-torre_nucleotide_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>.</p>
</section>
<section id="survival-and-time-to-event-modeling" class="level3" data-number="17.2.2">
<h3 data-number="17.2.2" class="anchored" data-anchor-id="survival-and-time-to-event-modeling"><span class="header-section-number">17.2.2</span> Survival and Time-to-Event Modeling</h3>
<p>Risk is often more naturally expressed as <strong>time-to-event</strong>:</p>
<ul>
<li>Time from baseline to myocardial infarction or revascularization.<br>
</li>
<li>Time from surgery to cancer recurrence.<br>
</li>
<li>Time from first exposure to drug to severe toxicity.</li>
</ul>
<p>These require models that handle <strong>censoring</strong> (patients lost to follow-up or event-free at study end). Approaches include:</p>
<ul>
<li><strong>Cox proportional hazards models</strong> with genomic and GFM-derived features as covariates.<br>
</li>
<li><strong>Deep survival models</strong> that use neural networks to parameterize hazard functions, survival curves, or discrete-time hazards.<br>
</li>
<li><strong>Competing risks models</strong> for mutually exclusive outcomes (e.g., cancer-specific vs non-cancer mortality).</li>
</ul>
<p>GFMs naturally provide <strong>high-dimensional, possibly non-linear features</strong>; deep survival architectures can exploit these features while learning flexible hazard structures.</p>
</section>
<section id="multi-task-risk-and-shared-representations" class="level3" data-number="17.2.3">
<h3 data-number="17.2.3" class="anchored" data-anchor-id="multi-task-risk-and-shared-representations"><span class="header-section-number">17.2.3</span> Multi-task Risk and Shared Representations</h3>
<p>Large health systems increasingly estimate risk for <strong>dozens of outcomes</strong> simultaneously (e.g., hospital readmission, multiple cardiovascular endpoints, medication-specific ADRs). This motivates <strong>multi-task frameworks</strong>:</p>
<ul>
<li>A shared encoder (combining EHR, genomic, and multi-omic encoders) produces a <strong>patient-level embedding</strong>.<br>
</li>
<li>Multiple output heads estimate risks for different endpoints or time horizons.</li>
</ul>
<p>Such models can exploit <strong>cross-task correlations</strong> and share statistical strength (e.g., overlapping genetic architectures between lipids, CAD, and stroke). Deep polygenic architectures like Delphi and G2PT already adopt multi-trait ideas for genomic risk representations <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>.</p>
<hr>
</section>
</section>
<section id="from-prs-to-gfm-enabled-risk-scores" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="from-prs-to-gfm-enabled-risk-scores"><span class="header-section-number">17.3</span> From PRS to GFM-Enabled Risk Scores</h2>
<p>Polygenic risk scores (PRS) are a natural starting point for genomically informed clinical prediction.</p>
<section id="classical-prs-strengths-and-limitations" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="classical-prs-strengths-and-limitations"><span class="header-section-number">17.3.1</span> Classical PRS: Strengths and Limitations</h3>
<p>Traditional PRS typically:</p>
<ol type="1">
<li>Use GWAS summary statistics to estimate per-variant weights.<br>
</li>
<li>Construct a score ( S = _j w_j g_j ), where ( g_j ) is genotype at variant ( j ) and ( w_j ) is its estimated effect size.<br>
</li>
<li>Plug PRS into regression or survival models alongside clinical covariates (age, sex, BMI, labs).</li>
</ol>
<p>Despite many successes, classical PRS have well-known limitations:</p>
<ul>
<li><strong>Limited modeling of epistasis and non-linearities</strong>: Additive models struggle with higher-order interactions and context-dependent effects.<br>
</li>
<li><strong>Challenge in integrating functional priors</strong>: Annotation-aware methods exist, but rarely leverage full GFMs.<br>
</li>
<li><strong>Portability gaps</strong>: Performance often drops in under-represented ancestries due to LD structure and GWAS ascertainment.</li>
</ul>
<p>These limitations motivate <strong>deep learning-based PRS</strong> that better exploit structure in both genotype and functional annotation space.</p>
</section>
<section id="deep-polygenic-risk-delphi-and-g2pt" class="level3" data-number="17.3.2">
<h3 data-number="17.3.2" class="anchored" data-anchor-id="deep-polygenic-risk-delphi-and-g2pt"><span class="header-section-number">17.3.2</span> Deep Polygenic Risk: Delphi and G2PT</h3>
<p>Recent methods push beyond additive scores by using <strong>deep sequence and genotype models</strong>:</p>
<ul>
<li><strong>Delphi</strong>: A deep-learning method for polygenic risk prediction that jointly models variant-level features and higher-order patterns across the genome <span class="citation" data-cites="georgantas_delphi_2024">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>)</span>.
<ul>
<li>Can incorporate <strong>variant annotations and linkage structure</strong> more flexibly than linear PRS.<br>
</li>
<li>Supports multi-phenotype prediction, effectively performing <strong>task-conditioned PRS</strong>.</li>
</ul></li>
<li><strong>G2PT (Genotype-to-Phenotype Transformer)</strong>: A transformer-based architecture that treats an individual’s genotype as a sequence of variant “tokens” and learns <strong>polygenic risk representations</strong> with attention-based context <span class="citation" data-cites="lee_g2pt_2025">(<a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>.
<ul>
<li>Naturally captures <strong>epistatic interactions</strong> via attention, not just additive effects.<br>
</li>
<li>Emphasizes interpretability by tying attention patterns back to loci and pathways.</li>
</ul></li>
</ul>
<p>Both systems can optionally use <strong>GFM-derived variant features</strong> (e.g., scores from sequence-level LMs such as Nucleotide Transformer, HyenaDNA, or GPN) <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>. In this view:</p>
<ol type="1">
<li>A GFM maps variant and local sequence context to <strong>variant effect features</strong> (e.g., predicted impact on chromatin, expression, motifs).<br>
</li>
<li>A <strong>polygenic risk model</strong> (Delphi, G2PT, or related) aggregates these features across the genome to produce a <strong>patient-level risk embedding</strong>.<br>
</li>
<li>A <strong>clinical head</strong> uses this embedding plus EHR covariates to output risk for specific outcomes or time horizons.</li>
</ol>
</section>
<section id="fine-mapping-and-causal-variants-mifm" class="level3" data-number="17.3.3">
<h3 data-number="17.3.3" class="anchored" data-anchor-id="fine-mapping-and-causal-variants-mifm"><span class="header-section-number">17.3.3</span> Fine-mapping and Causal Variants: MIFM</h3>
<p>Polygenic risk ultimately hinges on <strong>causal variants</strong>, not just associated markers. MIFM (Multiple Instance Fine-Mapping) exemplifies how deep sequence models can refine the link between variant effects and risk:</p>
<ul>
<li><strong>MIFM</strong> uses a deep sequence model in a <strong>multiple-instance learning</strong> framework to identify causal regulatory variants within associated loci <span class="citation" data-cites="rakowski_mifm_2025">(<a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.<br>
</li>
<li>By modeling sets (bags) of variants per locus, it distinguishes <strong>causal variants from passengers</strong> in tight LD blocks.<br>
</li>
<li>The outputs—posterior probabilities or importance scores for candidate variants—can inform both mechanistic studies and more <strong>parsimonious, interpretable PRS</strong>.</li>
</ul>
<p>Together, Delphi, G2PT, and MIFM illustrate a pattern that recurs throughout this chapter:</p>
<blockquote class="blockquote">
<p>Use GFMs and deep sequence models to <strong>transform raw genotype into rich, structured features</strong>, then plug those features into <strong>prediction and decision-support architectures</strong> that live closer to the clinic.</p>
</blockquote>
<hr>
</section>
</section>
<section id="beyond-genotype-fusing-gfms-with-ehr-and-multi-omics" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="beyond-genotype-fusing-gfms-with-ehr-and-multi-omics"><span class="header-section-number">17.4</span> Beyond Genotype: Fusing GFMs with EHR and Multi-omics</h2>
<p>Clinical risk prediction rarely depends on genetics alone. Real-world deployment typically requires <strong>fusing genomic features with EHR, imaging, and other omics</strong>, mirroring the multi-omics integration strategies from Chapter 16 <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024 clarke_deeprvat_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>; <a href="references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>.</p>
<section id="feature-sources" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="feature-sources"><span class="header-section-number">17.4.1</span> Feature Sources</h3>
<ol type="1">
<li><strong>Genomics and regulatory features</strong>
<ul>
<li>Zero-shot variant scores from DNA GFMs (e.g., Nucleotide Transformer, HyenaDNA, GPN, Grover) <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>.<br>
</li>
<li>Coding variant scores from protein LMs (e.g., AlphaMissense-like systems; see earlier chapters).<br>
</li>
<li>Fine-mapped causal variant probabilities from MIFM or similar <span class="citation" data-cites="rakowski_mifm_2025">(<a href="references.html#ref-rakowski_mifm_2025" role="doc-biblioref">Rakowski and Lippert 2025</a>)</span>.</li>
</ul></li>
<li><strong>Multi-omics and systems context</strong>
<ul>
<li>Cell-type–resolved epigenomic and transcriptomic embeddings from GLUE/SCGLUE and CpGPT <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>.<br>
</li>
<li>Rare-variant burden and pathway-level representations from DeepRVAT and related models <span class="citation" data-cites="clarke_deeprvat_2024">(<a href="references.html#ref-clarke_deeprvat_2024" role="doc-biblioref">Clarke et al. 2024</a>)</span>.<br>
</li>
<li>Tumor-level representations from models such as SetQuence/SetOmic or GNN-based cancer subtypers <span class="citation" data-cites="jurenaite_setquence_2024 li_mogcn_2022 li_cgmega_2024">(<a href="references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>; <a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>; <a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>.</li>
</ul></li>
<li><strong>Clinical covariates and EHR</strong>
<ul>
<li>Demographics, vitals, lab results, medication history.<br>
</li>
<li>Problem lists, procedures, imaging-derived features.<br>
</li>
<li>Time-varying trajectories of biomarkers (e.g., eGFR, HbA1c, tumor markers).</li>
</ul></li>
</ol>
</section>
<section id="fusion-patterns" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="fusion-patterns"><span class="header-section-number">17.4.2</span> Fusion Patterns</h3>
<p>Architecturally, risk models usually adopt one of the fusion strategies echoed from Chapter 16:</p>
<ul>
<li><strong>Early fusion</strong>
<ul>
<li>Concatenate GFM-derived genomic embeddings with static clinical covariates and feed into a single MLP or survival model.<br>
</li>
<li>Simple but sensitive to scaling, missingness, and modality imbalance.</li>
</ul></li>
<li><strong>Intermediate fusion</strong>
<ul>
<li>Separate encoders for genomics, EHR, and multi-omics produce modality-specific embeddings.<br>
</li>
<li>A fusion layer (attention, cross-modal transformer, or graph-based integration) combines them into a <strong>patient embedding</strong>, which downstream heads use for risk prediction.</li>
</ul></li>
<li><strong>Late fusion / ensembling</strong>
<ul>
<li>Independent models per modality (e.g., a PRS-only model, an EHR-only model).<br>
</li>
<li>Meta-model or decision rule combines predictions (e.g., “treat if either PRS or EHR risk is high”).</li>
</ul></li>
</ul>
<p>From a practical standpoint, <strong>intermediate fusion</strong> is often most attractive: it allows modularity (swap encoders as GFMs improve) while enabling cross-modal interactions.</p>
<hr>
</section>
</section>
<section id="evaluation-discrimination-calibration-and-clinical-utility" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="evaluation-discrimination-calibration-and-clinical-utility"><span class="header-section-number">17.5</span> Evaluation: Discrimination, Calibration, and Clinical Utility</h2>
<p>High performance on test sets is not enough for clinical deployment. Risk models must be <strong>discriminative, well-calibrated, robust, and clinically useful</strong>.</p>
<section id="discrimination" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="discrimination"><span class="header-section-number">17.5.1</span> Discrimination</h3>
<p><strong>Discrimination</strong> measures how well the model ranks individuals by risk:</p>
<ul>
<li><strong>AUROC (AUC)</strong> for binary endpoints.<br>
</li>
<li><strong>AUPRC</strong> when outcomes are rare (e.g., severe ADRs).<br>
</li>
<li><strong>C-index</strong> and time-dependent AUC for survival tasks.</li>
</ul>
<p>Strong discrimination is necessary but not sufficient; poorly calibrated models can still achieve high AUROC.</p>
</section>
<section id="calibration-and-risk-stratification" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="calibration-and-risk-stratification"><span class="header-section-number">17.5.2</span> Calibration and Risk Stratification</h3>
<p><strong>Calibration</strong> asks whether predicted probabilities match observed frequencies:</p>
<ul>
<li>If a group of patients is assigned ~20% risk of an event, do ~20% actually experience it?<br>
</li>
<li>Calibration is assessed with <strong>calibration plots</strong>, <strong>Hosmer–Lemeshow tests</strong>, and <strong>Brier scores</strong>, often stratified by subgroups (e.g., ancestry, sex, age).</li>
</ul>
<p>For PRS-informed models, calibration is especially important because:</p>
<ul>
<li>Raw PRS are often <strong>centered and scaled</strong> rather than calibrated; mapping PRS to absolute risk usually requires <strong>post-hoc models</strong> that incorporate baseline incidence and covariates.<br>
</li>
<li>GFMs can shift score distributions as architectures evolve; recalibration may be required when swapping or updating encoders.</li>
</ul>
</section>
<section id="uncertainty-estimation-and-when-not-to-predict" class="level3" data-number="17.5.3">
<h3 data-number="17.5.3" class="anchored" data-anchor-id="uncertainty-estimation-and-when-not-to-predict"><span class="header-section-number">17.5.3</span> Uncertainty Estimation and “When Not to Predict”</h3>
<p>In high-stakes settings, models should know when they <strong>do not know</strong>. Common strategies include:</p>
<ul>
<li><strong>Ensemble variance</strong> or <strong>Monte Carlo dropout</strong> as uncertainty proxies.<br>
</li>
<li><strong>Conformal prediction</strong> to output <strong>risk intervals</strong> or <strong>prediction sets</strong> with guaranteed coverage.<br>
</li>
<li><strong>Selective prediction / abstention</strong>: allow models to <strong>abstain</strong> on cases where uncertainty is high or inputs are out-of-distribution (e.g., rare ancestries missing from training, novel tumor subtypes).</li>
</ul>
<p>For GFM-based systems, uncertainty can be decomposed:</p>
<ul>
<li><strong>Genomic uncertainty</strong>: confidence in variant effect predictions or fine-mapping (e.g., MIFM probabilities).<br>
</li>
<li><strong>Clinical uncertainty</strong>: extrapolation to new care settings, practice patterns, or patient populations.</li>
</ul>
<p>Communicating uncertainty transparently is a core part of decision support.</p>
</section>
<section id="fairness-bias-and-health-equity" class="level3" data-number="17.5.4">
<h3 data-number="17.5.4" class="anchored" data-anchor-id="fairness-bias-and-health-equity"><span class="header-section-number">17.5.4</span> Fairness, Bias, and Health Equity</h3>
<p>Many genomic and EHR datasets reflect <strong>historical and structural inequities</strong>. Risk models can <strong>amplify</strong> these biases if not carefully evaluated.</p>
<p>Key considerations:</p>
<ul>
<li><strong>Ancestry and PRS portability</strong>: Classical PRS underperform in under-represented ancestries due to GWAS design; GFM-based methods such as Delphi and G2PT have the opportunity—but not the guarantee—to improve this by leveraging functional priors and cross-ancestry information <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>.<br>
</li>
<li><strong>Measurement and access bias</strong>: EHR-derived features may differ systematically across groups (e.g., who gets genotyped, which labs are ordered).<br>
</li>
<li><strong>Group-wise calibration</strong>: Evaluate calibration and discrimination separately by ancestry, sex, socio-economic proxies, and care site.<br>
</li>
<li><strong>Fairness metrics and constraints</strong>: When necessary, enforce group-level constraints (e.g., equalized odds) or design <strong>affirmative</strong> models targeting historically disadvantaged groups.</li>
</ul>
<p>Equity is not an afterthought; for GFMs, it should inform <strong>what data to pretrain on</strong>, which <strong>benchmarks</strong> to report, and how to deploy models in practice.</p>
<hr>
</section>
</section>
<section id="prospective-validation-trials-and-regulation" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="prospective-validation-trials-and-regulation"><span class="header-section-number">17.6</span> Prospective Validation, Trials, and Regulation</h2>
<p>Retrospective AUCs are not enough to justify clinical use. Clinical risk models typically require:</p>
<ul>
<li><strong>Prospective validation</strong>: Evaluate model performance in a temporally held-out cohort, ideally in multiple health systems with different population structures and practice patterns.<br>
</li>
<li><strong>Impact studies</strong>: Measure whether using the model actually <strong>changes clinician behavior</strong> and <strong>improves outcomes</strong> (e.g., better statin targeting, fewer ADRs, reduced unnecessary imaging).<br>
</li>
<li><strong>Randomized or pragmatic trials</strong> when models materially influence treatment decisions, to guard against hidden confounding in observational evaluations.</li>
</ul>
<p>Regulatory landscapes (e.g., device approvals, software-as-a-medical-device frameworks) increasingly recognize <strong>learning systems</strong> and <strong>continuous updates</strong>. GFMs complicate this further:</p>
<ul>
<li>A “fixed” risk model may rely on a GFM backbone that improves over time; updates may change risk rankings and calibration.<br>
</li>
<li>Regulatory strategies include <strong>locked models with explicit versions</strong>, <strong>change control plans</strong>, or <strong>adaptive approvals</strong> for constrained forms of continual learning.</li>
</ul>
<p>Regardless of the framework, clear documentation of <strong>data provenance</strong>, <strong>GFM versions</strong>, <strong>training procedures</strong>, and <strong>validation results</strong> is essential.</p>
<hr>
</section>
<section id="monitoring-drift-and-continual-learning" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="monitoring-drift-and-continual-learning"><span class="header-section-number">17.7</span> Monitoring, Drift, and Continual Learning</h2>
<p>Once deployed, GFMs and downstream risk models operate in <strong>non-stationary environments</strong>:</p>
<ul>
<li>Clinical practice patterns change (new treatments, guidelines).<br>
</li>
<li>Patient populations drift (e.g., new screening programs).<br>
</li>
<li>Lab assays and sequencing pipelines evolve.</li>
</ul>
<p>Monitoring should track:</p>
<ul>
<li><strong>Input distributions</strong> (e.g., genotype frequencies, EHR feature patterns).<br>
</li>
<li><strong>Output distributions</strong> (risk score histograms, fraction of patients above decision thresholds).<br>
</li>
<li><strong>Performance over time</strong> (calibration, discrimination), often via rolling windows or periodic audits.</li>
</ul>
<p>When drift is detected:</p>
<ul>
<li><strong>Recalibration</strong> may suffice (e.g., refitting a calibration layer to current data).<br>
</li>
<li><strong>Partial retraining</strong> of heads or fusion layers can adapt to new environments while keeping GFM weights fixed.<br>
</li>
<li><strong>Full continual learning</strong>—including updating GFM backbones—requires careful safeguards to avoid catastrophic forgetting and maintain regulatory compliance.</li>
</ul>
<p>Design patterns from Chapter 16’s systems models (e.g., modular encoders, robust interfaces between GFMs and clinical layers) are crucial for maintainable, updatable decision support.</p>
<hr>
</section>
<section id="case-studies" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="case-studies"><span class="header-section-number">17.8</span> Case Studies</h2>
<p>To make these ideas concrete, we outline three stylized case studies that build on models and concepts from earlier chapters.</p>
<section id="cardiometabolic-risk-stratification" class="level3" data-number="17.8.1">
<h3 data-number="17.8.1" class="anchored" data-anchor-id="cardiometabolic-risk-stratification"><span class="header-section-number">17.8.1</span> Cardiometabolic Risk Stratification</h3>
<p><strong>Goal:</strong> Identify individuals at high risk of major adverse cardiovascular events (MACE)—e.g., myocardial infarction, stroke, cardiovascular death—over a 10-year horizon.</p>
<p><strong>Inputs:</strong></p>
<ul>
<li><strong>Genotype</strong>: Biobank-scale genotyping or WGS data.<br>
</li>
<li><strong>GFM features</strong>: Variant effect scores from DNA GFMs (Nucleotide Transformer, HyenaDNA, GPN) <span class="citation" data-cites="dalla-torre_nucleotide_2023 nguyen_hyenadna_2023 benegas_gpn_2023">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-nguyen_hyenadna_2023" role="doc-biblioref">Nguyen et al. 2023</a>; <a href="references.html#ref-benegas_gpn_2023" role="doc-biblioref">Benegas, Batra, and Song 2023</a>)</span>.<br>
</li>
<li><strong>Polygenic model</strong>: Delphi or G2PT to produce a <strong>polygenic risk embedding</strong> for cardiometabolic traits <span class="citation" data-cites="georgantas_delphi_2024 lee_g2pt_2025">(<a href="references.html#ref-georgantas_delphi_2024" role="doc-biblioref">Georgantas, Kutalik, and Richiardi 2024</a>; <a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>.<br>
</li>
<li><strong>Clinical data</strong>: Age, sex, BMI, blood pressure, lipids, smoking, diabetes status, medications (e.g., statins, antihypertensives).</li>
</ul>
<p><strong>Model design:</strong></p>
<ol type="1">
<li>Use a DNA GFM to compute variant-level annotations (e.g., predicted enhancer disruption in cardiomyocyte or hepatocyte contexts).<br>
</li>
<li>Feed annotations and genotypes into Delphi or G2PT to obtain a <strong>patient-level genomics embedding</strong> tuned for cardiometabolic outcomes.<br>
</li>
<li>Fuse the genomics embedding with EHR covariates via an intermediate fusion network (e.g., MLP or transformer over structured features).<br>
</li>
<li>Train the model to predict <strong>10-year MACE risk</strong> using survival or discrete-time hazard losses.</li>
</ol>
<p><strong>Clinical use:</strong></p>
<ul>
<li>Stratify patients into risk categories (e.g., low, intermediate, high) that inform <strong>statin initiation</strong>, <strong>PCSK9 inhibitor consideration</strong>, or <strong>intensive lifestyle intervention</strong>.<br>
</li>
<li>Provide <strong>individual-level explanations</strong>: highlight variants and pathways (via G2PT attention or Delphi variant contributions) that most contributed to risk—bridging Chapters 9 and 15.<br>
</li>
<li>Evaluate equity: ensure performance and calibration hold across ancestries and care sites.</li>
</ul>
</section>
<section id="oncology-risk-and-recurrence-prediction" class="level3" data-number="17.8.2">
<h3 data-number="17.8.2" class="anchored" data-anchor-id="oncology-risk-and-recurrence-prediction"><span class="header-section-number">17.8.2</span> Oncology: Risk and Recurrence Prediction</h3>
<p><strong>Goal:</strong> Predict recurrence risk and treatment benefit for patients with solid tumors after surgery or first-line therapy.</p>
<p><strong>Inputs:</strong></p>
<ul>
<li><strong>Somatic landscapes</strong> from whole-exome or whole-genome tumor sequencing.<br>
</li>
<li><strong>Tumor representations</strong> from deep set or transformer architectures such as SetQuence/SetOmic <span class="citation" data-cites="jurenaite_setquence_2024">(<a href="references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>)</span>.<br>
</li>
<li><strong>Multi-omics</strong>: tumor expression, methylation, and chromatin accessible from integrated frameworks (GLUE, CpGPT) <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>.<br>
</li>
<li><strong>GNN-based subtyping</strong>: embeddings or cluster assignments from cancer subtyping models like MoGCN and CGMega <span class="citation" data-cites="li_mogcn_2022 li_cgmega_2024">(<a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>; <a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>.<br>
</li>
<li><strong>Clinical features</strong>: stage, grade, performance status, treatment regimen.</li>
</ul>
<p><strong>Model design:</strong></p>
<ol type="1">
<li>Encode somatic mutation sets with SetQuence/SetOmic to obtain <strong>tumor-variant embeddings</strong> <span class="citation" data-cites="jurenaite_setquence_2024">(<a href="references.html#ref-jurenaite_setquence_2024" role="doc-biblioref">Jurenaite et al. 2024</a>)</span>.<br>
</li>
<li>Integrate transcriptomic and epigenomic profiles via GLUE-like latent spaces and CpGPT methylation embeddings <span class="citation" data-cites="cao_glue_2022 camillo_cpgpt_2024">(<a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>; <a href="references.html#ref-camillo_cpgpt_2024" role="doc-biblioref">Camillo et al. 2024</a>)</span>.<br>
</li>
<li>Combine these with <strong>GNN-based subtype embeddings</strong> (MoGCN/CGMega) to capture tumor–microenvironment and histopathological context <span class="citation" data-cites="li_mogcn_2022 li_cgmega_2024">(<a href="references.html#ref-li_mogcn_2022" role="doc-biblioref">X. Li et al. 2022</a>; <a href="references.html#ref-li_cgmega_2024" role="doc-biblioref">H. Li et al. 2024</a>)</span>.<br>
</li>
<li>Fuse tumor-level representations with clinical features in a <strong>time-to-recurrence model</strong> (e.g., flexible deep survival network).</li>
</ol>
<p><strong>Clinical use:</strong></p>
<ul>
<li>Provide risk estimates that guide <strong>adjuvant therapy decisions</strong> (e.g., intensifying chemotherapy or adding targeted agents for high-risk patients).<br>
</li>
<li>Suggest <strong>candidate biomarkers</strong> or pathways for trial stratification, based on GFM-derived importance scores and attention maps.<br>
</li>
<li>Monitor drift as treatment standards evolve; update models to reflect new targeted therapies and immune checkpoint inhibitors.</li>
</ul>
</section>
<section id="pharmacogenomics-and-adverse-drug-reaction-risk" class="level3" data-number="17.8.3">
<h3 data-number="17.8.3" class="anchored" data-anchor-id="pharmacogenomics-and-adverse-drug-reaction-risk"><span class="header-section-number">17.8.3</span> Pharmacogenomics and Adverse Drug Reaction Risk</h3>
<p><strong>Goal:</strong> Predict which patients are at high risk of <strong>severe ADRs</strong> (e.g., myopathy on statins, severe cutaneous reactions to certain drugs, cardiotoxicity of oncology agents).</p>
<p><strong>Inputs:</strong></p>
<ul>
<li><strong>Germline variation</strong> in pharmacogenes (e.g., CYP family, HLA alleles) and broader genome.<br>
</li>
<li><strong>Variant effect scores</strong> from both DNA and protein LMs for coding and regulatory variants in drug metabolism and immune genes (see Chapters 2–3, 9–10).<br>
</li>
<li><strong>Clinical context</strong>: co-medications, comorbidities, organ function (liver, kidney), prior adverse reactions.</li>
</ul>
<p><strong>Model design:</strong></p>
<ol type="1">
<li>Use GFMs to derive <strong>mechanistically meaningful features</strong> for variants in pharmacogenes (e.g., predicted impact on protein stability, binding, or gene regulation).<br>
</li>
<li>Aggregate these features across loci into a <strong>pharmacogenomic risk embedding</strong>, possibly using a G2PT-style transformer restricted to relevant genes <span class="citation" data-cites="lee_g2pt_2025">(<a href="references.html#ref-lee_g2pt_2025" role="doc-biblioref">Lee et al. 2025</a>)</span>.<br>
</li>
<li>Combine this with EHR data in a multi-task classification model that predicts ADR risk for multiple drugs or drug classes.</li>
</ol>
<p><strong>Clinical use:</strong></p>
<ul>
<li>Flag patients at high risk <strong>before initiating therapy</strong>, prompting genotype-guided drug choice or dose adjustment.<br>
</li>
<li>Generate reports that tie risk back to <strong>specific variants and pharmacogenes</strong>, aligned with existing clinical pharmacogenomics guidelines.<br>
</li>
<li>Evaluate performance across ancestries to avoid <strong>exacerbating disparities</strong> in access to safe and effective therapy.</li>
</ul>
<hr>
</section>
</section>
<section id="practical-design-patterns-and-outlook" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="practical-design-patterns-and-outlook"><span class="header-section-number">17.9</span> Practical Design Patterns and Outlook</h2>
<p>Across these examples, several design patterns for GFM-enabled clinical prediction recur:</p>
<ul>
<li><p>Treat GFMs as <strong>modular feature extractors</strong>:</p>
<ul>
<li>Keep a clear separation between <strong>foundation encoders</strong> and <strong>clinical prediction heads</strong>, easing updates and regulatory management.</li>
</ul></li>
<li><p>Embrace <strong>multi-modal fusion</strong>:</p>
<ul>
<li>Combine genotype, multi-omics, and EHR, taking advantage of architectures discussed in Chapters 10 and 16 <span class="citation" data-cites="dalla-torre_nucleotide_2023 cao_glue_2022">(<a href="references.html#ref-dalla-torre_nucleotide_2023" role="doc-biblioref">Dalla-Torre et al. 2023</a>; <a href="references.html#ref-cao_glue_2022" role="doc-biblioref">Cao and Gao 2022</a>)</span>.</li>
</ul></li>
<li><p>Prioritize <strong>calibration, uncertainty, and fairness</strong> as first-class citizens, not post-hoc add-ons.</p></li>
<li><p>Bridge <strong>interpretability and mechanism</strong>:</p>
<ul>
<li>Use tools from Chapter 15 to connect individual risk predictions to variants, regions, and pathways, enabling mechanistic hypotheses and clinician trust.</li>
</ul></li>
<li><p>Design for <strong>continual learning and monitoring</strong>:</p>
<ul>
<li>Assume that clinical practice and data distributions will change; build pipelines that can adapt responsibly.</li>
</ul></li>
</ul>
<p>In the broader story of this book, clinical risk prediction and decision support represent a key <strong>translation layer</strong>: they connect the representational gains of genomic foundation models to the realities of patient care. The next chapters will extend these ideas to other application domains (e.g., rare disease diagnosis, discovery of pathogenic variants, and drug/biotech innovation), further exploring how GFMs reshape translational genomics.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-benegas_gpn_2023" class="csl-entry" role="listitem">
Benegas, Gonzalo, Sanjit Singh Batra, and Yun S. Song. 2023. <span>“[<span>GPN</span>] <span>DNA</span> Language Models Are Powerful Predictors of Genome-Wide Variant Effects.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (44): e2311219120. <a href="https://doi.org/10.1073/pnas.2311219120">https://doi.org/10.1073/pnas.2311219120</a>.
</div>
<div id="ref-camillo_cpgpt_2024" class="csl-entry" role="listitem">
Camillo, Lucas Paulo de Lima, Raghav Sehgal, Jenel Armstrong, Albert T. Higgins-Chen, Steve Horvath, and Bo Wang. 2024. <span>“<span>CpGPT</span>: A <span>Foundation</span> <span>Model</span> for <span>DNA</span> <span>Methylation</span>.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.24.619766">https://doi.org/10.1101/2024.10.24.619766</a>.
</div>
<div id="ref-cao_glue_2022" class="csl-entry" role="listitem">
Cao, Zhi-Jie, and Ge Gao. 2022. <span>“[<span>GLUE</span>] <span>Multi</span>-Omics Single-Cell Data Integration and Regulatory Inference with Graph-Linked Embedding.”</span> <em>Nature Biotechnology</em> 40 (10): 1458–66. <a href="https://doi.org/10.1038/s41587-022-01284-4">https://doi.org/10.1038/s41587-022-01284-4</a>.
</div>
<div id="ref-clarke_deeprvat_2024" class="csl-entry" role="listitem">
Clarke, Brian, Eva Holtkamp, Hakime Öztürk, Marcel Mück, Magnus Wahlberg, Kayla Meyer, Felix Munzlinger, et al. 2024. <span>“[<span>DeepRVAT</span>] <span>Integration</span> of Variant Annotations Using Deep Set Networks Boosts Rare Variant Association Testing.”</span> <em>Nature Genetics</em> 56 (10): 2271–80. <a href="https://doi.org/10.1038/s41588-024-01919-z">https://doi.org/10.1038/s41588-024-01919-z</a>.
</div>
<div id="ref-dalla-torre_nucleotide_2023" class="csl-entry" role="listitem">
Dalla-Torre, Hugo, Liam Gonzalez, Javier Mendoza-Revilla, Nicolas Lopez Carranza, Adam Henryk Grzywaczewski, Francesco Oteri, Christian Dallago, et al. 2023. <span>“Nucleotide <span>Transformer</span>: Building and Evaluating Robust Foundation Models for Human Genomics.”</span> <em>Nature Methods</em> 22 (2): 287–97. <a href="https://doi.org/10.1038/s41592-024-02523-z">https://doi.org/10.1038/s41592-024-02523-z</a>.
</div>
<div id="ref-georgantas_delphi_2024" class="csl-entry" role="listitem">
Georgantas, Costa, Zoltán Kutalik, and Jonas Richiardi. 2024. <span>“Delphi: <span>A</span> <span>Deep</span>-Learning <span>Method</span> for <span>Polygenic</span> <span>Risk</span> <span>Prediction</span>.”</span> medRxiv. <a href="https://doi.org/10.1101/2024.04.19.24306079">https://doi.org/10.1101/2024.04.19.24306079</a>.
</div>
<div id="ref-jurenaite_setquence_2024" class="csl-entry" role="listitem">
Jurenaite, Neringa, Daniel León-Periñán, Veronika Donath, Sunna Torge, and René Jäkel. 2024. <span>“<span>SetQuence</span> &amp; <span>SetOmic</span>: <span>Deep</span> Set Transformers for Whole Genome and Exome Tumour Analysis.”</span> <em>BioSystems</em> 235 (January): 105095. <a href="https://doi.org/10.1016/j.biosystems.2023.105095">https://doi.org/10.1016/j.biosystems.2023.105095</a>.
</div>
<div id="ref-lee_g2pt_2025" class="csl-entry" role="listitem">
Lee, Ingoo, Zachary S. Wallace, Yuqi Wang, Sungjoon Park, Hojung Nam, Amit R. Majithia, and Trey Ideker. 2025. <span>“[<span>G2PT</span>] <span>A</span> Genotype-Phenotype Transformer to Assess and Explain Polygenic Risk.”</span> bioRxiv. <a href="https://doi.org/10.1101/2024.10.23.619940">https://doi.org/10.1101/2024.10.23.619940</a>.
</div>
<div id="ref-li_cgmega_2024" class="csl-entry" role="listitem">
Li, Hao, Zebei Han, Yu Sun, Fu Wang, Pengzhen Hu, Yuang Gao, Xuemei Bai, et al. 2024. <span>“<span>CGMega</span>: Explainable Graph Neural Network Framework with Attention Mechanisms for Cancer Gene Module Dissection.”</span> <em>Nature Communications</em> 15 (1): 5997. <a href="https://doi.org/10.1038/s41467-024-50426-6">https://doi.org/10.1038/s41467-024-50426-6</a>.
</div>
<div id="ref-li_mogcn_2022" class="csl-entry" role="listitem">
Li, Xiao, Jie Ma, Ling Leng, Mingfei Han, Mansheng Li, Fuchu He, and Yunping Zhu. 2022. <span>“<span>MoGCN</span>: <span>A</span> <span>Multi</span>-<span>Omics</span> <span>Integration</span> <span>Method</span> <span>Based</span> on <span>Graph</span> <span>Convolutional</span> <span>Network</span> for <span>Cancer</span> <span>Subtype</span> <span>Analysis</span>.”</span> <em>Frontiers in Genetics</em> 13 (February). <a href="https://doi.org/10.3389/fgene.2022.806842">https://doi.org/10.3389/fgene.2022.806842</a>.
</div>
<div id="ref-nguyen_hyenadna_2023" class="csl-entry" role="listitem">
Nguyen, Eric, Michael Poli, Marjan Faizi, Armin Thomas, Callum Birch-Sykes, Michael Wornow, Aman Patel, et al. 2023. <span>“<span>HyenaDNA</span>: <span>Long</span>-<span>Range</span> <span>Genomic</span> <span>Sequence</span> <span>Modeling</span> at <span>Single</span> <span>Nucleotide</span> <span>Resolution</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2306.15794">https://doi.org/10.48550/arXiv.2306.15794</a>.
</div>
<div id="ref-rakowski_mifm_2025" class="csl-entry" role="listitem">
Rakowski, Alexander, and Christoph Lippert. 2025. <span>“[<span>MIFM</span>] <span>Multiple</span> Instance Fine-Mapping: Predicting Causal Regulatory Variants with a Deep Sequence Model.”</span> medRxiv. <a href="https://doi.org/10.1101/2025.06.13.25329551">https://doi.org/10.1101/2025.06.13.25329551</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch-p4-interp.html" class="pagination-link" aria-label="Interpretability &amp; Mechanisms">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Interpretability &amp; Mechanisms</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch-p5-variants.html" class="pagination-link" aria-label="Pathogenic Variant Discovery">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Pathogenic Variant Discovery</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Josh Meehl</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>