::: {.callout-warning .content-visible when-profile="draft"}
**Chapter TODO**

- Double-check citation keys for Xpresso, ExPecto, Basenji, Enformer, and related models, and ensure they are present in `references.bib`.
- Coordinate figures and tables proposed in the inline callouts with the global book figure/table numbering.
- Verify technical details on model architectures, particularly window sizes and feature sets.
- Consider adding extended discussion of Borzoi in relation to Chapter 11.
:::

# Transcriptional Effects {#sec-trans}

The previous chapter examined CNN-based models that predict chromatin accessibility, histone modifications, and transcription factor binding directly from DNA sequence. These regulatory marks tell us where the genome is poised for transcriptional activity, but they do not directly answer a key question: which genes are actually expressed, at what levels, and in which cell types? This chapter extends from regulatory annotations to gene expression itself, showing how models integrate promoter sequences, distal regulatory elements, and mRNA stability features to predict transcript abundance and perturbation effects.

We focus primarily on two complementary approaches: Xpresso, which models promoter-proximal sequences and mRNA features to predict baseline expression, and ExPecto, which uses a CNN to predict chromatin features from sequence and then combines these features in tissue-specific linear models to predict expression across hundreds of cell types. Both frameworks enable variant effect prediction through in silico mutagenesis, providing mechanistic hypotheses about how sequence changes perturb expression. We close by discussing limitations around context dependence, epistasis, and the challenge of predicting cell-type-specific expression from sequence alone.

Throughout, we emphasize that expression is a systems-level phenotype shaped by multiple layers of regulation. Sequence encodes cis-regulatory information, but trans factors, chromatin state, and cellular context all modulate the final output. The models in this chapter represent early efforts to capture this complexity through deep learning, establishing patterns that reappear in transformer-based architectures and multi-omic foundation models in later chapters.

## From Chromatin to Expression: The Multilayer Problem

Gene expression levels in a given cell type emerge from multiple regulatory layers. Promoter-proximal sequences encode core transcription factor binding sites, TATA boxes, initiator elements, and CpG islands that recruit RNA polymerase II. Distal enhancers provide cell-type-specific activation or repression, with effects that can extend over hundreds of kilobases through chromatin looping. Transcript stability, codon usage, and UTR regulatory elements shape how much mRNA accumulates once transcription begins. Environmental signals, epigenetic modifications, and three-dimensional genome architecture modulate these effects dynamically.

This multilayer structure creates a prediction challenge. Models that look only at promoter-proximal sequence miss distal regulatory context. Models that incorporate chromatin state as input require experimental measurements for every cell type of interest. Ideally, we want models that predict expression from sequence alone, integrating promoter logic, distal regulation, and post-transcriptional features in a principled way.

The models discussed in this chapter pursue two distinct strategies. Xpresso focuses narrowly on promoter sequences and mRNA features, deliberately excluding distal regulatory elements to isolate what can be learned from local sequence context and transcript properties. ExPecto takes the opposite approach, using a CNN trained on chromatin data to infer regulatory element activity across large windows, then combining these predictions in linear models to estimate expression. Both approaches achieve substantial predictive power, revealing different aspects of the sequence-to-expression mapping.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Regulatory layers to expression**

Add a schematic showing the flow from DNA sequence through regulatory layers to mRNA abundance:
- Promoter-proximal elements (TF binding, TATA, CpG)
- Distal enhancers and silencers
- Chromatin state (accessibility, histone marks)
- Transcription initiation and elongation
- mRNA stability and decay
Indicate which layers Xpresso versus ExPecto explicitly model.
:::

## Xpresso: Expression from Promoters and mRNA Features

Xpresso represents a deliberately constrained approach to expression prediction. Rather than attempting to model the full regulatory landscape, it asks a focused question: how much of expression variability can be explained by promoter sequences and intrinsic mRNA properties, without considering distal elements or cell-type-specific chromatin state?

### Model Design and Features

Xpresso predicts steady-state mRNA abundance using two primary sources of information. First, it encodes the promoter region with a CNN that scans a window around the transcription start site, typically extending a few kilobases upstream and downstream. This CNN learns motifs corresponding to transcription factor binding sites, core promoter elements, and local sequence composition such as CpG dinucleotide density. Second, Xpresso incorporates features associated with mRNA stability: coding sequence length, 5' and 3' UTR characteristics, codon usage bias, and predicted secondary structure. These features are concatenated with the learned promoter representations and passed to fully connected layers that output a predicted log-transformed expression level.

The architecture is straightforward, involving convolutional layers for promoter sequence encoding followed by dense layers for regression. The key insight is feature selection: by restricting attention to promoter-proximal sequence and transcript properties, Xpresso isolates the contribution of these elements without confounding from distal regulation or trans-acting factors that vary across cell types.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Xpresso architecture**

Insert a diagram showing:
- Input: promoter sequence (CNN) + mRNA features (hand-crafted)
- CNN extracts learned representations from promoter
- Concatenation with mRNA stability features
- Fully connected layers → predicted expression
:::

### Predictive Performance

Xpresso achieves approximately 59% variance explained in human steady-state mRNA levels and 71% in mouse when trained on large-scale RNA-seq datasets. This performance is striking given the restricted feature set. It suggests that a substantial fraction of expression variability is determined by local promoter architecture and intrinsic transcript properties, independent of distal enhancers or cell-type-specific trans factors.

Interpretation of the learned model reveals that promoter-proximal CpG dinucleotides are among the strongest predictors of transcriptional activity. CpG islands near transcription start sites are canonical features of constitutively expressed housekeeping genes, and Xpresso's emphasis on CpG features recapitulates this biological knowledge without explicit feature engineering. Beyond CpG content, the CNN learns motifs corresponding to known transcription factor families, providing a direct link between sequence patterns and expression output.

### Limitations and Insights

Xpresso's focus on promoters and mRNA features means it cannot capture cell-type-specific regulation driven by distal enhancers or chromatin remodeling. Residuals from Xpresso predictions can be used to quantify the influence of factors the model ignores: enhancers, heterochromatic domains, microRNAs, and other trans-acting regulators. These residuals provide a complementary signal for downstream analyses, effectively partitioning expression into a promoter-driven baseline and a context-dependent modulation term.

The success of Xpresso establishes an important baseline: even without distal elements or chromatin state, local sequence and transcript features explain a large fraction of expression variance. This sets a benchmark for models like ExPecto and Enformer, which incorporate larger genomic windows and chromatin predictions. Any gains from those models represent the additional contribution of distal regulation and systems-level context.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Xpresso performance and interpretation**

Add a panel figure showing:
- Scatter plot of predicted versus observed expression for a representative dataset
- Bar chart of feature importance, highlighting CpG dinucleotides
- Residual analysis showing correlation with enhancer activity or chromatin marks
:::

## ExPecto: From Sequence to Chromatin to Expression

ExPecto extends the sequence-to-expression paradigm by explicitly modeling the intermediate layer of chromatin features. Rather than predicting expression directly from sequence, ExPecto uses a two-stage architecture: first, a CNN predicts genome-wide chromatin features from DNA sequence; second, tissue-specific linear models combine these chromatin predictions to estimate expression. This design cleanly separates sequence-level regulatory grammar (learned by the CNN) from tissue-specific regulatory programs (captured by the linear models).

### Architecture and Training

The first stage of ExPecto is the Beluga CNN, discussed in @sec-reg. Beluga is trained to predict 2,002 chromatin features spanning transcription factor binding, histone modifications, and DNase hypersensitivity across hundreds of cell types and assays. Beluga scans a 40 kb window centered on the transcription start site of each gene and outputs a vector of chromatin feature predictions at multiple positions within that window.

The second stage takes these chromatin feature predictions and aggregates them spatially and functionally to predict gene expression. For each gene and tissue, ExPecto fits a linear model that combines upstream and downstream chromatin features with position-dependent exponential decay functions. This formulation assumes that regulatory elements closer to the promoter have stronger effects, and it models activation and repression separately. The linear model is trained on large-scale expression datasets from GTEx, Roadmap Epigenomics, and ENCODE, covering 218 tissues and cell types.

Linear models were chosen deliberately. They provide interpretability, preventing overfitting given the high-dimensional feature space and enabling straightforward coefficient analysis to identify which chromatin features drive expression in each tissue. Because the upstream Beluga CNN is tissue-agnostic, the combination of a shared sequence-to-chromatin model with separate tissue-specific linear heads provides a clean separation between sequence-level regulatory grammar and tissue-specific regulatory programs.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: ExPecto two-stage architecture**

Insert a diagram showing:
- Stage 1: DNA sequence → Beluga CNN → chromatin feature predictions (2,002 features)
- Stage 2: chromatin features → tissue-specific linear model → predicted expression
- Indicate spatial aggregation with position-dependent decay functions
:::

### Expression Prediction Performance

ExPecto achieves a median Spearman correlation of 0.819 between predicted and observed expression across 218 tissues and cell types when evaluated on a held-out chromosome. This performance substantially improves over prior sequence-based expression models, which were typically limited to narrower regulatory regions (under 2 kb) and fewer cell types. The improvement demonstrates the value of integrating distal regulatory elements captured by the 40 kb window and leveraging chromatin features as an intermediate representation.

Beyond predicting absolute expression levels, ExPecto captures tissue-specific expression patterns. Analysis of model coefficients reveals automatic learning of cell-type-relevant features without explicit tissue labels. The liver expression model assigns top weights to transcription factors profiled in HepG2 (liver-derived) cells. The breast tissue model weights estrogen receptor and glucocorticoid receptor features from breast cancer cell lines most heavily among its positive coefficients. These patterns emerge purely from learning to predict expression, without any tissue identity information provided to the chromatin features.

Model coefficients also reveal the relative contributions of different chromatin feature types. Transcription factors and histone marks receive consistently higher weights, reflecting their direct mechanistic roles in transcriptional regulation. DNase I features receive significantly lower weights despite indicating regulatory activity. This discrepancy likely reflects that DNase hypersensitivity marks the presence of regulatory activity without specifying its type or causal relationship to expression.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: ExPecto performance and tissue specificity**

Add a multi-panel figure showing:
- Scatter plot of predicted versus observed expression for a representative tissue
- Bar chart of per-tissue Spearman correlation
- Heatmap of model coefficients for several tissues, highlighting tissue-specific transcription factors
:::

### Variant Effect Prediction

ExPecto's expression predictions enable scoring variant effects through in silico mutagenesis. For a given variant, the model predicts expression with the reference allele and with the alternative allele, then computes the difference:

$$
\Delta \text{expression} = f(\text{sequence}_{\text{alt}}) - f(\text{sequence}_{\text{ref}})
$$

Because the model never trains on variant data, predictions are unconfounded by linkage disequilibrium, a fundamental advantage over statistical eQTL approaches that rely on association testing in human populations.

ExPecto correctly predicted the direction of expression change for 92% of the top 500 strongest-effect GTEx eQTL variants. This performance demonstrates that sequence-based models can recapitulate population-level association signals without observing those associations during training. The model identifies which variants are likely causal by evaluating their effects on chromatin features and expression, rather than relying on correlation structure in the data.

ExPecto has been applied to prioritize causal variants within disease-associated loci from genome-wide association studies. In experimental validation for four immune-related diseases, ExPecto successfully identified variants that showed significant changes in transcriptional regulatory activity in reporter assays. For example, in a Crohn's disease locus, the top ExPecto-prioritized SNP was predicted to decrease expression of IRGM, an innate immune response gene strongly associated with inflammatory bowel disease. Reporter assays confirmed a significant decrease in transcriptional activity for this variant. Similar results held for loci associated with Behçet's disease and chronic hepatitis B infection. Importantly, in all cases, the directionality of expression change matched ExPecto's predictions.

These validations illustrate a key advantage of sequence-based variant effect prediction over purely statistical fine-mapping. Statistical approaches identify regions of association but struggle to pinpoint causal variants within correlated haplotype blocks. ExPecto evaluates variants mechanistically, predicting how each alters chromatin features and expression, which enables prioritization even when multiple variants are in strong linkage disequilibrium.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Variant effect prediction and validation**

Insert a figure showing:
- In silico mutagenesis schematic: reference → prediction, alternative → prediction, difference
- Scatter plot of predicted versus observed expression changes for GTEx eQTLs
- Bar chart of experimental validation results for GWAS-prioritized variants
:::

## Variation Potential and Evolutionary Constraints

ExPecto enables exploration of the regulatory mutation space at unprecedented scale. By computing predicted expression effects for every possible single nucleotide mutation within promoter-proximal regions, the model generates a catalog of variant effects spanning over 140 million potential mutations across all human RNA polymerase II-transcribed genes.

This catalog supports several analyses not possible with experimental assays. First, it identifies mutations with strong predicted effects on expression at high confidence, providing candidates for functional validation. Second, it characterizes the distribution of predicted effect sizes for each gene, which can serve as a measure of mutational robustness or constraint. Genes with many predicted high-impact mutations may be especially vulnerable to regulatory disruption, whereas genes with few such mutations may be buffered by redundant regulatory elements.

Third, the distribution of predicted effects across tissues reveals tissue-specific regulatory constraints. A variant predicted to strongly decrease expression in one tissue but have minimal effect in others highlights tissue-specific regulatory elements. Such predictions can guide experimental designs for reporter assays or CRISPR screens, focusing resources on variants and tissues most likely to show functional effects.

The concept of "variation potential" proposed by the ExPecto authors quantifies the collective impact of all potential mutations on a gene's expression. Genes with high variation potential are predicted to be more sensitive to regulatory perturbation, which may correlate with their roles in development, disease susceptibility, or evolutionary constraint. Conversely, genes with low variation potential may be robustly regulated, protected by multiple redundant elements or strong core promoters that buffer against single-nucleotide changes.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Variation potential landscape**

Add a figure showing:
- Distribution of predicted variant effects across genes (histogram or violin plot)
- Example gene locus with mutation effect predictions colored by magnitude
- Correlation between variation potential and evolutionary constraint metrics (e.g., LOEUF)
:::

## Cell-Type Specificity and Regulatory Context

One of the central challenges in expression prediction is accounting for cell-type specificity. The same genomic sequence produces vastly different expression patterns in liver versus brain versus immune cells. This variability arises from differences in trans-acting factors (transcription factors, coactivators, chromatin remodelers) that interpret cis-regulatory sequences.

Xpresso, by design, does not model cell-type-specific expression. It predicts a single baseline expression value that represents the average or typical level across contexts. This approach works well for constitutively expressed housekeeping genes but fails for genes with highly variable, context-dependent expression.

ExPecto addresses cell-type specificity through its two-stage architecture. The Beluga CNN learns a universal mapping from sequence to chromatin features, capturing which regulatory elements are present. The tissue-specific linear models learn how each cell type weighs these features to produce expression. This design assumes that sequence determines the potential for regulatory activity, while cellular context determines which potential is realized.

However, this assumption has limits. ExPecto's linear models cannot capture complex interactions among regulatory elements or nonlinear dependencies between chromatin features. In reality, enhancers often act synergistically, and repressors can override activation in context-dependent ways. The linear combination of chromatin features provides a useful first-order approximation but misses higher-order regulatory logic.

Models like Enformer and Borzoi, discussed in @sec-hybrid, extend ExPecto's approach by using transformer-based attention mechanisms to model long-range dependencies and nonlinear interactions among regulatory elements. These hybrid architectures achieve higher performance by capturing more complex regulatory grammar, though at the cost of reduced interpretability compared to ExPecto's linear models.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Cell-type-specific regulation**

Add a schematic contrasting:
- Xpresso: sequence → universal expression (no cell-type specificity)
- ExPecto: sequence → chromatin features → cell-type-specific linear model → expression
- Mention Enformer's transformer attention as extension for nonlinear interactions
:::

## Limitations and Open Challenges

Despite their success, sequence-based expression models face several fundamental limitations that remain active areas of research.

### Context Dependence Beyond Sequence

Expression is shaped by factors not encoded in cis-regulatory sequences. Trans-acting factors vary across cell types and developmental stages, chromatin architecture changes dynamically in response to signaling, and environmental perturbations alter regulatory programs. Models that predict from sequence alone cannot capture these dynamic effects without additional input.

One approach is to condition models on cell-type or context embeddings that represent the trans-regulatory environment. Another is to train models on perturbation data, learning how expression responds to changes in transcription factor abundance or chromatin state. Both strategies require moving beyond static sequence-to-expression mappings toward models that integrate sequence with cellular state.

### Long-Range Regulation and 3D Genome

Both Xpresso and ExPecto use relatively short genomic windows: Xpresso focuses on promoter-proximal regions, while ExPecto scans 40 kb around the TSS. Many enhancers lie hundreds of kilobases or even megabases away from their target genes, brought into proximity through chromatin looping. Models with limited context windows cannot see these distal elements, leading to systematic underprediction for genes regulated by long-range enhancers.

Addressing this limitation requires larger context windows, as achieved by Enformer (200 kb) and other hybrid models. However, even 200 kb is insufficient for the most distal regulatory elements. Incorporating 3D genome conformation data such as Hi-C or ChIA-PET offers a complementary approach, explicitly modeling which distal elements contact target promoters. Integrating sequence and 3D genome information remains an open challenge.

### Epistasis and Combinatorial Regulation

Most variant effect predictions assume independent effects: the impact of a variant is computed by comparing reference and alternative alleles in isolation. In reality, regulatory elements often act combinatorially. Two enhancers may act synergistically, producing greater-than-additive effects when both are active. Conversely, a silencer may override activation by enhancers, creating context-dependent epistasis.

Linear models like those in ExPecto cannot capture these interactions. More expressive architectures such as transformers can learn some combinatorial patterns, but interpreting these patterns mechanistically remains difficult. Developing models that explicitly represent regulatory logic (e.g., AND, OR, NOT gates) and epistatic interactions is a key frontier.

### Prediction Versus Understanding

High predictive accuracy does not guarantee mechanistic understanding. A model may predict expression accurately by exploiting spurious correlations or dataset biases without learning the underlying regulatory mechanisms. For example, a model might learn that high GC content predicts high expression in training data, even though GC content is correlated with but not causally responsible for expression.

Distinguishing learned mechanisms from learned shortcuts requires careful evaluation, including ablation studies, perturbation experiments, and tests of generalization to held-out contexts. Interpretability tools such as saliency maps and motif discovery can help, but they must be used cautiously and validated against known biology.

::: {.callout-warning .content-visible when-profile="draft"}
**Visual suggestion: Limitation schematic**

Add a diagram highlighting key limitations:
- Trans factors not in sequence (e.g., TF concentration varying across cells)
- Distal enhancers beyond model window
- Combinatorial logic (synergy, repression) not captured by linear models
- Spurious correlations versus causal mechanisms
:::

## Connections to Later Chapters

The models discussed in this chapter provide a foundation for understanding more complex architectures and applications in later parts of the book.

Hybrid models like Enformer and Borzoi, covered in @sec-hybrid, extend ExPecto's sequence-to-chromatin-to-expression paradigm by using transformers to model long-range dependencies. These models achieve state-of-the-art performance on expression prediction benchmarks by capturing regulatory grammar that linear models miss.

Genomic foundation models discussed in Part IV leverage similar architectures but are pretrained on massive unlabeled sequence corpora using self-supervised objectives. These models learn generalizable representations that can be fine-tuned for expression prediction, variant effect prediction, and other downstream tasks, as explored in @sec-princ and @sec-vep.

The interpretability challenges highlighted here recur throughout the book. @sec-interp examines tools for extracting mechanistic insights from learned models, including saliency maps, motif discovery, and perturbation-based attribution methods. Understanding when these tools succeed and when they mislead is critical for building trustworthy genomic AI systems.

Finally, the variant effect prediction strategies introduced here inform clinical applications in @sec-variants. Sequence-based models provide orthogonal information to population genetics approaches, enabling prioritization of causal variants in disease-associated loci even when linkage disequilibrium confounds statistical fine-mapping.

## Significance

Sequence-based expression prediction models represent a major step forward in understanding the regulatory code. By learning to predict expression from DNA sequence and mRNA features, they isolate the contribution of cis-regulatory elements and provide mechanistic hypotheses about how variants perturb expression.

Xpresso demonstrated that promoter-proximal sequences and mRNA features explain a substantial fraction of expression variance, establishing a baseline for more complex models. ExPecto extended this framework by incorporating distal regulatory elements through chromatin predictions, achieving strong performance across hundreds of tissues and enabling variant prioritization in disease-associated loci.

The two-stage architecture pioneered by ExPecto (sequence to chromatin to expression) provides a template for later models. By separating sequence-level grammar from tissue-specific interpretation, it offers interpretability and modularity that fully end-to-end models often lack. This design pattern recurs in hybrid architectures like Enformer and in multi-omic foundation models that integrate diverse data types.

The limitations discussed here point toward future directions: incorporating 3D genome conformation, modeling combinatorial regulatory logic, integrating trans-regulatory context, and developing mechanistic rather than merely predictive models. These challenges motivate much of the research in subsequent chapters, where transformers, foundation models, and multi-omic integration offer new tools for tackling the complexity of gene regulation.